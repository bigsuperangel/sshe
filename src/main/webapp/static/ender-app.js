/*!
  * =============================================================
  * Ender: open module JavaScript framework (https://ender.no.de)
  * Build: ender build ./modules/common ./modules/libs/template ./modules/libs/buypop ./modules/builder/cms ./modules/builder/cms/editor ./modules/builder/cms/templateAttributes ./modules/builder/settings ./modules/builder/store ./modules/builder/promotion ./modules/builder/event ./modules/builder/appointment ./modules/builder/business ./modules/builder ./modules/launcher ./modules/app ./modules/app/appList ./modules/app/setting --use ender-factory --noop --output ender-app
  * Packages: CommonModule@2.0.0 ArtTemplateLibs@1.0.0 BuyPopFeeatures@1.0.0 CMSModule@2.0.0 HTMLRichEditor@2.0.0 templateAttributes@2.0.0 AppSettings@2.0.0 AppStoreModule@2.0.0 AppPromotions@2.0.0 AppEventModule@2.0.0 AppAppointmentModule@2.0.0 BusinessModule@1.0.0 AppBuilderMain@2.0.0 AppLauncher@2.0.0 appModule@1.0.0 appList@1.0.0 setting@2.0.0
  * =============================================================
  */
(function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.common||(r.modules.common={})})(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf"),i=5;r.modules.common.Dialog=r.common.BaseView.extend({events:{"click .close":"close"},doInitialize:function(t){this.$el.html(s(this.title())).appendTo("body").find(".modal-content-inner"),this.internalInitialize(t),this.adjustLocation(),this.internalDialogShow(),e(window).bind("resize",n.bind(this._onWindowResize,this)),Mousetrap.bind("esc",n.bind(this.close,this)),this.show(t)},title:function(){return"Dialog"},viewport:function(){return this.__viewport||(this.__viewport=this.$el.find(".modal-content-inner"))},internalDialogShow:function(){this.$el.find(".modal").show(),e("body").addClass("modal-open")},internalInitialize:function(){},onClose:function(){},adjustLocation:function(){var t=this.$el.find(".modal-dialog"),n=e(window).height(),r=e(window).width(),i=t.outerHeight(),s=(r-t.outerWidth())/2/r*100,o=n-100<=i?n-100:i;o=(this.args.valign=="center"?(n-o)/3:o/10)/n*100,t.css({marginLeft:s+"%",marginTop:o+"%"})},close:function(){e("body").removeClass("modal-open"),this.onClose(),this.remove()},onRemove:function(){Mousetrap.unbind("esc",this.close),e(window).unbind("resize",this._onWindowResize)},_onWindowResize:function(e){this.adjustLocation()}});var s=function(e){return'<div>			<div class="modal">				<div class="modal-dialog">					<div class="modal-content">						<div class="modal-header lighter blue">							<button class="close">x</button>							<h4>'+e+'</h4>						</div>						<div class="modal-content-inner"></div>					</div>				</div>			</div>			<div class="modal-backdrop in"></div>		</div>'}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.common.weixinShareDialog=r.modules.common.Dialog.extend({events:{"click .close, .btn[data-action=cancel]":"close","click .list-group-item i[data-action=removeFile]":"_removeFile","click .btn[data-action=save]":"_ok","click a[data-action=uploadCover]":"_uploadCover"},internalInitialize:function(){this.shareInfo=this.args.shareInfo||{},this.formData={thumbPath:this.shareInfo.coverImg,title:this.shareInfo.title,contentSourceUrl:this.shareInfo.viewUrl,content:this.shareInfo.content,digest:this.shareInfo.digest,author:this.shareInfo.author},this.viewport().html(i(this.formData)),this.cover=new r.modules.common.ImageUploader({wrapperView:this,el:this.$el.find('[data-action="uploadCover"]'),uploadUrl:r.api("/files")}),this.cover.setImgSrc(this.formData.thumbPath),this._editor=new r.modules.cms.editor.RichEditor({el:this.$el.find("textarea[name=content]")}),this.formData.content&&this._editor.initContent(this.formData.content),this.$baseForm=this.$el.find("form"),this.$baseForm.validate({onkeyup:function(t){e(t).valid()},onfocusout:function(t){e(t).valid()},errorElement:"div",errorClass:"help-block",rules:{title:"required",digest:"required"},highlight:function(t){e(t).closest(".form-group").addClass("has-error")},unhighlight:function(t){e(t).closest(".form-group").removeClass("has-error")}})},title:function(){return"微信公共平台分享"},_onCoverUploaded:function(e){},_uploadCover:function(e){e.preventDefault(),this.$baseForm.find('img[data-action="uploadCover"]').trigger("click")},onClose:function(){this.args.cancel&&this.args.cancel()},_ok:function(t){t&&t.preventDefault&&t.preventDefault();if(!this.$baseForm.valid())return r.showMessage("error","请检查某些信息格式",!0),!1;if(this.checkIsUploading())return!1;var n=this;this.formData.thumbPath=this.cover.getImgSrc(),this.formData.title=this.$('input[name="title"]').val(),this.formData.content=this._editor.getContent(),this.formData.digest=this.$('input[name="digest"]').val(),e.ajax("/api/client/social/weixin/share",{dataType:"json",type:"POST",data:JSON.stringify(this.formData),success:function(e){console.debug(e),e&&e.code==200&&n.close(),n.$('[data-block="errorTip"]').removeClass("hide").siblings().addClass("hide")}})},_save:function(e){this._ok(e)}});var i=function(e){return'<form action="" class="form-horizontal">                    <div class="modal-body">                        <div data-block="errorTip" class="row setPort hide">                            <div class="col-sm-10 col-sm-offset-1">                                <p class="orange">很抱歉，您还未配置微信接口：</p>                                <p>公众号类型为<span class="serviceAccount"><i></i>服务号</span>的用户可以到以下链接进行配置</p>                                <p><a href="/account/configWeixin" id="">微信公众平台账号绑定</a></p>                                <p>公众号类型为<span class="subscribeAccount"><i></i>订阅号</span>的用户因微信设置原因不能实现此功能。</p>                            </div>                        </div>    					<div class="form-group">                            <label class="col-sm-2 control-label">                                标题                            </label>                            <div class="col-sm-9">                                <input value="'+e.title+'" name="title" type="text" class="col-sm-12" placeholder="标题">                            </div>                        </div>    					<div class="form-group">    						<label class="col-sm-2 control-label">封面</label>    						<div class="col-sm-4">                                <img data-action="uploadCover" data-src="holder.js/180x100/text:建议尺寸360x200" class="img  dz-clickable" alt="建议尺寸360x200" src="">    						</div>                            <div class="col-sm-3">                                <a href="#" data-action="uploadCover" class="btn btn-xs" style="margin-top:74px;">上传图标</a>                            </div>    					</div>    					<div class="form-group">                            <label class="col-sm-2 control-label">                                摘要                            </label>                            <div class="col-sm-9">                                <input value="'+e.digest+'" name="digest" type="text" class="col-sm-12" placeholder="摘要">                            </div>                        </div>                        <div class="form-group">                            <label class="col-sm-2 control-label">                                内容                            </label>                            <div class="col-sm-9">                                <textarea name="content" type="text" class="col-sm-12" style="min-height:150px" placeholder="内容"></textarea>                            </div>                        </div>    				</div>    				<div class="modal-footer">    					<button type="button" class="btn" data-action="cancel"><i class="icon-remove"></i> 取消</button>    					<button type="submit" class="btn btn-primary" data-action="save"><i class="icon-ok icon-white"></i> 确定</button>    				</div>                </form>'}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.common.socialShare=r.common.BaseView.extend({events:{'click a.[data-action="shareSina"]':"shareSina",'click a.[data-action="shareQq"]':"shareQq",'click a.[data-action="shareWeixin"]':"shareWeixin"},doInitialize:function(e){this.confInfo=e.confInfo||{},this.from=this.confInfo.from,this.option=this.confInfo.option||{},this.$el.html(i())},shareSina:function(e){e.preventDefault();var t=this;window.open(r.util.getWeiboShareUrl(t.from,t.option,t.confInfo))},shareQq:function(e){e.preventDefault(),window.open(r.util.getQQShareUrl(this.from,this.option,this.confInfo))},shareWeixin:function(e){e.preventDefault();var t=r.util.getWeixinShareObj(this.from,this.option,this.confInfo);new r.modules.common.weixinShareDialog({shareInfo:t})}});var i=function(){var e='<div class="shareBtn grey">分享到<i class="icon-caret-down bigger-110 width-auto"></i>                <div class="popup" style="width:71px;">                    <div class="bds_tools get-codes-bdshare">                        <a class="bds_tsina" data-action="shareSina" title="分享到新浪微博" href="#"></a>                        <a class="bds_qzone" data-action="shareQq" title="分享到QQ空间" href="#"></a>                        <a class="bds_weixin" data-action="shareWeixin" title="分享到微信" href="#"></a>                    </div>                </div>            </div>';return e}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf"),i=5;r.modules.common.Paginater=r.common.BaseView.extend({events:{"click li>a":"_gotoPage"},doInitialize:function(){this.setData({pno:1,psize:15,total_count:0})},getData:function(e){return{pno:this.pno,psize:this.psize,total_count:this.totalCount,total_pages:this._totalPages}},setData:function(e){this.pno=e.pno,this.psize=e.psize,this.totalCount=e.total_count,this._totalPages=parseInt(this.totalCount/this.psize),this.totalCount%this.psize==0||this._totalPages++,this._setNo=parseInt(this.pno/i),this.pno%i==0||this._setNo++,this._totalSets=parseInt(this._totalPages/i),this._totalPages%i==0||this._totalSets++,this.$el.html(s(this.pno,this.totalCount,this._totalPages,this._totalSets,this._setNo))},_gotoPage:function(t){t.preventDefault();var r=e(t.target).parents("li"),s=r.data().page;if(s==this.pno)return;n.isNumber(s)&&r.siblings().removeClass("active").end().addClass("active"),s=="PREV_SET"&&(s=(this._setNo-1)*i),s=="NEXT_SET"&&(s=this._setNo*i+1),this.trigger("pageChanged",s)}});var s=function(e,t,n,r,s){if(n==1)return"";var a='<ul class="pagination">';e<=i||(a+=o());var f=s*i;f<=n||(f=n);for(var l=(s-1)*i+1;l<=f;l++)a+='<li data-page="'+l+'" '+(e==l?'class="active"':"")+'>				<a href="#">'+l+"</a>			</li>";return r==s||r>1&&(a+=u()),a+="</ul>",a},o=function(){return'<li data-page="PREV_SET">			<a href="#">				<i class="icon-double-angle-left"></i>			</a>		</li>'},u=function(){return'<li data-page="NEXT_SET">			<a href="#">				<i class="icon-double-angle-right"></i>			</a>		</li>'}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf"),i=5;r.modules.common.ImageUploader=r.common.BaseView.extend({events:{"click .img-handlers i[data-action=remove]":"_removeImage"},doInitialize:function(t){var i=this;if(!t.doNotAutoWrapDiv){var o=this.$el.attr("data-src").match(/\d+/),u='<div class="widget-fgp-image" style="width:'+o+'px;">';this.$el.wrap(u).wrap('<div class="imageUploader"/>')}e(s(t.removeUrl)).appendTo(this.$el.parent()).find("[data-action=remove]").bind("click",n.bind(this._removeImage,this)),this.cropWidth=t.cropWidth||0,this.cropHeight=t.cropHeight||0,this.minWidth=t.minWidth||0,this.minHeight=t.minHeight||0,this.wrapperView=t.wrapperView||{},this._uploader=this.$el.uploader({url:t.uploadUrl,maxFiles:1,params:{authenticityToken:r.App.config.authToken},handlers:{sending:n.bind(this._onSending,this),uploadprogress:n.bind(this._onUploadProgress,this),complete:n.bind(this._onComplete,this),success:n.bind(this._onSuccess,this),error:n.bind(this._onError,this)}}).uploader("INSTANCE"),this.wrapperView.setUploaders&&this.wrapperView.setUploaders(this),this.callbackOpt={callbackOpt:t.callbackOpt},this.setImgSrc(t.src)},getImgSrc:function(){return this.imgSrc},setImgSrc:function(e){this.imgSrc=e,this.$el.attr("src",e),this._displayDefaultImageHolderIfNecessary()},_removeImage:function(t){if(!this.args.removeUrl||!this.$el.attr("src"))return;var n=this,i=this.args.removeUrl,s={authenticityToken:r.App.config.authToken};if(this.args.removeUrl=="/api/v2/files"||r.util.startsWith(this.imgSrc,"\\files\\temp"))i="/api/v2/files",s.path=this.getImgSrc();e.ajax(i,{type:"DELETE",data:s}).done(function(){n.setImgSrc(""),n.args.onremoved&&n.args.onremoved(n.callbackOpt)})},_displayDefaultImageHolderIfNecessary:function(){if(this.$el.attr("src"))return;!this.$el.data().src||this.$el.imageHolder()},_createThumbnail:function(e){if(!window.FileReader)return;var t=new FileReader,n=this;t.onload=function(){n.$el.attr({src:t.result}),t=null},t.readAsDataURL(e)},_onSending:function(e,t,n){this._originalImageUrl=this.$el.attr("src"),this.$el.next(".progress").remove(),this.$el.after(o()),this._createThumbnail(e),this.args.onsending&&this.args.onsending(e,n,this.callbackOpt)},_onUploadProgress:function(e,t,n){this.$el.next(".progress").find(".progress-bar").width(t+"%"),this.args.onuploadprogress&&this.args.onuploadprogress(e,t,n,this.callbackOpt)},_onComplete:function(t){this.$el.next(".progress").fadeOut(800,function(){e(this).remove()}),this.args.oncomplete&&this.args.oncomplete(t,this.callbackOpt),this._uploader.removeFile(t)},_onSuccess:function(e,t){var i=this.args.onsuccess||function(){};if(this.args.imgCrop){this._imageCrop=new r.modules.common.ImageCrop({url:t.url,width:this.cropWidth,height:this.cropHeight,minWidth:this.minWidth,minHeight:this.minHeight,callback:n.bind(i,this,e,t,this.callbackOpt),setImg:n.bind(this.setImgSrc,this)});return}this.setImgSrc(t.url),this.args.onsuccess&&this.args.onsuccess(e,t,this.callbackOpt)},_onCanceled:function(e){if(this.isUploading()){r.showMessage("ERROR","当前图片正在上传，请等待完成!",!0);return}this.setImgSrc(this._originalImageUrl),this.$el.next(".progress").remove(),this.args.oncanceled&&this.args.oncanceled(e,this.callbackOpt)},_onError:function(e,t){this.setImgSrc(this._originalImageUrl),this.$el.next(".progress").remove(),this.args.onerror&&this.args.onerror(this.callbackOpt)},isUploading:function(){return this._uploader&&this._uploader.files.length>0}});var s=function(e){return'<div class="img-handlers">			<i class="icon-remove bigger-120 '+(e?"":"hide")+'" data-action="remove"></i>		</div>'},o=function(){return'<div class="progress progress-striped active img-progress-bar"><div class="progress-bar"></div></div>'}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.common.ColorPicker=r.common.BaseView.extend({doInitialize:function(e){this._color=this._initialColor=e.color,this._fieldName=e.fieldName||"color",this.$icon=this.$el.html(i(this._fieldName)).find("i[data-action=pickColor]"),this.$input=this.$el.find("input"),this._initialColor&&(this.$icon.css({backgroundColor:this._initialColor}),this.$input.val(this._initialColor)),this.$icon.colorPicker({color:this._initialColor,localStorageKey:"colorPicker$"+r.App.config.currentApp.id,change:n.bind(this._onChange,this),move:n.bind(this._onMove,this),hide:n.bind(this._onColorPickerHide,this)})},getColor:function(){return this._color},setColor:function(e){this._setColor(e)},_setColor:function(e){this._color=e,this.$icon.css({backgroundColor:e}),this.$input.val(this._color),this.$icon.colorPicker("set",this._color)},_onChange:function(e){this._setColor(e.toRgbString()),this.trigger("valueChanged",e.toRgbString())},_onMove:function(e){this.$icon.css({backgroundColor:e}),this.trigger("valueChanging",e.toRgbString())},_onColorPickerHide:function(e){this.$icon.css({backgroundColor:e}),this.trigger("valueChanging",e.toRgbString())}});var i=function(e){return'<i class="color-configurator" data-action="pickColor"></i>			<input type="hidden" name="'+e+'"/>'}}(),function(e,t){typeof exports=="object"?module.exports=t():typeof define=="function"&&define.amd?define(t):e.Spinner=t()}(this,function(){"use strict";function r(e,t){var n=document.createElement(e||"div"),r;for(r in t)n[r]=t[r];return n}function i(e){for(var t=1,n=arguments.length;t<n;t++)e.appendChild(arguments[t]);return e}function o(e,r,i,o){var u=["opacity",r,~~(e*100),i,o].join("-"),a=.01+i/o*100,f=Math.max(1-(1-e)/r*(100-a),e),l=n.substring(0,n.indexOf("Animation")).toLowerCase(),c=l&&"-"+l+"-"||"";return t[u]||(s.insertRule("@"+c+"keyframes "+u+"{"+"0%{opacity:"+f+"}"+a+"%{opacity:"+e+"}"+(a+.01)+"%{opacity:1}"+(a+r)%100+"%{opacity:"+e+"}"+"100%{opacity:"+f+"}"+"}",s.cssRules.length),t[u]=1),u}function u(t,n){var r=t.style,i,s;n=n.charAt(0).toUpperCase()+n.slice(1);for(s=0;s<e.length;s++){i=e[s]+n;if(r[i]!==undefined)return i}if(r[n]!==undefined)return n}function a(e,t){for(var n in t)e.style[u(e,n)||n]=t[n];return e}function f(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)e[r]===undefined&&(e[r]=n[r])}return e}function l(e){var t={x:e.offsetLeft,y:e.offsetTop};while(e=e.offsetParent)t.x+=e.offsetLeft,t.y+=e.offsetTop;return t}function c(e,t){return typeof e=="string"?e:e[t%e.length]}function p(e){if(typeof this=="undefined")return new p(e);this.opts=f(e||{},p.defaults,h)}function d(){function e(e,t){return r("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',t)}s.addRule(".spin-vml","behavior:url(#default#VML)"),p.prototype.lines=function(t,n){function o(){return a(e("group",{coordsize:s+" "+s,coordorigin:-r+" "+ -r}),{width:s,height:s})}function h(t,s,u){i(f,i(a(o(),{rotation:360/n.lines*t+"deg",left:~~s}),i(a(e("roundrect",{arcsize:n.corners}),{width:r,height:n.width,left:n.radius,top:-n.width>>1,filter:u}),e("fill",{color:c(n.color,t),opacity:n.opacity}),e("stroke",{opacity:0}))))}var r=n.length+n.width,s=2*r,u=-(n.width+n.length)*2+"px",f=a(o(),{position:"absolute",top:u,left:u}),l;if(n.shadow)for(l=1;l<=n.lines;l++)h(l,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(l=1;l<=n.lines;l++)h(l);return i(t,f)},p.prototype.opacity=function(e,t,n,r){var i=e.firstChild;r=r.shadow&&r.lines||0,i&&t+r<i.childNodes.length&&(i=i.childNodes[t+r],i=i&&i.firstChild,i=i&&i.firstChild,i&&(i.opacity=n))}}var e=["webkit","Moz","ms","O"],t={},n,s=function(){var e=r("style",{type:"text/css"});return i(document.getElementsByTagName("head")[0],e),e.sheet||e.styleSheet}(),h={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"auto",left:"auto",position:"relative"};p.defaults={},f(p.prototype,{spin:function(e){this.stop();var t=this,i=t.opts,s=t.el=a(r(0,{className:i.className}),{position:i.position,width:0,zIndex:i.zIndex}),o=i.radius+i.length+i.width,u,f;e&&(e.insertBefore(s,e.firstChild||null),f=l(e),u=l(s),a(s,{left:(i.left=="auto"?f.x-u.x+(e.offsetWidth>>1):parseInt(i.left,10)+o)+"px",top:(i.top=="auto"?f.y-u.y+(e.offsetHeight>>1):parseInt(i.top,10)+o)+"px"})),s.setAttribute("role","progressbar"),t.lines(s,t.opts);if(!n){var c=0,h=(i.lines-1)*(1-i.direction)/2,p,d=i.fps,v=d/i.speed,m=(1-i.opacity)/(v*i.trail/100),g=v/i.lines;(function y(){c++;for(var e=0;e<i.lines;e++)p=Math.max(1-(c+(i.lines-e)*g)%v*m,i.opacity),t.opacity(s,e*i.direction+h,p,i);t.timeout=t.el&&setTimeout(y,~~(1e3/d))})()}return t},stop:function(){var e=this.el;return e&&(clearTimeout(this.timeout),e.parentNode&&e.parentNode.removeChild(e),this.el=undefined),this},lines:function(e,t){function l(e,n){return a(r(),{position:"absolute",width:t.length+t.width+"px",height:t.width+"px",background:e,boxShadow:n,transformOrigin:"left",transform:"rotate("+~~(360/t.lines*s+t.rotate)+"deg) translate("+t.radius+"px"+",0)",borderRadius:(t.corners*t.width>>1)+"px"})}var s=0,u=(t.lines-1)*(1-t.direction)/2,f;for(;s<t.lines;s++)f=a(r(),{position:"absolute",top:1+~(t.width/2)+"px",transform:t.hwaccel?"translate3d(0,0,0)":"",opacity:t.opacity,animation:n&&o(t.opacity,t.trail,u+s*t.direction,t.lines)+" "+1/t.speed+"s linear infinite"}),t.shadow&&i(f,a(l("#000","0 0 4px #000"),{top:"2px"})),i(e,i(f,l(c(t.color,s),"0 0 1px rgba(0,0,0,.1)")));return e},opacity:function(e,t,n){t<e.childNodes.length&&(e.childNodes[t].style.opacity=n)}});var v=a(r("group"),{behavior:"url(#default#VML)"});return!u(v,"transform")&&v.adj?d():n=u(v,"animation"),p}),function(e,t,n){function l(e,t,n){var r=[];for(var i=0;i<e.length;i++){var s=e[i];if(s){var u=tinycolor(s),a=u.toHsl().l<.5?"sp-thumb-el sp-thumb-dark":"sp-thumb-el sp-thumb-light";a+=tinycolor.equals(t,s)?" sp-thumb-active":"";var f=o?"background-color:"+u.toRgbString():"filter:"+u.toFilter();r.push('<span title="'+u.toRgbString()+'" data-color="'+u.toRgbString()+'" class="'+a+'"><span class="sp-thumb-inner" style="'+f+';" /></span>')}else{var l="sp-clear-display";r.push('<span title="No Color Selected" data-color="" style="background-color:transparent;" class="'+l+'"></span>')}}return"<div class='sp-cf "+n+"'>"+r.join("")+"</div>"}function c(){for(var e=0;e<i.length;e++)i[e]&&i[e].hide()}function h(e,n){var i=t.extend({},r,e);return i.callbacks={move:g(i.move,n),change:g(i.change,n),show:g(i.show,n),hide:g(i.hide,n),beforeShow:g(i.beforeShow,n)},i}function p(r,p){function St(){v.showPaletteOnly&&(v.showPalette=!0),K.toggleClass("sp-flat",g),K.toggleClass("sp-input-disabled",!v.showInput),K.toggleClass("sp-alpha-enabled",v.showAlpha),K.toggleClass("sp-clear-enabled",Et),K.toggleClass("sp-buttons-disabled",!v.showButtons),K.toggleClass("sp-palette-disabled",!v.showPalette),K.toggleClass("sp-palette-only",v.showPaletteOnly),K.toggleClass("sp-initial-disabled",!v.showInitial),K.addClass(v.className),Ut()}function xt(){function o(e){return e.data&&e.data.ignore?(Ht(t(this).data("color")),Ft()):(Ht(t(this).data("color")),Rt(!0),Ft(),Dt()),!1}s&&K.find("*:not(input)").attr("unselectable","on"),St(),ct&&V.after(ht).hide(),Et||ut.hide();if(g)V.after(K).hide();else{var n=v.appendTo==="parent"?V.parent():t(v.appendTo);n.length!==1&&(n=t("body")),n.append(K)}if(E&&e.localStorage){try{var r=e.localStorage[E].split(",#");r.length>1&&(delete e.localStorage[E],t.each(r,function(e,t){Tt(t)}))}catch(i){}try{q=e.localStorage[E].split(";")}catch(i){}}pt.bind("click.spectrum touchstart.spectrum",function(e){J||Mt(),e.stopPropagation(),t(e.target).is("input")||e.preventDefault()}),(V.is(":disabled")||v.disabled===!0)&&Vt(),K.click(m),rt.change(Ot),rt.bind("paste",function(){setTimeout(Ot,1)}),rt.keydown(function(e){e.keyCode==13&&Ot()}),ot.text(v.cancelText),ot.bind("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),Dt("cancel")}),ut.bind("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),wt=!0,Ft(),g&&Rt(!0)}),at.text(v.chooseText),at.bind("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),jt()&&(Rt(!0),Dt())}),y(tt,function(e,t,n){j=e/M,wt=!1,n.shiftKey&&(j=Math.round(j*10)/10),Ft()}),y(Y,function(e,t){P=parseFloat(t/A),wt=!1,Ft()},Lt,At),y(Q,function(e,t,n){if(!n.shiftKey)z=null;else if(!z){var r=H*C,i=k-B*k,s=Math.abs(e-r)>Math.abs(t-i);z=s?"x":"y"}var o=!z||z==="x",u=!z||z==="y";o&&(H=parseFloat(e/C)),u&&(B=parseFloat((k-t)/k)),wt=!1,Ft()},Lt,At),vt?(Ht(vt),It(),yt=gt||tinycolor(vt).format,Tt(vt)):It(),g&&_t();var u=s?"mousedown.spectrum":"click.spectrum touchstart.spectrum";it.delegate(".sp-thumb-el",u,o),st.delegate(".sp-thumb-el:nth-child(1)",u,{ignore:!0},o)}function Tt(n){if(w){var r=tinycolor(n).toRgbString();if(t.inArray(r,q)===-1){q.push(r);while(q.length>R)q.shift()}if(E&&e.localStorage)try{e.localStorage[E]=q.join(";")}catch(i){}}}function Nt(){var e=[],t=q,n={},r;if(v.showPalette){for(var i=0;i<I.length;i++)for(var s=0;s<I[i].length;s++)r=tinycolor(I[i][s]).toRgbString(),n[r]=!0;for(i=0;i<t.length;i++)r=tinycolor(t[i]).toRgbString(),n.hasOwnProperty(r)||(e.push(t[i]),n[r]=!0)}return e.reverse().slice(0,v.maxSelectionSize)}function Ct(){var e=Bt(),n=t.map(I,function(t,n){return l(t,e,"sp-palette-row sp-palette-row-"+n)});q&&n.push(l(Nt(),e,"sp-palette-row sp-palette-row-selection")),it.html(n.join(""))}function kt(){if(v.showInitial){var e=mt,t=Bt();st.html(l([e,t],t,"sp-palette-row-initial"))}}function Lt(){(k<=0||C<=0||A<=0)&&Ut(),K.addClass(U),z=null}function At(){K.removeClass(U)}function Ot(){var e=rt.val();if(e!==null&&e!==""||!Et){var t=tinycolor(e);t.ok?Ht(t):rt.addClass("sp-validation-error")}else Ht(null)}function Mt(){N?Dt():_t()}function _t(){var n=t.Event("beforeShow.spectrum");if(N){Ut();return}V.trigger(n,[Bt()]);if(x.beforeShow(Bt())===!1||n.isDefaultPrevented())return;c(),N=!0,t(W).bind("click.spectrum",Dt),t(e).bind("resize.spectrum",T),ht.addClass("sp-active"),K.removeClass("sp-hidden"),v.showPalette&&Ct(),Ut(),It(),mt=Bt(),kt(),x.show(mt),V.trigger("show.spectrum",[mt])}function Dt(n){if(n&&n.type=="click"&&n.button==2)return;if(!N||g)return;N=!1,t(W).unbind("click.spectrum",Dt),t(e).unbind("resize.spectrum",T),ht.removeClass("sp-active"),K.addClass("sp-hidden");var r=!tinycolor.equals(Bt(),mt);r&&(bt&&n!=="cancel"?Rt(!0):Pt()),x.hide(Bt()),V.trigger("hide.spectrum",[Bt()])}function Pt(){Ht(mt,!0)}function Ht(e,t){if(tinycolor.equals(e,Bt()))return;var n;if(!e&&Et)wt=!0;else{wt=!1,n=tinycolor(e);var r=n.toHsv();P=r.h%360/360,H=r.s,B=r.v,j=r.a}It(),n&&n.ok&&!t&&(yt=gt||n.format)}function Bt(e){return e=e||{},Et&&wt?null:tinycolor.fromRatio({h:P,s:H,v:B,a:Math.round(j*100)/100},{format:e.format||yt})}function jt(){return!rt.hasClass("sp-validation-error")}function Ft(){It(),x.move(Bt()),V.trigger("move.spectrum",[Bt()])}function It(){rt.removeClass("sp-validation-error"),qt();var e=tinycolor.fromRatio({h:P,s:1,v:1});Q.css("background-color",e.toHexString());var t=yt;j<1&&(t==="hex"||t==="hex3"||t==="hex6"||t==="name")&&(t="rgb");var n=Bt({format:t}),r="";dt.removeClass("sp-clear-display"),dt.css("background-color","transparent");if(!n&&Et)dt.addClass("sp-clear-display");else{var i=n.toHexString(),u=n.toRgbString();o||n.alpha===1?dt.css("background-color",u):(dt.css("background-color","transparent"),dt.css("filter",n.toFilter()));if(v.showAlpha){var a=n.toRgb();a.a=0;var f=tinycolor(a).toRgbString(),l="linear-gradient(left, "+f+", "+i+")";s?et.css("filter",tinycolor(f).toFilter({gradientType:1},i)):(et.css("background","-webkit-"+l),et.css("background","-moz-"+l),et.css("background","-ms-"+l),et.css("background",l))}r=n.toString(t)}v.showInput&&rt.val(r),v.showPalette&&Ct(),kt()}function qt(){var e=H,t=B;if(Et&&wt)nt.hide(),Z.hide(),G.hide();else{nt.show(),Z.show(),G.show();var n=e*C,r=k-t*k;n=Math.max(-L,Math.min(C-L,n-L)),r=Math.max(-L,Math.min(k-L,r-L)),G.css({top:r,left:n});var i=j*M;nt.css({left:i-_/2});var s=P*A;Z.css({top:s-D})}}function Rt(e){var t=Bt(),n="",r=!tinycolor.equals(t,mt);t&&(n=t.toString(yt),Tt(t)),ft&&V.val(n),mt=t,e&&r&&(x.change(t),V.trigger("change",[t]))}function Ut(){C=Q.width(),k=Q.height(),L=G.height(),O=Y.width(),A=Y.height(),D=Z.height(),M=tt.width(),_=nt.width(),g||(K.css("position","absolute"),K.offset(d(K,pt))),qt()}function zt(){V.show(),pt.unbind("click.spectrum touchstart.spectrum"),K.remove(),ht.remove(),i[$t.id]=null}function Wt(e,r){if(e===n)return t.extend({},v);if(r===n)return v[e];v[e]=r,St()}function Xt(){J=!1,V.attr("disabled",!1),pt.removeClass("sp-disabled")}function Vt(){Dt(),J=!0,V.attr("disabled",!0),pt.addClass("sp-disabled")}var v=h(p,r),g=v.flat,w=v.showSelectionPalette,E=v.localStorageKey,S=v.theme,x=v.callbacks,T=b(Ut,10),N=!1,C=0,k=0,L=0,A=0,O=0,M=0,_=0,D=0,P=0,H=0,B=0,j=1,F=v.palette.slice(0),I=t.isArray(F[0])?F:[F],q=v.selectionPalette.slice(0),R=v.maxSelectionSize,U="sp-dragging",z=null,W=r.ownerDocument,X=W.body,V=t(r),J=!1,K=t(f,W).addClass(S),Q=K.find(".sp-color"),G=K.find(".sp-dragger"),Y=K.find(".sp-hue"),Z=K.find(".sp-slider"),et=K.find(".sp-alpha-inner"),tt=K.find(".sp-alpha"),nt=K.find(".sp-alpha-handle"),rt=K.find(".sp-input"),it=K.find(".sp-palette"),st=K.find(".sp-initial"),ot=K.find(".sp-cancel"),ut=K.find(".sp-clear"),at=K.find(".sp-choose"),ft=V.is("input"),lt=ft&&u&&V.attr("type")==="color",ct=ft&&!g,ht=ct?t(a).addClass(S).addClass(v.className):t([]),pt=ct?ht:V,dt=ht.find(".sp-preview-inner"),vt=v.color||ft&&V.val(),mt=!1,gt=v.preferredFormat,yt=gt,bt=!v.showButtons||v.clickoutFiresChange,wt=!vt,Et=v.allowEmpty&&!lt;xt();var $t={show:_t,hide:Dt,toggle:Mt,reflow:Ut,option:Wt,enable:Xt,disable:Vt,set:function(e){Ht(e),Rt()},get:Bt,destroy:zt,container:K};return $t.id=i.push($t)-1,$t}function d(e,n){var r=0,i=e.outerWidth(),s=e.outerHeight(),o=n.outerHeight(),u=e[0].ownerDocument,a=u.documentElement,f=a.clientWidth+t(u).scrollLeft(),l=a.clientHeight+t(u).scrollTop(),c=n.offset();return c.top+=o,c.left-=Math.min(c.left,c.left+i>f&&f>i?Math.abs(c.left+i-f):0),c.top-=Math.min(c.top,c.top+s>l&&l>s?Math.abs(s+o-r):r),c}function v(){}function m(e){e.stopPropagation()}function g(e,t){var n=Array.prototype.slice,r=n.call(arguments,2);return function(){return e.apply(t,r.concat(n.call(arguments)))}}function y(n,r,i,o){function d(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),e.returnValue=!1}function v(e){if(a){if(s&&document.documentMode<9&&!e.button)return g();var t=e.originalEvent.touches,i=t?t[0].pageX:e.pageX,o=t?t[0].pageY:e.pageY,u=Math.max(0,Math.min(i-f.left,c)),p=Math.max(0,Math.min(o-f.top,l));h&&d(e),r.apply(n,[u,p,e])}}function m(e){var r=e.which?e.which==3:e.button==2,s=e.originalEvent.touches;!r&&!a&&i.apply(n,arguments)!==!1&&(a=!0,l=t(n).height(),c=t(n).width(),f=t(n).offset(),t(u).bind(p),t(u.body).addClass("sp-dragging"),h||v(e),d(e))}function g(){a&&(t(u).unbind(p),t(u.body).removeClass("sp-dragging"),o.apply(n,arguments)),a=!1}r=r||function(){},i=i||function(){},o=o||function(){};var u=n.ownerDocument||document,a=!1,f={},l=0,c=0,h="ontouchstart"in e,p={};p.selectstart=d,p.dragstart=d,p["touchmove mousemove"]=v,p["touchend mouseup"]=g,t(n).bind("touchstart mousedown",m)}function b(e,t,n){var r;return function(){var i=this,s=arguments,o=function(){r=null,e.apply(i,s)};n&&clearTimeout(r);if(n||!r)r=setTimeout(o,t)}}function w(){e.console&&(Function.prototype.bind?w=Function.prototype.bind.call(console.log,console):w=function(){Function.prototype.apply.call(console.log,console,arguments)},w.apply(this,arguments))}var r={beforeShow:v,move:v,change:v,show:v,hide:v,color:!1,flat:!1,showInput:!1,allowEmpty:!1,showButtons:!0,clickoutFiresChange:!1,showInitial:!1,showPalette:!1,showPaletteOnly:!1,showSelectionPalette:!0,localStorageKey:!1,appendTo:"body",maxSelectionSize:7,cancelText:"cancel",chooseText:"choose",preferredFormat:!1,className:"",showAlpha:!1,theme:"sp-light",palette:["fff","000"],selectionPalette:[],disabled:!1},i=[],s=!!/msie/i.exec(e.navigator.userAgent),o=function(){function e(e,t){return!!~(""+e).indexOf(t)}var t=document.createElement("div"),n=t.style;return n.cssText="background-color:rgba(0,0,0,.5)",e(n.backgroundColor,"rgba")||e(n.backgroundColor,"hsla")}(),u=function(){var e=t("<input type='color' value='!' />")[0];return e.type==="color"&&e.value!=="!"}(),a=["<div class='sp-replacer'>","<div class='sp-preview'><div class='sp-preview-inner'></div></div>","<div class='sp-dd'>&#9660;</div>","</div>"].join(""),f=function(){var e="";if(s)for(var t=1;t<=6;t++)e+="<div class='sp-"+t+"'></div>";return["<div class='sp-container sp-hidden'>","<div class='sp-palette-container'>","<div class='sp-palette sp-thumb sp-cf'></div>","</div>","<div class='sp-picker-container'>","<div class='sp-top sp-cf'>","<div class='sp-fill'></div>","<div class='sp-top-inner'>","<div class='sp-color'>","<div class='sp-sat'>","<div class='sp-val'>","<div class='sp-dragger'></div>","</div>","</div>","</div>","<div class='sp-clear sp-clear-display' title='Clear Color Selection'>","</div>","<div class='sp-hue'>","<div class='sp-slider'></div>",e,"</div>","</div>","<div class='sp-alpha'><div class='sp-alpha-inner'><div class='sp-alpha-handle'></div></div></div>","</div>","<div class='sp-input-container sp-cf'>","<input class='sp-input' type='text' spellcheck='false'  />","</div>","<div class='sp-initial sp-thumb sp-cf'></div>","<div class='sp-button-container sp-cf'>","<a class='sp-cancel' href='#'></a>","<button class='sp-choose'></button>","</div>","</div>","</div>"].join("")}(),E="spectrum.id";t.fn.spectrum=function(e,n){if(typeof e=="string"){var r=this,s=Array.prototype.slice.call(arguments,1);return this.each(function(){var n=i[t(this).data(E)];if(n){var o=n[e];if(!o)throw new Error("Spectrum: no such method: '"+e+"'");e=="get"?r=n.get():e=="container"?r=n.container:e=="option"?r=n.option.apply(n,s):e=="destroy"?(n.destroy(),t(this).removeData(E)):o.apply(n,s)}}),r}return this.spectrum("destroy").each(function(){var n=p(this,e);t(this).data(E,n.id)})},t.fn.spectrum.load=!0,t.fn.spectrum.loadOpts={},t.fn.spectrum.draggable=y,t.fn.spectrum.defaults=r,t.spectrum={},t.spectrum.localization={},t.spectrum.palettes={},t.fn.spectrum.processNativeColorInputs=function(){u||t("input[type=color]").spectrum({preferredFormat:"hex6"})},function(){function f(e,t){e=e?e:"",t=t||{};if(typeof e=="object"&&e.hasOwnProperty("_tc_id"))return e;var n=l(e),i=n.r,o=n.g,u=n.b,a=n.a,c=s(100*a)/100,p=t.format||n.format;return i<1&&(i=s(i)),o<1&&(o=s(o)),u<1&&(u=s(u)),{ok:n.ok,format:p,_tc_id:r++,alpha:a,getAlpha:function(){return a},setAlpha:function(e){a=w(e),c=s(100*a)/100},toHsv:function(){var e=d(i,o,u);return{h:e.h*360,s:e.s,v:e.v,a:a}},toHsvString:function(){var e=d(i,o,u),t=s(e.h*360),n=s(e.s*100),r=s(e.v*100);return a==1?"hsv("+t+", "+n+"%, "+r+"%)":"hsva("+t+", "+n+"%, "+r+"%, "+c+")"},toHsl:function(){var e=h(i,o,u);return{h:e.h*360,s:e.s,l:e.l,a:a}},toHslString:function(){var e=h(i,o,u),t=s(e.h*360),n=s(e.s*100),r=s(e.l*100);return a==1?"hsl("+t+", "+n+"%, "+r+"%)":"hsla("+t+", "+n+"%, "+r+"%, "+c+")"},toHex:function(e){return m(i,o,u,e)},toHexString:function(e){return"#"+m(i,o,u,e)},toRgb:function(){return{r:s(i),g:s(o),b:s(u),a:a}},toRgbString:function(){return a==1?"rgb("+s(i)+", "+s(o)+", "+s(u)+")":"rgba("+s(i)+", "+s(o)+", "+s(u)+", "+c+")"},toPercentageRgb:function(){return{r:s(E(i,255)*100)+"%",g:s(E(o,255)*100)+"%",b:s(E(u,255)*100)+"%",a:a}},toPercentageRgbString:function(){return a==1?"rgb("+s(E(i,255)*100)+"%, "+s(E(o,255)*100)+"%, "+s(E(u,255)*100)+"%)":"rgba("+s(E(i,255)*100)+"%, "+s(E(o,255)*100)+"%, "+s(E(u,255)*100)+"%, "+c+")"},toName:function(){return a===0?"transparent":y[m(i,o,u,!0)]||!1},toFilter:function(e){var n=m(i,o,u),r=n,s=Math.round(parseFloat(a)*255).toString(16),l=s,c=t&&t.gradientType?"GradientType = 1, ":"";if(e){var h=f(e);r=h.toHex(),l=Math.round(parseFloat(h.alpha)*255).toString(16)}return"progid:DXImageTransform.Microsoft.gradient("+c+"startColorstr=#"+C(s)+n+",endColorstr=#"+C(l)+r+")"},toString:function(e){var t=!!e;e=e||this.format;var n=!1,r=!t&&a<1&&a>0,i=r&&(e==="hex"||e==="hex6"||e==="hex3"||e==="name");e==="rgb"&&(n=this.toRgbString()),e==="prgb"&&(n=this.toPercentageRgbString());if(e==="hex"||e==="hex6")n=this.toHexString();return e==="hex3"&&(n=this.toHexString(!0)),e==="name"&&(n=this.toName()),e==="hsl"&&(n=this.toHslString()),e==="hsv"&&(n=this.toHsvString()),i?this.toRgbString():n||this.toHexString()}}}function l(e){var t={r:0,g:0,b:0},n=1,r=!1,i=!1;return typeof e=="string"&&(e=A(e)),typeof e=="object"&&(e.hasOwnProperty("r")&&e.hasOwnProperty("g")&&e.hasOwnProperty("b")?(t=c(e.r,e.g,e.b),r=!0,i=String(e.r).substr(-1)==="%"?"prgb":"rgb"):e.hasOwnProperty("h")&&e.hasOwnProperty("s")&&e.hasOwnProperty("v")?(e.s=k(e.s),e.v=k(e.v),t=v(e.h,e.s,e.v),r=!0,i="hsv"):e.hasOwnProperty("h")&&e.hasOwnProperty("s")&&e.hasOwnProperty("l")&&(e.s=k(e.s),e.l=k(e.l),t=p(e.h,e.s,e.l),r=!0,i="hsl"),e.hasOwnProperty("a")&&(n=e.a)),n=w(n),{ok:r,format:e.format||i,r:o(255,u(t.r,0)),g:o(255,u(t.g,0)),b:o(255,u(t.b,0)),a:n}}function c(e,t,n){return{r:E(e,255)*255,g:E(t,255)*255,b:E(n,255)*255}}function h(e,t,n){e=E(e,255),t=E(t,255),n=E(n,255);var r=u(e,t,n),i=o(e,t,n),s,a,f=(r+i)/2;if(r==i)s=a=0;else{var l=r-i;a=f>.5?l/(2-r-i):l/(r+i);switch(r){case e:s=(t-n)/l+(t<n?6:0);break;case t:s=(n-e)/l+2;break;case n:s=(e-t)/l+4}s/=6}return{h:s,s:a,l:f}}function p(e,t,n){function o(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}var r,i,s;e=E(e,360),t=E(t,100),n=E(n,100);if(t===0)r=i=s=n;else{var u=n<.5?n*(1+t):n+t-n*t,a=2*n-u;r=o(a,u,e+1/3),i=o(a,u,e),s=o(a,u,e-1/3)}return{r:r*255,g:i*255,b:s*255}}function d(e,t,n){e=E(e,255),t=E(t,255),n=E(n,255);var r=u(e,t,n),i=o(e,t,n),s,a,f=r,l=r-i;a=r===0?0:l/r;if(r==i)s=0;else{switch(r){case e:s=(t-n)/l+(t<n?6:0);break;case t:s=(n-e)/l+2;break;case n:s=(e-t)/l+4}s/=6}return{h:s,s:a,v:f}}function v(e,t,n){e=E(e,360)*6,t=E(t,100),n=E(n,100);var r=i.floor(e),s=e-r,o=n*(1-t),u=n*(1-s*t),a=n*(1-(1-s)*t),f=r%6,l=[n,u,o,o,a,n][f],c=[a,n,n,u,o,o][f],h=[o,o,a,n,n,u][f];return{r:l*255,g:c*255,b:h*255}}function m(e,t,n,r){var i=[C(s(e).toString(16)),C(s(t).toString(16)),C(s(n).toString(16))];return r&&i[0].charAt(0)==i[0].charAt(1)&&i[1].charAt(0)==i[1].charAt(1)&&i[2].charAt(0)==i[2].charAt(1)?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function b(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[e[n]]=n);return t}function w(e){e=parseFloat(e);if(isNaN(e)||e<0||e>1)e=1;return e}function E(e,t){T(e)&&(e="100%");var n=N(e);return e=o(t,u(0,parseFloat(e))),n&&(e=parseInt(e*t,10)/100),i.abs(e-t)<1e-6?1:e%t/parseFloat(t)}function S(e){return o(1,u(0,e))}function x(e){return parseInt(e,16)}function T(e){return typeof e=="string"&&e.indexOf(".")!=-1&&parseFloat(e)===1}function N(e){return typeof e=="string"&&e.indexOf("%")!=-1}function C(e){return e.length==1?"0"+e:""+e}function k(e){return e<=1&&(e=e*100+"%"),e}function A(e){e=e.replace(t,"").replace(n,"").toLowerCase();var r=!1;if(g[e])e=g[e],r=!0;else if(e=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var i;return(i=L.rgb.exec(e))?{r:i[1],g:i[2],b:i[3]}:(i=L.rgba.exec(e))?{r:i[1],g:i[2],b:i[3],a:i[4]}:(i=L.hsl.exec(e))?{h:i[1],s:i[2],l:i[3]}:(i=L.hsla.exec(e))?{h:i[1],s:i[2],l:i[3],a:i[4]}:(i=L.hsv.exec(e))?{h:i[1],s:i[2],v:i[3]}:(i=L.hex6.exec(e))?{r:x(i[1]),g:x(i[2]),b:x(i[3]),format:r?"name":"hex"}:(i=L.hex3.exec(e))?{r:x(i[1]+""+i[1]),g:x(i[2]+""+i[2]),b:x(i[3]+""+i[3]),format:r?"name":"hex"}:!1}var t=/^[\s,#]+/,n=/\s+$/,r=0,i=Math,s=i.round,o=i.min,u=i.max,a=i.random;f.fromRatio=function(e,t){if(typeof e=="object"){var n={};for(var r in e)e.hasOwnProperty(r)&&(r==="a"?n[r]=e[r]:n[r]=k(e[r]));e=n}return f(e,t)},f.equals=function(e,t){return!e||!t?!1:f(e).toRgbString()==f(t).toRgbString()},f.random=function(){return f.fromRatio({r:a(),g:a(),b:a()})},f.desaturate=function(e,t){t=t===0?0:t||10;var n=f(e).toHsl();return n.s-=t/100,n.s=S(n.s),f(n)},f.saturate=function(e,t){t=t===0?0:t||10;var n=f(e).toHsl();return n.s+=t/100,n.s=S(n.s),f(n)},f.greyscale=function(e){return f.desaturate(e,100)},f.lighten=function(e,t){t=t===0?0:t||10;var n=f(e).toHsl();return n.l+=t/100,n.l=S(n.l),f(n)},f.darken=function(e,t){t=t===0?0:t||10;var n=f(e).toHsl();return n.l-=t/100,n.l=S(n.l),f(n)},f.complement=function(e){var t=f(e).toHsl();return t.h=(t.h+180)%360,f(t)},f.triad=function(e){var t=f(e).toHsl(),n=t.h;return[f(e),f({h:(n+120)%360,s:t.s,l:t.l}),f({h:(n+240)%360,s:t.s,l:t.l})]},f.tetrad=function(e){var t=f(e).toHsl(),n=t.h;return[f(e),f({h:(n+90)%360,s:t.s,l:t.l}),f({h:(n+180)%360,s:t.s,l:t.l}),f({h:(n+270)%360,s:t.s,l:t.l})]},f.splitcomplement=function(e){var t=f(e).toHsl(),n=t.h;return[f(e),f({h:(n+72)%360,s:t.s,l:t.l}),f({h:(n+216)%360,s:t.s,l:t.l})]},f.analogous=function(e,t,n){t=t||6,n=n||30;var r=f(e).toHsl(),i=360/n,s=[f(e)];for(r.h=(r.h-(i*t>>1)+720)%360;--t;)r.h=(r.h+i)%360,s.push(f(r));return s},f.monochromatic=function(e,t){t=t||6;var n=f(e).toHsv(),r=n.h,i=n.s,s=n.v,o=[],u=1/t;while(t--)o.push(f({h:r,s:i,v:s})),s=(s+u)%1;return o},f.readability=function(e,t){var n=f(e).toRgb(),r=f(t).toRgb(),i=(n.r*299+n.g*587+n.b*114)/1e3,s=(r.r*299+r.g*587+r.b*114)/1e3,o=Math.max(n.r,r.r)-Math.min(n.r,r.r)+Math.max(n.g,r.g)-Math.min(n.g,r.g)+Math.max(n.b,r.b)-Math.min(n.b,r.b);return{brightness:Math.abs(i-s),color:o}},f.readable=function(e,t){var n=f.readability(e,t);return n.brightness>125&&n.color>500},f.mostReadable=function(e,t){var n=null,r=0,i=!1;for(var s=0;s<t.length;s++){var o=f.readability(e,t[s]),u=o.brightness>125&&o.color>500,a=3*(o.brightness/125)+o.color/500;if(u&&!i||u&&i&&a>r||!u&&!i&&a>r)i=u,r=a,n=f(t[s])}return n};var g=f.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},y=f.hexNames=b(g),L=function(){var e="[-\\+]?\\d+%?",t="[-\\+]?\\d*\\.\\d+%?",n="(?:"+t+")|(?:"+e+")",r="[\\s|\\(]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")\\s*\\)?",i="[\\s|\\(]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")\\s*\\)?";return{rgb:new RegExp("rgb"+r),rgba:new RegExp("rgba"+i),hsl:new RegExp("hsl"+r),hsla:new RegExp("hsla"+i),hsv:new RegExp("hsv"+r),hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();e.tinycolor=f}(),t(function(){t.fn.spectrum.load&&t.fn.spectrum.processNativeColorInputs()})}(window,jQuery),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf"),i=5;r.modules.common.PreviewDialog=r.common.BaseView.extend({events:{"click .closeBtn":"close"},doInitialize:function(e){this.$el.html(s(e.url)).appendTo("body"),this.$el.find(".modal").show(),Mousetrap.bind("esc",n.bind(this.close,this)),this.show(e)},title:function(){return"Dialog"},internalInitialize:function(){},onClose:function(){},close:function(){jQuery("body").removeClass("modal-open"),jQuery("#modalBackdrop").remove(),this.onClose(),this.remove()},onRemove:function(){Mousetrap.unbind("esc",this.close)}});var s=function(e){return'<div id="previewApp" class="modal previeweModal in"><!-- 预览 -->					<div class="modal-dialog">							<div class="previewer">								<div class="closeBtn">									<i class="icon-remove-circle"></i>								</div>								<div class="previewerInner">									<iframe frameborder="0" src="'+e+'"></iframe>								</div>							</div>					</div>				</div>'}}(),function(e){function i(e,t){if(r[e]){var n=s(this);return r[e].apply(n,t)}throw new Error("method '"+e+"()' does not exist for slider.")}function s(r){var i=e(r).data("slider");if(i&&i instanceof n)return i;throw new Error(t.callingContextNotSliderInstance)}function o(t){var r=e(this),i=r.data("slider"),s=typeof t=="object"&&t;return i||r.data("slider",i=new n(this,e.extend({},e.fn.slider.defaults,s))),r}var t={formatInvalidInputErrorMsg:function(e){return"Invalid input value '"+e+"' passed in"},callingContextNotSliderInstance:"Calling context element does not have instance of Slider bound to it. Check your code to make sure the JQuery object returned from the call to the slider() initializer is calling the method"},n=function(t,n){var r=this.element=e(t).hide(),i=r.outerWidth(),s=!1,o=this.element.parent();o.hasClass("slider")===!0?(s=!0,this.picker=o):this.picker=e('<div class="slider"><div class="slider-track"><div class="slider-selection"></div><div class="slider-handle"></div><div class="slider-handle"></div></div><div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div></div>').insertBefore(this.element).append(this.element),this.id=this.element.data("slider-id")||n.id,this.id&&(this.picker[0].id=this.id),typeof Modernizr!="undefined"&&Modernizr.touch&&(this.touchCapable=!0);var u=this.element.data("slider-tooltip")||n.tooltip;this.tooltip=this.picker.find(".tooltip"),this.tooltipInner=this.tooltip.find("div.tooltip-inner"),this.orientation=this.element.data("slider-orientation")||n.orientation;switch(this.orientation){case"vertical":this.picker.addClass("slider-vertical"),this.stylePos="top",this.mousePos="pageY",this.sizePos="offsetHeight",this.tooltip.addClass("right")[0].style.left="100%";break;default:this.picker.addClass("slider-horizontal").css("width",i),this.orientation="horizontal",this.stylePos="left",this.mousePos="pageX",this.sizePos="offsetWidth",this.tooltip.addClass("top")[0].style.top=-this.tooltip.outerHeight()-14+"px"}["min","max","step","value"].forEach(function(e){typeof r.data("slider-"+e)!="undefined"?this[e]=r.data("slider-"+e):typeof n[e]!="undefined"?this[e]=n[e]:typeof r.prop(e)!="undefined"?this[e]=r.prop(e):this[e]=0},this),this.value instanceof Array&&(this.range=!0),this.selection=this.element.data("slider-selection")||n.selection,this.selectionEl=this.picker.find(".slider-selection"),this.selection==="none"&&this.selectionEl.addClass("hide"),this.selectionElStyle=this.selectionEl[0].style,this.handle1=this.picker.find(".slider-handle:first"),this.handle1Stype=this.handle1[0].style,this.handle2=this.picker.find(".slider-handle:last"),this.handle2Stype=this.handle2[0].style;var a=this.element.data("slider-handle")||n.handle;switch(a){case"round":this.handle1.addClass("round"),this.handle2.addClass("round");break;case"triangle":this.handle1.addClass("triangle"),this.handle2.addClass("triangle")}this.range?(this.value[0]=Math.max(this.min,Math.min(this.max,this.value[0])),this.value[1]=Math.max(this.min,Math.min(this.max,this.value[1]))):(this.value=[Math.max(this.min,Math.min(this.max,this.value))],this.handle2.addClass("hide"),this.selection==="after"?this.value[1]=this.max:this.value[1]=this.min),this.diff=this.max-this.min,this.percentage=[(this.value[0]-this.min)*100/this.diff,(this.value[1]-this.min)*100/this.diff,this.step*100/this.diff],this.offset=this.picker.offset(),this.size=this.picker[0][this.sizePos],this.formater=n.formater,this.reversed=this.element.data("slider-reversed")||n.reversed,this.layout(),this.touchCapable?this.picker.on({touchstart:e.proxy(this.mousedown,this)}):this.picker.on({mousedown:e.proxy(this.mousedown,this)}),u==="hide"?this.tooltip.addClass("hide"):u==="always"?(this.showTooltip(),this.alwaysShowTooltip=!0):this.picker.on({mouseenter:e.proxy(this.showTooltip,this),mouseleave:e.proxy(this.hideTooltip,this)});if(s===!0){var f=this.getValue(),l=this.calculateValue();this.element.trigger({type:"slide",value:l}).data("value",l).prop("value",l),f!==l&&this.element.trigger({type:"slideChange","new":l,old:f}).data("value",l).prop("value",l)}this.enabled=n.enabled&&(this.element.data("slider-enabled")===undefined||this.element.data("slider-enabled")===!0),this.enabled||this.disable()};n.prototype={constructor:n,over:!1,inDrag:!1,showTooltip:function(){this.tooltip.addClass("in"),this.over=!0},hideTooltip:function(){this.inDrag===!1&&this.alwaysShowTooltip!==!0&&this.tooltip.removeClass("in"),this.over=!1},layout:function(){var e;this.reversed?e=[100-this.percentage[0],this.percentage[1]]:e=[this.percentage[0],this.percentage[1]],this.handle1Stype[this.stylePos]=e[0]+"%",this.handle2Stype[this.stylePos]=e[1]+"%",this.orientation==="vertical"?(this.selectionElStyle.top=Math.min(e[0],e[1])+"%",this.selectionElStyle.height=Math.abs(e[0]-e[1])+"%"):(this.selectionElStyle.left=Math.min(e[0],e[1])+"%",this.selectionElStyle.width=Math.abs(e[0]-e[1])+"%"),this.range?(this.tooltipInner.text(this.formater(this.value[0])+" : "+this.formater(this.value[1])),this.tooltip[0].style[this.stylePos]=this.size*(e[0]+(e[1]-e[0])/2)/100-(this.orientation==="vertical"?this.tooltip.outerHeight()/2:this.tooltip.outerWidth()/2)+"px"):(this.tooltipInner.text(this.formater(this.value[0])),this.tooltip[0].style[this.stylePos]=this.size*e[0]/100-(this.orientation==="vertical"?this.tooltip.outerHeight()/2:this.tooltip.outerWidth()/2)+"px")},mousedown:function(t){if(!this.isEnabled())return!1;this.touchCapable&&t.type==="touchstart"&&(t=t.originalEvent),this.offset=this.picker.offset(),this.size=this.picker[0][this.sizePos];var n=this.getPercentage(t);if(this.range){var r=Math.abs(this.percentage[0]-n),i=Math.abs(this.percentage[1]-n);this.dragged=r<i?0:1}else this.dragged=0;this.percentage[this.dragged]=this.reversed?100-n:n,this.layout(),this.touchCapable?e(document).on({touchmove:e.proxy(this.mousemove,this),touchend:e.proxy(this.mouseup,this)}):e(document).on({mousemove:e.proxy(this.mousemove,this),mouseup:e.proxy(this.mouseup,this)}),this.inDrag=!0;var s=this.calculateValue();return this.setValue(s),this.element.trigger({type:"slideStart",value:s}).trigger({type:"slide",value:s}),!1},mousemove:function(e){if(!this.isEnabled())return!1;this.touchCapable&&e.type==="touchmove"&&(e=e.originalEvent);var t=this.getPercentage(e);this.range&&(this.dragged===0&&this.percentage[1]<t?(this.percentage[0]=this.percentage[1],this.dragged=1):this.dragged===1&&this.percentage[0]>t&&(this.percentage[1]=this.percentage[0],this.dragged=0)),this.percentage[this.dragged]=this.reversed?100-t:t,this.layout();var n=this.calculateValue();return this.setValue(n),this.element.trigger({type:"slide",value:n}).data("value",n).prop("value",n),!1},mouseup:function(){if(!this.isEnabled())return!1;this.touchCapable?e(document).off({touchmove:this.mousemove,touchend:this.mouseup}):e(document).off({mousemove:this.mousemove,mouseup:this.mouseup}),this.inDrag=!1,this.over===!1&&this.hideTooltip();var t=this.calculateValue();return this.layout(),this.element.data("value",t).prop("value",t).trigger({type:"slideStop",value:t}),!1},calculateValue:function(){var e;return this.range?(e=[Math.max(this.min,this.min+Math.round(this.diff*this.percentage[0]/100/this.step)*this.step),Math.min(this.max,this.min+Math.round(this.diff*this.percentage[1]/100/this.step)*this.step)],this.value=e):(e=this.min+Math.round(this.diff*this.percentage[0]/100/this.step)*this.step,e<this.min?e=this.min:e>this.max&&(e=this.max),e=parseFloat(e),this.value=[e,this.value[1]]),e},getPercentage:function(e){this.touchCapable&&(e=e.touches[0]);var t=(e[this.mousePos]-this.offset[this.stylePos])*100/this.size;return t=Math.round(t/this.percentage[2])*this.percentage[2],Math.max(0,Math.min(100,t))},getValue:function(){return this.range?this.value:this.value[0]},setValue:function(e){this.value=this.validateInputValue(e),this.range?(this.value[0]=Math.max(this.min,Math.min(this.max,this.value[0])),this.value[1]=Math.max(this.min,Math.min(this.max,this.value[1]))):(this.value=[Math.max(this.min,Math.min(this.max,this.value))],this.handle2.addClass("hide"),this.selection==="after"?this.value[1]=this.max:this.value[1]=this.min),this.diff=this.max-this.min,this.percentage=[(this.value[0]-this.min)*100/this.diff,(this.value[1]-this.min)*100/this.diff,this.step*100/this.diff],this.layout()},validateInputValue:function(e){if(typeof e=="number")return e;if(e instanceof Array)return e.forEach(function(e){if(typeof e!="number")throw new Error(t.formatInvalidInputErrorMsg(e))}),e;throw new Error(t.formatInvalidInputErrorMsg(e))},destroy:function(){this.element.show().insertBefore(this.picker),this.picker.remove(),e(this.element).removeData("slider"),e(this.element).off()},disable:function(){this.enabled=!1,this.picker.addClass("slider-disabled"),this.element.trigger("slideDisabled")},enable:function(){this.enabled=!0,this.picker.removeClass("slider-disabled"),this.element.trigger("slideEnabled")},toggle:function(){this.enabled?this.disable():this.enable()},isEnabled:function(){return this.enabled}};var r={getValue:n.prototype.getValue,setValue:n.prototype.setValue,destroy:n.prototype.destroy,disable:n.prototype.disable,enable:n.prototype.enable,toggle:n.prototype.toggle,isEnabled:n.prototype.isEnabled};e.fn.slider=function(e){if(typeof e=="string"){var t=Array.prototype.slice.call(arguments,1);return i.call(this,e,t)}return o.call(this,e)},e.fn.slider.defaults={min:0,max:10,step:1,orientation:"horizontal",value:5,selection:"before",tooltip:"show",handle:"round",reversed:!1,enabled:!0,formater:function(e){return e}},e.fn.slider.Constructor=n}(window.jQuery),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.FeedbackNavbar=r.common.BaseView.extend({events:{"click .btn[data-action=cancel]":"_cancel","click .btn[data-action=save]":"_save","click .close[data-action=close]":"_close"},doInitialize:function(e){this.$el.html(i())},_save:function(t){t.preventDefault();var n=this.$el.find("[data-action=feedbackTitle]").val(),i=this.$el.find("[data-action=feedbackContent]").val();if(!n){r.showMessage("ERROR","标题必输",!0);return}if(!i){r.showMessage("ERROR","内容必输",!0);return}var s=this;e.ajax("/api/v2/symFeedback/",{type:"POST",data:e("#feedbackForm").serialize()}).done(function(e){e.code=="200"&&(s.$el.find("[data-action=feedbackModal]").hide(),jQuery("body").find("#modalBackdrop").hide(),r.showMessage("SUCCESS",e.message,!0))})},_cancel:function(e){this._close(e)},_close:function(e){e.preventDefault(),this.$el.find("[data-action=feedbackModal]").hide(),jQuery("body").find("#modalBackdrop").hide()}});var i=function(){return'<div id="feedbackModal" class="modal" data-action="feedbackModal">    <div class="modal-dialog">        <div class="modal-content">            <div class="modal-header lighter blue">                <button class="close" data-action="close">                    x                </button>                <h4>                    	我要反馈                </h4>            </div>            <div class="modal-body">                <form id="feedbackForm" class="form-horizontal" role="form">                    <div class="form-group">                        <label class="col-sm-3 control-label no-padding-right">标题<span class="red">*</span></label>                        <div class="col-sm-9">                            <div class="clearfix">		 						<input type="text" data-action="feedbackTitle" name="feedback.title" id="title" placeholder="标题" class="col-xs-12 col-sm-6">                            </div>                        </div>                    </div>                    <div class="space-2"></div>                    <div class="form-group">                        <label class="col-sm-3 control-label no-padding-right">提交类型<span class="red">*</span></label>                        <div class="col-sm-9">                            <div class="clearfix">                                <select class="input-medium" data-action="feedbackType" name="feedback.type">                                    <option value="QUESTION">问题</option>                                    <option value="SUGGESTION">建议</option>                                    <option value="OTHER">其他</option>                                </select>                            </div>                        </div>                    </div>                    <div class="space-2"></div>                    <div class="form-group">                        <label class="col-sm-3 control-label no-padding-right">反馈内容<span class="red">*</span></label>                        <div class="col-sm-9">                            <div class="clearfix">                                <textarea name="feedback.content" data-action="feedbackContent" class="width-80" style="min-height:150px;"></textarea>                            </div>                        </div>                    </div>                </form>            </div>            <div class="modal-footer">                <button class="btn" data-action="cancel">                    	取消                </button>                <button class="btn btn-primary" data-action="save">					提交                </button>            </div>        </div>    </div></div>'};e(function(){e("#wrap-feedback a").click(function(t){t.preventDefault(),new r.modules.FeedbackNavbar({el:e("#wrap-feedback div[data-action=feedbackView]")}),e("[data-action=feedbackModal]").show(),e("body").append('<div id="modalBackdrop" class="modal-backdrop  in"></div>')})})}();var $=jQuery||window.require&&window.require("jQuery");(function(e){e.fn.zclip=function(t){if(typeof t=="object"&&!t.length){var n=e.extend({path:"ZeroClipboard.swf",copy:null,beforeCopy:null,afterCopy:null,clickAfter:!0,setHandCursor:!0,setCSSEffects:!0},t);return this.each(function(){var t=e(this);if(t.is(":visible")&&(typeof n.copy=="string"||e.isFunction(n.copy))){ZeroClipboard.setMoviePath(n.path);var r=new ZeroClipboard.Client;e.isFunction(n.copy)&&t.bind("zClip_copy",n.copy),e.isFunction(n.beforeCopy)&&t.bind("zClip_beforeCopy",n.beforeCopy),e.isFunction(n.afterCopy)&&t.bind("zClip_afterCopy",n.afterCopy),r.setHandCursor(n.setHandCursor),r.setCSSEffects(n.setCSSEffects),r.addEventListener("mouseOver",function(e){t.trigger("mouseenter")}),r.addEventListener("mouseOut",function(e){t.trigger("mouseleave")}),r.addEventListener("mouseDown",function(i){t.trigger("mousedown"),e.isFunction(n.copy)?r.setText(t.triggerHandler("zClip_copy")):r.setText(n.copy),e.isFunction(n.beforeCopy)&&t.trigger("zClip_beforeCopy")}),r.addEventListener("complete",function(r,i){e.isFunction(n.afterCopy)?t.trigger("zClip_afterCopy"):(i.length>500&&(i=i.substr(0,500)+"...\n\n("+(i.length-500)+" characters not shown)"),t.removeClass("hover"),alert("内容已经复制到了剪贴板:\n\n "+i)),n.clickAfter&&t.trigger("click")}),r.glue(t[0],t.parent()[0]),e(window).bind("load resize",function(){r.reposition()})}})}if(typeof t=="string")return this.each(function(){var n=e(this);t=t.toLowerCase();var r=n.data("zclipId"),i=e("#"+r+".zclip");t=="remove"?(i.remove(),n.removeClass("active hover")):t=="hide"?(i.hide(),n.removeClass("active hover")):t=="show"&&i.show()})}})(jQuery);var ZeroClipboard={version:"1.0.7",clients:{},moviePath:"ZeroClipboard.swf",nextId:1,$:function(e){return typeof e=="string"&&(e=document.getElementById(e)),e.addClass||(e.hide=function(){this.style.display="none"},e.show=function(){this.style.display=""},e.addClass=function(e){this.removeClass(e),this.className+=" "+e},e.removeClass=function(e){var t=this.className.split(/\s+/),n=-1;for(var r=0;r<t.length;r++)t[r]==e&&(n=r,r=t.length);return n>-1&&(t.splice(n,1),this.className=t.join(" ")),this},e.hasClass=function(e){return!!this.className.match(new RegExp("\\s*"+e+"\\s*"))}),e},setMoviePath:function(e){this.moviePath=e},dispatch:function(e,t,n){var r=this.clients[e];r&&r.receiveEvent(t,n)},register:function(e,t){this.clients[e]=t},getDOMObjectPosition:function(e,t){var n={left:0,top:0,width:e.width?e.width:e.offsetWidth,height:e.height?e.height:e.offsetHeight};return e&&e!=t&&(n.left+=e.offsetLeft,n.top+=e.offsetTop),n},Client:function(e){this.handlers={},this.id=ZeroClipboard.nextId++,this.movieId="ZeroClipboardMovie_"+this.id,ZeroClipboard.register(this.id,this),e&&this.glue(e)}};ZeroClipboard.Client.prototype={id:0,ready:!1,movie:null,clipText:"",handCursorEnabled:!0,cssEffects:!0,handlers:null,glue:function(e,t,n){this.domElement=ZeroClipboard.$(e);var r=99;this.domElement.style.zIndex&&(r=parseInt(this.domElement.style.zIndex,10)+1),typeof t=="string"?t=ZeroClipboard.$(t):typeof t=="undefined"&&(t=document.getElementsByTagName("body")[0]);var i=ZeroClipboard.getDOMObjectPosition(this.domElement,t);this.div=document.createElement("div"),this.div.className="zclip",this.div.id="zclip-"+this.movieId,$(this.domElement).data("zclipId","zclip-"+this.movieId);var s=this.div.style;s.position="absolute",s.left=""+i.left+"px",s.top=""+i.top+"px",s.width=""+i.width+"px",s.height=""+i.height+"px",s.zIndex=r;if(typeof n=="object")for(addedStyle in n)s[addedStyle]=n[addedStyle];t.appendChild(this.div),this.div.innerHTML=this.getHTML(i.width,i.height)},getHTML:function(e,t){var n="",r="id="+this.id+"&width="+e+"&height="+t;if(navigator.userAgent.match(/MSIE/)){var i=location.href.match(/^https/i)?"https://":"http://";n+='<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="'+i+'download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0" width="'+e+'" height="'+t+'" id="'+this.movieId+'" align="middle"><param name="allowScriptAccess" value="always" /><param name="allowFullScreen" value="false" /><param name="movie" value="'+ZeroClipboard.moviePath+'" /><param name="loop" value="false" /><param name="menu" value="false" /><param name="quality" value="best" /><param name="bgcolor" value="#ffffff" /><param name="flashvars" value="'+r+'"/><param name="wmode" value="transparent"/></object>'}else n+='<embed id="'+this.movieId+'" src="'+ZeroClipboard.moviePath+'" loop="false" menu="false" quality="best" bgcolor="#ffffff" width="'+e+'" height="'+t+'" name="'+this.movieId+'" align="middle" allowScriptAccess="always" allowFullScreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="'+r+'" wmode="transparent" />';return n},hide:function(){this.div&&(this.div.style.left="-2000px")},show:function(){this.reposition()},destroy:function(){if(this.domElement&&this.div){this.hide(),this.div.innerHTML="";var e=document.getElementsByTagName("body")[0];try{e.removeChild(this.div)}catch(t){}this.domElement=null,this.div=null}},reposition:function(e){e&&(this.domElement=ZeroClipboard.$(e),this.domElement||this.hide());if(this.domElement&&this.div){var t=ZeroClipboard.getDOMObjectPosition(this.domElement),n=this.div.style;n.left=""+t.left+"px",n.top=""+t.top+"px"}},setText:function(e){this.clipText=e,this.ready&&this.movie.setText(e)},addEventListener:function(e,t){e=e.toString().toLowerCase().replace(/^on/,""),this.handlers[e]||(this.handlers[e]=[]),this.handlers[e].push(t)},setHandCursor:function(e){this.handCursorEnabled=e,this.ready&&this.movie.setHandCursor(e)},setCSSEffects:function(e){this.cssEffects=!!e},receiveEvent:function(e,t){e=e.toString().toLowerCase().replace(/^on/,"");switch(e){case"load":this.movie=document.getElementById(this.movieId);if(!this.movie){var n=this;setTimeout(function(){n.receiveEvent("load",null)},1);return}if(!this.ready&&navigator.userAgent.match(/Firefox/)&&navigator.userAgent.match(/Windows/)){var n=this;setTimeout(function(){n.receiveEvent("load",null)},100),this.ready=!0;return}this.ready=!0;try{this.movie.setText(this.clipText)}catch(r){}try{this.movie.setHandCursor(this.handCursorEnabled)}catch(r){}break;case"mouseover":this.domElement&&this.cssEffects&&(this.domElement.addClass("hover"),this.recoverActive&&this.domElement.addClass("active"));break;case"mouseout":this.domElement&&this.cssEffects&&(this.recoverActive=!1,this.domElement.hasClass("active")&&(this.domElement.removeClass("active"),this.recoverActive=!0),this.domElement.removeClass("hover"));break;case"mousedown":this.domElement&&this.cssEffects&&this.domElement.addClass("active");break;case"mouseup":this.domElement&&this.cssEffects&&(this.domElement.removeClass("active"),this.recoverActive=!1)}if(this.handlers[e])for(var i=0,s=this.handlers[e].length;i<s;i++){var o=this.handlers[e][i];typeof o=="function"?o(this,t):typeof o=="object"&&o.length==2?o[0][o[1]](this,t):typeof o=="string"&&window[o](this,t)}}},function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.common.AccountBindDialog=t.View.extend({el:e("#modal-firstLogin"),events:{"click a.validateCode":"_getValidateCode","click a.weiboShare":"_shareToWeibo","click a.qqShare":"_shareToQQ","click [data-action=nextStep]":"nextStep","click [data-action=logout]":"logout","click #verificationImg":"changeVerifyCodeImg","click [data-action=finish]":"finish"},startBind:function(){var t=r.supportedAccess();if(!t){var n=this;e("#browserModal").removeClass("hide").modal("show").on("hidden.bs.modal",function(e){n.startBindUser()});return}this.startBindUser()},startBindUser:function(){if(!r.account.user.telephone)this._startPhoneBind(),this.render();else if(!r.account.user.isSnsUser){var e=localStorage.getItem("temp-skip-sns-bind-"+r.account.user.id);if(!e||e!=r.util.getCookie("loginTime"))this._startSnsBind(),this.render()}else localStorage.getItem("need-bind-confirm-"+r.account.user.id)&&(this._startShareToSns(!0),this.render());return},logout:function(){window.location="/logout"},nextStep:function(){this._currentStep=="bindTelephone"?this._currentForm.valid()&&this._bindPhoneToUser():this._currentStep=="bindSns"&&this._startShareToSns()},finish:function(){this.$el.modal("hide"),e.post("/api/users/shareToSns"),localStorage.removeItem("need-bind-confirm-"+r.account.user.id),localStorage.setItem("temp-skip-sns-bind-"+r.account.user.id,r.util.getCookie("loginTime"))},render:function(){this.$el.modal({backdrop:"static",keyboard:!1})},changeVerifyCodeImg:function(t){t.preventDefault(),e("#getTelephoneVerifycode").attr("disabled","disabled"),e("#verificationImg").attr("src","/api/users/genValidCode?v="+Date.now())},_getValidateCode:function(t){t.preventDefault();var n=e(t.target);if(this._currentForm.validate().element("input[name=telephone]")&&this._currentForm.validate().element("input[name=verificationCode]")){n.addClass("disabled");var r=this.$("input[name=telephone]").val(),i=this.$("#verificationCode").val(),s=this;e.get("/api/users/sendCode?telephone="+r+"&captchaCode="+i,function(e){e.code=="200"?(n.html("（免费收到资金变动的短信提醒）"),s._wait=80,s._updateTimer(n)):(n.removeClass("disabled"),s._currentForm.validate().showErrors({verificationCode:"验证码输入错误"}))})}},_updateTimer:function(t){this._wait==0?(t.removeClass("disabled"),t.html("重新获取验证码")):(t.html("重新发送("+this._wait+")"),this._wait--,setTimeout(e.proxy(this._updateTimer,this,t),1e3))},_bindPhoneToUser:function(t){this.$("[data-action=nextStep]").addClass("disabled");var n=this;e.post("/api/users/bindphone",this._currentForm.serialize()).done(function(e){n.$("[data-action=nextStep]").removeClass("disabled"),e.code==200?(r.account.user.telephone=n.$("input[name=telephone]").val(),n._startSnsBind()):e.code==401?n._currentForm.validate().showErrors({validateCode:"验证码错误"}):e.code==402?n._currentForm.validate().showErrors({telephone:"手机号已被使用"}):e.code==403&&n._currentForm.validate().showErrors({telephone:"账号已绑定手机号"})})},_shareToWeibo:function(t){e(t.target).attr("href",this.getShareUrl("weibo"))},_shareToQQ:function(t){e(t.target).attr("href",this.getShareUrl("qq"))},getShareUrl:function(e){var t=location.protocol+"//"+location.host+"/register?refer="+r.account.user.id,n=this.$("textarea.share-text").val(),i=this.$("div.share-img").css("background-image").replace(/^url|[\(\)]/g,""),s={registerUrl:t,avator:i,title:n};if(e==="weibo")return r.util.getWeiboShareUrl("register",s);if(e==="qq")return r.util.getQQShareUrl("register",s)},_startPhoneBind:function(){this.$(".bindTelephone").addClass("active"),this._currentStep="bindTelephone",this._currentForm=this.$("form.bindTelephone"),this._currentForm.validate({errorElement:"div",errorClass:"help-block",rules:{telephone:{required:!0,phoneZh:!0},verificationCode:{required:!0,minlength:5,maxlength:5},validateCode:{required:!0,number:!0,minlength:6}},messages:{telephone:{required:"请输入手机号",phoneZh:"请输入正确的手机号"},verificationCode:{required:"验证码不能为空",minlength:"验证码为5位数",maxlength:"验证码为5位数"},validateCode:{required:"请输入验证码",number:"验证码为6位数字",minlength:"验证码为6位数字"}},highlight:function(t){e(t).closest(".form-group").addClass("has-error")},unhighlight:function(t){e(t).closest(".form-group").removeClass("has-error")}})},_startSnsBind:function(){this.$("button[data-action=logout]").addClass("hide"),localStorage.setItem("need-bind-confirm-"+r.account.user.id,new Date),r.account.user.isSnsUser?this._startShareToSns(!0):(this.$("form.bindTelephone").removeClass("active"),this.$("li.bindTelephone").addClass("active"),this.$(".bindSns").addClass("active"),this._currentStep="bindSns")},_startShareToSns:function(e){this.$("button[data-action=logout]").addClass("hide");var t=r.account.user.id;if(e||localStorage.getItem("need-bind-confirm-"+t))this.$("form.bindTelephone, form.bindSns").removeClass("active"),this.$("li.bindTelephone, li.bindSns").addClass("active"),this.$(".shareToSns").addClass("active"),this._currentStep="shareToSns",this.$("button[data-action=nextStep]").addClass("hide"),this.$("button[data-action=finish]").removeClass("hide")}})}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf"),i=5,s,o,u,a,f,l,c,h,p,d,v,m;r.modules.common.ImageCrop=r.common.BaseView.extend({events:{"click .close, .btn-cancel":"_cancel","click .btn-ok":"_ok"},doInitialize:function(e){m=this,p=this,this.wrapperView=e.wrapperView||{},this._data=e,o=m._data.width,u=m._data.height,d=m._data.minWidth||0,v=m._data.minHeight||0,this.$el.html(g(this._data)).appendTo("body"),this.$el.find(".modal").show(),this.$imgcrop=this.$el.find("#imgcrop"),l=this.$el.find("#imgpreview"),c=this.$el.find("#imgpreview .preview-container"),h=this.$el.find("#imgpreview .preview-container img"),this._initImageCrop()},_ok:function(e){this._postFormData(),this.remove()},_cancel:function(e){this.setImgSrc(this.getImgSrc()),n.isFunction(this._data.callback)&&this._data.callback(),this.remove()},_initImageCrop:function(){var e=this;this.$imgcrop.Jcrop({onChange:e._updatePreview,onSelect:e._updatePreview,boxWidth:300,minSize:[d,v],aspectRatio:o/u},function(){var t=this.getBounds(),n=this.getWidgetSize();a=t[0],f=t[1];var r=n[0],i=n[1];console.log(t),console.log(n),s=this;var o=r<300?(300-r)/2:0,u=i<300?(300-i)/2:0,l={position:"relative",left:o+"px",top:u+"px","background-color":"white"};s.ui.holder.css(l),this.setSelect([0,0,a,f]),console.log(this.tellScaled());var c=this.tellScaled();c.w==r&&c.h==i?e.hasChanged=!1:e.hasChanged=!0})},_updatePreview:function(e){c.hasClass("hide")&&c.removeClass("hide");if(parseInt(e.w)>0){var t=o/e.w,n=u/e.h;h.css({width:Math.round(t*a)+"px",height:Math.round(n*f)+"px",marginLeft:"-"+Math.round(t*e.x)+"px",marginTop:"-"+Math.round(n*e.y)+"px"}),m.hasChanged=!0,p.setFormData(e)}},setFormData:function(t){e("#x1").val(t.x),e("#y1").val(t.y),e("#w").val(t.w),e("#h").val(t.h)},getFormData:function(t){var n={path:this._data.url,x:Math.round(e("#x1").val()),y:Math.round(e("#y1").val()),width:Math.round(e("#w").val()),height:Math.round(e("#h").val())};return n},_postFormData:function(){var t=this.getFormData();if(!t.width||!this.hasChanged){this.setImgSrc(this.getImgSrc()),n.isFunction(this._data.callback)&&this._data.callback();return}var i=this,s="/api/v2/files/crop";e.post(s,t).done(function(e){e.code==200?(r.showMessage("剪裁成功","图片已成功剪裁!",!0),i.setImgSrc(i.getImgSrc()),n.isFunction(i._data.callback)&&i._data.callback()):r.showMessage("error","图片裁剪失败，请重新裁剪",!0)})},setImgSrc:function(e){this._data.setImg(e)},getImgSrc:function(){var e=new Date;return this._data.url+"?v="+e.getTime()}});var g=function(e){return'<div id="imgCropDlg">				<input type="hidden" size="4" id="x1" name="x1" />		  		<input type="hidden" size="4" id="y1" name="y1" />			    <input type="hidden" size="4" id="w" name="w" />			    <input type="hidden" size="4" id="h" name="h" />				<div class="modal fade in">					<div class="modal-dialog confirm-dialog">						<div class="modal-content">							<div class="alert">								<button type="button" class="close">×</button>								<h4 class="confirm-title blue">图片裁剪</h4>								<div class="message">									<div style="width:300px;min-height:300px;background-color:rgb(229, 225, 225);position:relative;overflow:hidden;">										<img src="'+e.url+'" id="imgcrop">									</div>									<div id="imgpreview" style="position:absolute;left:330px;top:100px;" >										<div style="position:absolute;width:200px;top:-50px;font-size:13px;">											随意拖拽或缩放图中的虚线方格，预览的小图即为保存后的图片											<span style="color:rgb(218, 73, 73);" class="'+(e.width&&"hide")+'">(该处没有预览效果，请自行判断裁剪)</span>										</div>										<div class="hide preview-container" style="width: '+e.width+"px;height:"+e.height+"px;overflow: hidden;"+(e.width&&"border: 6px solid lightgray;")+'">		     								 <img src="'+e.url+'" class="imgcrop-preview" alt="Preview" />		   								</div>		   							</div>		   						</div>								<p class="actions">								  <a class="btn btn-ok" href="javascript:;">确定</a> <a class="btn btn-danger btn-cancel" href="javascript:;">取消</a>								</p>							</div>						</div>					</div>				</div>				<div class="modal-backdrop in"></div>			</div>'}}(),function(e,t){"object"==typeof exports?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e)}(this,function(e){function t(e){this._targetElement=e,this._options={nextLabel:"Next &rarr;",prevLabel:"&larr; Back",skipLabel:"Skip",doneLabel:"Done",tooltipPosition:"bottom",tooltipClass:"",highlightClass:"",exitOnEsc:!0,exitOnOverlayClick:!0,showStepNumbers:!0,keyboardNavigation:!0,showButtons:!0,showBullets:!0,showProgress:!1,scrollToElement:!0,overlayOpacity:.8,positionPrecedence:["bottom","top","right","left"],disableInteraction:!1}}function n(e){var t=[],n=this;if(this._options.steps)for(var u=[],a=0,u=this._options.steps.length;a<u;a++){var l=r(this._options.steps[a]);l.step=t.length+1,"string"==typeof l.element&&(l.element=document.querySelector(l.element));if("undefined"==typeof l.element||null==l.element){var c=document.querySelector(".introjsFloatingElement");null==c&&(c=document.createElement("div"),c.className="introjsFloatingElement",document.body.appendChild(c)),l.element=c,l.position="floating"}null!=l.element&&t.push(l)}else{u=e.querySelectorAll("*[data-intro]");if(1>u.length)return!1;a=0;for(l=u.length;a<l;a++){var c=u[a],h=parseInt(c.getAttribute("data-step"),10);0<h&&(t[h-1]={element:c,intro:c.getAttribute("data-intro"),step:parseInt(c.getAttribute("data-step"),10),tooltipClass:c.getAttribute("data-tooltipClass"),highlightClass:c.getAttribute("data-highlightClass"),position:c.getAttribute("data-position")||this._options.tooltipPosition})}a=h=0;for(l=u.length;a<l;a++)if(c=u[a],null==c.getAttribute("data-step")){for(;"undefined"!=typeof t[h];)h++;t[h]={element:c,intro:c.getAttribute("data-intro"),step:h+1,tooltipClass:c.getAttribute("data-tooltipClass"),highlightClass:c.getAttribute("data-highlightClass"),position:c.getAttribute("data-position")||this._options.tooltipPosition}}}a=[];for(u=0;u<t.length;u++)t[u]&&a.push(t[u]);return t=a,t.sort(function(e,t){return e.step-t.step}),n._introItems=t,v.call(n,e)&&(i.call(n),e.querySelector(".introjs-skipbutton"),e.querySelector(".introjs-nextbutton"),n._onKeyDown=function(t){if(27===t.keyCode&&1==n._options.exitOnEsc)o.call(n,e),void 0!=n._introExitCallback&&n._introExitCallback.call(n);else if(37===t.keyCode)s.call(n);else if(39===t.keyCode)i.call(n);else if(13===t.keyCode){var r=t.target||t.srcElement;r&&0<r.className.indexOf("introjs-prevbutton")?s.call(n):r&&0<r.className.indexOf("introjs-skipbutton")?o.call(n,e):i.call(n),t.preventDefault?t.preventDefault():t.returnValue=!1}},n._onResize=function(e){f.call(n,document.querySelector(".introjs-helperLayer")),f.call(n,document.querySelector(".introjs-tooltipReferenceLayer"))},window.addEventListener?(this._options.keyboardNavigation&&window.addEventListener("keydown",n._onKeyDown,!0),window.addEventListener("resize",n._onResize,!0)):document.attachEvent&&(this._options.keyboardNavigation&&document.attachEvent("onkeydown",n._onKeyDown),document.attachEvent("onresize",n._onResize))),!1}function r(e){if(null==e||"object"!=typeof e||"undefined"!=typeof e.nodeType)return e;var t={},n;for(n in e)t[n]=r(e[n]);return t}function i(){this._direction="forward","undefined"==typeof this._currentStep?this._currentStep=0:++this._currentStep;if(this._introItems.length<=this._currentStep)"function"==typeof this._introCompleteCallback&&this._introCompleteCallback.call(this),o.call(this,this._targetElement);else{var e=this._introItems[this._currentStep];"undefined"!=typeof this._introBeforeChangeCallback&&this._introBeforeChangeCallback.call(this,e.element),c.call(this,e)}}function s(){this._direction="backward";if(0===this._currentStep)return!1;var e=this._introItems[--this._currentStep];"undefined"!=typeof this._introBeforeChangeCallback&&this._introBeforeChangeCallback.call(this,e.element),c.call(this,e)}function o(e){var t=e.querySelector(".introjs-overlay");if(null!=t){t.style.opacity=0,setTimeout(function(){t.parentNode&&t.parentNode.removeChild(t)},500);var n=e.querySelector(".introjs-helperLayer");n&&n.parentNode.removeChild(n),(n=e.querySelector(".introjs-tooltipReferenceLayer"))&&n.parentNode.removeChild(n),(e=e.querySelector(".introjs-disableInteraction"))&&e.parentNode.removeChild(e),(e=document.querySelector(".introjsFloatingElement"))&&e.parentNode.removeChild(e);if(e=document.querySelector(".introjs-showElement"))e.className=e.className.replace(/introjs-[a-zA-Z]+/g,"").replace(/^\s+|\s+$/g,"");if((e=document.querySelectorAll(".introjs-fixParent"))&&0<e.length)for(n=e.length-1;0<=n;n--)e[n].className=e[n].className.replace(/introjs-fixParent/g,"").replace(/^\s+|\s+$/g,"");window.removeEventListener?window.removeEventListener("keydown",this._onKeyDown,!0):document.detachEvent&&document.detachEvent("onkeydown",this._onKeyDown),this._currentStep=void 0}}function u(e,t,n,r){var i="";t.style.top=null,t.style.right=null,t.style.bottom=null,t.style.left=null,t.style.marginLeft=null,t.style.marginTop=null,n.style.display="inherit","undefined"!=typeof r&&null!=r&&(r.style.top=null,r.style.left=null);if(this._introItems[this._currentStep]){i=this._introItems[this._currentStep],i="string"==typeof i.tooltipClass?i.tooltipClass:this._options.tooltipClass,t.className=("introjs-tooltip "+i).replace(/^\s+|\s+$/g,""),currentTooltipPosition=this._introItems[this._currentStep].position;if(("auto"==currentTooltipPosition||"auto"==this._options.tooltipPosition)&&"floating"!=currentTooltipPosition){var i=currentTooltipPosition,s=this._options.positionPrecedence.slice(),o=p(),u=m(t).height+10,f=m(t).width+20,l=m(e),c="floating";l.left+f>o.width||0>l.left+l.width/2-f?(a(s,"bottom"),a(s,"top")):(l.height+l.top+u>o.height&&a(s,"bottom"),0>l.top-u&&a(s,"top")),l.width+l.left+f>o.width&&a(s,"right"),0>l.left-f&&a(s,"left"),0<s.length&&(c=s[0]),i&&"auto"!=i&&-1<s.indexOf(i)&&(c=i),currentTooltipPosition=c}i=m(e),s=m(t).height,o=p();switch(currentTooltipPosition){case"top":t.style.left="15px",t.style.top="-"+(s+10)+"px",n.className="introjs-arrow bottom";break;case"right":t.style.left=m(e).width+20+"px",i.top+s>o.height&&(n.className="introjs-arrow left-bottom",t.style.top="-"+(s-i.height-20)+"px"),n.className="introjs-arrow left";break;case"left":1==this._options.showStepNumbers&&(t.style.top="15px"),i.top+s>o.height?(t.style.top="-"+(s-i.height-20)+"px",n.className="introjs-arrow right-bottom"):n.className="introjs-arrow right",t.style.right=i.width+20+"px";break;case"floating":n.style.display="none",e=m(t),t.style.left="50%",t.style.top="50%",t.style.marginLeft="-"+e.width/2+"px",t.style.marginTop="-"+e.height/2+"px","undefined"!=typeof r&&null!=r&&(r.style.left="-"+(e.width/2+18)+"px",r.style.top="-"+(e.height/2+18)+"px");break;case"bottom-right-aligned":n.className="introjs-arrow top-right",t.style.right="0px",t.style.bottom="-"+(m(t).height+10)+"px";break;case"bottom-middle-aligned":r=m(e),e=m(t),n.className="introjs-arrow top-middle",t.style.left=r.width/2-e.width/2+"px",t.style.bottom="-"+(e.height+10)+"px";break;default:t.style.bottom="-"+(m(t).height+10)+"px",t.style.left=m(e).width/2-m(t).width/2+"px",n.className="introjs-arrow top"}}}function a(e,t){-1<e.indexOf(t)&&e.splice(e.indexOf(t),1)}function f(e){if(e&&this._introItems[this._currentStep]){var t=this._introItems[this._currentStep],n=m(t.element),r=10;"floating"==t.position&&(r=0),e.setAttribute("style","width: "+(n.width+r)+"px; height:"+(n.height+r)+"px; top:"+(n.top-5)+"px;left: "+(n.left-5)+"px;")}}function l(){var e=document.querySelector(".introjs-disableInteraction");null===e&&(e=document.createElement("div"),e.className="introjs-disableInteraction",this._targetElement.appendChild(e)),f.call(this,e)}function c(e){"undefined"!=typeof this._introChangeCallback&&this._introChangeCallback.call(this,e.element);var t=this,n=document.querySelector(".introjs-helperLayer"),r=document.querySelector(".introjs-tooltipReferenceLayer"),a="introjs-helperLayer";m(e.element),"string"==typeof e.highlightClass&&(a+=" "+e.highlightClass),"string"==typeof this._options.highlightClass&&(a+=" "+this._options.highlightClass);if(null!=n){var c=r.querySelector(".introjs-helperNumberLayer"),v=r.querySelector(".introjs-tooltiptext"),y=r.querySelector(".introjs-arrow"),b=r.querySelector(".introjs-tooltip"),w=r.querySelector(".introjs-skipbutton"),E=r.querySelector(".introjs-prevbutton"),S=r.querySelector(".introjs-nextbutton");n.className=a,b.style.opacity=0,b.style.display="none";if(null!=c){var T=this._introItems[0<=e.step-2?e.step-2:0];if(null!=T&&"forward"==this._direction&&"floating"==T.position||"backward"==this._direction&&"floating"==e.position)c.style.opacity=0}f.call(t,n),f.call(t,r);if((T=document.querySelectorAll(".introjs-fixParent"))&&0<T.length)for(a=T.length-1;0<=a;a--)T[a].className=T[a].className.replace(/introjs-fixParent/g,"").replace(/^\s+|\s+$/g,"");T=document.querySelector(".introjs-showElement"),T.className=T.className.replace(/introjs-[a-zA-Z]+/g,"").replace(/^\s+|\s+$/g,""),t._lastShowElementTimer&&clearTimeout(t._lastShowElementTimer),t._lastShowElementTimer=setTimeout(function(){null!=c&&(c.innerHTML=e.step),v.innerHTML=e.intro,b.style.display="block",u.call(t,e.element,b,y,c),r.querySelector(".introjs-bullets li > a.active").className="",r.querySelector('.introjs-bullets li > a[data-stepnumber="'+e.step+'"]').className="active",r.querySelector(".introjs-progress .introjs-progressbar").setAttribute("style","width:"+g.call(t)+"%;"),b.style.opacity=1,c&&(c.style.opacity=1),-1===S.tabIndex?w.focus():S.focus()},350)}else{var N=document.createElement("div"),E=document.createElement("div"),n=document.createElement("div"),A=document.createElement("div"),O=document.createElement("div"),_=document.createElement("div"),D=document.createElement("div"),P=document.createElement("div");N.className=a,E.className="introjs-tooltipReferenceLayer",f.call(t,N),f.call(t,E),this._targetElement.appendChild(N),this._targetElement.appendChild(E),n.className="introjs-arrow",O.className="introjs-tooltiptext",O.innerHTML=e.intro,_.className="introjs-bullets",!1===this._options.showBullets&&(_.style.display="none");for(var N=document.createElement("ul"),a=0,B=this._introItems.length;a<B;a++){var j=document.createElement("li"),q=document.createElement("a");q.onclick=function(){t.goToStep(this.getAttribute("data-stepnumber"))},a===e.step-1&&(q.className="active"),q.href="javascript:void(0);",q.innerHTML="&nbsp;",q.setAttribute("data-stepnumber",this._introItems[a].step),j.appendChild(q),N.appendChild(j)}_.appendChild(N),D.className="introjs-progress",!1===this._options.showProgress&&(D.style.display="none"),a=document.createElement("div"),a.className="introjs-progressbar",a.setAttribute("style","width:"+g.call(this)+"%;"),D.appendChild(a),P.className="introjs-tooltipbuttons",!1===this._options.showButtons&&(P.style.display="none"),A.className="introjs-tooltip",A.appendChild(O),A.appendChild(_),A.appendChild(D),1==this._options.showStepNumbers&&(T=document.createElement("span"),T.className="introjs-helperNumberLayer",T.innerHTML=e.step,E.appendChild(T)),A.appendChild(n),E.appendChild(A),S=document.createElement("a"),S.onclick=function(){t._introItems.length-1!=t._currentStep&&i.call(t)},S.href="javascript:void(0);",S.innerHTML=this._options.nextLabel,E=document.createElement("a"),E.onclick=function(){0!=t._currentStep&&s.call(t)},E.href="javascript:void(0);",E.innerHTML=this._options.prevLabel,w=document.createElement("a"),w.className="introjs-button introjs-skipbutton",w.href="javascript:void(0);",w.innerHTML=this._options.skipLabel,w.onclick=function(){t._introItems.length-1==t._currentStep&&"function"==typeof t._introCompleteCallback&&t._introCompleteCallback.call(t),t._introItems.length-1!=t._currentStep&&"function"==typeof t._introExitCallback&&t._introExitCallback.call(t),o.call(t,t._targetElement)},P.appendChild(w),1<this._introItems.length&&(P.appendChild(E),P.appendChild(S)),A.appendChild(P),u.call(t,e.element,A,n,T)}!0===this._options.disableInteraction&&l.call(t),E.removeAttribute("tabIndex"),S.removeAttribute("tabIndex"),0==this._currentStep&&1<this._introItems.length?(E.className="introjs-button introjs-prevbutton introjs-disabled",E.tabIndex="-1",S.className="introjs-button introjs-nextbutton",w.innerHTML=this._options.skipLabel):this._introItems.length-1==this._currentStep||1==this._introItems.length?(w.innerHTML=this._options.doneLabel,E.className="introjs-button introjs-prevbutton",S.className="introjs-button introjs-nextbutton introjs-disabled",S.tabIndex="-1"):(E.className="introjs-button introjs-prevbutton",S.className="introjs-button introjs-nextbutton",w.innerHTML=this._options.skipLabel),S.focus(),e.element.className+=" introjs-showElement",T=h(e.element,"position"),"absolute"!==T&&"relative"!==T&&(e.element.className+=" introjs-relativePosition");for(T=e.element.parentNode;null!=T&&"body"!==T.tagName.toLowerCase();){n=h(T,"z-index"),A=parseFloat(h(T,"opacity")),P=h(T,"transform")||h(T,"-webkit-transform")||h(T,"-moz-transform")||h(T,"-ms-transform")||h(T,"-o-transform");if(/[0-9]+/.test(n)||1>A||"none"!==P)T.className+=" introjs-fixParent";T=T.parentNode}d(e.element)||!0!==this._options.scrollToElement||(A=e.element.getBoundingClientRect(),T=p().height,n=A.bottom-(A.bottom-A.top),A=A.bottom-T,0>n||e.element.clientHeight>T?window.scrollBy(0,n-30):window.scrollBy(0,A+100)),"undefined"!=typeof this._introAfterChangeCallback&&this._introAfterChangeCallback.call(this,e.element)}function h(e,t){var n="";return e.currentStyle?n=e.currentStyle[t]:document.defaultView&&document.defaultView.getComputedStyle&&(n=document.defaultView.getComputedStyle(e,null).getPropertyValue(t)),n&&n.toLowerCase?n.toLowerCase():n}function p(){if(void 0!=window.innerWidth)return{width:window.innerWidth,height:window.innerHeight};var e=document.documentElement;return{width:e.clientWidth,height:e.clientHeight}}function d(e){return e=e.getBoundingClientRect(),0<=e.top&&0<=e.left&&e.bottom+80<=window.innerHeight&&e.right<=window.innerWidth}function v(e){var t=document.createElement("div"),n="",r=this;t.className="introjs-overlay";if("body"===e.tagName.toLowerCase())n+="top: 0;bottom: 0; left: 0;right: 0;position: fixed;",t.setAttribute("style",n);else{var i=m(e);i&&(n+="width: "+i.width+"px; height:"+i.height+"px; top:"+i.top+"px;left: "+i.left+"px;",t.setAttribute("style",n))}return e.appendChild(t),t.onclick=function(){1==r._options.exitOnOverlayClick&&(o.call(r,e),void 0!=r._introExitCallback&&r._introExitCallback.call(r))},setTimeout(function(){n+="opacity: "+r._options.overlayOpacity.toString()+";",t.setAttribute("style",n)},10),!0}function m(e){var t={};t.width=e.offsetWidth,t.height=e.offsetHeight;for(var n=0,r=0;e&&!isNaN(e.offsetLeft)&&!isNaN(e.offsetTop);)n+=e.offsetLeft,r+=e.offsetTop,e=e.offsetParent;return t.top=r,t.left=n,t}function g(){return 100*(parseInt(this._currentStep+1,10)/this._introItems.length)}var y=function(e){if("object"==typeof e)return new t(e);if("string"==typeof e){if(e=document.querySelector(e))return new t(e);throw Error("There is no element with given selector.")}return new t(document.body)};return y.version="1.0.0",y.fn=t.prototype={clone:function(){return new t(this)},setOption:function(e,t){return this._options[e]=t,this},setOptions:function(e){var t=this._options,n={},r;for(r in t)n[r]=t[r];for(r in e)n[r]=e[r];return this._options=n,this},start:function(){return n.call(this,this._targetElement),this},goToStep:function(e){return this._currentStep=e-2,"undefined"!=typeof this._introItems&&i.call(this),this},nextStep:function(){return i.call(this),this},previousStep:function(){return s.call(this),this},exit:function(){return o.call(this,this._targetElement),this},refresh:function(){return f.call(this,document.querySelector(".introjs-helperLayer")),f.call(this,document.querySelector(".introjs-tooltipReferenceLayer")),this},onbeforechange:function(e){if("function"!=typeof e)throw Error("Provided callback for onbeforechange was not a function");return this._introBeforeChangeCallback=e,this},onchange:function(e){if("function"!=typeof e)throw Error("Provided callback for onchange was not a function.");return this._introChangeCallback=e,this},onafterchange:function(e){if("function"!=typeof e)throw Error("Provided callback for onafterchange was not a function");return this._introAfterChangeCallback=e,this},oncomplete:function(e){if("function"!=typeof e)throw Error("Provided callback for oncomplete was not a function.");return this._introCompleteCallback=e,this},onexit:function(e){if("function"!=typeof e)throw Error("Provided callback for onexit was not a function.");return this._introExitCallback=e,this}},e.introJs=y}),function(){"use strict";var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",t=String.fromCharCode,n=function(){try{document.createElement("$")}catch(e){return e}}();window.btoa||(window.btoa=function(t){var r,i,s,o,u,a,f,l=0,c=t.length,h=Math.max,p="";while(l<c){r=t.charCodeAt(l++)||0,i=t.charCodeAt(l++)||0,f=t.charCodeAt(l++)||0;if(h(r,i,f)>255)throw n;s=r>>2&63,o=(r&3)<<4|i>>4&15,u=(i&15)<<2|f>>6&3,a=f&63,i?f||(a=64):u=a=64,p+=e.charAt(s)+e.charAt(o)+e.charAt(u)+e.charAt(a)}return p}),window.atob||(window.atob=function(r){r=r.replace(/=+$/,"");var i,s,o,u,a,f,l,c=0,h=r.length,p=[];if(h%4===1)throw n;while(c<h)o=e.indexOf(r.charAt(c++)),u=e.indexOf(r.charAt(c++)),a=e.indexOf(r.charAt(c++)),f=e.indexOf(r.charAt(c++)),i=(o&63)<<2|u>>4&3,s=(u&15)<<4|a>>2&15,l=(a&3)<<6|f&63,p.push(t(i)),s&&p.push(t(s)),l&&p.push(t(l));return p.join("")}),window.ExcellentExport=function(){var e="1.3",t={excel:"data:application/vnd.ms-excel;base64,",csv:"data:application/csv;base64,"},n={excel:'<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>'},r=function(e){return window.btoa(unescape(encodeURIComponent(e)))},i=function(e,t){return e.replace(/{(\w+)}/g,function(e,n){return t[n]})},s=function(e){return e.nodeType?e:document.getElementById(e)},o=function(e){var t=e,n=e.indexOf(",")!==-1||e.indexOf("\r")!==-1||e.indexOf("\n")!==-1,r=e.indexOf('"')!==-1;r&&(t=t.replace(/"/g,'""'));if(n||r)t='"'+t+'"';return t},u=function(e){var t="";for(var n=0,r;r=e.rows[n];n++){for(var i=0,s;s=r.cells[i];i++)t=t+(i?",":"")+o(s.innerHTML);t+="\r\n"}return t},a={excel:function(e,o,u){o=s(o);var a={worksheet:u||"Worksheet",table:o.innerHTML},f=t.excel+r(i(n.excel,a));return e.href=f,!0},csv:function(e,n){n=s(n);var i=u(n),o=t.csv+r(i);return e.href=o,!0}};return a}()}(),
/*!
 * artTemplate - Template Engine
 * https://github.com/aui/artTemplate
 * Released under the MIT, BSD, and GPL Licenses
 */
!function(){var e=function(t,n){return e[typeof n=="object"?"render":"compile"].apply(e,arguments)};(function(e,t){"use strict";e.version="2.0.0",e.openTag="<%",e.closeTag="%>",e.isEscape=!0,e.isCompress=!1,e.parser=null,e.render=function(e,t){var n=r(e);return n===undefined?i({id:e,name:"Render Error",message:"No Template"}):n(t)},e.compile=function(t,r){function c(n){try{return new f(n)+""}catch(s){return u?(s.id=t||r,s.name="Render Error",s.source=r,i(s)):e.compile(t,r,!0)(n)}}var o=arguments,u=o[2],a="anonymous";typeof r!="string"&&(u=o[1],r=o[0],t=a);try{var f=s(r,u)}catch(l){return l.id=t||r,l.name="Syntax Error",i(l)}return c.prototype=f.prototype,c.toString=function(){return f.toString()},t!==a&&(n[t]=c),c},e.helper=function(t,n){e.prototype[t]=n},e.onerror=function(e){var n="[template]:\n"+e.id+"\n\n[name]:\n"+e.name;e.message&&(n+="\n\n[message]:\n"+e.message),e.line&&(n+="\n\n[line]:\n"+e.line,n+="\n\n[source]:\n"+e.source.split(/\n/)[e.line-1].replace(/^[\s\t]+/,"")),e.temp&&(n+="\n\n[temp]:\n"+e.temp),t.console&&console.error(n)};var n={},r=function(r){var i=n[r];if(i===undefined&&"document"in t){var s=document.getElementById(r);if(s){var o=s.value||s.innerHTML;return e.compile(r,o.replace(/^\s*|\s*$/g,""))}}else if(n.hasOwnProperty(r))return i},i=function(t){function n(){return n+""}return e.onerror(t),n.toString=function(){return"{Template Error}"},n},s=function(){e.prototype={$render:e.render,$escape:function(e){return typeof e=="string"?e.replace(/&(?![\w#]+;)|[<>"']/g,function(e){return{"<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","&":"&#38;"}[e]}):e},$string:function(e){return typeof e=="string"||typeof e=="number"?e:typeof e=="function"?e():""}};var t=Array.prototype.forEach||function(e,t){var n=this.length>>>0;for(var r=0;r<n;r++)r in this&&e.call(t,this[r],r,this)},n=function(e,n){t.call(e,n)},r="break,case,catch,continue,debugger,default,delete,do,else,false,finally,for,function,if,in,instanceof,new,null,return,switch,this,throw,true,try,typeof,var,void,while,with,abstract,boolean,byte,char,class,const,double,enum,export,extends,final,float,goto,implements,import,int,interface,long,native,package,private,protected,public,short,static,super,synchronized,throws,transient,volatile,arguments,let,yield,undefined",i=new RegExp(["/\\*(.|\n)*?\\*/|//[^\n]*\n|//[^\n]*$","'[^']*'|\"[^\"]*\"","\\.[s	\n]*[\\$\\w]+","\\b"+r.replace(/,/g,"\\b|\\b")+"\\b"].join("|"),"g"),s=function(e){return e=e.replace(i,",").replace(/[^\w\$]+/g,",").replace(/^,|^\d+|,\d+|,$/g,""),e?e.split(","):[]};return function(t,r){function S(t){return l+=t.split(/\n/).length-1,e.isCompress&&(t=t.replace(/[\n\r\t\s]+/g," ")),t=t.replace(/('|\\)/g,"\\$1").replace(/\r/g,"\\r").replace(/\n/g,"\\n"),t=m[1]+"'"+t+"'"+m[2],t+"\n"}function x(t){var n=l;u?t=u(t):r&&(t=t.replace(/\n/g,function(){return l++,"$line="+l+";"}));if(t.indexOf("=")===0){var i=t.indexOf("==")!==0;t=t.replace(/^=*|[\s;]*$/g,"");if(i&&e.isEscape){var s=t.replace(/\s*\([^\)]+\)/,"");!h.hasOwnProperty(s)&&!/^(include|print)$/.test(s)&&(t="$escape($string("+t+"))")}else t="$string("+t+")";t=m[1]+t+m[2]}return r&&(t="$line="+n+";"+t),T(t),t+"\n"}function T(e){e=s(e),n(e,function(e){c.hasOwnProperty(e)||(N(e),c[e]=!0)})}function N(e){var t;e==="print"?t=y:e==="include"?(p.$render=h.$render,t=b):(t="$data."+e,h.hasOwnProperty(e)&&(p[e]=h[e],e.indexOf("$")===0?t="$helpers."+e:t=t+"===undefined?$helpers."+e+":"+t)),d+=e+"="+t+","}var i=e.openTag,o=e.closeTag,u=e.parser,a=t,f="",l=1,c={$data:!0,$helpers:!0,$out:!0,$line:!0},h=e.prototype,p={},d="var $helpers=this,"+(r?"$line=0,":""),v="".trim,m=v?["$out='';","$out+=",";","$out"]:["$out=[];","$out.push(",");","$out.join('')"],g=v?"if(content!==undefined){$out+=content;return content}":"$out.push(content);",y="function(content){"+g+"}",b="function(id,data){if(data===undefined){data=$data}var content=$helpers.$render(id,data);"+g+"}";n(a.split(i),function(e,t){e=e.split(o);var n=e[0],r=e[1];e.length===1?f+=S(n):(f+=x(n),r&&(f+=S(r)))}),a=f,r&&(a="try{"+a+"}catch(e){"+"e.line=$line;"+"throw e"+"}"),a="'use strict';"+d+m[0]+a+"return new String("+m[3]+")";try{var w=new Function("$data",a);return w.prototype=p,w}catch(E){throw E.temp="function anonymous($data) {"+a+"}",E}}}()})(e,window),window=window||{},window.template=e,typeof define=="function"?define(function(t,n,r){r.exports=e}):typeof exports!="undefined"&&(module.exports=e)}(),
/*!
 * artTemplate - Syntax Extensions
 * https://github.com/aui/artTemplate
 * Released under the MIT, BSD, and GPL Licenses
 */
!function(e){e.openTag="{",e.closeTag="}",e.parser=function(t){t=t.replace(/^\s/,"");var n=t.split(" "),r=n.shift(),i=e.keywords,s=i[r];return s&&i.hasOwnProperty(r)?(n=n.join(" "),t=s.call(t,n)):e.prototype.hasOwnProperty(r)?(n=n.join(","),t="=="+r+"("+n+");"):(t=t.replace(/[\s;]*$/,""),t="="+t),t},e.keywords={"if":function(e){return"if("+e+"){"},"else":function(e){return e=e.split(" "),e.shift()==="if"?e=" if("+e.join(" ")+")":e="","}else"+e+"{"},"/if":function(){return"}"},each:function(e){e=e.split(" ");var t=e[0]||"$data",n=e[1]||"as",r=e[2]||"$value",i=e[3]||"$index",s=r+","+i;return n!=="as"&&(t="[]"),"$each("+t+",function("+s+"){"},"/each":function(){return"});"},echo:function(e){return"print("+e+");"},include:function(e){e=e.split(" ");var t=e[0],n=e[1],r=t+(n?","+n:"");return"include("+r+");"}},e.helper("$each",function(e,t){var n=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"};if(n(e))for(var r=0,i=e.length;r<i;r++)t.call(e,e[r],r,e);else for(r in e)t.call(e,e[r],r)})}(template),!function(){"use strict";var e=require("underscore"),t=require("jQuery"),n=require("yf"),r=require("moment"),i=window.template,s={};s.direct={testTplId1:function(e,t){return"<i>根据data来手动拼接DOM片段然后返回</i>"}},s.render=function(e,n,r){r=r||{},n=n||{};var i,o=s.direct[e];o?i=o(n):i=s.engine(e,n);var u=t("<div />").append(i).children();return u},s.setEngine=function(e){this.engine=e},s.setIsEscape=function(e){s.engine.isEscape=e},s.registerHelper=function(t){if(!t)return;e.each(t,function(e,t,n){s.engine.helper(t,e)})},s.setEngine(i);var o={yf:n,_:e,now:function(){return Date.now()},len:function(t){return e.size(t)},formatChineseDay:function(e){return e?r(e).format("YYYY-MM-DD"):""},formatMinutes:function(e){return e?r(e).format("YYYY-MM-DD HH:mm"):""},productType:function(e){if("CARD"==e)return"微名片";if("WEBSITE"==e)return"微站"},productStatus:function(e){if("INIT"==e)return"未创建";if("TRIAL"==e)return"试用";if("TRIAL_EXPIRED"==e)return"试用已过期";if("BOUGHT"==e)return"已购买";if("EXPIRED"==e)return"已过期"},productOperationType:function(e){if("BUY"==e)return"购买";if("UPGRADE"==e)return"升级";if("RENEW"==e)return"续费"},depositType:function(e){if("PERSON_TRANSFER_ACCOUNTS"==e)return"人工转账";if("PAYMENT_PLATFORM_RECHARGE"==e)return"支付平台充值";if("SCORE_RECHARGE"==e)return"积分兑换";if("HAND_COIN_RECHARGE"==e)return"掌币兑换"},evalCondition:function(e,t,n){return e?t:n},currency:function(e){return e=e?e:0,(new Number(e)).toFixed(2)},bgImgUrl:function(e){return e?"background-image:url("+e+")":""},getFullUrl:function(e){return e?e.indexOf("http")>=0?e:n.App.config.hostDomain+e:""}};s.registerHelper(o),s.setIsEscape(!0),n.tpl=s}(),function(e){function m(t){var n=e(template.render("payment-modal",{title:t})).appendTo("body").on("click","button.close",function(e){n.remove()}).on("click",".modal-footer .buy-cancel",function(){n.remove()});return n}function S(){n=$modal.find('form[data-form="handleWrapper"]').validate({onkeyup:function(t){e(t).valid()},onfocusout:function(t){e(t).valid()},errorElement:"div",errorClass:"help-block",rules:{jifen:{digits:!0,min:0,max:i.generalInfo.score},zhangbi:{digits:!0,min:0,max:i.generalInfo.handCoin||0}},highlight:function(t){e(t).closest(".row").addClass("has-error")},unhighlight:function(t){e(t).closest(".row").removeClass("has-error")}})}function x(){$modal.on("blur",'input[data-input="configCount"]',function(){var t=e(this).val()-0,n=b(t)}),$modal.on("input",'input[data-input="configCount"]',function(){var t=e(this).val()-0;b(t)}),$modal.on("input",'input[data-input="jifenUsed"]',function(){var t=e(this).val()-0;!t||t<0?(h=0,c=0):t>i.generalInfo.score?(h=i.generalInfo.score*i.generalInfo.scoreRate,c=i.generalInfo.score):(h=t*i.generalInfo.scoreRate,c=t),y()}),$modal.on("focus",'input[data-input="jifenUsed"]',function(e){v!="jifen"&&E("jifen")}),$modal.on("input",'input[data-input="zhangbiUsed"]',function(){v!="zhangbi"&&E("zhangbi");var t=e(this).val()-0;!t||t<0?(d=0,p=0):t>i.generalInfo.handCoin?(d=i.generalInfo.handCoin*i.generalInfo.handCoinRate,p=i.generalInfo.handCoin):(d=t*i.generalInfo.handCoinRate,p=t),y()}),$modal.on("focus",'input[data-input="zhangbiUsed"]',function(e){v!="zhangbi"&&E("zhangbi")}),$modal.on("change",'input[name="type"]',function(t){var n=e(t.target).val();E(n)}),$modal.on("change","select",function(){a=e(this).val()*12,y()}),$modal.on("click",".modal-body tr",function(){e(this).find("input").attr("checked",!0),o=e(this).find("input").val(),r=e(this).index(),s=i.result[r]})}var t=require("yf"),n,r=0,i,s,o,u,a=12,f=0,l=0,c,h=0,p,d=0,v="jifen",g=function(){n=undefined,i={},r=0,s={},o=a=12,u=1,l=f=0,c=h=0,p=d=0,v="jifen"},y=function(){l=parseFloat(s.unitPrice)*u*a,f=l-h-d,$modal.find(".modal-body .buy-total").html(f+"元")},b=function(e){return u=e,y(),u},w=function(){if(!s.unitsFixed){var e=s.lowerLimit||0,n=s.upperLimit||1e10;if(u<e||u>n)return t.showMessage("ERROR","所填名片张数非法",!0),!1}return!0},E=function(e){v=e;var t="zhangbi";e=="zhangbi"&&(t="jifen");var n=$modal.find('[data-row="'+e+'"]'),r=$modal.find('[data-row="'+t+'"]'),i=n.find('input[value="'+e+'"]').eq(0);i[0].checked=!0;var s=r.find('input[value="'+t+'"]').eq(0);s[0].checked=!1,r.find('input[name="'+t+'"]').val(0).valid(),c=h=p=d=0,y()};window.Buypop={processCard:function(f,l){function h(){$modal.find(".modal-title").html(l.title||"微名片购买"),$modal.find(".modal-body").html(template.render("payment-table-cardBuy",{list:i.result,hidePrice:t.configs.hidePlanPrice})),$modal.find(".modal-footer").html(e(template.render("payment-button",{text:"下一步"})).addClass("buy-next")),$modal.find(".modal-body input:eq("+r+")").attr("checked",!0).trigger("click")}function d(){s=i.result[r],u=s.count,s.unitsFixed||(u=s.lowerLimit),$modal.find(".modal-title").html("确认缴费"),$modal.find(".modal-body").html(template.render("payment-table-cardBuy2",{hidePrice:t.configs.hidePlanPrice,list:[i.result[r]],score:i.generalInfo.score||0,scoreRate:i.generalInfo.scoreRate||1,handCoin:i.generalInfo.handCoin||0,handCoinRate:i.generalInfo.handCoinRate||1})),$modal.find(".modal-footer").html(e(template.render("payment-button",{text:"上一步"})).addClass("buy-prev")),$modal.find(".modal-footer").append(e(template.render("payment-button",{text:"确认缴费"})).addClass("buy-ok")),S()}l=l||{};if(!i.result.length){$modal.find(".modal-body").html(l.tipNoPlan||"没有可购买的套餐"),$modal.find(".modal-footer").html(e(template.render("payment-button",{text:"关闭"})).addClass("buy-cancel"));return}x(),$modal.on("click",".modal-footer .buy-next",function(){d(),$modal.find("select").trigger("change")}),$modal.on("click",".modal-footer .buy-prev",function(){h()}),$modal.on("click",".modal-footer .buy-ok",function(){if(!w())return;if(!n.valid()){t.showMessage("ERROR","某些字段填写有误，请检查",!0);return}e(this).attr("disabled",!0),e.post(l.postApi||"/product/api/card/buy",{planId:o,months:a,score:c,handCoin:p,units:u},function(e){$modal.remove(),f(e)},"json")}),h()},cardBuy:function(t){g(),$modal=m("微名片购买");var n=require("yf"),r=this;e.get("/product/api/card/plans",function(e){i=e,r.processCard(t)},"json")},cardUpgrade:function(t){g(),$modal=m("微名片升级");var n=require("yf"),r=this;e.get("/product/api/card/upgradePlans",function(e){i=e;var n={tipNoPlan:"没有可升级的套餐",title:"微名片升级",postApi:"/product/api/card/upgrade"};r.processCard(t,n)},"json")},cardRenew:function(t,n){var r=require("yf");e.get("/product/api/card/plans",function(i){function w(){h=parseFloat(a.unitPrice)*l*c,s.find(".modal-body .buy-total").html(h-d-g+"元")}function E(e){return l=e,w(),l}var s=m("微名片续费"),o,u=0,a,f,l,c=12,h=0,p=0,d=0,v=0,g=0,y="jifen";a=t;var b;a.unitsFixed?l=a.count:(window.yfCardConfig?b=window.yfCardConfig.cardApp:r.summary?b=r.summary.cardApp:b=r.account.cardApp,b=b||{},l=b.boughtCardsNumber||0),s.find(".modal-body").html(template.render("payment-table-cardBuy2",{hidePrice:r.configs.hidePlanPrice,type:"cardRenew",count:l,list:[t],score:i.generalInfo.score,scoreRate:i.generalInfo.scoreRate,handCoin:i.generalInfo.handCoin||0,handCoinRate:i.generalInfo.handCoinRate||1})),o=s.find('form[data-form="handleWrapper"]').validate({onkeyup:function(t){e(t).valid()},onfocusout:function(t){e(t).valid()},errorElement:"div",errorClass:"help-block",rules:{jifen:{digits:!0,min:0,max:i.generalInfo.score},zhangbi:{digits:!0,min:0,max:i.generalInfo.handCoin||0}},highlight:function(t){e(t).closest(".row").addClass("has-error")},unhighlight:function(t){e(t).closest(".row").removeClass("has-error")}}),w(),s.on("click",".modal-body tr",function(){e(this).find("input").attr("checked",!0),f=e(this).find("input").val(),u=e(this).index()}),s.on("change","select",function(){c=e(this).val()*12,w()});var S=function(){if(!a.unitsFixed){var e=a.lowerLimit||0,t=a.upperLimit||1e10;if(l<e||l>t)return r.showMessage("ERROR","所填名片张数非法",!0),!1}return!0},x=function(e){y=e;var t="zhangbi";e=="zhangbi"&&(t="jifen");var n=s.find('[data-row="'+e+'"]'),r=s.find('[data-row="'+t+'"]'),i=n.find('input[value="'+e+'"]').eq(0);i[0].checked=!0;var o=r.find('input[value="'+t+'"]').eq(0);o[0].checked=!1,r.find('input[name="'+t+'"]').val(0).valid(),p=d=v=g=0,w()};s.on("blur",'input[data-input="configCount"]',function(){var t=e(this).val()-0,n=E(t)}),s.on("input",'input[data-input="configCount"]',function(){var t=e(this).val()-0;E(t)}),s.on("input",'input[data-input="jifenUsed"]',function(){var t=e(this).val()-0;!t||t<0?(d=0,p=0):t>i.generalInfo.score?(d=i.generalInfo.score*i.generalInfo.scoreRate,p=i.generalInfo.score):(d=t*i.generalInfo.scoreRate,p=t),w()}),s.on("focus",'input[data-input="jifenUsed"]',function(e){y!="jifen"&&x("jifen")}),s.on("input",'input[data-input="zhangbiUsed"]',function(){y!="zhangbi"&&x("zhangbi");var t=e(this).val()-0;!t||t<0?(g=0,v=0):t>i.generalInfo.handCoin?(g=i.generalInfo.handCoin*i.generalInfo.handCoinRate,v=i.generalInfo.handCoin):(g=t*i.generalInfo.handCoinRate,v=t),w()}),s.on("focus",'input[data-input="zhangbiUsed"]',function(e){y!="zhangbi"&&x("zhangbi")}),s.on("change",'input[name="type"]',function(t){var n=e(t.target).val();x(n)}),s.find(".modal-footer").html(e(template.render("payment-button",{text:"确认缴费"})).click(function(t){if(!S())return;if(!o.valid()){r.showMessage("ERROR","某些字段填写有误，请检查",!0);return}e(this).attr("disabled",!0),e.post("/product/api/card/renew",{months:c,score:p,units:l,handCoin:v},function(e){s.remove(),n(e)},"json")}))},"json")},appBuy:function(s,u){g(),$modal=m("微站购买"),e.get("/product/api/app/plans",{appId:s},function(l){function h(){$modal.find(".modal-title").html("微站购买"),$modal.find(".modal-body").html(template.render("payment-table-appBuy",{list:i.result,hidePrice:t.configs.hidePlanPrice})),$modal.find(".modal-footer").html(e(template.render("payment-button",{text:"下一步"})).addClass("buy-next")),$modal.find(".modal-body input:eq("+r+")").attr("checked",!0).trigger("click")}function d(){$modal.find(".modal-title").html("确认缴费"),$modal.find(".modal-body").html(template.render("payment-table-appBuy2",{hidePrice:t.configs.hidePlanPrice,list:[i.result[r]],score:i.generalInfo.score,scoreRate:i.generalInfo.scoreRate})),$modal.find(".modal-footer").html(e(template.render("payment-button",{text:"上一步"})).addClass("buy-prev")),$modal.find(".modal-footer").append(e(template.render("payment-button",{text:"确认缴费"})).addClass("buy-ok")),S()}i=l;if(!i.result.length){$modal.find(".modal-body").html("没有可购买的套餐"),$modal.find(".modal-footer").html(e(template.render("payment-button",{text:"关闭"})).addClass("buy-cancel"));return}x(),$modal.on("click",".modal-footer .buy-next",function(){d(),$modal.find("select").trigger("change")}),$modal.on("click",".modal-footer .buy-prev",function(){h()}),$modal.on("click",".modal-footer .buy-ok",function(){if(!n.valid()){t.showMessage("ERROR","某些字段填写有误，请检查",!0);return}e(this).attr("disabled",!0),e.post("/product/api/app/buy",{appId:s,planId:o,years:a/12,money:f,score:c,handCoin:p},function(e){$modal.remove(),u(e)},"json")}),h()},"json")},appUpgrade:function(s,u){g(),$modal=m("微站升级"),e.get("/product/api/app/upgradePlans",{appId:s},function(l){function h(){$modal.find(".modal-title").html("微站购买"),$modal.find(".modal-body").html(template.render("payment-table-appBuy",{list:i.result,hidePrice:t.configs.hidePlanPrice})),$modal.find(".modal-footer").html(e(template.render("payment-button",{text:"下一步"})).addClass("buy-next")),$modal.find(".modal-body input:eq("+r+")").attr("checked",!0).trigger("click")}function d(){$modal.find(".modal-title").html("确认缴费"),$modal.find(".modal-body").html(template.render("payment-table-appBuy2",{hidePrice:t.configs.hidePlanPrice,list:[i.result[r]],score:i.generalInfo.score,scoreRate:i.generalInfo.scoreRate,handCoin:i.generalInfo.handCoin,handCoinRate:i.generalInfo.handCoinRate})),$modal.find(".modal-footer").html(e(template.render("payment-button",{text:"上一步"})).addClass("buy-prev")),$modal.find(".modal-footer").append(e(template.render("payment-button",{text:"确认缴费"})).addClass("buy-ok")),S()}i=l;if(!i.result.length){$modal.find(".modal-body").html("没有可升级的套餐"),$modal.find(".modal-footer").html(e(template.render("payment-button",{text:"关闭"})).addClass("buy-cancel"));return}x(),$modal.on("click",".modal-footer .buy-next",function(){d(),$modal.find("select").trigger("change")}),$modal.on("click",".modal-footer .buy-prev",function(){h()}),$modal.on("click",".modal-footer .buy-ok",function(){if(!n.valid()){t.showMessage("ERROR","某些字段填写有误，请检查",!0);return}e(this).attr("disabled",!0),e.post("/product/api/app/upgrade",{appId:s,planId:o,years:a/12,money:f,score:c,handCoin:p},function(e){$modal.remove(),u(e)},"json")}),h()},"json")},appRenew:function(r,o){g(),$modal=m("微站续费"),e.get("/product/api/app/renewPlans",{appId:r},function(u){i=u;if(!i.result){$modal.find(".modal-body").html("没有可续费的套餐"),$modal.find(".modal-footer").html(e(template.render("payment-button",{text:"关闭"})).addClass("buy-cancel"));return}var l=i.result;s=l,$modal.find(".modal-body").html(template.render("payment-table-appBuy2",{hidePrice:t.configs.hidePlanPrice,list:[l],score:i.generalInfo.score,scoreRate:i.generalInfo.scoreRate,handCoin:i.generalInfo.handCoin,handCoinRate:i.generalInfo.handCoinRate})),y(),S(),x(),$modal.find(".modal-footer").html(e(template.render("payment-button",{text:"确认缴费"})).click(function(i){if(!n.valid()){t.showMessage("ERROR","某些字段填写有误，请检查",!0);return}e(this).attr("disabled",!0),e.post("/product/api/app/renew",{appId:r,years:a/12,money:f,score:c,handCoin:p},function(e){$modal.remove(),o(e)},"json")}))})}}}(jQuery),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.cms||(r.modules.cms={})}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.cms||(r.modules.cms={}),r.modules.cms.CMSHomeView=r.common.BaseView.extend({events:{"input input[data-input=appName]":"_onKeyup","input textarea[data-input=aboutInfo]":"_onKeyup","click .btn[data-action=uploadAppIcon], .btn[data-action=uploadTitleImg], .btn[data-action=uploadBgImg],.btn[data-action=appIconImg], .btn[data-action=uploadTopImg], .btn[data-action=uploadStartupImg]":"_uploadImgs","click .btn[data-action=cancel]":"_cancel","click .btn[data-action=save]":"_save",submit:"_save","click .btn[data-action=selectLayout]":"_appSettings"},doInitialize:function(){var i=this;t.Events.trigger("cms.home.show"),this._app=r.App.config.currentApp,this._appLength=r.App.config.webApps.apps.length,this._initBgiSelector(),this.$form=this.$el.html(this.template()).find("[data-block=appSetting] form"),this._setFormData(),this._initImageUploaders(),n.delay(function(){i._headerbarConfigurator=new r.modules.cms.templates.AttributesConfigurator({el:i.$el.find('div[data-type="headerBarConfigurator"]')}),i._headerbarConfigurator.on("changed",n.bind(i._onHeadbarAttrChanged,i)),i._initializeHeaderbarConfigurator()},100),n.delay(function(){i.sectionSettings=new r.modules.cms.SectionSettingsNew(n.extend(i.args,{el:i.$('[data-block="sectionSettings"]'),parentSectionId:undefined,onContentChanged:n.bind(i._onSectionSettingChanged,i)})),i.sectionSettings.scrollToSection(i.args.anchor)},100),this.socialShare=new r.modules.common.socialShare({el:this.$('[data-block="socialShare"]'),confInfo:{from:"vSite",option:this._app}}),this._topImageConfigurator=new r.modules.cms.TopImageConfigurator({el:this.$el.find('[data-block="topImg"]'),type:"home",app:this._app,onTopImgChanged:n.bind(this._contentChanged,this),onAppSettingChanged:n.bind(this._onAppSettingChanged,this)}),t.Events.on("previewer.loaded",n.bind(this._onPreviewerLoaded,this)),this._appLength&&this._appLength==1&&e("#returnToAppsPage").addClass("hide")},_onHomeFocusChanged:function(e){},_initializeHeaderbarConfigurator:function(){var e=r.App.config.headerBarAttributes||[],t={id:"",option_id:"",type:"HEADERBAR"};this._headerbarConfigurator.setAttributes(e,this._app.headerbar.attributes,t)},_onSectionSettingChanged:function(e){e===undefined&&(e=!0),this.sectionSettingChanged=e,this._contentChanged(e)},_onAppSettingChanged:function(e){e===undefined&&(e=!0),this.appSettingChanged=e,this._contentChanged(e),this._fireSettingsChangedEvent()},_onHeadbarAttrChanged:function(e){e===undefined&&(e=!0),this.appSettingChanged=e,this._contentChanged(e)},_initBgiSelector:function(){e("#modal-bgiSelecter").length<=0&&e("body").append(i()),this.$topImgSelecter=e("#modal-bgiSelecter"),this.$topImgSelecter.off("click").on("shown.bs.modal",n.bind(this._onTopImgSelecterShown,this)),this.$topImgSelecter.on("click","ul.bgiSelecter-inner li",n.bind(this._onTopImgSelected,this)),this.$topImgSelecter.on("click",".btn[data-action=selectTopImg]",n.bind(this._selectTopImg,this))},_onTopImgSelecterShown:function(e){var t=this._app.top_img_url;if(t&&t.indexOf("material")>=0){var n=this.$topImgSelecter.find('li div[data-url="'+t+'"]'),r=n.parent("li");r.click()}},_onTopImgSelected:function(t){var n=e(t.target).closest("li"),r=n.find("div").data("url");this.$topImgSelecter.find("li.active").removeClass("active"),n.addClass("active"),this._tmpTopImgUrl=r},_selectTopImg:function(){this.$topImgSelecter.modal("hide");if(!this._tmpTopImgUrl)return;var e=this._tmpTopImgUrl;this._onHomeTopImgUploaded({},{url:e}),this.$el.find("img[data-action=uploadTopImg]").attr({src:e})},_findHomeNavTemplates:function(){return n.find(r.App.config.sectionTypes,function(e){return e.code=="HOME"}).templates},_initImageUploaders:function(){this._app.icon_url&&this.$form.find("img[data-action=appIconImg]").attr({src:this._app.icon_url}),new r.modules.common.ImageUploader({wrapperView:this,el:this.$form.find("img[data-action=appIconImg]"),uploadUrl:r.api("/files"),onsuccess:n.bind(this._onAppIconImgUploaded,this),doNotAutoWrapDiv:!0,imgCrop:!0,cropWidth:100,cropHeight:100}),this._app.title_img_url&&this.$form.find("img[data-action=uploadTitleImg]").attr({src:this._app.title_img_url}),new r.modules.common.ImageUploader({wrapperView:this,el:this.$form.find("img[data-action=uploadTitleImg]"),uploadUrl:r.api("/files"),removeUrl:r.api("/apps/"+this._app.id+"/title_img"),onsuccess:n.bind(this._onTitleImgUploaded,this),onremoved:n.bind(this._onTitleImgRemoved,this),doNotAutoWrapDiv:!0,imgCrop:!0,cropWidth:240,cropHeight:74}),this._app.top_img_url&&this.$form.find("img[data-action=uploadTopImg]").attr({src:this._app.top_img_url}),new r.modules.common.ImageUploader({wrapperView:this,el:this.$form.find("img[data-action=uploadTopImg]"),uploadUrl:r.api("/files"),removeUrl:r.api("/apps/"+this._app.id+"/top_img"),onsuccess:n.bind(this._onHomeTopImgUploaded,this),onremoved:n.bind(this._onHomeTopImgRemoved,this),doNotAutoWrapDiv:!0})},_uploadImgs:function(t){var n=e(t.target).closest("button").data("action");this.$form.find('img[data-action="'+n+'"]').trigger("click")},_cancel:function(e){this.$form.find("input[name=name]").val(n.unescape(this._app.name)),this.$form.find("textarea[data-input=aboutInfo]").val(n.unescape(this._app.about_info||"")),this.$form.find("input[name=app_icon_url]").val(""),this.$form.find("input[name=title_img_url]").val(""),this.$form.find("input[name=home_bg_img_url]").val(""),this.$form.find("input[name=home_top_img_url]").val(""),this._app.title_img_url?this.$form.find("img[data-action=uploadTitleImg]").attr({src:this._app.title_img_url}):this.$form.find("img[data-action=uploadTitleImg]").imageHolder(),this._app.top_img_url?this.$form.find("img[data-action=uploadTopImg]").attr({src:this._app.top_img_url}):this.$form.find("img[data-action=uploadTopImg]").imageHolder(),this._app.icon_url?this.$form.find("img[data-action=appIconImg]").attr({src:this._app.icon_url}):this.$form.find("img[data-action=appIconImg]").imageHolder(),this._onAppSettingChanged(!1),this._topImageConfigurator._resetData(),this._topImageConfigurator._render(),this._fireSettingsChangedEvent(),this.sectionSettings._cancel()},_appSettings:function(e){e.preventDefault(),r.navigate("/builder/"+r.App.config.currentApp.id+"/cms/layout")},_setFormData:function(){this.$form.find("input[name=name]").val(n.unescape(this._app.name)),this.$form.find("textarea[data-input=aboutInfo]").val(n.unescape(this._app.about_info||"")),this.$form.find("input[name=authenticityToken]").val(r.App.config.authToken),this._setHomeTemplateId(),this._setHomeTemplateAttrs(),this._setHeadbarAttrs()},_setHomeTemplateId:function(e){e=e||this._app.home.template_id,this.$form.find("input[name=home_template_id]").val(e)},_setHomeTemplateAttrs:function(e){e=e||this._app.home.attributes,this.$form.find("input[name=template_attributes]").val(JSON.stringify(e))},_setHeadbarAttrs:function(e){e=e||this._app.headerbar.attributes,this.$form.find("input[name=headerbar_attributes]").val(JSON.stringify(e))},_save:function(e){e&&e.preventDefault&&e.preventDefault();if(this.checkIsUploading())return!1;var t=this;this._disableFormActionsIfNecessary(!0),this._saveAppSettings(function(){t.sectionSettings._save()})},_saveAppSettings:function(n){if(!this.appSettingChanged){n&&n();return}this.$form.find(".form-group").removeClass("has-error");var i=this;this.$form.find("input[name=headerbar_attributes]").val(JSON.stringify(this._headerbarConfigurator.getValues())),this.$form.find("input[name=home_focus]").val(JSON.stringify(this._topImageConfigurator.getImages())),r.showProgressIndicator("微站设置保存中...");var s=this.$form.serialize();console.log(s,"++++++++++++"),e.post(r.api("/apps/"+this._app.id+"/settings"),s).done(function(e){if(e.code==400){i._handleValidationErrors(e.errors),r.closeProgressIndicator(),r.showMessage("ERROR","微站设置有些项填写不正确",!0),i._onAppSettingChanged(!0);return}i._app.title_img_url!=e.app.title_img_url&&i._setImgInputVal("title_img_url",e.app.title_img_url),i._app.top_img_url!=e.app.top_img_url&&i._setImgInputVal("home_top_img_url",e.app.top_img_url),i._app=r.App.config.currentApp=e.app,i._topImageConfigurator._resetApp(e.app),i._topImageConfigurator._resetTopImages(),i._topImageConfigurator._render(),t.Events.trigger("app.settings.updated",e.app),t.Events.trigger("app.settings.cache",e.app),t.Events.trigger("app.settings.currApp",e.app),i._onAppSettingChanged(!1),r.closeProgressIndicator(),r.showMessage("INFO","微站设置成功",!0)}).error(function(e){r.closeProgressIndicator(),r.showMessage("ERROR","微站设置保存出错.",!0),i._onAppSettingChanged(!0)}).complete(function(){console.debug("=====继续请求======"),n&&n()})},_handleValidationErrors:function(e){var t=this.$form;t.find("div.help-block").remove(),n.each(e,function(e){t.find("[name="+e.key+"]").after('<div class="help-block">'+e.message+"</div>").parents(".form-group").addClass("has-error")}),t.find(".form-actions").addClass("has-error").prepend('<span class="validation-error">有些项填写不正确，请根据指示检查.</span>')},_removeValidationErrorOnFormActions:function(){this.$formActions||(this.$formActions=this.$el.find(".form-actions")),this.$formActions.removeClass("has-error").find(".validation-error").remove()},onHide:function(){this.isChanged()&&this._cancel()},onShow:function(e){r.modules.AppPreviewer.navHome(),this.sectionSettings&&e&&this.sectionSettings.scrollToSection(e.anchor)},onRecover:function(e){this.sectionSettings&&e&&e.anchor?this.sectionSettings.scrollToSection(e.anchor):window.scrollTo(0,0)},onRefresh:function(e){this.sectionSettings&&e&&this.sectionSettings.scrollToSection(e.anchor)},onRemove:function(){t.Events.off("previewer.loaded",this._onPreviewerLoaded),this.isChanged()&&this._cancel()},isChanged:function(){return this._contentModifiedDt||this._templateModifiedDt},_contentChanged:function(e){e!=undefined||(e=!0),e?(this._contentModifiedDt=(new Date).getTime(),this._enableFormActions()):(this._contentModifiedDt=null,this._disableFormActionsIfNecessary())},_enableFormActions:function(){this.$('[data-action="save"]').removeClass("disabled")},_disableFormActionsIfNecessary:function(e){(e||!this._contentModifiedDt&&!this._templateModifiedDt)&&this.$('[data-action="save"]').addClass("disabled")},_initializeTemplateAttrsConfigurator:function(e,t){this._cacheCurrentTemplateAttributes();var n=this._findTemplateById(e),r=this._cachedTemplateAttributes[e]||[];t==undefined&&(t=!0),this._templateAttrsConfigurator.setAttributes(n.attributes,r,n,t)},_cacheCurrentTemplateAttributes:function(){this._cachedTemplateAttributes?this._cachedTemplateAttributes[this._lastTemplateId]=this._templateAttrsConfigurator.getValues():(this._cachedTemplateAttributes={},this._cachedTemplateAttributes[this._app.home.template_id]=this._app.home.attributes)},_clearCachedTemplateAttributes:function(){delete this._cachedTemplateAttributes},_onTemplateChanged:function(e){this._templateChanged(),this._initializeTemplateAttrsConfigurator(e.id),this._lastTemplateId=e.id},_onKeyup:function(t){e(t.target).parents(".form-group").removeClass("has-error").end().next(".validation-error").remove(),this._removeValidationErrorOnFormActions(),this._onAppSettingChanged()},_setImgInputVal:function(e,t){this.$form.find("input[name="+e+"]").val(t)},_onAppIconImgUploaded:function(e,t){this._setImgInputVal("app_icon_url",t.url),this._onAppSettingChanged()},_onAppIconImgRemoved:function(){this.$form.find("input[name=app_icon_url]").val(""),this._onAppSettingChanged()},_onTitleImgUploaded:function(e,t){this._setImgInputVal("title_img_url",t.url),this._onAppSettingChanged()},_onTitleImgRemoved:function(){this.$form.find("input[name=title_img_url]").val(""),this._onAppSettingChanged()},_onHomeTopImgUploaded:function(e,t){this._setImgInputVal("home_top_img_url",t.url),this._onAppSettingChanged()},_onHomeTopImgRemoved:function(){this.$form.find("input[name=home_top_img_url]").val(""),this._onAppSettingChanged()},_onPreviewerLoaded:function(){this.isChanged()&&this._fireSettingsChangedEvent()},_findTemplateById:function(e){return n.find(this._findHomeNavTemplates(),function(t){return t.id==e})},_fireSettingsChangedEvent:function(){var e=new Date,t=this.$form.find("input[name=title_img_url]").val()+"?v="+e.getTime(),i=n.extend({name:this.$form.find("input[name=name]").val(),titleImage:t,home:{homeFocus:[]}});i.titleImage||(i.titleImage=this._app.title_img_url),i.home.homeFocus=this._topImageConfigurator.getImages(),r.modules.AppPreviewer.appSettingsChanged(i)},_fireTemplateChangedEvent:function(){var e=this._homeTemplateConfigurator.getSelectedTemplate().optionId;r.modules.AppPreviewer.homeTemplateChanged(e)},template:function(){var e='<div class="page-content">						<div class="newSecionForm form-horizontal" data-block="appSetting">						    <form action="" class="form-horizontal">						        <div class="topBtns">						            <div class="pull-right">						                <a href="#" class="btn btn-success btn-sm disabled" data-action="save">						                    <i class="icon-ok bigger-120 "></i>保存						                </a>						                <a href="#" class="btn btn-info btn-sm" data-action="selectLayout">						                    <i class="icon-copy bigger-120 "></i>版式选择						                </a>						            </div>						        </div>						        <div id="wrap-appBasicInfo">						        <input type="hidden" name="authenticityToken"/>								<input type="hidden" name="home_template_id"/>								<input type="hidden" name="app_icon_url"/>								<input type="hidden" name="title_img_url"/>								<input type="hidden" name="home_bg_img_url"/>								<input type="hidden" name="home_top_img_url"/>								<input type="hidden" name="startup_pic"/>								<input type="hidden" name="template_attributes"/>								<input type="hidden" name="headerbar_attributes"/>								<input type="hidden" name="home_focus"/>							    <div class="form-group">							        <label class="col-sm-2 control-label no-padding-right grey">微站名称</label>							        <div class="col-sm-4">							            <input type="text" class="col-sm-12" name="name" data-input="appName" placeholder="微站名称">							        </div>							        <div data-block="socialShare" class="col-sm-6 no-padding-left">							        </div>							    </div>							    <hr>							    <div class="form-group">							        <label class="col-sm-2 control-label no-padding-right grey">微站图标</label>							        <div class="col-sm-6">							            <div class="widget-fgp-image">							            	<div class="imageUploader pull-left" style="max-width: 221px">							                	<img style="width:100px;height:100px;" data-src="holder.js/100x100/text:尺寸比例 100x100" data-action="appIconImg" alt="尺寸比例 100x100" src="" />							                </div>							                <div class="pull-right">							                    <button type="button" class="btn btn-xs btn-default" data-action="appIconImg">							                        <i class="icon-arrow-up bigger-125"></i>上传							                    </button>							                </div>							            </div>							            <div class="clearfix"></div>							        </div>							    </div>							    <hr>							    <div class="form-group">							        <label class="col-sm-2 control-label no-padding-right grey">微站描述</label>							        <div class="col-sm-9">							            <textarea class="col-sm-12" name="about_info" data-input="aboutInfo" placeholder="微站描述" style="height: 4em;"></textarea>							        </div>							    </div>							    <hr>							    <div class="form-group">							        <label class="col-sm-2 control-label no-padding-right grey">标题栏</label>							        <div class="col-sm-6">							            <div class="widget-fgp-image">							            	<div class="imageUploader pull-left" style="max-width: 221px">							                	<img data-src="holder.js/221x68/text:尺寸比例 280x86" data-action="uploadTitleImg" alt="尺寸比例 280x86" src="" />							                </div>							                <div class="pull-right">							                    <button type="button" class="btn btn-xs btn-default" data-action="uploadTitleImg">							                        <i class="icon-arrow-up bigger-125"></i>上传							                    </button>							                </div>							            </div>							            <div class="clearfix"></div>							        </div>							        <div class="col-sm-3">							            <p class="tip">会覆盖微站名称，为了展示效果最佳，建议上传背景透明的图片</p>							        </div>							    </div>							    <div class="col-sm-10">							        <div class="group-configurator" data-type="headerBarConfigurator"></div>							    </div>							    <div class="clearfix"></div>							    <div class="space-4"></div>							    <hr>							    <div class="form-group" data-block="homeTopImg">									<div class="grey" style="font-size: 1.1em;padding-left: 20px;">顶部/背景图片 (注：某些版式只支持一张背景图片)</div>									<div data-block="topImg"></div>							    </div>							    <div class="form-group hide" data-block="homeBg">							        <label class="col-sm-2 control-label no-padding-right grey">顶部图片</label>							        <div class="col-sm-10">							            <div class="widget-fgp-image" style="width:320px;">							            	<div class="imageUploader pull-left" style="width: 221px">							                	<img data-src="holder.js/320x176/text:尺寸比例 320x180" data-action="uploadTopImg" alt="尺寸比例 320x180" src="" />							                </div>							                <div class="pull-right" style="margin-right: 17px">								                <div style="margin-bottom: 5px">								                	<button type="button" class="btn btn-xs" href="#modal-bgiSelecter" data-toggle="modal">											            <i class="icon-th bigger-125"></i>选择											        </button>											    </div>											    <div>								                    <button type="button" class="btn btn-xs btn-default" data-action="uploadTopImg">								                        <i class="icon-arrow-up bigger-125"></i>上传								                    </button>								                </div>								            </div>							            </div>							        </div>							    </div>						    </form>						</div>						<div class="sectionList" data-block="sectionSettings">						</div>					</div>';return e}});var i=function(){var e='<div id="modal-bgiSelecter" class="modal in" aria-hidden="false">				    <div class="modal-dialog bgiSelecter">				        <div class="modal-content">				            <div class="modal-header lighter blue">选择背景图片				                <span class="close" data-dismiss="modal">×</span>				            </div>				            <div class="modal-body">				                <div>				                    <ul class="bgiSelecter-inner clearfix">				                    	<li><div class="bgi-101@2x~iphone" data-url="/files/material/bgis/640/101@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/101@2x~iphone.jpg)"></div></li><li><div class="bgi-102@2x~iphone" data-url="/files/material/bgis/640/102@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/102@2x~iphone.jpg)"></div></li><li><div class="bgi-103@2x~iphone" data-url="/files/material/bgis/640/103@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/103@2x~iphone.jpg)"></div></li><li><div class="bgi-104@2x~iphone" data-url="/files/material/bgis/640/104@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/104@2x~iphone.jpg)"></div></li><li><div class="bgi-105@2x~iphone" data-url="/files/material/bgis/640/105@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/105@2x~iphone.jpg)"></div></li><li><div class="bgi-106@2x~iphone" data-url="/files/material/bgis/640/106@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/106@2x~iphone.jpg)"></div></li><li><div class="bgi-107@2x~iphone" data-url="/files/material/bgis/640/107@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/107@2x~iphone.jpg)"></div></li><li><div class="bgi-108@2x~iphone" data-url="/files/material/bgis/640/108@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/108@2x~iphone.jpg)"></div></li><li><div class="bgi-109@2x~iphone" data-url="/files/material/bgis/640/109@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/109@2x~iphone.jpg)"></div></li><li><div class="bgi-110@2x~iphone" data-url="/files/material/bgis/640/110@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/110@2x~iphone.jpg)"></div></li><li><div class="bgi-111@2x~iphone" data-url="/files/material/bgis/640/111@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/111@2x~iphone.jpg)"></div></li><li><div class="bgi-112@2x~iphone" data-url="/files/material/bgis/640/112@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/112@2x~iphone.jpg)"></div></li><li><div class="bgi-113@2x~iphone" data-url="/files/material/bgis/640/113@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/113@2x~iphone.jpg)"></div></li><li><div class="bgi-114@2x~iphone" data-url="/files/material/bgis/640/114@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/114@2x~iphone.jpg)"></div></li><li><div class="bgi-115@2x~iphone" data-url="/files/material/bgis/640/115@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/115@2x~iphone.jpg)"></div></li><li><div class="bgi-116@2x~iphone" data-url="/files/material/bgis/640/116@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/116@2x~iphone.jpg)"></div></li><li><div class="bgi-117@2x~iphone" data-url="/files/material/bgis/640/117@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/117@2x~iphone.jpg)"></div></li><li><div class="bgi-118@2x~iphone" data-url="/files/material/bgis/640/118@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/118@2x~iphone.jpg)"></div></li><li><div class="bgi-119@2x~iphone" data-url="/files/material/bgis/640/119@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/119@2x~iphone.jpg)"></div></li><li><div class="bgi-120@2x~iphone" data-url="/files/material/bgis/640/120@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/120@2x~iphone.jpg)"></div></li><li><div class="bgi-121@2x~iphone" data-url="/files/material/bgis/640/121@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/121@2x~iphone.jpg)"></div></li><li><div class="bgi-122@2x~iphone" data-url="/files/material/bgis/640/122@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/122@2x~iphone.jpg)"></div></li><li><div class="bgi-123@2x~iphone" data-url="/files/material/bgis/640/123@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/123@2x~iphone.jpg)"></div></li><li><div class="bgi-124@2x~iphone" data-url="/files/material/bgis/640/124@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/124@2x~iphone.jpg)"></div></li><li><div class="bgi-125@2x~iphone" data-url="/files/material/bgis/640/125@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/125@2x~iphone.jpg)"></div></li><li><div class="bgi-126@2x~iphone" data-url="/files/material/bgis/640/126@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/126@2x~iphone.jpg)"></div></li><li><div class="bgi-127@2x~iphone" data-url="/files/material/bgis/640/127@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/127@2x~iphone.jpg)"></div></li><li><div class="bgi-200@2x~iphone" data-url="/files/material/bgis/640/200@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/200@2x~iphone.jpg)"></div></li><li><div class="bgi-201@2x~iphone" data-url="/files/material/bgis/640/201@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/201@2x~iphone.jpg)"></div></li><li><div class="bgi-202@2x~iphone" data-url="/files/material/bgis/640/202@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/202@2x~iphone.jpg)"></div></li><li><div class="bgi-203@2x~iphone" data-url="/files/material/bgis/640/203@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/203@2x~iphone.jpg)"></div></li><li><div class="bgi-204@2x~iphone" data-url="/files/material/bgis/640/204@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/204@2x~iphone.jpg)"></div></li><li><div class="bgi-205@2x~iphone" data-url="/files/material/bgis/640/205@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/205@2x~iphone.jpg)"></div></li>				                    </ul>				                </div>				            </div>				            <div class="modal-footer">				                <button type="button" class="btn btn-cancel" data-dismiss="modal">				                    <i class="icon-remove bigger-110"></i>取消				                </button>				                <button class="btn btn-success" data-action="selectTopImg">				                    <i class="icon-ok bigger-110"></i>确定				                </button>				            </div>				        </div>				    </div>				</div>';return e},s=function(){return'<div class="modal-content">					    <div class="modal-body">							<div data-type="mainHome"></div>					    </div>					    </div>					</div>'}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.cms||(r.modules.cms={}),r.modules.cms.CMSModule=r.common.ViewStack.extend({doInitialize:function(){this.views={section:r.modules.cms.SectionModule,welcome:r.modules.cms.CMSHomeView,cmsHome:r.modules.cms.CMSHomeView,cmsLayout:r.modules.cms.CmsLayout},this.$el.html(i()),this._sidebar=new r.modules.cms.Sidebar(n.extend(this.args,{el:this.$el.find(".sidebar")}))},viewport:function(){return this._viewport||(this._viewport=this.$el.find(".cmsViewport"))},isViewChangedWhenRecover:function(){return this.getLastFragment()!=t.history.getFragment()||window.location.search},show:function(e,t){if(!e){if(this.currentView()){r.navigate(this.getLastFragment());return}r.doJob(function(){r.navigate("/builder/"+r.App.config.currentApp.id+"/cms/home")});return}var i=t&&n.extend(t,{})||{};t&&t.sectionId?i.section=n.find(r.App.config.currentApp.sections,function(e){return e.id==t.sectionId}):i.section=r.App.config.currentApp.sections[0],this._sidebar.setCurrentMenu(t.sectionId),this._sidebar.activeMenu(),r.common.ViewStack.prototype.show.apply(this,[e].concat(i))},onRemove:function(){this._sidebar.remove()},_hasChildSections:function(e){return n.find(r.App.config.currentApp.sections,function(t){return t.parent_id==e.id})}});var i=function(){return'<div class="main-container-inner" data-viewport-type="CMS">					<div class="sidebar sidebar-fixed siderbarOfConsole"></div>					<div class="main-content cmsViewport"></div>				</div>'}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.cms.CMSWelcomePage=r.common.BaseView.extend({events:{"click a.btn-app":"_createSection"},doInitialize:function(){this.$el.html(i())},_createSection:function(t){t.preventDefault();var n=e(t.target);n=n.is("a")?n:n.parents("a"),new r.modules.cms.SectionCreationDialog({view:"form",title:"添加栏目 > "+n.data().sectionName,sectionType:{type:n.data().sectionType,name:n.data().sectionName},hideGuideAction:!0})}});var i=function(){return'<div class="add-section-guide">        	<h2>欢迎使用掌卡微站</h2>        	<div class="alert alert-info">				<h3>您还没有添加栏目哦. </h3>				<h3 class="header smaller lighter blue">现在就从下面的列表中选择一种栏目类型，开始创建你的微站吧.</h3>			    <a class="btn btn-info btn-app radius-4" data-section-type="NEWS" data-section-name="有列表图文">			        <i class="icon-rss bigger-160"></i>有列表图文			    </a>			    <a class="btn btn-info btn-app radius-4" data-section-type="CUSTOM_PAGE" data-section-name="无列表图文">			        <i class="icon-file-text bigger-160"></i>无列表图文			    </a>		        <a class="btn btn-info btn-app radius-4" data-section-type="GALLERY" data-section-name="图集">        			<i class="icon-picture bigger-160"></i>图集		        </a>		        <a class="btn btn-info btn-app radius-4" data-section-type="TEL" data-section-name="拨打电话">        			<i class="icon-phone bigger-160"></i>拨打电话		        </a>		        <a class="btn btn-info btn-app radius-4" data-section-type="BRANCH" data-section-name="网点">    				<i class="icon-map-marker bigger-160"></i>网点		        </a>		        <a class="btn btn-info btn-app radius-4" data-section-type="CONTACT_WAY" data-section-name="联系方式">					<i class="icon-user bigger-160"></i>联系方式				</a>		        <a class="btn btn-info btn-app radius-4" data-section-type="EVENT" data-section-name="活动">        			<i class="icon-volume-down bigger-160"></i>活动		        </a>		        <a class="btn btn-info btn-app radius-4" data-section-type="APPOINTMENT" data-section-name="预约">					<i class="icon-time bigger-160"></i>预约			    </a>			    <a class="btn btn-info btn-app radius-4" data-section-type="PRODUCT" data-section-name="商城">			        <i class="icon-shopping-cart bigger-160"></i>商城			    </a>		        <a class="btn btn-info btn-app radius-4" data-section-type="SECTION_SET" data-section-name="栏目集">        			<i class="icon-folder-open bigger-160"></i>栏目集		        </a>			</div>        </div>'}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.cms.ContentEditor=r.common.BaseView.extend({events:{'click input[name="section_cas_code"]':"_onContentChanged","keydown input, textarea, #cke_content":"_onKeydown","click input.dynaCheckbox,#cke_content":"_onKeydown","click a[data-action=back-list], .btn-cancel":"_back2list","click .imageListInner i[data-action=delete]":"_removeGalleryItem","click .galleryThumb":"_showGalleryItem","click input.date-input":"_showDatetimePicker","click input[name=applicable]":"_showApplicableInputs","change .imageListItem input":"_updateGalleryItemTitle","change .imageListItem textarea":"_updateGalleryItemDigest",submit:"_save","click [data-action=save]":"_save","click [data-action=addClass]":"_addClass","click [data-action=delClass]":"_delClass"},doInitialize:function(t){this._itemId=t.itemId,this.$el.html(h(r.modules.cms.SectionModule.currentSection)),this.$form=this.$el.find("form"),this._sectionType()=="GALLERY"&&(this.$galleryItems=this.$el.find("ul.imageListInner"),this._initializeItemsSorter()),this._isNewItem()&&(this._item=this._createNewItem(),this._render()),new r.modules.common.ImageUploader({wrapperView:this,el:this.$el.find(".thumbnailWrapper .thumbnail"),uploadUrl:r.api("/files"),removeUrl:this._isNewItem()?null:r.api("/items/"+this._itemId+"/thumbnail"),onsuccess:n.bind(this._onThumbnailUploaded,this),onremoved:n.bind(this._onItemImagesChanged,this)}),this._productImagesUploader=new r.modules.cms.ItemImagesUploader({el:this.$el.find("[data-action=uploadProductImages]"),uploadUrl:r.api("/files"),previewZone:this.$el.find(".product-imgs-wrapper"),onsuccess:n.bind(this._onItemImagesChanged,this),onremoved:n.bind(this._onItemImagesChanged,this)}),new r.modules.cms.GalleryImageUploader({el:this.$el.find(".btn[data-action=uploadGalleryImages]"),container:this.$items,uploadUrl:r.api("/files"),done:n.bind(this._onGalleryImagesUploaded,this)}),this._editor=new r.modules.cms.editor.RichEditor({el:this.$el.find("textarea[name=content]")}),this._editor.on("changed",n.bind(this._onContentChanged,this));var i=this;this._editor.onEditorReady(function(){i._timer=setInterval(n.bind(i._preview,i),400)}),r.modules.cms.SectionModule.currentSection.type.code=="EVENT"&&e(".form_datetime").datetimepicker({language:"zh-CN",weekStart:1,todayBtn:1,autoclose:1,todayHighlight:1,startView:2,forceParse:0,showMeridian:1}).on("changeDate",function(e){i._onKeydown(e)}),this.$saveBtn=this.$('[data-action="save"]'),e(window).bind("scroll",this._onScroll=n.bind(this._onScroll,this))},onHide:function(e){this._editor.hide()},onShow:function(t){this._sectionType()=="GALLERY"?e("#section").addClass("gallery"):e("#section").removeClass("gallery"),this._loadData()},onRemove:function(){clearInterval(this._timer),this._editor.off("changed",this._onContentChanged),e(window).unbind("scroll",this._onScroll),this._editor.remove(),this._preview(!0,!0),this._socialShare&&this._socialShare.remove()},onRecover:function(){this._editor.recover()},isChanged:function(){return!!this._lastModifiedDt},_isNewItem:function(){return this._itemId=="new"},_initializeItemsSorter:function(){this.$galleryItems.nestedSortable({attribute:"sort-data",forcePlaceholderSize:!0,listType:"ul",handle:".l-drag",helper:"clone",items:"li",opacity:.6,placeholder:"placeholder",revert:250,tabSize:25,scroll:!0,tolerance:"pointer",toleranceElement:">div",maxLevels:1,axis:"y",start:n.bind(this._onGalleryItemDragStart,this),stop:n.bind(this._onGalleryItemDragStop,this)})},_createNewItem:function(){var e=r.modules.cms.SectionModule.currentSection,t={id:"new",section_type:e.type.code,statuses:[{app_id:r.App.config.currentApp.id,section_id:e.id,section_cas_code:e.case_code,section_type:e.type.code,status:"ENABLE"}]};return this._sectionType()=="GALLERY"&&(t.attributes={},t.attributes.gallery_items=[]),this._sectionType()=="BRANCH"&&(t.attributes={}),t},_onKeydown:function(t){if(t.keyCode==r.constants.enter||t.keyCode==r.constants.tab)return;this._onContentChanged(!0),e(t.target).parents(".form-group").removeClass("has-error").end().siblings(".validation-tips").removeClass("hide").end().next(".validation-error").remove(),this._removeValidationErrorOnFormActions()},_onContentChanged:function(e){this._lastModifiedDt=(new Date).getTime(),this.$form.find("textarea[name=content]").next(".validation-error").remove().parents(".form-group").removeClass("has-error"),this._removeValidationErrorOnFormActions(),this._enableSaveBtn()},_onGalleryImagesUploaded:function(e){n.each(e,function(e){e.id="new"}),this._item.attributes.gallery_items=this._item.attributes.gallery_items.concat(e),!this._item.thumbnail_url&&this._item.attributes.gallery_items.length>0&&(this._item.thumbnail_url=this._item.attributes.gallery_items[0].picture_url,this.$form.find("input[name=thumbnail_url]").val(this._item.thumbnail_url),this.$form.find(".thumbnailWrapper .thumbnail").attr({src:this._item.thumbnail_url})),this._render(),this._onContentChanged()},_showGalleryItem:function(t){var n=e(t.target).css("background-image").replace("url(","").replace(")","");new r.modules.cms.PictureLightBox({picUrl:n,valign:"center"})},_removeGalleryItem:function(t){var n=e(t.target).closest("li.imageListItem"),r=n.parent().find("li.imageListItem").index(n);this._item.attributes.gallery_items.splice(r,1),n.remove(),this.$form.find("div.uploaded span").html(this._item.attributes.gallery_items.length),this._onContentChanged()},_updateGalleryItemTitle:function(t){var n=e(t.target).closest("li.imageListItem"),r=n.parent().find("li.imageListItem").index(n);this._item.attributes.gallery_items[r].title=e(t.target).val()},_showApplicableInputs:function(e){this.$form.find(".applicable").toggleClass("hide");if(!this.$form.find(".applicable").hasClass("hide")){var t=this.$form.find("input[name=apply_start_time]"),n=this.$form.find("input[name=apply_end_time]");t.val()||t.val(this.$form.find("input[name=start_time]").val()),n.val()||n.val(this.$form.find("input[name=end_time]").val())}},_showDatetimePicker:function(t){e(e(t.target).siblings("span")[1]).click()},_updateGalleryItemDigest:function(t){var n=e(t.target).closest("li.imageListItem"),r=n.parent().find("li.imageListItem").index(n);this._item.attributes.gallery_items[r].digest=e(t.target).val()},_onGalleryItemDragStart:function(e,t){this._itemPositionWhenSortStart=t.item.index()},_onGalleryItemDragStop:function(e,t){var n=this._item.attributes;if(this._itemPositionWhenSortStart!=t.item.index()){var r=n.gallery_items[this._itemPositionWhenSortStart];n.gallery_items.splice(this._itemPositionWhenSortStart,1),n.gallery_items.splice(t.item.index(),0,r),this._onContentChanged()}},_loadData:function(){if(this._isNewItem()){this._preview(!0,!1);return}r.showProgressIndicator("装载内容...");var t=this;e.get(r.api("/items/"+this._itemId)).done(function(e){t._item=e.item,t._render(),t._initSocialShare(),r.closeProgressIndicator()}).error(function(e){r.closeProgressIndicator(),r.showMessage("ERROR","内容装载出错",!0)})},_initSocialShare:function(){if(!this._item||!this._item.id)return;var e=this.$('[data-block="socialShare"]');this._socialShare=new r.modules.common.socialShare({el:e,confInfo:{from:"item",option:this._item,sectionInfo:r.modules.cms.SectionModule.currentSection,appInfo:r.App.config.currentApp}})},_save:function(n){n.preventDefault();if(this.checkIsUploading())return!1;r.showProgressIndicator("保存中..."),this._disableSaveBtn();var i=this.$form.find(".has-error");i.removeClass("has-error").find(".validation-error").remove(),i.find(".validation-tips").removeClass("hide"),this.$form.find("input[name=authenticityToken]").val(r.App.config.authToken),this.$form.find("input[name=app_id]").val(r.App.config.currentApp.id),this.$form.find("input[name=section_type]").val(r.modules.cms.SectionModule.currentSection.type.code);if(this._sectionType()=="GALLERY"&&!this._prepostGallery())return;this._sectionType()=="BRANCH"&&this.$form.find("input[name=coordinate]").val(this._item.attributes.coordinate);var s=this;if(this._sectionType()=="PRODUCT"){var o=[];this.$form.find(".form-product-group").each(function(t){var n=e(this).find("input[name=product_item_id]").val();n?o.push({productItemName:e(this).find("input[name=producttype]").val(),inventory:e(this).find("input[name=inventory]").val()*1,retailPrice:e(this).find("input[name=retailPrice]").val()*1,price:e(this).find("input[name=price]").val()*1,id:n}):o.push({productItemName:e(this).find("input[name=producttype]").val(),inventory:e(this).find("input[name=inventory]").val()*1,retailPrice:e(this).find("input[name=retailPrice]").val()*1,price:e(this).find("input[name=price]").val()*1})}),o=JSON.stringify(o),this.$form.find("input[name=product_item]").val(o)}e.post(r.api("/items/"+this._item.id),this.$form.serialize()).done(function(e){if(e.code==200){s._lastModifiedDt=null,s._preview(!0,!0),t.Events.trigger("item.saved",e.item),s._back2list(),r.closeProgressIndicator();return}s._handleValdiationErrors(e.errors),r.closeProgressIndicator(),s._enableSaveBtn(),r.showMessage("ERROR","有些项填写不正确，请根据提示进行检查.",!0)}).complete(function(e){})},_enableSaveBtn:function(){this.$saveBtn.removeClass("disabled")},_disableSaveBtn:function(){this.$saveBtn.addClass("disabled")},_render:function(){this._updateFormBySectionType(this._sectionType());var e=this._item,t=this;e.id!="new"&&(this.$form.find("input[name=id]").val(e.id),this.$form.find("input[name=app_id]").val(e.app_id),e.focus_id&&this.$form.find("input[name=focus_id]").val(e.focus_id),e.author&&this.$form.find("input[name=author]").val(n.unescape(e.author)),e.source&&this.$form.find("input[name=source]").val(n.unescape(e.source)),e.thumbnail_url&&(this.$form.find(".thumbnailWrapper .thumbnail").attr({src:e.thumbnail_url}),this.$form.find("input[name=thumbnail_url]").val(e.thumbnail_url)),this.$form.find("input[name=title]").val(n.unescape(e.title)),this.$form.find("textarea[name=summary]").val(n.unescape(e.summary)),this._editor.initContent(e.content),this._renderSectionTypeRelatedProperties(e),this._lastModifiedDt=null,this._lastPreviewerSyncDt=(new Date).getTime()),this._renderAvailableSections()},_updateFormBySectionType:function(e){e=="GALLERY"&&this._renderGalleryItems(this._item.attributes.gallery_items),e=="BRANCH"&&new r.modules.cms.LocationPicker({item:this._item,container:this.$form.find("div.location-picker"),editor:this})},_prepostGallery:function(){var t=this,i=!0;return n.each(this._item.attributes.gallery_items,function(r,s){r.title&&n.escape(r.title).length>100&&(i=!1,e(t.$form.find("li.imageListItem")[s]).find("input").addClass("error")),r.title&&n.escape(r.digest).length>4e3&&(i=!1,e(t.$form.find("li.imageListItem")[s]).find("textarea").addClass("error"))}),this.$form.find("textarea[name=content]").val(JSON.stringify(this._item.attributes.gallery_items)),i||(r.closeProgressIndicator(),r.showMessage("ERROR","保存出错.",!0),this.$form.find(".form-actions").addClass("has-error").prepend('<span class="validation-error">输入内容过长, 图片标题最大长度为100, 摘要最大长度为4000.</span>'),this.$form.find(".btn-primary").button("reset")),i},_renderGalleryItems:function(e){var t=this;this.$form.find("div.uploaded span").html(e.length),t.$galleryItems.html(""),n.each(e,function(e){e.title=n.unescape(e.title),e.digest=n.unescape(e.digest);var r='<li class="imageListItem" data-item-id="'+e.id+'">                <div>                <div class="l-thumbnail galleryThumb" style="background-image:url('+e.picture_url.replace(/\\/g,"/")+')"> </div>                <div class="l-title"> <input type="text" placeholder="图片标题" value="'+(e.title||"")+'"> </div>                <div class="l-summ"><textarea placeholder="图片说明">'+(e.digest||"")+'</textarea> </div>                <div class="l-setting"><i class="l-delete" data-rel="tooltip" data-action="delete" data-original-title="删除"> </i>                <i class="l-drag" data-action="drag" data-rel="tooltip" data-original-title="拖动排序" data-placement="left"> </i>                </div>                </li>';t.$galleryItems.append(r)})},_renderSectionTypeRelatedProperties:function(t){if(t.section_type=="PRODUCT"){this.$form.find("input[name=price]").val(t.attributes.price),this.$form.find("input[name=retailPrice]").val(t.attributes.retail_price),this.$form.find("input[name=inventory]").val(t.attributes.inventory),this._productImagesUploader.setImages(t.attributes.media.pictures),this.$form.find(".form-product-group").remove();var n="";for(var r in t.attributes.productItems)n+=c(t.attributes.productItems[r]);e("i[data-action=addClass]").parents(".form-group").before(n)}else t.section_type=="NEWS"?(this.$form.find("input[name=source]").val(t.attributes.source),this.$form.find("input[name=author]").val(t.attributes.author)):t.section_type=="BRANCH"?(this.$form.find("input[name=phones]").val(t.attributes.phones),this.$form.find("#branchAddress").val(t.attributes.address),this.$form.find("input[name=coordinate]").val(t.attributes.coordinate)):t.section_type=="EVENT"&&(this.$form.find("input[name=address]").val(t.attributes.address),this.$form.find("input[name=start_time]").val(t.attributes.start_time),this.$form.find("input[name=end_time]").val(t.attributes.end_time),t.attributes.applicable?(this.$form.find(".applicable").removeClass("hide"),this.$form.find("input[name=applicable]").attr("checked",""),this.$form.find("input[name=apply_start_time]").val(t.attributes.apply_start_time),this.$form.find("input[name=apply_end_time]").val(t.attributes.apply_end_time),t.attributes.signin_apply&&this.$form.find("input[name=applicable]").attr("checked","")):this.$form.find(".applicable").addClass("hide"))},_sectionType:function(){return r.modules.cms.SectionModule.currentSection.type.code},_renderAvailableSections:function(){this.$form.find(".section-list").html(s(this._item,r.App.config.currentApp.sections))},_preview:function(e,t){if(this._lastModifiedDt==this._lastPreviewerSyncDt&&!e)return;this._lastPreviewerSyncDt=this._lastModifiedDt;var i=r.modules.cms.SectionModule.currentSection,s=n.extend({optionId:i.content_template.option_id,sectionId:i.id,properties:{title:this.$form.find("input[name=title]").val(),content:this._parseContent(this._editor.getContent())}});!t||(s.completed=!0),this._handlePreviewerTypeRelatedProperties(s),r.modules.AppPreviewer.itemContentChanged(s)},_handlePreviewerTypeRelatedProperties:function(e){if(this._item.section_type=="PRODUCT"){e.properties.attributes={price:this.$form.find("input[name=price]").val()*1,retailPrice:this.$form.find("input[name=retailPrice]").val()*1,inventory:this.$form.find("input[name=inventory]").val()*1,productItems:this._getProductItems(),media:{pictures:this._productImagesUploader.getImages()}};return}if(this._item.section_type=="GALLERY"){e.properties.attributes={summary:this.$form.find("textarea[name=summary]").val(),images:this._item.attributes.gallery_items};return}this._item.section_type=="NEWS"&&(e.properties.attributes={author:this.$form.find("input[name=author]").val(),source:this.$form.find("input[name=source]").val()}),this._item.section_type=="BRANCH"&&(e.properties.attributes={address:this.$form.find("#branchAddress").val(),phone:this.$form.find("input[name=phones]").val(),mapInfo:this.$form.find("input[name=coordinate]").val()}),this._item.section_type=="EVENT"&&(e.properties.attributes={address:this.$form.find("input[name=address]").val(),startTime:this.$form.find("input[name=start_time]").val()&&this.$form.find("input[name=start_time]").val()+":00",endTime:this.$form.find("input[name=end_time]").val()&&this.$form.find("input[name=end_time]").val()+":00",allowSignUp:this.$form.find("input[name=applicable]").is(":checked")?!0:!1,signUpInfo:{mustLogin:this.$form.find("input[name=signin_apply]").is(":checked")?!0:!1,startTime:this.$form.find("input[name=apply_start_time]").val()&&this.$form.find("input[name=apply_start_time]").val()+":00",endTime:this.$form.find("input[name=apply_end_time]").val()&&this.$form.find("input[name=apply_end_time]").val()+":00"}})},_parseContent:function(t){var n=e("<div/>").append(t),r=n[0].firstChild,i=this;return this._cleanImgTags(n),n.find("img:not([data-video-type])").each(function(){i._wrapImgTag(this)}),n.find("img[data-video-type]").each(function(){i._setVideoTag(this)}),n.find('a[href^="tel:"]').each(function(){e(this).removeAttr("title").prepend("<i/>")}),n.html()},_getProductItems:function(){var t=[];return this.$form.find(".form-product-group").each(function(){t.push({id:e(this).find("input[name=product_item_id]").val(),inventory:e(this).find("input[name=inventory]").val(),price:e(this).find("input[name=price]").val(),productItemName:e(this).find("input[name=producttype]").val(),retailPrice:e(this).find("input[name=retailPrice]").val()})}),t},_cleanImgTags:function(t){t.find('img[data-video-type=""]').each(function(){var t=e(this);t.removeAttr("data-video-type").removeAttr("data-video-id").removeAttr("data-video-thumbnail-url").removeAttr("data-video-url")})},_wrapImgTag:function(t){var n=e(t);n.attr("data-src")||(n.attr("data-src",n.attr("src")),n.removeAttr("src"));if(t.tagName=="IMG"&&t.className=="editorPic"&&t.width<50&&t.height<50){t.classList.add("display-inline");return}t.tagName=="IMG"&&(t.parentNode.tagName!="DIV"||!t.parentNode.className.match(/contentImg/))&&n.wrap('<div class="contentImg"/>')},_setVideoTag:function(t){var n=e(t);n.replaceWith('<div class="video-info" data-video-type="'+n.data().videoType+'"                 data-video-id="'+n.data().videoId+'"                 data-thumbnail-url="'+n.data().videoThumbnailUrl+'"></div>')},_handleValdiationErrors:function(e){var t=this.$form,r=this;n.each(e,function(e){if(e.key=="title")t.find("[name="+e.key+"]").after('<div class="validation-error">'+e.message+"</div>").parents(".form-group").addClass("has-error");else{if(r._item.section_type=="PRODUCT"){var n=/\d{1,2}$/g,i=e.key.match(n);i=+(i&&(i[0]||0))-1;var s=e.key.replace(n,"");t.find("[name="+s+"]").eq(i).siblings(".validation-tips").addClass("hide").end().closest("div.form-group-control").append('<div class="validation-error">'+e.message+"</div>").addClass("has-error");return}t.find("[name="+e.key+"]").siblings(".validation-tips").addClass("hide").end().closest("div.form-group-control").append('<div class="validation-error">'+e.message+"</div>").parents(".form-group").addClass("has-error")}}),t.find(".form-actions").addClass("has-error").prepend('<span class="validation-error">有些项填写不正确，请根据指示检查.</span>')},_removeValidationErrorOnFormActions:function(){this.$formActions||(this.$formActions=this.$form),this.$formActions.removeClass("has-error").find(".validation-error").remove()},_back2list:function(t){!t||t.preventDefault();var n=t&&e(t.target).attr("href")||i(r.modules.cms.SectionModule.currentSection);n=n.replace(r.App.config.root,""),r.navigate(n)},_onScroll:function(e){},_onThumbnailUploaded:function(e,t){this.$form.find("input[name=thumbnail_url]").val(t.url),this._onContentChanged()},_onItemImagesChanged:function(){this._onContentChanged()},_addClass:function(t){var n=c();e(t.target).parents(".form-group").before(n)},_delClass:function(t){if(e("[data-action=delClass]").length==1)return;e(t.target).parents(".form-group").eq(0).remove(),this._onContentChanged()}});var i=function(e){return r.App.config.root+"/builder/"+r.App.config.currentApp.id+"/cms/"+e.id+"/content"},s=function(e,t){var i="";return n.each(t,function(n){if(n.type.code!=e.section_type||o(n,t))return;i+='<label class="checkbox-inline">                    <input type="checkbox" name="section_cas_code" value="'+n.cas_code+'" '+(u(e,n)?"checked":"")+" "+(r.modules.cms.SectionModule.currentSection.id==n.id?"disabled":"")+"/> "+n.name+"                </label>"}),i},o=function(e,t){return n.any(t,function(t){return t.parent_id==e.id})},u=function(e,t){return n.any(e.statuses,function(e){return e.section_id==t.id})},a=function(e){return e.type.code!="GALLERY"},f=function(e){return e.type.code=="BRANCH"?"网点描述":"内容"},l=function(e){return e.type.code=="BRANCH"?"网点名称":e.type.code=="EVENT"?"活动名称":"标题"},c=function(e){if(e&&!e.enabled)return"";var e=e||{};return'<div class="form-group enhanced form-product-group">                    <label class="form-group-label class-delete-button"><i class="icon-minus-sign red product-class-operate" data-rel="tooltip" data-original-title="删除类别" data-action="delClass"></i></label>                    <div class="form-group-control form-add-class-group">                        <div class="form-group enhanced required">                            <label class="form-group-label">商品类型</label>                            <div class="form-group-control">                                    <input type="hidden" value="'+(e.id||"")+'" name="product_item_id"/>                                    <input type="text" class="form-control" value="'+(e.product_item_name||"")+'" name="producttype" placeholder="商品类型"/>                            </div>                        </div>                       <div class="form-group enhanced required">                            <label class="form-group-label">售价</label>                            <div class="form-group-control form-money-group">                                <div class="input-group">                                    <input type="text" class="form-control" value="'+(e.price||"")+'" name="price" placeholder="售价"/>                                    <span class="input-group-addon">(元)</span>                                </div>                            </div>                            <label class="form-group-label">原价</label>                            <div class="form-group-control form-money-group">                                <div class="input-group">                                    <input type="text" class="form-control" value="'+(e.retail_price||"")+'" name="retailPrice" placeholder="原价"/>                                    <span class="input-group-addon">(元)</span>                                </div>                            </div>                        </div>                        <div class="form-group enhanced required">                            <label class="form-group-label">库存量</label>                            <div class="form-group-control">                                <input type="text" name="inventory" value="'+(e.inventory||"")+'" class="form-control" placeholder="库存量"/>                            </div>                        </div>                    </div>                </div>'},h=function(e){return'<div class="page-content">                    <div class="topBtns">                        <a href="'+i(e)+'" class="pull-right btn btn-sm" data-action="back-list" style="margin:-5px 0 0 10px">                            <i class="icon-reply bigger-120"></i>内容列表                        </a>                        <a href="#" class="pull-right btn btn-success btn-sm disabled" data-action="save" style="margin: -5px 0 0 0">                            <i class="icon-ok bigger-120 "></i>保存                        </a>                    </div>                    <div class="page-header">                        <h1>                            '+e.name+'                            <small>                                <i class="icon-double-angle-right"></i>                                录入                            </small>                            <div data-block="socialShare" class="" style="display: inline-block">                        </h1>                    </div>                    <div class="page-content">                        <form class="form-horizontal">                        <input type="hidden" name="app_id"/>                        <input type="hidden" name="section_type"/>                        <input type="hidden" name="section_cas_code" value="'+e.cas_code+'"/>                        <input type="hidden" name="id"/>                        <input type="hidden" name="authenticityToken"/>                        <input type="hidden" name="thumbnail_url"/>                        <input type="hidden" name="coordinate"/>                        <input type="hidden" name="product_item"/>                        <div class="form-group-set uploadThumbnail">                            <div class="form-group enhanced">                                <div class="form-group-label thumbnailWrapper clearfix">                                    <img name="thumbnail" class="thumbnail dz-clickable" data-src="holder.js/100x100/text: 缩略图(200x200)">                                </div>                            </div>                            <div class="form-group enhanced required">                                <div class="form-group-control">                                    <input type="text" class="form-control" name="title" placeholder="'+l(e)+'">                                </div>                            </div>                            <div class="form-group enhanced '+(e.type.code=="BRANCH"?"invisible":"")+'">                                <div class="form-group-control">                                    <textarea class="form-control" name="summary" placeholder="简介"></textarea>                                </div>                            </div>                        </div>                        <div class="form-group-set">                            <div class="form-group enhanced '+(e.type.code=="NEWS"?"":"hide")+'">                                <label class="form-group-label">作者</label>                                <div class="form-group-control">                                    <input type="text" class="form-control" name="author" placeholder="作者"/>                                </div>                            </div>                            <div class="form-group enhanced '+(e.type.code=="NEWS"?"":"hide")+'">                                <label class="form-group-label">来源</label>                                <div class="form-group-control">                                    <input type="text" class="form-control" name="source" placeholder="来源"/>                                </div>                            </div>                            <div class="form-group enhanced '+(e.type.code=="PRODUCT"?"":"hide")+'">                                <label class="form-group-label">商品配图</label>                                <div class="form-group-control">                                    <div>                                        <button type="button" class="btn btn-info btn-sm" data-action="uploadProductImages">                                            <i class="icon-upload bigger-110"></i>上传                                        </button>                                        <span class="hints">(最多六张图片,最大尺寸608x300)</span>                                    </div>                                    <div class="space-8"></div>                                    <div class="product-imgs-wrapper" data-type="productImages"></div>                                    <div class="clearfix"></div>                                </div>                            </div>                            <div class="form-group form-product-group enhanced '+(e.type.code=="PRODUCT"?"":"hide")+'">                                <label class="form-group-label class-delete-button"><i class="icon-minus-sign red product-class-operate" data-rel="tooltip" data-original-title="删除类别" data-action="delClass"></i></label>                                <div class="form-group-control form-add-class-group">                                    <div class="form-group enhanced required '+(e.type.code=="PRODUCT"?"":"hide")+'">                                        <label class="form-group-label">商品类型</label>                                        <div class="form-group-control">                                                <input type="hidden" class="form-control" name="product_item_id"/>                                                <input type="text" class="form-control" name="producttype" placeholder="商品类型"/>                                        </div>                                    </div>                                   <div class="form-group enhanced required '+(e.type.code=="PRODUCT"?"":"hide")+'">                                        <label class="form-group-label">售价</label>                                        <div class="form-group-control form-money-group">                                            <div class="input-group">                                                <input type="text" class="form-control" name="price" placeholder="售价"/>                                                <span class="input-group-addon">(元)</span>                                            </div>                                        </div>                                        <label class="form-group-label">原价</label>                                        <div class="form-group-control form-money-group">                                            <div class="input-group">                                                <input type="text" class="form-control" name="retailPrice" placeholder="原价"/>                                                <span class="input-group-addon">(元)</span>                                            </div>                                        </div>                                    </div>                                    <div class="form-group enhanced required '+(e.type.code=="PRODUCT"?"":"hide")+'">                                        <label class="form-group-label">库存量</label>                                        <div class="form-group-control">                                            <input type="text" name="inventory" class="form-control" placeholder="库存量"/>                                        </div>                                    </div>                                </div>                            </div>                            <div class="form-group enhanced '+(e.type.code=="PRODUCT"?"":"hide")+'">                                <label class="form-group-label class-add-button"><i class="icon-plus-sign red product-class-operate" data-rel="tooltip" data-original-title="增加类别" data-action="addClass"></i></label>                                <div class="form-group-control">                                    <span class="red input-span">添加商品类型</span>                                </div>                            </div>                            <div class="'+(e.type.code=="BRANCH"?"":"hide")+'">                                <div class="form-group enhanced">                                    <label class="form-group-label">电话</label>                                    <div class="form-group-control">                                        <input type="text" name="phones" class="form-control" placeholder="请输入电话号码"/>                                        <div class="validation-tips">                                                例如: 手机号码 13112345678, 电话号码: 028-85148898                                        </div>                                    </div>                                </div>                                <div class="location-picker required"></div>                            </div>                            <div class="form-group enhanced required '+(e.type.code=="EVENT"?"":"hide")+'">                                <label class="form-group-label">地点</label>                                <div class="form-group-control">                                    <input type="text" name="address" class="form-control" placeholder="地点"/>                                </div>                            </div>                            <div class="form-group enhanced required '+(e.type.code=="EVENT"?"":"hide")+'">                                <label class="form-group-label">活动开始时间</label>                                <div class="form-group-control">                                    <div class="input-group date form_datetime" data-date-format="yyyy-mm-dd HH:ii">                                        <input name="start_time" class="form-control valid date-input" size="16" type="text" value="" readonly="">                                        <span class="input-group-addon">                                            <span class="glyphicon glyphicon-remove"></span>                                        </span>                                        <span class="input-group-addon">                                            <span class="glyphicon glyphicon-time"></span>                                        </span>                                    </div>                                </div>                            </div>                            <div class="form-group enhanced required '+(e.type.code=="EVENT"?"":"hide")+'">                                <label class="form-group-label">活动结束时间</label>                                <div class="form-group-control">                                    <div class="input-group date form_datetime" data-date-format="yyyy-mm-dd HH:ii">                                        <input name="end_time" class="form-control valid date-input" size="16" type="text" value="" readonly="">                                        <span class="input-group-addon">                                            <span class="glyphicon glyphicon-remove"></span>                                        </span>                                        <span class="input-group-addon">                                            <span class="glyphicon glyphicon-time"></span>                                        </span>                                    </div>                                </div>                            </div>                            <div class="form-group enhanced '+(e.type.code=="EVENT"?"":"hide")+'">                                <label class="form-group-label">允许报名</label>                                <div class="form-group-static">                                    <label class="checkbox-inline"><input class="dynaCheckbox" type="checkbox" name="applicable"></label>                                </div>                            </div>                            <div class="form-group enhanced hide applicable">                                <label class="form-group-label">必须登录后报名</label>                                <div class="form-group-static">                                    <label class="checkbox-inline"><input class="dynaCheckbox" type="checkbox" name="signin_apply"></label>                                </div>                            </div>                            <div class="form-group enhanced hide required applicable">                                <label class="form-group-label">报名开始时间</label>                                <div class="form-group-control">                                    <div class="input-group date form_datetime" data-date-format="yyyy-mm-dd HH:ii">                                        <input name="apply_start_time" class="form-control valid date-input" size="16" type="text" value="" readonly="">                                        <span class="input-group-addon">                                            <span class="glyphicon glyphicon-remove"></span>                                        </span>                                        <span class="input-group-addon">                                            <span class="glyphicon glyphicon-time"></span>                                        </span>                                    </div>                                </div>                            </div>                            <div class="form-group enhanced hide required applicable">                                <label class="form-group-label">报名结束时间</label>                                <div class="form-group-control">                                    <div class="input-group date form_datetime" data-date-format="yyyy-mm-dd HH:ii">                                        <input name="apply_end_time" class="form-control valid date-input" size="16" type="text" value="" readonly="">                                        <span class="input-group-addon">                                            <span class="glyphicon glyphicon-remove"></span>                                        </span>                                        <span class="input-group-addon">                                            <span class="glyphicon glyphicon-time"></span>                                        </span>                                    </div>                                </div>                            </div>                            <div class="form-group enhanced  '+(a(e)?"":"hide ")+(f(e)=="内容"?"required":"")+'">                                <label class="form-group-label">'+f(e)+'</label>                                <div class="form-group-control">                                    <textarea name="content" class="form-control html-editor" placeholder="'+f(e)+'"></textarea>                                </div>                            </div>                            <div class="'+(e.type.code!="GALLERY"?"hide":"")+'">                                <div class="uploaded">已上传: <span>0</span>张</div>                                <div class="btn btn-success" data-action="uploadGalleryImages">上传图片</div>                            </div>                            <div class="imageList galleryItems '+(e.type.code!="GALLERY"?"hide":"")+'">                                <ul class="imageListInner ui-sortable"></ul>                            </div>                            <div class="form-group enhanced">                                <label class="form-group-label">栏目</label>                                <div class="form-group-static section-list">                                </div>                            </div>                        </div>                            <!--<div class="form-group form-actions">                                    <button type="reset" class="btn btn-cancel">                                        <i class="icon-remove bigger-110"></i>取消                                    </button>                                    <button class="btn btn-primary" data-loading-text="保存中...">                                        <i class="icon-ok bigger-110"></i>保存                                    </button>                            </div> -->                        </form>                    </div>                </div>'},p=function(){return"<div/>"}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.cms.ContentList=r.common.BaseView.extend({events:{"click .createBtn":"_createOrUpdateItem","click .l-title>a[data-action=viewItem], div[data-action=viewItem]":"_createOrUpdateItem","click [data-action=toggleItemStatus]":"_toggleItemStatus","click .l-setting i[data-action=delete]":"_deleteItem"},doInitialize:function(){this.$list=this.$el.html(i(this._sectionTypeName())).find(".contentListInner"),this._initializeItemsSorter(),this.paginater=(new r.modules.common.Paginater({el:this.$el.find(".paginationWrapper")})).on("pageChanged",n.bind(this._onPageChanged,this)),t.Events.on("item.saved",n.bind(this._onItemSaved,this)),this._itemPositionStart=0,this._itemPositionCurr=0},onShow:function(e){this._loadData(1)},onRemove:function(){this.paginater.off("pageChanged",this._onPageChanged),t.Events.off("item.saved",this._onItemSaved)},_initializeItemsSorter:function(){this.$list.nestedSortable({attribute:"sort-data",forcePlaceholderSize:!0,listType:"ul",handle:".l-drag",helper:"clone",items:"li",opacity:.6,placeholder:"placeholder",revert:250,tabSize:25,scroll:!0,tolerance:"pointer",toleranceElement:">div",maxLevels:1,axis:"y",isAllowed:n.bind(this._isItemAllowdSort,this),start:n.bind(this._onItemDragStart,this),stop:n.bind(this._onItemDragStop,this),sort:n.bind(this._onItemDragSort,this)})},_isItemAllowdSort:function(t,n,r){var i=t.next();return this._itemPositionCurr-this._itemPositionStart>=0&&(i=t.prev()),i.attr("data-item-publish-state")==e(r).attr("data-item-publish-state")},_onItemDragStart:function(e,t){this._itemPositionWhenSortStart=t.item.index(),this._itemPositionStart=e.originalEvent.clientY},_onItemDragStop:function(e,t){this._itemPositionWhenSortStart!=t.item.index()&&this._saveItemsSortResult()},_onItemDragSort:function(e,t){this._itemPositionCurr=e.originalEvent.clientY},_loadData:function(t){r.showProgressIndicator("装载内容列表...");var n=this;e.get(r.api("/items"),{app_id:r.App.config.currentApp.id,section_cas_code:r.modules.cms.SectionModule.currentSection.cas_code,psize:this.paginater.psize,pno:t}).done(function(e){n.$list.html(s(e.items,r.modules.cms.SectionModule.currentSection.id)),n.paginater.setData({psize:e.psize,pno:e.pno,total_count:e.total_count}),r.closeProgressIndicator()}).error(function(e){r.closeProgressIndicator(),r.showMessage("ERROR","内容列表装载失败.",!0)})},_createOrUpdateItem:function(t){return r.navigate("/builder/"+r.App.config.currentApp.id+"/cms/"+r.modules.cms.SectionModule.currentSection.id+"/"+e(t.target).data().itemId),!1},_toggleItemStatus:function(t){var n=e(t.target),i=n[0].checked?"POST":"DELETE",s={authenticityToken:r.App.config.authToken,cas_code:r.modules.cms.SectionModule.currentSection.cas_code},o=this;e.ajax(r.api("/items/"+n.parents(".contentListItem").data().itemId+"/publish_state"),{type:i,data:s}).success(function(e){r.showMessage("INFO",o._sectionTypeName()+(n[0].checked?"已发布":"已停止发布"),!0);var t=n.closest("li[data-item-publish-state]"),i=n[0].checked?"PUBLISHED":"UNPUBLISHED";t.attr("data-item-publish-state",i)}).error(function(e){n[0].checked=!n[0].checked,r.showMessage("ERROR",o._sectionTypeName()+(i=="DELETE"?"发布":"停止发布")+"失败.")})},_deleteItem:function(t){var n=e(t.target).parents(".contentListItem").data().itemId,i=this;r.confirm("删除"+this._sectionTypeName(),"你确定要删除这条"+this._sectionTypeName()+"吗？",function(){i._doDeleteItem(n)})},_sectionTypeName:function(){return n.find(r.App.config.sectionTypes,function(e){return r.modules.cms.SectionModule.currentSection.type.code==e.code}).name},_doDeleteItem:function(t){var n={authenticityToken:r.App.config.authToken,app_id:r.App.config.currentApp.id,cas_code:r.modules.cms.SectionModule.currentSection.cas_code},i=this,s=r.modules.cms.SectionModule.currentSection.id;e.ajax(r.api("/items/"+t+""),{type:"DELETE",data:n}).success(function(){i._removeItem(s),i.$el.find(".contentListItem[data-item-id="+t+"]").remove(),r.showMessage("INFO",i._sectionTypeName()+"已经被删除",!0)}).error(function(e){var t="条目已被使用";e.responseText=="PRODUCT"?t="商品已被购买":e.responseText=="EVENT"?t="已经有人报名此活动":e.responseText=="APPOINTMENT"&&(t="已经有人预约"),r.showMessage("ERROR",t+"，无法删除",!0)})},_removeItem:function(e){r.modules.AppPreviewer.navSection({sectionId:e})},_saveItemsSortResult:function(){var t=[],n=this;this.$list.find("li").each(function(){t.push(e(this).data().itemId)}),e.post(r.api("/items/orders"),{item_id:t,authenticityToken:r.App.config.authToken,section_cas_code:r.modules.cms.SectionModule.currentSection.cas_code}).error(function(e){r.showMessage("ERROR","排序失败.",!0)})},_onPageChanged:function(e){this._loadData(e)},_onItemSaved:function(e){var t=this.$el.find('.contentListItem[data-item-id="'+e.id+'"]'),n=r.modules.cms.SectionModule.currentSection.id;t.length?t.replaceWith(o(e,n)):this.paginater.getData().pno==1&&this.$list.prepend(o(e,n))}});var i=function(e){var t="录入"+e;return'<div class="tab-pane">			<div class="btn btn-success createBtn" data-action="createItem" data-item-id="new">'+t+'</div>			<div class="contentList">				<ul class="contentListInner"></ul>			</div>			<div class="paginationWrapper"></div>		</div>'},s=function(e,t){var r="";return n.each(e,function(e){r+=o(e,t)}),r},o=function(e,t){var n=u(e,t),i='<li class="contentListItem" data-item-id="'+e.id+'" data-item-publish-state="'+n+'">			<div class="contentListItemInner">';return e.thumbnail_url?i+='<div class="l-thumbnail" style="background-image:url('+r.assetLink(e.thumbnail_url)+')" data-action="viewItem" data-item-id="'+e.id+'"></div>':i+='<div class="l-thumbnail" data-action="viewItem" data-item-id="'+e.id+'"></div>',i+='<div class="l-title"><a href="'+a(e,t)+'" data-action="viewItem" data-item-id="'+e.id+'">'+e.title+'</a></div>			<div class="l-summ">'+(e.summary?e.summary:"")+'</div>			<div class="l-setting">				<label>	                <input class="ace ace-switch ace-switch-4" type="checkbox" data-action="toggleItemStatus" '+(n=="PUBLISHED"?'checked="checked"':"")+'>	                <span class="lbl">	                </span>	            </label>				<i class="l-delete" data-action="delete" data-rel="tooltip" data-original-title="删除"></i>				<i class="l-drag" data-action="drag"></i>			</div>		</div></li>',i},u=function(e,t){return n.find(e.statuses,function(e){return e.section_id==t}).publish_state},a=function(e,t){return r.App.config.root+"/builder/"+r.App.config.currentApp.id+"/cms/"+t+"/"+e.id}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.cms.SectionAdmin=r.common.ViewStack.extend({events:{"click .sectionAdminHeader li>a":"_selectTab","click input[data-action=toggleSectionStatus]":"_toggleSectionStatus","click .btn[data-action=selectLayout]":"_selectSetting","click [data-action=sectionSave]":"_save"},doInitialize:function(){var e=this;this._section=r.modules.cms.SectionModule.currentSection,this._configureViews(),this.$el.html(a(this._section)),this._section.type.code=="TEL"?this.$("[data-action=selectLayout]").addClass("hide"):this.$("[data-action=selectLayout]").removeClass("hide");var i=this.$('[data-block="socialShare"]');this._section.type.code=="TEL"?i.addClass("hide"):(i.removeClass("hide"),this._section.last_item_id&&["CUSTOM_PAGE","CONTACT_WAY","APPOINTMENT"].indexOf(this._section.type.code)>=0?r.util.getItemInfo(this._section.last_item_id,function(t){e.socialShare=new r.modules.common.socialShare({el:i,confInfo:{from:"section",option:e._section,itemInfo:t,appInfo:r.App.config.currentApp}})}):this.socialShare=new r.modules.common.socialShare({el:i,confInfo:{from:"section",option:this._section,appInfo:r.App.config.currentApp}})),this._section.type.code=="CONTACT_WAY"&&this.$("[data-action=selectLayout]").addClass("hide"),this.hasTopImg=!0;if(this._section.type.code=="TEL"||this._section.type.code=="SECTION_SET")this.hasTopImg=!1;this.hasTopImg&&(this._topImageConfigurator=new r.modules.cms.TopImageConfigurator({el:this.$el.find('[data-block="topImg"]'),section:this._section,onTopImgChanged:n.bind(this._contentChanged,this)})),this.hasChildren=!1,this._section.type.code=="SECTION_SET"?(this.$el.find(".sectionModuleContent").addClass("hide"),this.hasChildren=!0):this.$el.find(".sectionModuleContent").removeClass("hide"),this.hasChildren&&(this.$('[data-block="sectionSettings"]').removeClass("hide"),this.$('[data-block="sectionModuleContent"]').addClass("hide"),this.sectionSettings=new r.modules.cms.SectionSettingsNew(n.extend(arguments[0],{el:this.$('[data-block="sectionSettings"]'),parentSectionId:this._section.id,onContentChanged:n.bind(this._onSectionSettingChanged,this)})),this.sectionSettings.scrollToSection(arguments[0].anchor)),this.sectionEnabled=section.state,this.on("viewChanged",n.bind(this._onViewChanged,this)),t.Events.on("section.updated",this._onSectionUpdated=n.bind(this._onSectionUpdated,this)),t.Events.on("section-structure.changed",this._onSectionStructureChanged=n.bind(this._onSectionStructureChanged,this))},_cloneSectionTopImages:function(){var e=[];return n.each(this._section.top_images,function(t){e.push(n.clone(t))}),e},_onSectionSettingChanged:function(e){e===undefined&&(e=!0),this.sectionSettingChanged=e,this._contentChanged(e)},_onStatusChanged:function(e){},viewport:function(){return this._viewport||(this._viewport=this.$el.find(".sectionAdminTabContent"))},isViewChangedWhenRecover:function(){return this.getLastFragment()!=t.history.getFragment()},show:function(e){this.args.anchor!=null&&this.onShow(this.args);if(this.hasChildren)return;e=="content"&&!this._hasContent()&&(arguments[0]=e="settings");var t=this.$el.find(".sectionAdminHeader li[data-view-id=content]");this._hasContent()?t.removeClass("hide"):t.addClass("hide");if(this.isSectionCacheStale){var i=this.cache.settings;delete this.cache.settings,i&&(i.$el.detach(),i.hide(),this.isSectionCacheStale=!1)}r.common.ViewStack.prototype.show.apply(this,arguments),this.contentEditor=this.cache.content;if(this.contentEditor){var s=this.contentEditor.setCallbacks;s&&s.call(this.contentEditor,"onContentChanged",n.bind(this._contentChanged,this))}},onHide:function(){r.common.ViewStack.prototype.onHide.apply(this),this.isChanged()&&this._cancel()},onRemove:function(){this.off("viewChanged",this._onViewChanged),this.isChanged()&&this._cancel()},onShow:function(e){this.sectionSettings&&e!=undefined&&e.anchor?this.sectionSettings.scrollToSection(e.anchor):window.scrollTo(0,0)},onRefresh:function(e){this.sectionSettings&&e!=undefined&&this.sectionSettings.scrollToSection(e.anchor)},onRecover:function(e){this.sectionSettings&&e!=undefined&&e.anchor?this.sectionSettings.scrollToSection(e.anchor):window.scrollTo(0,0)},isChanged:function(){return this._contentModifiedDt||this._templateModifiedDt},_cancel:function(e){this.hasTopImg&&this._topImageConfigurator._cancel(),r.App.util.isSectionSet(this._section)&&this.sectionSettings._cancel()},_save:function(e){e.preventDefault(),this._disableFormActionsIfNecessary(!0);var t=this;this._saveTopImg(function(){t._saveSectionSettings(function(){t._saveContent()})})},_saveTopImg:function(e){if(this.hasTopImg){this._topImageConfigurator._save(e);return}e&&e()},_saveSectionSettings:function(e){if(r.App.util.isSectionSet(this._section)){this.sectionSettings._save(e);return}e&&e()},_saveContent:function(e){if(!this.hasContentEditor)return;this.contentEditor&&this.contentEditor._save()},_contentChanged:function(e){e!=undefined||(e=!0),e?(this._contentModifiedDt=(new Date).getTime(),this._enableFormActions()):(this._contentModifiedDt=null,this._disableFormActionsIfNecessary())},_enableFormActions:function(){this.$('[data-action="sectionSave"]').removeClass("disabled")},_disableFormActionsIfNecessary:function(e){(e||!this._contentModifiedDt&&!this._templateModifiedDt)&&this.$('[data-action="sectionSave"]').addClass("disabled")},_hasContent:function(){return!o(this._section)},_configureViews:function(){this.views={settings:r.modules.cms.SectionSettings},this.views.content=this._infoTypeSction()},_infoTypeSction:function(){return this.hasContentEditor=!0,this._section.type.code=="CONTACT_WAY"?r.modules.cms.ContactWayEditor:this._section.type.code=="APPOINTMENT"?r.modules.cms.AppointmentEditor:this._section.type.code=="CUSTOM_PAGE"?r.modules.cms.InfoContentEditor:this._section.type.code=="TEL"?r.modules.cms.telEditor:this._section.type.code=="LINK"?r.modules.cms.linkEditor:(this.hasContentEditor=!1,r.modules.cms.ContentList)},_selectTab:function(t){t.preventDefault();var n=e(t.target).attr("href").replace(r.App.config.root,"");r.navigate(n)},_selectSetting:function(e){e.preventDefault(),this._section.type.code=="SECTION_SET"&&(this.hasChildren=!1),r.navigate("/builder/"+r.App.config.currentApp.id+"/cms/"+this._section.id+"/layoutSettings")},_toggleSectionStatus:function(t){var n=e(t.target)[0],i=n.checked,s=i?"POST":"DELETE",o=this;e.ajax(r.api("/sections/"+this._section.id+"/status"),{type:s,data:{authenticityToken:r.App.config.authToken}}).success(function(e){e.code!="200"?(n.checked=!i,r.showMessage("ERROR",e.message,!0)):(r.showMessage("INFO","栏目已"+(i?"启用":"禁用"),!0),o._section.state=s=="DELETE"?"DISABLED":"ENABLE",o._section.state=="ENABLE"?r.App.util.enableSection(o._section.id):r.App.util.disableSection(o._section.id))}).error(function(e){r.showMessage("ERROR",e)})},_findParentSections:function(e){return n.filter(r.App.config.currentApp.sections,function(t){return t.id==e.parent_id})},_findChildSections:function(e){return n.filter(r.App.config.currentApp.sections,function(t){return t.parent_id==e.id})},_onViewChanged:function(e,t){this.$el.find('.sectionAdminHeader li[data-view-id="'+t+'"]').addClass("active").siblings().removeClass("active")},_onSectionUpdated:function(e){console.debug("====lalal",e);if(e.id!=this._section.id)return;this.$el.find(".sectionModuleHeader h1 .name").html(e.name),this.$el.find(".sectionModuleHeader h1 .type").text("<"+e.type.name+">")},_onSectionStructureChanged:function(){var e=r.modules.cms.SectionModule.currentSection;this.isSectionCacheStale=!0;var n=o(e),i="/builder/"+r.App.config.currentApp.id+"/cms/"+e.id;if(n)r.doJob(function(){r.navigate(i+"/settings")},50);else if(!n){var s=t.history.fragment.match(/settings$/)?"/settings":"/content";r.doJob(function(){r.navigate(i+s)},50)}}});var i=function(e){return r.App.config.root+"/builder/"+r.App.config.currentApp.id+"/cms/"+e+"/content"},s=function(e){return r.App.config.root+"/builder/"+r.App.config.currentApp.id+"/cms/"+e+"/settings"},o=function(e){return"SECTION_SET"==e.type.code?!0:n.find(r.App.config.currentApp.sections,function(t){return t.parent_id==e.id})},u=function(e){var t=o(e),n=e.state=="ENABLE"?"checked":"";return'<div class="page-content">			<div class="page-header sectionModuleHeader">				<h1><span class="name">'+e.name+'</span><span class="type">&lt;'+e.type.name+'&gt;</span>					<label class="pull-right" data-rel="tooltip" data-placement="bottom" data-original-title="'+(e.state=="ENABLE"?"栏目已启用":"栏目已停用")+'" >						<input class="ace ace-switch ace-switch-6" type="checkbox" data-action="toggleSectionStatus" '+n+'>						<span class="lbl"></span>					</label>				</h1>				<div data-block="socialShare" class="col-sm-6 no-padding-left">				</div>			</div>			<div class="sectionModuleContent">				<div class="tabbable">					<ul class="nav nav-tabs sectionAdminHeader">						<li class="'+(t?"hide":"")+'" data-view-id="content">							<a href="'+i(e.id)+'">内容</a>						</li>						</li>'+f(e)+'					</ul>					<div class="clearfix sectionAdminTabContent"></div>				</div>			</div>		</div>'},a=function(e){var t=o(e),n=e.state=="ENABLE"?'checked="checked"':"",r='<div class="page-content"><div class="sectionIndex">				    <div class="topBtns">				        <div class="pull-right">				            <a href="#" class="btn btn-success btn-sm disabled" data-action="sectionSave">				                <i class="icon-ok bigger-120 "></i>保存				            </a>				            <a href="#" class="btn btn-info btn-sm" data-action="selectLayout">				                <i class="icon-copy bigger-120 "></i>版式选择				            </a>				        </div>				    </div>				    <form class="form-horizontal">				        <h3 class="blue">				            <span class="name">'+e.name+'</span>				            <span class="type grey">&lt;'+e.type.name+'&gt;</span>				            <label>				                <input class="ace ace-switch ace-switch-5" data-action="toggleSectionStatus" type="checkbox" '+n+'>				                <span class="lbl">				                </span>				            </label>				            <div data-block="socialShare" class="" style="display: inline-block">				        </h3>				        <div data-block="topImg"></div>				    </form>				    <div class="sectionList hide" data-block="sectionSettings"></div>				    <div class="sectionModuleContent" data-block="sectionModuleContent">						<div class="tabbable">							<div class="clearfix sectionAdminTabContent"></div>						</div>					</div>				</div></div>';return r},f=function(e){return e.type.code!="TEL"?"":'<li data-view-id="settings">			<a href="'+s(e.id)+'">设置</a>			</li>'},l=function(e){return e.type.code=="SECTION_SET"||e.type.code=="TEL"?"":'<div class="topBtns">					<div class="pull-right">						<a href="'+s(e.id)+'"  class="btn btn-info btn-sm" data-action="selectLayout">			        	<i class="icon-copy bigger-120 "></i>版式选择					        </a>				    </div>				</div>'},c=function(){return'<div class="modal-content">				    <div class="modal-body">						<div data-type="mainHome"></div>				    </div>				    </div>				</div>'}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf"),i=r.common.ViewStack.extend({doInitialize:function(e){this.views={typeList:s,form:{clazz:o,removable:!0}}}}),s=r.common.BaseView.extend({events:{"click .btn[data-action=cancel]":"_cancel","click a[data-section-type]":"_selectSectionType"},doInitialize:function(e){var t=e.parentSection?!1:!0;this.$el.html(u(t))},_selectSectionType:function(n){n.preventDefault();var r=e(n.target).data().sectionType||e(n.target).parents("a").data().sectionType,i=e(n.target).data().sectionName||e(n.target).parents("a").data().sectionName;t.Events.trigger("sectionCreationDialog.command",{action:"form",sectionType:{type:r,name:i}})},_cancel:function(e){t.Events.trigger("sectionCreationDialog.command",{action:"close"})}}),o=r.common.BaseView.extend({events:{"click .btn[data-action=cancel]":"_back2SectionTypeList","keydown input[name=name]":"_onKeydown",submit:"_save"},doInitialize:function(e){this.$el.html(a(e.sectionType.type,e.hideGuideAction)).find("input[name=name]").focus(),e.parentSection&&(this.$el.find(".form-group[data-type=parentSection]").removeClass("hide").find(".form-control-static").text(n.unescape(e.parentSection.name)),this.$el.find("input[name=parent_id]").val(e.parentSection.id)),this.$el.find(".img").imageHolder("vine"),new r.modules.common.ImageUploader({el:this.$el.find(".img"),uploadUrl:r.api("/files"),onsuccess:n.bind(this._onIconUploaded,this)})},_onKeydown:function(t){e(t.target).parents(".form-group").removeClass("has-error").end().next(".validation-error").remove(),this._removeValidationErrorOnFormActions()},_back2SectionTypeList:function(e){e.preventDefault(),t.Events.trigger("sectionCreationDialog.command",{action:"typeList"})},_gotoSection:function(e){e.parent_id?r.navigate("builder/"+e.app_id+"/cms/"+e.parent_id+"/settings/section-li-"+e.id):r.navigate("builder/"+e.app_id+"/cms/home/section-li-"+e.id)},_save:function(n){n.preventDefault();var i=this.$el.find("form"),s=this.$el.find("button[data-action=ok]"),o=this;s.button("loading"),i.find(".form-group").removeClass("has-error"),i.find(".validation-error").remove(),i.find("input[name=authenticityToken]").val(r.App.config.authToken),i.find("input[name=app_id]").val(r.App.config.currentApp.id),e.post(r.api("/sections/new"),i.serialize()).done(function(e){if(e.code==400){s.button("reset"),o._handleValidationErrors(e.errors);return}s.button("reset"),t.Events.trigger("section.updated",e.section),t.Events.trigger("sectionCreationDialog.command",{action:"close"}),o._gotoSection(e.section)}).error(function(e){s.button("reset")})},_handleValidationErrors:function(e){var t=this.$el.find("form");n.each(e,function(e){t.find("[name="+e.key+"]").after('<div class="validation-error">'+e.message+"</div>").parents(".form-group").addClass("has-error")}),t.find(".modal-footer").addClass("has-error").prepend('<span class="validation-error">有些项填写不正确，请根据指示检查.</span>')},_removeValidationErrorOnFormActions:function(){this.$formActions||(this.$formActions=this.$el.find(".modal-footer")),this.$formActions.removeClass("has-error").find(".validation-error").remove()},_onIconUploaded:function(e,t){this.$el.find("input[name=icon_url]").val(t.url)}});r.modules.cms.SectionCreationDialog=r.modules.common.Dialog.extend({internalInitialize:function(r){var s=e('<div class="section-creation-dialog-inner"/>').appendTo(this.viewport());this._wizard=new i({el:s}),t.Events.on("sectionCreationDialog.command",n.bind(this._onCommand,this))},title:function(){return this.args.title||"选择栏目类型"},onShow:function(e){var t=this.args.view||"typeList",n={sectionType:e.sectionType,hideGuideAction:e.hideGuideAction,doNotEnterSection:e.doNotEnterSection,parentSection:e.parentSection};this._wizard.show(t,n)},onClose:function(){t.Events.off("sectionCreationDialog.command",this._onCommand)},_onCommand:function(e){e.action=="form"?(this.$el.find(".modal-header>h4").html(this.title()+" > "+n.escape(e.sectionType.name)),this._wizard.show("form",{sectionType:e.sectionType,parentSection:this.args.parentSection})):e.action=="typeList"?(this.$el.find(".modal-header>h4").html(this.title()),this._wizard.show("typeList",{sectionType:e.sectionType,parentSection:this.args.parentSection})):(e.action="close")&&this.close()},adjustLocation:function(){var t=this.$el.find(".modal-dialog"),n=e(window).height(),r=e(window).width(),i=t.outerHeight(),s=(r-t.outerWidth())/2/r*100;t.css({marginLeft:s+"%",marginTop:"120px"})}});var u=function(e){return'<div class="modal-body">			<div class="noSection">				<ul>'+(e?'<li class="pre_folder disc" data-item="sectionSet"><a href="#" class="folder" data-section-type="SECTION_SET" data-section-name="栏目集"><i class="icon-folder-open bigger-300"><span>栏目集</span></i></a></li>':"")+'<li class="pre_news w2"><a href="#" class="btn btn-app btn-light radius-4" data-section-type="NEWS" data-section-name="有列表图文"><i class="icon-rss bigger-160"></i>有列表图文</a></li>					<li class="pre_custom_page"><a href="#" class="btn btn-app btn-light radius-4" data-section-type="CUSTOM_PAGE" data-section-name="无列表图文"><i class="icon-file-text bigger-160"></i>无列表图文</a></li>					<li class="pre_gallery w2"><a href="#" class="btn btn-app btn-light radius-4" data-section-type="GALLERY" data-section-name="图集"><i class="icon-picture bigger-160"></i>图集</a></li>					<li class="pre_tel disc"><a href="#" class="btn btn-app btn-light radius-4" data-section-type="TEL" data-section-name="拨打电话"><i class="icon-phone bigger-160"></i>拨打电话</a></li>					<li class="pre_branch"><a href="#" class="btn btn-app btn-light radius-4" data-section-type="BRANCH" data-section-name="网点"><i class="icon-map-marker bigger-160"></i>网点</a></li>					<li class="pre_contact_way"><a href="#" class="btn btn-app btn-light radius-4" data-section-type="CONTACT_WAY" data-section-name="联系方式"><i class="icon-user bigger-160"></i>联系方式</a></li>					<li class="pre_event w2"><a href="#" class="btn btn-app btn-light radius-4" data-section-type="EVENT" data-section-name="活动"><i class="icon-volume-down bigger-160"></i>活动</a></li>					<li class="pre_appointment"><a href="#" class="btn btn-app btn-light radius-4" data-section-type="APPOINTMENT" data-section-name="预约"><i class="icon-time bigger-160"></i>预约</a></li>					<li class="pre_product w2"><a href="#" class="btn btn-app btn-light radius-4" data-section-type="PRODUCT" data-section-name="商城"><i class="icon-shopping-cart bigger-160"></i>商城</a></li>					<li class="pre_link disc"><a href="#" class="btn btn-app btn-light radius-4" data-section-type="LINK" data-section-name="外部链接"><i class="icon-link bigger-160"></i>外部链接</a></li>				</ul>			</div>		</div>		<div class="modal-footer">			<button class="btn" data-action="cancel">				<i class="icon-remove"></i>取消			</button>			<button class="btn btn-primary hide" data-action="nextStep">				<i class="icon-arrow-right icon-on-right"></i>下一步			</button>		</div>'},a=function(e,t){return'<div>			<form class="form-horizontal">				<div class="modal-body">					<input type="hidden" name="authenticityToken"/>					<input type="hidden" name="app_id"/>					<input type="hidden" name="section_type" value="'+e+'"/>					<input type="hidden" name="parent_id"/>					<input type="hidden" name="icon_url"/>					<div class="form-group">						<label class="col-sm-3 control-label no-padding-right">名称</label>						<div class="col-sm-7">							<input type="text" class="form-control" name="name" placeholder="栏目名称" >						</div>					</div>					<div class="form-group hide" data-type="parentSection">						<label class="col-sm-3 control-label no-padding-right">父栏目</label>						<div class="col-sm-7">							<div class="form-control-static" data-type="parentSectionName"></div>						</div>					</div>					<div class="form-group enhanced">						<label class="col-sm-3 control-label no-padding-right">图标</label>						<div class="col-sm-7">							<img data-src="holder.js/100x100" class="img img-thumbnail" alt="200x200"/>						</div>					</div>			</div>			<div class="modal-footer">				<button class="btn '+(t?"hide":"")+'" type="button" data-action="cancel"><i class="icon-arrow-left icon-on-left"></i>上一步</button>				<button class="btn btn-primary" data-action="ok" data-loading-text="保存中..."><i class="icon-ok"></i>确认</button>			</div>		</form>'}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.cms.SectionModule=r.common.ViewStack.extend({doInitialize:function(){this._section=r.modules.cms.SectionModule.currentSection=this.args.section,this.views={admin:r.modules.cms.SectionAdmin,layout:{clazz:r.modules.cms.SectionLayout,removable:!0},edit:{clazz:r.modules.cms.ContentEditor,removable:!0}}},onShow:function(e){t.Events.trigger("cms.section.show",this._section)},viewport:function(){return this.$el},test:function(e){return this._section.id==e.sectionId},isViewChangedWhenRecover:function(){return this._section.id!=this.args.section.id}})}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.cms.SectionSettings=r.common.BaseView.extend({events:{"keyup input":"_onKeyup","click .btn[data-action=uploadIcon], .btn[data-action=uploadIconBg]":"_uploadIcons","click .btn-cancel":"_cancel",submit:"_save"},doInitialize:function(){this._section=r.modules.cms.SectionModule.currentSection,this.$form=this.$el.html(i(this._section)).find("form"),this.$form.find("input[name=name]").val(n.unescape(this._section.name)),this._section.type.code=="TEL"?(this.$form.find("input[name=telephone]").val(n.unescape(this._section.telephone)),this.$form.find("[data-action=settingCancel]").addClass("hide"),this._initializeIconUploader()):this.$form.find("[data-action=settingCancel]").removeClass("hide"),this.$form.find("[data-action=settingCancel]").enable(),this._navTemplateConfigurator=new r.modules.cms.TemplateConfigurator({el:this.$el.find(".templates-slider[data-type=NAVIGATION]"),templates:this._findTemplatesByType(this._section.type.code,"NAVIGATION"),selectedTemplateId:this._section.nav_template.template_id}),this._listTemplateConfigurator=new r.modules.cms.TemplateConfigurator({el:this.$el.find(".templates-slider[data-type=LIST]"),templates:this._findTemplatesByType(this._section.type.code,"LIST"),selectedTemplateId:this._section.list_template.template_id}),this._contentTemplateConfigurator=new r.modules.cms.TemplateConfigurator({el:this.$el.find(".templates-slider[data-type=CONTENT]"),templates:this._findTemplatesByType(this._section.type.code,"CONTENT"),selectedTemplateId:this._section.content_template.template_id}),this._navTemplateConfigurator.on("templateSettings.updated",this._onTemplateChanged=n.bind(this._onTemplateChanged,this)),this._listTemplateConfigurator.on("templateSettings.updated",this._onTemplateChanged),this._contentTemplateConfigurator.on("templateSettings.updated",this._onTemplateChanged),t.Events.on("previewer.loaded",n.bind(this._onPreviewerLoaded,this))},isChanged:function(){return this._contentModifiedDt||this._templateModifiedDt},onHide:function(){this.isChanged()&&this._cancel()},_return:function(e){e.preventDefault()},_handleSelectIcons:function(){this.$iconSelecter.modal("show")},_onIconSelecterModalShown:function(e){var t=this._section.icon_url,n="icons-black";if(t&&t.indexOf("material")>=0){var r=this.$iconSelecter.find('li div[data-url="'+t+'"]'),i=r.parent("li");i.click(),console.log("init choose icon",this._section.icon_url),n=i.closest(".tab-pane").attr("id")}var s=this.$iconSelecter.find('ul.nav-tabs a[href="#'+n+'"]');s.click()},_onIconSelected:function(t){var n=e(t.target).closest("li"),r=n.find("div").data("url");e("div.tab-content li.active").removeClass("active"),n.addClass("active"),this._tmpIconSelected=r},_selectIcon:function(){this.$iconSelecter.modal("hide");if(!this._tmpIconSelected)return;var e=this._tmpIconSelected;this._onIconUploaded({},{url:e}),this.$el.find("img[data-action=uploadIcon]").attr({src:e})},onRemove:function(){this._navTemplateConfigurator.off("templateSettings.updated",this._onTemplateChanged),this._listTemplateConfigurator.off("templateSettings.updated",this._onTemplateChanged),this._contentTemplateConfigurator.off("templateSettings.updated",this._onTemplateChanged),this.isChanged()&&this._cancel(),this._navTemplateConfigurator.remove(),this._listTemplateConfigurator.remove(),this._contentTemplateConfigurator.remove(),t.Events.off("previewer.loaded",this._onPreviewerLoaded)},_initializeIconUploader:function(){this._section.icon_url&&this.$el.find("img[data-action=uploadIcon]").attr({src:this._section.icon_url}),this._section.background_url&&this.$el.find("img[data-action=uploadIconBg]").attr({src:this._section.background_url}),new r.modules.common.ImageUploader({el:this.$el.find(".sectionIconSetting img[data-action=uploadIcon]"),uploadUrl:r.api("/files"),removeUrl:r.api("/sections/"+this._section.id+"/icon"),onsuccess:n.bind(this._onIconUploaded,this),onremoved:n.bind(this._onIconRemoved,this)}),new r.modules.common.ImageUploader({el:this.$el.find(".sectionIconBgiSetting img[data-action=uploadIconBg]"),uploadUrl:r.api("/files"),removeUrl:r.api("/sections/"+this._section.id+"/icon_bg"),onsuccess:n.bind(this._onIconBgUploaded,this),onremoved:n.bind(this._onIconBgRemoved,this)})},_findTemplatesByType:function(e,t){var i=n.find(r.App.config.sectionTypes,function(t){return t.code==e});return i?n.filter(i.templates,function(e){return e.type==t}):[]},_uploadIcons:function(t){var n=e(t.target).data().action||e(t.target).parent().data().action;e(t.target).closest("div").find("img[data-action="+n+"]").trigger("click")},_cancel:function(e){this.$form.find("input[name=name]").val(n.unescape(this._section.name)),this._section.type.code=="TEL"&&this.$form.find("input[name=telephone]").val(n.unescape(this._section.telephone)),this.$form.find("input[name=icon_url]").val(""),this.$form.find("input[name=background_url]").val(""),this._section.icon_url?this.$form.find(".imageUploader img[data-action=uploadIcon]").attr({src:this._section.icon_url}):this.$form.find(".imageUploader img[data-action=uploadIcon]").imageHolder(),this._section.background_url?this.$form.find(".imageUploader img[data-action=uploadIconBg]").attr({src:this._section.background_url}):this.$form.find(".imageUploader img[data-action=uploadIconBg]").imageHolder(),this.$form.find(".form-group").removeClass("has-error"),this._removeValidationErrorOnFormActions(),this._contentChanged(!1),this._templateChanged(!1),this._section.type.code!="TEL"&&r.navigate("/builder/"+r.App.config.currentApp.id+"/cms/"+this._section.id+"/content")},_save:function(n){n.preventDefault(),this._removeValidationErrorOnFormActions(),r.showProgressIndicator("保存中..."),this._section.type.code=="TEL"&&this.$form.find("input[name=telephone]").val(this.$form.find("input[name=telephone]").val().trim());var i={id:this._section.id,name:this.$form.find("input[name=name]").val(),telephone:this.$form.find("input[name=telephone]").val(),icon_url:this.$form.find("input[name=icon_url]").val(),background_url:this.$form.find("input[name=background_url]").val(),nav_template_id:this._navTemplateConfigurator.getSelectedTemplate().id,list_template_id:this._listTemplateConfigurator.getSelectedTemplate().id,content_template_id:this._contentTemplateConfigurator.getSelectedTemplate().id};this.$form.find(".form-group").removeClass("has-error").find(".validation-tips").removeClass("hide");var s=this.$form.find(".btn-save").button("loading"),o=this;e.post(r.api("/sections/"+this._section.id),i).done(function(e){if(e.code==400){s.button("reset").disable(),o._handleValidationErrors(e.errors),r.closeProgressIndicator(),r.showMessage("ERROR","有些表单项填写不正确, 请根据提示进行检查.",!0);return}s.button("reset").disable(),o._section.icon_url!=e.section.icon_url&&o._setIconInput(e.section.icon_url),o._section.background_url!=e.section.background_url&&o._setIconBgInput(e.section.background_url),r.showMessage("SUCCESS","保存成功!",!0),r.modules.cms.SectionModule.currentSection=o._section=e.section,t.Events.trigger("section.updated",e.section),o._contentChanged(!1),o._templateChanged(!1),r.closeProgressIndicator(),o._section.type.code!="TEL"&&r.navigate("/builder/"+r.App.config.currentApp.id+"/cms/"+o._section.id+"/content")}).error(function(e){s.button("reset").disable(),r.closeProgressIndicator(),r.showMessage("ERROR","保存出错!",!0)})},_cloneSectionTopImages:function(){var e=[];return n.each(this._section.top_images,function(t){e.push(n.clone(t))}),e},_handleValidationErrors:function(e){var t=this.$form;n.each(e,function(e){t.find("[name="+e.key+"]").siblings(".validation-tips").addClass("hide").end().after('<div class="validation-error">'+e.message+"</div>").parents(".form-group").addClass("has-error")}),t.find(".form-actions").addClass("has-error").prepend('<span class="validation-error">有些项填写不正确，请根据指示检查.</span>')},_removeValidationErrorOnFormActions:function(){this.$form.find("div.has-error").removeClass("has-error"),this.$form.find(".validation-error").remove(),this.$formActions||(this.$formActions=this.$el.find(".form-actions")),this.$formActions.removeClass("has-error").find(".validation-error").remove()},_contentChanged:function(e){e!=undefined||(e=!0),e?(this._contentModifiedDt=(new Date).getTime(),this._enableFormActions()):(this._contentModifiedDt=null,this._disableFormActionsIfNecessary()),this._fireSettingsChangedEvent()},_templateChanged:function(e){e!=undefined||(e=!0),e?(this._templateModifiedDt=(new Date).getTime(),this._enableFormActions()):(this._templateModifiedDt=null,this._navTemplateConfigurator.selectTemplate(this._section.nav_template.template_id),this._listTemplateConfigurator.selectTemplate(this._section.list_template.template_id),this._contentTemplateConfigurator.selectTemplate(this._section.content_template.template_id),this._disableFormActionsIfNecessary()),this._fireTemplateChangedEvent()},_enableFormActions:function(){this._section.type.code=="TEL"?this.$form.find(".form-actions .btn").enable():this.$form.find(".topBtns .btn").enable()},_disableFormActionsIfNecessary:function(){this._section.type.code=="TEL"&&!this._contentModifiedDt&&!this._templateModifiedDt?this.$form.find(".form-actions .btn").button("reset").disable():this._section.type!="TEL"&&!this._contentModifiedDt&&!this._templateModifiedDt&&this.$form.find(".topBtns .btn-save").button("reset").disable()},_onTemplateChanged:function(){this._templateChanged()},_onKeyup:function(t){e(t.target).parents(".form-group").removeClass("has-error").end().siblings(".validation-tips").removeClass("hide").end().next(".validation-error").remove(),this._removeValidationErrorOnFormActions(),this._contentChanged()},_onIconUploaded:function(e,t){this._setIconInput(t.url),this._contentChanged()},_setIconInput:function(e){this.$el.find("input[name=icon_url]").val(e)},_onIconRemoved:function(){this._section.icon_url=null,this.$el.find("input[name=icon_url]").val(""),this._contentChanged()},_onIconBgUploaded:function(e,t){this._setIconBgInput(t.url),this._contentChanged()},_setIconBgInput:function(e){this.$el.find("input[name=background_url]").val(e)},_onIconBgRemoved:function(){this._section.background_url=null,this.$el.find("input[name=background_url]").val(""),this._contentChanged()},_onPreviewerLoaded:function(){this.isChanged()&&(this._fireSettingsChangedEvent(),this._fireTemplateChangedEvent())},_fireSettingsChangedEvent:function(){},_fireTemplateChangedEvent:function(){var e=[{sectionId:this._section.id,nav:this._navTemplateConfigurator.getSelectedTemplate().optionId,list:this._listTemplateConfigurator.getSelectedTemplate().optionId,content:this._contentTemplateConfigurator.getSelectedTemplate().optionId}];r.modules.AppPreviewer.sectionTemplatesChanged(e)}});var i=function(e){var t='<div id="sectionSettingPanel" class="tab-pane in active">			<form class="form-horizontal sectionSettingForm">			<input type="hidden" name="authentictyToken"/>			<input type="hidden" name="id"/>			<input type="hidden" name="icon_url"/>			'+u(e)+'			<input type="hidden" name="background_url"/>'+s(e)+a(e)+f(e);return t+=l(e),t+=c(e),t+=h(e),t+=o(e)+"</form>		</div>",t},s=function(e){return e.type.code=="TEL"?"":'<div class="topBtns">            <div class="pull-right">			<button class="btn btn-cancel btn-sm disabled" type="button" disabled data-action="settingCancel">			<i class="icon-remove bigger-110"></i>取消			</button> 			<button class="btn btn-primary btn-sm btn-save disabled" data-loading-text="保存中..." disabled>				<i class="icon-ok bigger-110"></i>保存			</button>        </div>	</div>'},o=function(e){return e.type.code!="TEL"?"":'<div class="clearfix form-actions">									 <button class="btn btn-cancel btn-sm disabled" type="button" disabled>										<i class="icon-remove bigger-110"></i>取消									</button> 									<button class="btn btn-primary btn-sm btn-save disabled" data-loading-text="保存中..." disabled>										<i class="icon-ok bigger-110"></i>保存									</button>								</div>'},u=function(e){return e.type.code=="TEL"?"":'<input type="hidden" name="name">'},a=function(e){return e.type.code!="TEL"?"":'<h3 class="header smaller light-grey" data-type="basic">电话号码</h3>			<div class="form-group">					<label class="col-sm-2 control-label no-padding-right grey">电话号码</label>					<div class="col-sm-6">						<input type="text" name="telephone" placeholder="请输入电话号码" class="form-control">						<div class="validation-tips">						例如: 手机号码 13112345678, 电话号码: 028-85148898						</div>					</div>			</div>'},f=function(e){return e.type.code!="TEL"?"":'<h3 class="header smaller light-grey" data-type="basic">基本信息</h3>		<div class="form-group">		<label class="col-sm-2 control-label no-padding-right grey">名称</label>		<div class="col-sm-6">			<input type="text" name="name" placeholder="栏目名称" class="form-control">		</div>	</div>	<div class="form-group" data-type="icons">		<label class="col-sm-2 control-label no-padding-right grey">			<div>图标</div>			<div>(200x200)</div>		</label>		<div class="col-sm-4 sectionIconSetting">			<div class="settingIcon">				<img data-src="holder.js/100x100/text:200x200" data-action="uploadIcon"/>			</div>			<button type="button" data-toggle="modal" data-target="#modal-iconSelecter" data-action="showSelectIcons" class="btn btn-xs" href="#modal-iconSelecter" data-toggle="modal">                <i class="icon-th bigger-125"></i>选择            </button>			<button type="button" class="btn btn-xs btn-default" data-action="uploadIcon">				<i class="icon-upload bigger-125"></i>上传			</button>		</div>		<label class="col-sm-2 control-label no-padding-right grey">			<div>栏目图片</div>			<div>(400x330)</div>		</label>		<div class="col-sm-4 sectionIconBgiSetting">			<div class="settingIconBgi">				<img data-src="holder.js/100x100/text:400x330" data-action="uploadIconBg"/>			</div>			<button type="button" class="btn btn-xs btn-default" data-action="uploadIconBg">				<i class="icon-upload bigger-125"></i>上传			</button>		</div>	</div>'},l=function(e){if(!p(e))return"";var t='<h3 class="header smaller light-grey">下一级版式</h3>			<div class="form-group">				<div class="col-sm-12 templates-slider" data-type="NAVIGATION"></div>			</div>';return t},c=function(e){if(!d(e))return"";var t='<h3 class="header smaller light-grey">列表版式</h3>			<div class="form-group">				<div class="col-sm-12 templates-slider" data-type="LIST"></div>			</div>';return t},h=function(e){if(!v(e))return"";var t='<h3 class="header smaller light-grey">内容版式</h3>			<div class="form-group">				<div class="col-sm-12 templates-slider" data-type="CONTENT"></div>			</div>';return t},p=function(e){return m(e)},d=function(e){return e.type.code!="TEL"&&e.type.code!="CUSTOM_PAGE"&&e.type.code!="CONTACT_WAY"&&e.type.code!="APPOINTMENT"&&!m(e)},v=function(e){return e.type.code!="TEL"&&e.type.code!="CONTACT_WAY"&&!m(e)},m=function(e){return"SECTION_SET"==e.type.code?!0:n.find(r.App.config.currentApp.sections,function(t){return t.parent_id==e.id})},g=function(){var e='<div id="modal-iconSelecter" class="modal" aria-hidden="false">			        <div class="modal-dialog iconSelecter">			            <div class="modal-content">			                <div class="modal-header lighter blue">选择图标			                    <span class="close" data-dismiss="modal">×</span>			                </div>			                <div class="modal-body">			                    <div class="tabbable">			                        <ul class="nav nav-tabs">			                            <li class="active"><a data-toggle="tab" href="#icons-black"><span class="color-black"></span></a></li><li class=""><a data-toggle="tab" href="#icons-grey"><span class="color-grey"></span></a></li><li><a data-toggle="tab" href="#icons-white"><span class="color-white"></span></a></li><li><a data-toggle="tab" href="#icons-red"><span class="color-red"></span></a></li><li><a data-toggle="tab" href="#icons-yellow"><span class="color-yellow"></span></a></li><li><a data-toggle="tab" href="#icons-green"><span class="color-green"></span></a></li><li class=""><a data-toggle="tab" href="#icons-blue"><span class="color-blue"></span></a></li>			                        </ul>			                        <div class="tab-content clearfix">		                            	<div id="icons-black" class="tab-pane active"><ul class="iconSelecter-inner icons-black clearfix"><li><div class="ico-address-book" data-url="/files/material/icons/black/png/address-book.png"></div></li><li><div class="ico-addressbook" data-url="/files/material/icons/black/png/addressbook.png"></div></li><li><div class="ico-airplane" data-url="/files/material/icons/black/png/airplane.png"></div></li><li><div class="ico-apple" data-url="/files/material/icons/black/png/apple.png"></div></li><li><div class="ico-barcode" data-url="/files/material/icons/black/png/barcode.png"></div></li><li><div class="ico-bars" data-url="/files/material/icons/black/png/bars.png"></div></li><li><div class="ico-bars2" data-url="/files/material/icons/black/png/bars2.png"></div></li><li><div class="ico-book" data-url="/files/material/icons/black/png/book.png"></div></li><li><div class="ico-bookmark" data-url="/files/material/icons/black/png/bookmark.png"></div></li><li><div class="ico-bubble" data-url="/files/material/icons/black/png/bubble.png"></div></li><li><div class="ico-calculate" data-url="/files/material/icons/black/png/calculate.png"></div></li><li><div class="ico-calendar" data-url="/files/material/icons/black/png/calendar.png"></div></li><li><div class="ico-calendar2" data-url="/files/material/icons/black/png/calendar2.png"></div></li><li><div class="ico-camera" data-url="/files/material/icons/black/png/camera.png"></div></li><li><div class="ico-camera2" data-url="/files/material/icons/black/png/camera2.png"></div></li><li><div class="ico-cancel" data-url="/files/material/icons/black/png/cancel.png"></div></li><li><div class="ico-cart" data-url="/files/material/icons/black/png/cart.png"></div></li><li><div class="ico-cart2" data-url="/files/material/icons/black/png/cart2.png"></div></li><li><div class="ico-checkmark" data-url="/files/material/icons/black/png/checkmark.png"></div></li><li><div class="ico-clipboard" data-url="/files/material/icons/black/png/clipboard.png"></div></li><li><div class="ico-coffee" data-url="/files/material/icons/black/png/coffee.png"></div></li><li><div class="ico-cog" data-url="/files/material/icons/black/png/cog.png"></div></li><li><div class="ico-cogs" data-url="/files/material/icons/black/png/cogs.png"></div></li><li><div class="ico-compass" data-url="/files/material/icons/black/png/compass.png"></div></li><li><div class="ico-credit" data-url="/files/material/icons/black/png/credit.png"></div></li><li><div class="ico-disk" data-url="/files/material/icons/black/png/disk.png"></div></li><li><div class="ico-earth" data-url="/files/material/icons/black/png/earth.png"></div></li><li><div class="ico-edit" data-url="/files/material/icons/black/png/edit.png"></div></li><li><div class="ico-envelope" data-url="/files/material/icons/black/png/envelope.png"></div></li><li><div class="ico-external-link" data-url="/files/material/icons/black/png/external-link.png"></div></li><li><div class="ico-female" data-url="/files/material/icons/black/png/female.png"></div></li><li><div class="ico-file" data-url="/files/material/icons/black/png/file.png"></div></li><li><div class="ico-file2" data-url="/files/material/icons/black/png/file2.png"></div></li><li><div class="ico-film" data-url="/files/material/icons/black/png/film.png"></div></li><li><div class="ico-folder-open" data-url="/files/material/icons/black/png/folder-open.png"></div></li><li><div class="ico-folder" data-url="/files/material/icons/black/png/folder.png"></div></li><li><div class="ico-food" data-url="/files/material/icons/black/png/food.png"></div></li><li><div class="ico-food2" data-url="/files/material/icons/black/png/food2.png"></div></li><li><div class="ico-gift" data-url="/files/material/icons/black/png/gift.png"></div></li><li><div class="ico-graph" data-url="/files/material/icons/black/png/graph.png"></div></li><li><div class="ico-heart-empty" data-url="/files/material/icons/black/png/heart-empty.png"></div></li><li><div class="ico-heart" data-url="/files/material/icons/black/png/heart.png"></div></li><li><div class="ico-home" data-url="/files/material/icons/black/png/home.png"></div></li><li><div class="ico-image" data-url="/files/material/icons/black/png/image.png"></div></li><li><div class="ico-image2" data-url="/files/material/icons/black/png/image2.png"></div></li><li><div class="ico-info" data-url="/files/material/icons/black/png/info.png"></div></li><li><div class="ico-info2" data-url="/files/material/icons/black/png/info2.png"></div></li><li><div class="ico-ipod" data-url="/files/material/icons/black/png/ipod.png"></div></li><li><div class="ico-lab" data-url="/files/material/icons/black/png/lab.png"></div></li><li><div class="ico-list-alt" data-url="/files/material/icons/black/png/list-alt.png"></div></li><li><div class="ico-location" data-url="/files/material/icons/black/png/location.png"></div></li><li><div class="ico-lock" data-url="/files/material/icons/black/png/lock.png"></div></li><li><div class="ico-male" data-url="/files/material/icons/black/png/male.png"></div></li><li><div class="ico-map" data-url="/files/material/icons/black/png/map.png"></div></li><li><div class="ico-mic" data-url="/files/material/icons/black/png/mic.png"></div></li><li><div class="ico-mobile" data-url="/files/material/icons/black/png/mobile.png"></div></li><li><div class="ico-monitor" data-url="/files/material/icons/black/png/monitor.png"></div></li><li><div class="ico-mug" data-url="/files/material/icons/black/png/mug.png"></div></li><li><div class="ico-music" data-url="/files/material/icons/black/png/music.png"></div></li><li><div class="ico-newspaper" data-url="/files/material/icons/black/png/newspaper.png"></div></li><li><div class="ico-notebook" data-url="/files/material/icons/black/png/notebook.png"></div></li><li><div class="ico-notification" data-url="/files/material/icons/black/png/notification.png"></div></li><li><div class="ico-numbered-list" data-url="/files/material/icons/black/png/numbered-list.png"></div></li><li><div class="ico-office" data-url="/files/material/icons/black/png/office.png"></div></li><li><div class="ico-phone-sign" data-url="/files/material/icons/black/png/phone-sign.png"></div></li><li><div class="ico-phone" data-url="/files/material/icons/black/png/phone.png"></div></li><li><div class="ico-picture" data-url="/files/material/icons/black/png/picture.png"></div></li><li><div class="ico-pie" data-url="/files/material/icons/black/png/pie.png"></div></li><li><div class="ico-play" data-url="/files/material/icons/black/png/play.png"></div></li><li><div class="ico-print" data-url="/files/material/icons/black/png/print.png"></div></li><li><div class="ico-profile" data-url="/files/material/icons/black/png/profile.png"></div></li><li><div class="ico-qrcode" data-url="/files/material/icons/black/png/qrcode.png"></div></li><li><div class="ico-question" data-url="/files/material/icons/black/png/question.png"></div></li><li><div class="ico-quote-left" data-url="/files/material/icons/black/png/quote-left.png"></div></li><li><div class="ico-rss" data-url="/files/material/icons/black/png/rss.png"></div></li><li><div class="ico-screen" data-url="/files/material/icons/black/png/screen.png"></div></li><li><div class="ico-search" data-url="/files/material/icons/black/png/search.png"></div></li><li><div class="ico-signup" data-url="/files/material/icons/black/png/signup.png"></div></li><li><div class="ico-smiley" data-url="/files/material/icons/black/png/smiley.png"></div></li><li><div class="ico-smiley2" data-url="/files/material/icons/black/png/smiley2.png"></div></li><li><div class="ico-star" data-url="/files/material/icons/black/png/star.png"></div></li><li><div class="ico-star2" data-url="/files/material/icons/black/png/star2.png"></div></li><li><div class="ico-star3" data-url="/files/material/icons/black/png/star3.png"></div></li><li><div class="ico-stats" data-url="/files/material/icons/black/png/stats.png"></div></li><li><div class="ico-stats2" data-url="/files/material/icons/black/png/stats2.png"></div></li><li><div class="ico-stopwatch" data-url="/files/material/icons/black/png/stopwatch.png"></div></li><li><div class="ico-support" data-url="/files/material/icons/black/png/support.png"></div></li><li><div class="ico-tag" data-url="/files/material/icons/black/png/tag.png"></div></li><li><div class="ico-target" data-url="/files/material/icons/black/png/target.png"></div></li><li><div class="ico-thumbs-up" data-url="/files/material/icons/black/png/thumbs-up.png"></div></li><li><div class="ico-time" data-url="/files/material/icons/black/png/time.png"></div></li><li><div class="ico-trophy" data-url="/files/material/icons/black/png/trophy.png"></div></li><li><div class="ico-user" data-url="/files/material/icons/black/png/user.png"></div></li><li><div class="ico-user2" data-url="/files/material/icons/black/png/user2.png"></div></li><li><div class="ico-user3" data-url="/files/material/icons/black/png/user3.png"></div></li><li><div class="ico-users" data-url="/files/material/icons/black/png/users.png"></div></li><li><div class="ico-users2" data-url="/files/material/icons/black/png/users2.png"></div></li><li><div class="ico-users3" data-url="/files/material/icons/black/png/users3.png"></div></li><li><div class="ico-volume-down" data-url="/files/material/icons/black/png/volume-down.png"></div></li><li><div class="ico-weibo" data-url="/files/material/icons/black/png/weibo.png"></div></li></ul></div><div id="icons-grey" class="tab-pane"><ul class="iconSelecter-inner icons-grey clearfix"><li><div class="ico-address-book" data-url="/files/material/icons/grey/png/address-book.png"></div></li><li><div class="ico-addressbook" data-url="/files/material/icons/grey/png/addressbook.png"></div></li><li><div class="ico-airplane" data-url="/files/material/icons/grey/png/airplane.png"></div></li><li><div class="ico-apple" data-url="/files/material/icons/grey/png/apple.png"></div></li><li><div class="ico-barcode" data-url="/files/material/icons/grey/png/barcode.png"></div></li><li><div class="ico-bars" data-url="/files/material/icons/grey/png/bars.png"></div></li><li><div class="ico-bars2" data-url="/files/material/icons/grey/png/bars2.png"></div></li><li><div class="ico-book" data-url="/files/material/icons/grey/png/book.png"></div></li><li><div class="ico-bookmark" data-url="/files/material/icons/grey/png/bookmark.png"></div></li><li><div class="ico-bubble" data-url="/files/material/icons/grey/png/bubble.png"></div></li><li><div class="ico-calculate" data-url="/files/material/icons/grey/png/calculate.png"></div></li><li><div class="ico-calendar" data-url="/files/material/icons/grey/png/calendar.png"></div></li><li><div class="ico-calendar2" data-url="/files/material/icons/grey/png/calendar2.png"></div></li><li><div class="ico-camera" data-url="/files/material/icons/grey/png/camera.png"></div></li><li><div class="ico-camera2" data-url="/files/material/icons/grey/png/camera2.png"></div></li><li><div class="ico-cancel" data-url="/files/material/icons/grey/png/cancel.png"></div></li><li><div class="ico-cart" data-url="/files/material/icons/grey/png/cart.png"></div></li><li><div class="ico-cart2" data-url="/files/material/icons/grey/png/cart2.png"></div></li><li><div class="ico-checkmark" data-url="/files/material/icons/grey/png/checkmark.png"></div></li><li><div class="ico-clipboard" data-url="/files/material/icons/grey/png/clipboard.png"></div></li><li><div class="ico-coffee" data-url="/files/material/icons/grey/png/coffee.png"></div></li><li><div class="ico-cog" data-url="/files/material/icons/grey/png/cog.png"></div></li><li><div class="ico-cogs" data-url="/files/material/icons/grey/png/cogs.png"></div></li><li><div class="ico-compass" data-url="/files/material/icons/grey/png/compass.png"></div></li><li><div class="ico-credit" data-url="/files/material/icons/grey/png/credit.png"></div></li><li><div class="ico-disk" data-url="/files/material/icons/grey/png/disk.png"></div></li><li><div class="ico-earth" data-url="/files/material/icons/grey/png/earth.png"></div></li><li><div class="ico-edit" data-url="/files/material/icons/grey/png/edit.png"></div></li><li><div class="ico-envelope" data-url="/files/material/icons/grey/png/envelope.png"></div></li><li><div class="ico-external-link" data-url="/files/material/icons/grey/png/external-link.png"></div></li><li><div class="ico-female" data-url="/files/material/icons/grey/png/female.png"></div></li><li><div class="ico-file" data-url="/files/material/icons/grey/png/file.png"></div></li><li><div class="ico-file2" data-url="/files/material/icons/grey/png/file2.png"></div></li><li><div class="ico-film" data-url="/files/material/icons/grey/png/film.png"></div></li><li><div class="ico-folder-open" data-url="/files/material/icons/grey/png/folder-open.png"></div></li><li><div class="ico-folder" data-url="/files/material/icons/grey/png/folder.png"></div></li><li><div class="ico-food" data-url="/files/material/icons/grey/png/food.png"></div></li><li><div class="ico-food2" data-url="/files/material/icons/grey/png/food2.png"></div></li><li><div class="ico-gift" data-url="/files/material/icons/grey/png/gift.png"></div></li><li><div class="ico-graph" data-url="/files/material/icons/grey/png/graph.png"></div></li><li><div class="ico-heart-empty" data-url="/files/material/icons/grey/png/heart-empty.png"></div></li><li><div class="ico-heart" data-url="/files/material/icons/grey/png/heart.png"></div></li><li><div class="ico-home" data-url="/files/material/icons/grey/png/home.png"></div></li><li><div class="ico-image" data-url="/files/material/icons/grey/png/image.png"></div></li><li><div class="ico-image2" data-url="/files/material/icons/grey/png/image2.png"></div></li><li><div class="ico-info" data-url="/files/material/icons/grey/png/info.png"></div></li><li><div class="ico-info2" data-url="/files/material/icons/grey/png/info2.png"></div></li><li><div class="ico-ipod" data-url="/files/material/icons/grey/png/ipod.png"></div></li><li><div class="ico-lab" data-url="/files/material/icons/grey/png/lab.png"></div></li><li><div class="ico-list-alt" data-url="/files/material/icons/grey/png/list-alt.png"></div></li><li><div class="ico-location" data-url="/files/material/icons/grey/png/location.png"></div></li><li><div class="ico-lock" data-url="/files/material/icons/grey/png/lock.png"></div></li><li><div class="ico-male" data-url="/files/material/icons/grey/png/male.png"></div></li><li><div class="ico-map" data-url="/files/material/icons/grey/png/map.png"></div></li><li><div class="ico-mic" data-url="/files/material/icons/grey/png/mic.png"></div></li><li><div class="ico-mobile" data-url="/files/material/icons/grey/png/mobile.png"></div></li><li><div class="ico-monitor" data-url="/files/material/icons/grey/png/monitor.png"></div></li><li><div class="ico-mug" data-url="/files/material/icons/grey/png/mug.png"></div></li><li><div class="ico-music" data-url="/files/material/icons/grey/png/music.png"></div></li><li><div class="ico-newspaper" data-url="/files/material/icons/grey/png/newspaper.png"></div></li><li><div class="ico-notebook" data-url="/files/material/icons/grey/png/notebook.png"></div></li><li><div class="ico-notification" data-url="/files/material/icons/grey/png/notification.png"></div></li><li><div class="ico-numbered-list" data-url="/files/material/icons/grey/png/numbered-list.png"></div></li><li><div class="ico-office" data-url="/files/material/icons/grey/png/office.png"></div></li><li><div class="ico-phone-sign" data-url="/files/material/icons/grey/png/phone-sign.png"></div></li><li><div class="ico-phone" data-url="/files/material/icons/grey/png/phone.png"></div></li><li><div class="ico-picture" data-url="/files/material/icons/grey/png/picture.png"></div></li><li><div class="ico-pie" data-url="/files/material/icons/grey/png/pie.png"></div></li><li><div class="ico-play" data-url="/files/material/icons/grey/png/play.png"></div></li><li><div class="ico-print" data-url="/files/material/icons/grey/png/print.png"></div></li><li><div class="ico-profile" data-url="/files/material/icons/grey/png/profile.png"></div></li><li><div class="ico-qrcode" data-url="/files/material/icons/grey/png/qrcode.png"></div></li><li><div class="ico-question" data-url="/files/material/icons/grey/png/question.png"></div></li><li><div class="ico-quote-left" data-url="/files/material/icons/grey/png/quote-left.png"></div></li><li><div class="ico-rss" data-url="/files/material/icons/grey/png/rss.png"></div></li><li><div class="ico-screen" data-url="/files/material/icons/grey/png/screen.png"></div></li><li><div class="ico-search" data-url="/files/material/icons/grey/png/search.png"></div></li><li><div class="ico-signup" data-url="/files/material/icons/grey/png/signup.png"></div></li><li><div class="ico-smiley" data-url="/files/material/icons/grey/png/smiley.png"></div></li><li><div class="ico-smiley2" data-url="/files/material/icons/grey/png/smiley2.png"></div></li><li><div class="ico-star" data-url="/files/material/icons/grey/png/star.png"></div></li><li><div class="ico-star2" data-url="/files/material/icons/grey/png/star2.png"></div></li><li><div class="ico-star3" data-url="/files/material/icons/grey/png/star3.png"></div></li><li><div class="ico-stats" data-url="/files/material/icons/grey/png/stats.png"></div></li><li><div class="ico-stats2" data-url="/files/material/icons/grey/png/stats2.png"></div></li><li><div class="ico-stopwatch" data-url="/files/material/icons/grey/png/stopwatch.png"></div></li><li><div class="ico-support" data-url="/files/material/icons/grey/png/support.png"></div></li><li><div class="ico-tag" data-url="/files/material/icons/grey/png/tag.png"></div></li><li><div class="ico-target" data-url="/files/material/icons/grey/png/target.png"></div></li><li><div class="ico-thumbs-up" data-url="/files/material/icons/grey/png/thumbs-up.png"></div></li><li><div class="ico-time" data-url="/files/material/icons/grey/png/time.png"></div></li><li><div class="ico-trophy" data-url="/files/material/icons/grey/png/trophy.png"></div></li><li><div class="ico-user" data-url="/files/material/icons/grey/png/user.png"></div></li><li><div class="ico-user2" data-url="/files/material/icons/grey/png/user2.png"></div></li><li><div class="ico-user3" data-url="/files/material/icons/grey/png/user3.png"></div></li><li><div class="ico-users" data-url="/files/material/icons/grey/png/users.png"></div></li><li><div class="ico-users2" data-url="/files/material/icons/grey/png/users2.png"></div></li><li><div class="ico-users3" data-url="/files/material/icons/grey/png/users3.png"></div></li><li><div class="ico-volume-down" data-url="/files/material/icons/grey/png/volume-down.png"></div></li><li><div class="ico-weibo" data-url="/files/material/icons/grey/png/weibo.png"></div></li></ul></div><div id="icons-white" class="tab-pane"><ul class="iconSelecter-inner icons-white clearfix"><li><div class="ico-address-book" data-url="/files/material/icons/white/png/address-book.png"></div></li><li><div class="ico-addressbook" data-url="/files/material/icons/white/png/addressbook.png"></div></li><li><div class="ico-airplane" data-url="/files/material/icons/white/png/airplane.png"></div></li><li><div class="ico-apple" data-url="/files/material/icons/white/png/apple.png"></div></li><li><div class="ico-barcode" data-url="/files/material/icons/white/png/barcode.png"></div></li><li><div class="ico-bars" data-url="/files/material/icons/white/png/bars.png"></div></li><li><div class="ico-bars2" data-url="/files/material/icons/white/png/bars2.png"></div></li><li><div class="ico-book" data-url="/files/material/icons/white/png/book.png"></div></li><li><div class="ico-bookmark" data-url="/files/material/icons/white/png/bookmark.png"></div></li><li><div class="ico-bubble" data-url="/files/material/icons/white/png/bubble.png"></div></li><li><div class="ico-calculate" data-url="/files/material/icons/white/png/calculate.png"></div></li><li><div class="ico-calendar" data-url="/files/material/icons/white/png/calendar.png"></div></li><li><div class="ico-calendar2" data-url="/files/material/icons/white/png/calendar2.png"></div></li><li><div class="ico-camera" data-url="/files/material/icons/white/png/camera.png"></div></li><li><div class="ico-camera2" data-url="/files/material/icons/white/png/camera2.png"></div></li><li><div class="ico-cancel" data-url="/files/material/icons/white/png/cancel.png"></div></li><li><div class="ico-cart" data-url="/files/material/icons/white/png/cart.png"></div></li><li><div class="ico-cart2" data-url="/files/material/icons/white/png/cart2.png"></div></li><li><div class="ico-checkmark" data-url="/files/material/icons/white/png/checkmark.png"></div></li><li><div class="ico-clipboard" data-url="/files/material/icons/white/png/clipboard.png"></div></li><li><div class="ico-coffee" data-url="/files/material/icons/white/png/coffee.png"></div></li><li><div class="ico-cog" data-url="/files/material/icons/white/png/cog.png"></div></li><li><div class="ico-cogs" data-url="/files/material/icons/white/png/cogs.png"></div></li><li><div class="ico-compass" data-url="/files/material/icons/white/png/compass.png"></div></li><li><div class="ico-credit" data-url="/files/material/icons/white/png/credit.png"></div></li><li><div class="ico-disk" data-url="/files/material/icons/white/png/disk.png"></div></li><li><div class="ico-earth" data-url="/files/material/icons/white/png/earth.png"></div></li><li><div class="ico-edit" data-url="/files/material/icons/white/png/edit.png"></div></li><li><div class="ico-envelope" data-url="/files/material/icons/white/png/envelope.png"></div></li><li><div class="ico-external-link" data-url="/files/material/icons/white/png/external-link.png"></div></li><li><div class="ico-female" data-url="/files/material/icons/white/png/female.png"></div></li><li><div class="ico-file" data-url="/files/material/icons/white/png/file.png"></div></li><li><div class="ico-file2" data-url="/files/material/icons/white/png/file2.png"></div></li><li><div class="ico-film" data-url="/files/material/icons/white/png/film.png"></div></li><li><div class="ico-folder-open" data-url="/files/material/icons/white/png/folder-open.png"></div></li><li><div class="ico-folder" data-url="/files/material/icons/white/png/folder.png"></div></li><li><div class="ico-food" data-url="/files/material/icons/white/png/food.png"></div></li><li><div class="ico-food2" data-url="/files/material/icons/white/png/food2.png"></div></li><li><div class="ico-gift" data-url="/files/material/icons/white/png/gift.png"></div></li><li><div class="ico-graph" data-url="/files/material/icons/white/png/graph.png"></div></li><li><div class="ico-heart-empty" data-url="/files/material/icons/white/png/heart-empty.png"></div></li><li><div class="ico-heart" data-url="/files/material/icons/white/png/heart.png"></div></li><li><div class="ico-home" data-url="/files/material/icons/white/png/home.png"></div></li><li><div class="ico-image" data-url="/files/material/icons/white/png/image.png"></div></li><li><div class="ico-image2" data-url="/files/material/icons/white/png/image2.png"></div></li><li><div class="ico-info" data-url="/files/material/icons/white/png/info.png"></div></li><li><div class="ico-info2" data-url="/files/material/icons/white/png/info2.png"></div></li><li><div class="ico-ipod" data-url="/files/material/icons/white/png/ipod.png"></div></li><li><div class="ico-lab" data-url="/files/material/icons/white/png/lab.png"></div></li><li><div class="ico-list-alt" data-url="/files/material/icons/white/png/list-alt.png"></div></li><li><div class="ico-location" data-url="/files/material/icons/white/png/location.png"></div></li><li><div class="ico-lock" data-url="/files/material/icons/white/png/lock.png"></div></li><li><div class="ico-male" data-url="/files/material/icons/white/png/male.png"></div></li><li><div class="ico-map" data-url="/files/material/icons/white/png/map.png"></div></li><li><div class="ico-mic" data-url="/files/material/icons/white/png/mic.png"></div></li><li><div class="ico-mobile" data-url="/files/material/icons/white/png/mobile.png"></div></li><li><div class="ico-monitor" data-url="/files/material/icons/white/png/monitor.png"></div></li><li><div class="ico-mug" data-url="/files/material/icons/white/png/mug.png"></div></li><li><div class="ico-music" data-url="/files/material/icons/white/png/music.png"></div></li><li><div class="ico-newspaper" data-url="/files/material/icons/white/png/newspaper.png"></div></li><li><div class="ico-notebook" data-url="/files/material/icons/white/png/notebook.png"></div></li><li><div class="ico-notification" data-url="/files/material/icons/white/png/notification.png"></div></li><li><div class="ico-numbered-list" data-url="/files/material/icons/white/png/numbered-list.png"></div></li><li><div class="ico-office" data-url="/files/material/icons/white/png/office.png"></div></li><li><div class="ico-phone-sign" data-url="/files/material/icons/white/png/phone-sign.png"></div></li><li><div class="ico-phone" data-url="/files/material/icons/white/png/phone.png"></div></li><li><div class="ico-picture" data-url="/files/material/icons/white/png/picture.png"></div></li><li><div class="ico-pie" data-url="/files/material/icons/white/png/pie.png"></div></li><li><div class="ico-play" data-url="/files/material/icons/white/png/play.png"></div></li><li><div class="ico-print" data-url="/files/material/icons/white/png/print.png"></div></li><li><div class="ico-profile" data-url="/files/material/icons/white/png/profile.png"></div></li><li><div class="ico-qrcode" data-url="/files/material/icons/white/png/qrcode.png"></div></li><li><div class="ico-question" data-url="/files/material/icons/white/png/question.png"></div></li><li><div class="ico-quote-left" data-url="/files/material/icons/white/png/quote-left.png"></div></li><li><div class="ico-rss" data-url="/files/material/icons/white/png/rss.png"></div></li><li><div class="ico-screen" data-url="/files/material/icons/white/png/screen.png"></div></li><li><div class="ico-search" data-url="/files/material/icons/white/png/search.png"></div></li><li><div class="ico-signup" data-url="/files/material/icons/white/png/signup.png"></div></li><li><div class="ico-smiley" data-url="/files/material/icons/white/png/smiley.png"></div></li><li><div class="ico-smiley2" data-url="/files/material/icons/white/png/smiley2.png"></div></li><li><div class="ico-star" data-url="/files/material/icons/white/png/star.png"></div></li><li><div class="ico-star2" data-url="/files/material/icons/white/png/star2.png"></div></li><li><div class="ico-star3" data-url="/files/material/icons/white/png/star3.png"></div></li><li><div class="ico-stats" data-url="/files/material/icons/white/png/stats.png"></div></li><li><div class="ico-stats2" data-url="/files/material/icons/white/png/stats2.png"></div></li><li><div class="ico-stopwatch" data-url="/files/material/icons/white/png/stopwatch.png"></div></li><li><div class="ico-support" data-url="/files/material/icons/white/png/support.png"></div></li><li><div class="ico-tag" data-url="/files/material/icons/white/png/tag.png"></div></li><li><div class="ico-target" data-url="/files/material/icons/white/png/target.png"></div></li><li><div class="ico-thumbs-up" data-url="/files/material/icons/white/png/thumbs-up.png"></div></li><li><div class="ico-time" data-url="/files/material/icons/white/png/time.png"></div></li><li><div class="ico-trophy" data-url="/files/material/icons/white/png/trophy.png"></div></li><li><div class="ico-user" data-url="/files/material/icons/white/png/user.png"></div></li><li><div class="ico-user2" data-url="/files/material/icons/white/png/user2.png"></div></li><li><div class="ico-user3" data-url="/files/material/icons/white/png/user3.png"></div></li><li><div class="ico-users" data-url="/files/material/icons/white/png/users.png"></div></li><li><div class="ico-users2" data-url="/files/material/icons/white/png/users2.png"></div></li><li><div class="ico-users3" data-url="/files/material/icons/white/png/users3.png"></div></li><li><div class="ico-volume-down" data-url="/files/material/icons/white/png/volume-down.png"></div></li><li><div class="ico-weibo" data-url="/files/material/icons/white/png/weibo.png"></div></li></ul></div><div id="icons-red" class="tab-pane"><ul class="iconSelecter-inner icons-red clearfix"><li><div class="ico-address-book" data-url="/files/material/icons/red/png/address-book.png"></div></li><li><div class="ico-addressbook" data-url="/files/material/icons/red/png/addressbook.png"></div></li><li><div class="ico-airplane" data-url="/files/material/icons/red/png/airplane.png"></div></li><li><div class="ico-apple" data-url="/files/material/icons/red/png/apple.png"></div></li><li><div class="ico-barcode" data-url="/files/material/icons/red/png/barcode.png"></div></li><li><div class="ico-bars" data-url="/files/material/icons/red/png/bars.png"></div></li><li><div class="ico-bars2" data-url="/files/material/icons/red/png/bars2.png"></div></li><li><div class="ico-book" data-url="/files/material/icons/red/png/book.png"></div></li><li><div class="ico-bookmark" data-url="/files/material/icons/red/png/bookmark.png"></div></li><li><div class="ico-bubble" data-url="/files/material/icons/red/png/bubble.png"></div></li><li><div class="ico-calculate" data-url="/files/material/icons/red/png/calculate.png"></div></li><li><div class="ico-calendar" data-url="/files/material/icons/red/png/calendar.png"></div></li><li><div class="ico-calendar2" data-url="/files/material/icons/red/png/calendar2.png"></div></li><li><div class="ico-camera" data-url="/files/material/icons/red/png/camera.png"></div></li><li><div class="ico-camera2" data-url="/files/material/icons/red/png/camera2.png"></div></li><li><div class="ico-cancel" data-url="/files/material/icons/red/png/cancel.png"></div></li><li><div class="ico-cart" data-url="/files/material/icons/red/png/cart.png"></div></li><li><div class="ico-cart2" data-url="/files/material/icons/red/png/cart2.png"></div></li><li><div class="ico-checkmark" data-url="/files/material/icons/red/png/checkmark.png"></div></li><li><div class="ico-clipboard" data-url="/files/material/icons/red/png/clipboard.png"></div></li><li><div class="ico-coffee" data-url="/files/material/icons/red/png/coffee.png"></div></li><li><div class="ico-cog" data-url="/files/material/icons/red/png/cog.png"></div></li><li><div class="ico-cogs" data-url="/files/material/icons/red/png/cogs.png"></div></li><li><div class="ico-compass" data-url="/files/material/icons/red/png/compass.png"></div></li><li><div class="ico-credit" data-url="/files/material/icons/red/png/credit.png"></div></li><li><div class="ico-disk" data-url="/files/material/icons/red/png/disk.png"></div></li><li><div class="ico-earth" data-url="/files/material/icons/red/png/earth.png"></div></li><li><div class="ico-edit" data-url="/files/material/icons/red/png/edit.png"></div></li><li><div class="ico-envelope" data-url="/files/material/icons/red/png/envelope.png"></div></li><li><div class="ico-external-link" data-url="/files/material/icons/red/png/external-link.png"></div></li><li><div class="ico-female" data-url="/files/material/icons/red/png/female.png"></div></li><li><div class="ico-file" data-url="/files/material/icons/red/png/file.png"></div></li><li><div class="ico-file2" data-url="/files/material/icons/red/png/file2.png"></div></li><li><div class="ico-film" data-url="/files/material/icons/red/png/film.png"></div></li><li><div class="ico-folder-open" data-url="/files/material/icons/red/png/folder-open.png"></div></li><li><div class="ico-folder" data-url="/files/material/icons/red/png/folder.png"></div></li><li><div class="ico-food" data-url="/files/material/icons/red/png/food.png"></div></li><li><div class="ico-food2" data-url="/files/material/icons/red/png/food2.png"></div></li><li><div class="ico-gift" data-url="/files/material/icons/red/png/gift.png"></div></li><li><div class="ico-graph" data-url="/files/material/icons/red/png/graph.png"></div></li><li><div class="ico-heart-empty" data-url="/files/material/icons/red/png/heart-empty.png"></div></li><li><div class="ico-heart" data-url="/files/material/icons/red/png/heart.png"></div></li><li><div class="ico-home" data-url="/files/material/icons/red/png/home.png"></div></li><li><div class="ico-image" data-url="/files/material/icons/red/png/image.png"></div></li><li><div class="ico-image2" data-url="/files/material/icons/red/png/image2.png"></div></li><li><div class="ico-info" data-url="/files/material/icons/red/png/info.png"></div></li><li><div class="ico-info2" data-url="/files/material/icons/red/png/info2.png"></div></li><li><div class="ico-ipod" data-url="/files/material/icons/red/png/ipod.png"></div></li><li><div class="ico-lab" data-url="/files/material/icons/red/png/lab.png"></div></li><li><div class="ico-list-alt" data-url="/files/material/icons/red/png/list-alt.png"></div></li><li><div class="ico-location" data-url="/files/material/icons/red/png/location.png"></div></li><li><div class="ico-lock" data-url="/files/material/icons/red/png/lock.png"></div></li><li><div class="ico-male" data-url="/files/material/icons/red/png/male.png"></div></li><li><div class="ico-map" data-url="/files/material/icons/red/png/map.png"></div></li><li><div class="ico-mic" data-url="/files/material/icons/red/png/mic.png"></div></li><li><div class="ico-mobile" data-url="/files/material/icons/red/png/mobile.png"></div></li><li><div class="ico-monitor" data-url="/files/material/icons/red/png/monitor.png"></div></li><li><div class="ico-mug" data-url="/files/material/icons/red/png/mug.png"></div></li><li><div class="ico-music" data-url="/files/material/icons/red/png/music.png"></div></li><li><div class="ico-newspaper" data-url="/files/material/icons/red/png/newspaper.png"></div></li><li><div class="ico-notebook" data-url="/files/material/icons/red/png/notebook.png"></div></li><li><div class="ico-notification" data-url="/files/material/icons/red/png/notification.png"></div></li><li><div class="ico-numbered-list" data-url="/files/material/icons/red/png/numbered-list.png"></div></li><li><div class="ico-office" data-url="/files/material/icons/red/png/office.png"></div></li><li><div class="ico-phone-sign" data-url="/files/material/icons/red/png/phone-sign.png"></div></li><li><div class="ico-phone" data-url="/files/material/icons/red/png/phone.png"></div></li><li><div class="ico-picture" data-url="/files/material/icons/red/png/picture.png"></div></li><li><div class="ico-pie" data-url="/files/material/icons/red/png/pie.png"></div></li><li><div class="ico-play" data-url="/files/material/icons/red/png/play.png"></div></li><li><div class="ico-print" data-url="/files/material/icons/red/png/print.png"></div></li><li><div class="ico-profile" data-url="/files/material/icons/red/png/profile.png"></div></li><li><div class="ico-qrcode" data-url="/files/material/icons/red/png/qrcode.png"></div></li><li><div class="ico-question" data-url="/files/material/icons/red/png/question.png"></div></li><li><div class="ico-quote-left" data-url="/files/material/icons/red/png/quote-left.png"></div></li><li><div class="ico-rss" data-url="/files/material/icons/red/png/rss.png"></div></li><li><div class="ico-screen" data-url="/files/material/icons/red/png/screen.png"></div></li><li><div class="ico-search" data-url="/files/material/icons/red/png/search.png"></div></li><li><div class="ico-signup" data-url="/files/material/icons/red/png/signup.png"></div></li><li><div class="ico-smiley" data-url="/files/material/icons/red/png/smiley.png"></div></li><li><div class="ico-smiley2" data-url="/files/material/icons/red/png/smiley2.png"></div></li><li><div class="ico-star" data-url="/files/material/icons/red/png/star.png"></div></li><li><div class="ico-star2" data-url="/files/material/icons/red/png/star2.png"></div></li><li><div class="ico-star3" data-url="/files/material/icons/red/png/star3.png"></div></li><li><div class="ico-stats" data-url="/files/material/icons/red/png/stats.png"></div></li><li><div class="ico-stats2" data-url="/files/material/icons/red/png/stats2.png"></div></li><li><div class="ico-stopwatch" data-url="/files/material/icons/red/png/stopwatch.png"></div></li><li><div class="ico-support" data-url="/files/material/icons/red/png/support.png"></div></li><li><div class="ico-tag" data-url="/files/material/icons/red/png/tag.png"></div></li><li><div class="ico-target" data-url="/files/material/icons/red/png/target.png"></div></li><li><div class="ico-thumbs-up" data-url="/files/material/icons/red/png/thumbs-up.png"></div></li><li><div class="ico-time" data-url="/files/material/icons/red/png/time.png"></div></li><li><div class="ico-trophy" data-url="/files/material/icons/red/png/trophy.png"></div></li><li><div class="ico-user" data-url="/files/material/icons/red/png/user.png"></div></li><li><div class="ico-user2" data-url="/files/material/icons/red/png/user2.png"></div></li><li><div class="ico-user3" data-url="/files/material/icons/red/png/user3.png"></div></li><li><div class="ico-users" data-url="/files/material/icons/red/png/users.png"></div></li><li><div class="ico-users2" data-url="/files/material/icons/red/png/users2.png"></div></li><li><div class="ico-users3" data-url="/files/material/icons/red/png/users3.png"></div></li><li><div class="ico-volume-down" data-url="/files/material/icons/red/png/volume-down.png"></div></li><li><div class="ico-weibo" data-url="/files/material/icons/red/png/weibo.png"></div></li></ul></div><div id="icons-yellow" class="tab-pane"><ul class="iconSelecter-inner icons-yellow clearfix"><li><div class="ico-address-book" data-url="/files/material/icons/yellow/png/address-book.png"></div></li><li><div class="ico-addressbook" data-url="/files/material/icons/yellow/png/addressbook.png"></div></li><li><div class="ico-airplane" data-url="/files/material/icons/yellow/png/airplane.png"></div></li><li><div class="ico-apple" data-url="/files/material/icons/yellow/png/apple.png"></div></li><li><div class="ico-barcode" data-url="/files/material/icons/yellow/png/barcode.png"></div></li><li><div class="ico-bars" data-url="/files/material/icons/yellow/png/bars.png"></div></li><li><div class="ico-bars2" data-url="/files/material/icons/yellow/png/bars2.png"></div></li><li><div class="ico-book" data-url="/files/material/icons/yellow/png/book.png"></div></li><li><div class="ico-bookmark" data-url="/files/material/icons/yellow/png/bookmark.png"></div></li><li><div class="ico-bubble" data-url="/files/material/icons/yellow/png/bubble.png"></div></li><li><div class="ico-calculate" data-url="/files/material/icons/yellow/png/calculate.png"></div></li><li><div class="ico-calendar" data-url="/files/material/icons/yellow/png/calendar.png"></div></li><li><div class="ico-calendar2" data-url="/files/material/icons/yellow/png/calendar2.png"></div></li><li><div class="ico-camera" data-url="/files/material/icons/yellow/png/camera.png"></div></li><li><div class="ico-camera2" data-url="/files/material/icons/yellow/png/camera2.png"></div></li><li><div class="ico-cancel" data-url="/files/material/icons/yellow/png/cancel.png"></div></li><li><div class="ico-cart" data-url="/files/material/icons/yellow/png/cart.png"></div></li><li><div class="ico-cart2" data-url="/files/material/icons/yellow/png/cart2.png"></div></li><li><div class="ico-checkmark" data-url="/files/material/icons/yellow/png/checkmark.png"></div></li><li><div class="ico-clipboard" data-url="/files/material/icons/yellow/png/clipboard.png"></div></li><li><div class="ico-coffee" data-url="/files/material/icons/yellow/png/coffee.png"></div></li><li><div class="ico-cog" data-url="/files/material/icons/yellow/png/cog.png"></div></li><li><div class="ico-cogs" data-url="/files/material/icons/yellow/png/cogs.png"></div></li><li><div class="ico-compass" data-url="/files/material/icons/yellow/png/compass.png"></div></li><li><div class="ico-credit" data-url="/files/material/icons/yellow/png/credit.png"></div></li><li><div class="ico-disk" data-url="/files/material/icons/yellow/png/disk.png"></div></li><li><div class="ico-earth" data-url="/files/material/icons/yellow/png/earth.png"></div></li><li><div class="ico-edit" data-url="/files/material/icons/yellow/png/edit.png"></div></li><li><div class="ico-envelope" data-url="/files/material/icons/yellow/png/envelope.png"></div></li><li><div class="ico-external-link" data-url="/files/material/icons/yellow/png/external-link.png"></div></li><li><div class="ico-female" data-url="/files/material/icons/yellow/png/female.png"></div></li><li><div class="ico-file" data-url="/files/material/icons/yellow/png/file.png"></div></li><li><div class="ico-file2" data-url="/files/material/icons/yellow/png/file2.png"></div></li><li><div class="ico-film" data-url="/files/material/icons/yellow/png/film.png"></div></li><li><div class="ico-folder-open" data-url="/files/material/icons/yellow/png/folder-open.png"></div></li><li><div class="ico-folder" data-url="/files/material/icons/yellow/png/folder.png"></div></li><li><div class="ico-food" data-url="/files/material/icons/yellow/png/food.png"></div></li><li><div class="ico-food2" data-url="/files/material/icons/yellow/png/food2.png"></div></li><li><div class="ico-gift" data-url="/files/material/icons/yellow/png/gift.png"></div></li><li><div class="ico-graph" data-url="/files/material/icons/yellow/png/graph.png"></div></li><li><div class="ico-heart-empty" data-url="/files/material/icons/yellow/png/heart-empty.png"></div></li><li><div class="ico-heart" data-url="/files/material/icons/yellow/png/heart.png"></div></li><li><div class="ico-home" data-url="/files/material/icons/yellow/png/home.png"></div></li><li><div class="ico-image" data-url="/files/material/icons/yellow/png/image.png"></div></li><li><div class="ico-image2" data-url="/files/material/icons/yellow/png/image2.png"></div></li><li><div class="ico-info" data-url="/files/material/icons/yellow/png/info.png"></div></li><li><div class="ico-info2" data-url="/files/material/icons/yellow/png/info2.png"></div></li><li><div class="ico-ipod" data-url="/files/material/icons/yellow/png/ipod.png"></div></li><li><div class="ico-lab" data-url="/files/material/icons/yellow/png/lab.png"></div></li><li><div class="ico-list-alt" data-url="/files/material/icons/yellow/png/list-alt.png"></div></li><li><div class="ico-location" data-url="/files/material/icons/yellow/png/location.png"></div></li><li><div class="ico-lock" data-url="/files/material/icons/yellow/png/lock.png"></div></li><li><div class="ico-male" data-url="/files/material/icons/yellow/png/male.png"></div></li><li><div class="ico-map" data-url="/files/material/icons/yellow/png/map.png"></div></li><li><div class="ico-mic" data-url="/files/material/icons/yellow/png/mic.png"></div></li><li><div class="ico-mobile" data-url="/files/material/icons/yellow/png/mobile.png"></div></li><li><div class="ico-monitor" data-url="/files/material/icons/yellow/png/monitor.png"></div></li><li><div class="ico-mug" data-url="/files/material/icons/yellow/png/mug.png"></div></li><li><div class="ico-music" data-url="/files/material/icons/yellow/png/music.png"></div></li><li><div class="ico-newspaper" data-url="/files/material/icons/yellow/png/newspaper.png"></div></li><li><div class="ico-notebook" data-url="/files/material/icons/yellow/png/notebook.png"></div></li><li><div class="ico-notification" data-url="/files/material/icons/yellow/png/notification.png"></div></li><li><div class="ico-numbered-list" data-url="/files/material/icons/yellow/png/numbered-list.png"></div></li><li><div class="ico-office" data-url="/files/material/icons/yellow/png/office.png"></div></li><li><div class="ico-phone-sign" data-url="/files/material/icons/yellow/png/phone-sign.png"></div></li><li><div class="ico-phone" data-url="/files/material/icons/yellow/png/phone.png"></div></li><li><div class="ico-picture" data-url="/files/material/icons/yellow/png/picture.png"></div></li><li><div class="ico-pie" data-url="/files/material/icons/yellow/png/pie.png"></div></li><li><div class="ico-play" data-url="/files/material/icons/yellow/png/play.png"></div></li><li><div class="ico-print" data-url="/files/material/icons/yellow/png/print.png"></div></li><li><div class="ico-profile" data-url="/files/material/icons/yellow/png/profile.png"></div></li><li><div class="ico-qrcode" data-url="/files/material/icons/yellow/png/qrcode.png"></div></li><li><div class="ico-question" data-url="/files/material/icons/yellow/png/question.png"></div></li><li><div class="ico-quote-left" data-url="/files/material/icons/yellow/png/quote-left.png"></div></li><li><div class="ico-rss" data-url="/files/material/icons/yellow/png/rss.png"></div></li><li><div class="ico-screen" data-url="/files/material/icons/yellow/png/screen.png"></div></li><li><div class="ico-search" data-url="/files/material/icons/yellow/png/search.png"></div></li><li><div class="ico-signup" data-url="/files/material/icons/yellow/png/signup.png"></div></li><li><div class="ico-smiley" data-url="/files/material/icons/yellow/png/smiley.png"></div></li><li><div class="ico-smiley2" data-url="/files/material/icons/yellow/png/smiley2.png"></div></li><li><div class="ico-star" data-url="/files/material/icons/yellow/png/star.png"></div></li><li><div class="ico-star2" data-url="/files/material/icons/yellow/png/star2.png"></div></li><li><div class="ico-star3" data-url="/files/material/icons/yellow/png/star3.png"></div></li><li><div class="ico-stats" data-url="/files/material/icons/yellow/png/stats.png"></div></li><li><div class="ico-stats2" data-url="/files/material/icons/yellow/png/stats2.png"></div></li><li><div class="ico-stopwatch" data-url="/files/material/icons/yellow/png/stopwatch.png"></div></li><li><div class="ico-support" data-url="/files/material/icons/yellow/png/support.png"></div></li><li><div class="ico-tag" data-url="/files/material/icons/yellow/png/tag.png"></div></li><li><div class="ico-target" data-url="/files/material/icons/yellow/png/target.png"></div></li><li><div class="ico-thumbs-up" data-url="/files/material/icons/yellow/png/thumbs-up.png"></div></li><li><div class="ico-time" data-url="/files/material/icons/yellow/png/time.png"></div></li><li><div class="ico-trophy" data-url="/files/material/icons/yellow/png/trophy.png"></div></li><li><div class="ico-user" data-url="/files/material/icons/yellow/png/user.png"></div></li><li><div class="ico-user2" data-url="/files/material/icons/yellow/png/user2.png"></div></li><li><div class="ico-user3" data-url="/files/material/icons/yellow/png/user3.png"></div></li><li><div class="ico-users" data-url="/files/material/icons/yellow/png/users.png"></div></li><li><div class="ico-users2" data-url="/files/material/icons/yellow/png/users2.png"></div></li><li><div class="ico-users3" data-url="/files/material/icons/yellow/png/users3.png"></div></li><li><div class="ico-volume-down" data-url="/files/material/icons/yellow/png/volume-down.png"></div></li><li><div class="ico-weibo" data-url="/files/material/icons/yellow/png/weibo.png"></div></li></ul></div><div id="icons-green" class="tab-pane"><ul class="iconSelecter-inner icons-green clearfix"><li><div class="ico-address-book" data-url="/files/material/icons/green/png/address-book.png"></div></li><li><div class="ico-addressbook" data-url="/files/material/icons/green/png/addressbook.png"></div></li><li><div class="ico-airplane" data-url="/files/material/icons/green/png/airplane.png"></div></li><li><div class="ico-apple" data-url="/files/material/icons/green/png/apple.png"></div></li><li><div class="ico-barcode" data-url="/files/material/icons/green/png/barcode.png"></div></li><li><div class="ico-bars" data-url="/files/material/icons/green/png/bars.png"></div></li><li><div class="ico-bars2" data-url="/files/material/icons/green/png/bars2.png"></div></li><li><div class="ico-book" data-url="/files/material/icons/green/png/book.png"></div></li><li><div class="ico-bookmark" data-url="/files/material/icons/green/png/bookmark.png"></div></li><li><div class="ico-bubble" data-url="/files/material/icons/green/png/bubble.png"></div></li><li><div class="ico-calculate" data-url="/files/material/icons/green/png/calculate.png"></div></li><li><div class="ico-calendar" data-url="/files/material/icons/green/png/calendar.png"></div></li><li><div class="ico-calendar2" data-url="/files/material/icons/green/png/calendar2.png"></div></li><li><div class="ico-camera" data-url="/files/material/icons/green/png/camera.png"></div></li><li><div class="ico-camera2" data-url="/files/material/icons/green/png/camera2.png"></div></li><li><div class="ico-cancel" data-url="/files/material/icons/green/png/cancel.png"></div></li><li><div class="ico-cart" data-url="/files/material/icons/green/png/cart.png"></div></li><li><div class="ico-cart2" data-url="/files/material/icons/green/png/cart2.png"></div></li><li><div class="ico-checkmark" data-url="/files/material/icons/green/png/checkmark.png"></div></li><li><div class="ico-clipboard" data-url="/files/material/icons/green/png/clipboard.png"></div></li><li><div class="ico-coffee" data-url="/files/material/icons/green/png/coffee.png"></div></li><li><div class="ico-cog" data-url="/files/material/icons/green/png/cog.png"></div></li><li><div class="ico-cogs" data-url="/files/material/icons/green/png/cogs.png"></div></li><li><div class="ico-compass" data-url="/files/material/icons/green/png/compass.png"></div></li><li><div class="ico-credit" data-url="/files/material/icons/green/png/credit.png"></div></li><li><div class="ico-disk" data-url="/files/material/icons/green/png/disk.png"></div></li><li><div class="ico-earth" data-url="/files/material/icons/green/png/earth.png"></div></li><li><div class="ico-edit" data-url="/files/material/icons/green/png/edit.png"></div></li><li><div class="ico-envelope" data-url="/files/material/icons/green/png/envelope.png"></div></li><li><div class="ico-external-link" data-url="/files/material/icons/green/png/external-link.png"></div></li><li><div class="ico-female" data-url="/files/material/icons/green/png/female.png"></div></li><li><div class="ico-file" data-url="/files/material/icons/green/png/file.png"></div></li><li><div class="ico-file2" data-url="/files/material/icons/green/png/file2.png"></div></li><li><div class="ico-film" data-url="/files/material/icons/green/png/film.png"></div></li><li><div class="ico-folder-open" data-url="/files/material/icons/green/png/folder-open.png"></div></li><li><div class="ico-folder" data-url="/files/material/icons/green/png/folder.png"></div></li><li><div class="ico-food" data-url="/files/material/icons/green/png/food.png"></div></li><li><div class="ico-food2" data-url="/files/material/icons/green/png/food2.png"></div></li><li><div class="ico-gift" data-url="/files/material/icons/green/png/gift.png"></div></li><li><div class="ico-graph" data-url="/files/material/icons/green/png/graph.png"></div></li><li><div class="ico-heart-empty" data-url="/files/material/icons/green/png/heart-empty.png"></div></li><li><div class="ico-heart" data-url="/files/material/icons/green/png/heart.png"></div></li><li><div class="ico-home" data-url="/files/material/icons/green/png/home.png"></div></li><li><div class="ico-image" data-url="/files/material/icons/green/png/image.png"></div></li><li><div class="ico-image2" data-url="/files/material/icons/green/png/image2.png"></div></li><li><div class="ico-info" data-url="/files/material/icons/green/png/info.png"></div></li><li><div class="ico-info2" data-url="/files/material/icons/green/png/info2.png"></div></li><li><div class="ico-ipod" data-url="/files/material/icons/green/png/ipod.png"></div></li><li><div class="ico-lab" data-url="/files/material/icons/green/png/lab.png"></div></li><li><div class="ico-list-alt" data-url="/files/material/icons/green/png/list-alt.png"></div></li><li><div class="ico-location" data-url="/files/material/icons/green/png/location.png"></div></li><li><div class="ico-lock" data-url="/files/material/icons/green/png/lock.png"></div></li><li><div class="ico-male" data-url="/files/material/icons/green/png/male.png"></div></li><li><div class="ico-map" data-url="/files/material/icons/green/png/map.png"></div></li><li><div class="ico-mic" data-url="/files/material/icons/green/png/mic.png"></div></li><li><div class="ico-mobile" data-url="/files/material/icons/green/png/mobile.png"></div></li><li><div class="ico-monitor" data-url="/files/material/icons/green/png/monitor.png"></div></li><li><div class="ico-mug" data-url="/files/material/icons/green/png/mug.png"></div></li><li><div class="ico-music" data-url="/files/material/icons/green/png/music.png"></div></li><li><div class="ico-newspaper" data-url="/files/material/icons/green/png/newspaper.png"></div></li><li><div class="ico-notebook" data-url="/files/material/icons/green/png/notebook.png"></div></li><li><div class="ico-notification" data-url="/files/material/icons/green/png/notification.png"></div></li><li><div class="ico-numbered-list" data-url="/files/material/icons/green/png/numbered-list.png"></div></li><li><div class="ico-office" data-url="/files/material/icons/green/png/office.png"></div></li><li><div class="ico-phone-sign" data-url="/files/material/icons/green/png/phone-sign.png"></div></li><li><div class="ico-phone" data-url="/files/material/icons/green/png/phone.png"></div></li><li><div class="ico-picture" data-url="/files/material/icons/green/png/picture.png"></div></li><li><div class="ico-pie" data-url="/files/material/icons/green/png/pie.png"></div></li><li><div class="ico-play" data-url="/files/material/icons/green/png/play.png"></div></li><li><div class="ico-print" data-url="/files/material/icons/green/png/print.png"></div></li><li><div class="ico-profile" data-url="/files/material/icons/green/png/profile.png"></div></li><li><div class="ico-qrcode" data-url="/files/material/icons/green/png/qrcode.png"></div></li><li><div class="ico-question" data-url="/files/material/icons/green/png/question.png"></div></li><li><div class="ico-quote-left" data-url="/files/material/icons/green/png/quote-left.png"></div></li><li><div class="ico-rss" data-url="/files/material/icons/green/png/rss.png"></div></li><li><div class="ico-screen" data-url="/files/material/icons/green/png/screen.png"></div></li><li><div class="ico-search" data-url="/files/material/icons/green/png/search.png"></div></li><li><div class="ico-signup" data-url="/files/material/icons/green/png/signup.png"></div></li><li><div class="ico-smiley" data-url="/files/material/icons/green/png/smiley.png"></div></li><li><div class="ico-smiley2" data-url="/files/material/icons/green/png/smiley2.png"></div></li><li><div class="ico-star" data-url="/files/material/icons/green/png/star.png"></div></li><li><div class="ico-star2" data-url="/files/material/icons/green/png/star2.png"></div></li><li><div class="ico-star3" data-url="/files/material/icons/green/png/star3.png"></div></li><li><div class="ico-stats" data-url="/files/material/icons/green/png/stats.png"></div></li><li><div class="ico-stats2" data-url="/files/material/icons/green/png/stats2.png"></div></li><li><div class="ico-stopwatch" data-url="/files/material/icons/green/png/stopwatch.png"></div></li><li><div class="ico-support" data-url="/files/material/icons/green/png/support.png"></div></li><li><div class="ico-tag" data-url="/files/material/icons/green/png/tag.png"></div></li><li><div class="ico-target" data-url="/files/material/icons/green/png/target.png"></div></li><li><div class="ico-thumbs-up" data-url="/files/material/icons/green/png/thumbs-up.png"></div></li><li><div class="ico-time" data-url="/files/material/icons/green/png/time.png"></div></li><li><div class="ico-trophy" data-url="/files/material/icons/green/png/trophy.png"></div></li><li><div class="ico-user" data-url="/files/material/icons/green/png/user.png"></div></li><li><div class="ico-user2" data-url="/files/material/icons/green/png/user2.png"></div></li><li><div class="ico-user3" data-url="/files/material/icons/green/png/user3.png"></div></li><li><div class="ico-users" data-url="/files/material/icons/green/png/users.png"></div></li><li><div class="ico-users2" data-url="/files/material/icons/green/png/users2.png"></div></li><li><div class="ico-users3" data-url="/files/material/icons/green/png/users3.png"></div></li><li><div class="ico-volume-down" data-url="/files/material/icons/green/png/volume-down.png"></div></li><li><div class="ico-weibo" data-url="/files/material/icons/green/png/weibo.png"></div></li></ul></div><div id="icons-blue" class="tab-pane"><ul class="iconSelecter-inner icons-blue clearfix"><li><div class="ico-address-book" data-url="/files/material/icons/blue/png/address-book.png"></div></li><li><div class="ico-addressbook" data-url="/files/material/icons/blue/png/addressbook.png"></div></li><li><div class="ico-airplane" data-url="/files/material/icons/blue/png/airplane.png"></div></li><li><div class="ico-apple" data-url="/files/material/icons/blue/png/apple.png"></div></li><li><div class="ico-barcode" data-url="/files/material/icons/blue/png/barcode.png"></div></li><li><div class="ico-bars" data-url="/files/material/icons/blue/png/bars.png"></div></li><li><div class="ico-bars2" data-url="/files/material/icons/blue/png/bars2.png"></div></li><li><div class="ico-book" data-url="/files/material/icons/blue/png/book.png"></div></li><li><div class="ico-bookmark" data-url="/files/material/icons/blue/png/bookmark.png"></div></li><li><div class="ico-bubble" data-url="/files/material/icons/blue/png/bubble.png"></div></li><li><div class="ico-calculate" data-url="/files/material/icons/blue/png/calculate.png"></div></li><li><div class="ico-calendar" data-url="/files/material/icons/blue/png/calendar.png"></div></li><li><div class="ico-calendar2" data-url="/files/material/icons/blue/png/calendar2.png"></div></li><li><div class="ico-camera" data-url="/files/material/icons/blue/png/camera.png"></div></li><li><div class="ico-camera2" data-url="/files/material/icons/blue/png/camera2.png"></div></li><li><div class="ico-cancel" data-url="/files/material/icons/blue/png/cancel.png"></div></li><li><div class="ico-cart" data-url="/files/material/icons/blue/png/cart.png"></div></li><li><div class="ico-cart2" data-url="/files/material/icons/blue/png/cart2.png"></div></li><li><div class="ico-checkmark" data-url="/files/material/icons/blue/png/checkmark.png"></div></li><li><div class="ico-clipboard" data-url="/files/material/icons/blue/png/clipboard.png"></div></li><li><div class="ico-coffee" data-url="/files/material/icons/blue/png/coffee.png"></div></li><li><div class="ico-cog" data-url="/files/material/icons/blue/png/cog.png"></div></li><li><div class="ico-cogs" data-url="/files/material/icons/blue/png/cogs.png"></div></li><li><div class="ico-compass" data-url="/files/material/icons/blue/png/compass.png"></div></li><li><div class="ico-credit" data-url="/files/material/icons/blue/png/credit.png"></div></li><li><div class="ico-disk" data-url="/files/material/icons/blue/png/disk.png"></div></li><li><div class="ico-earth" data-url="/files/material/icons/blue/png/earth.png"></div></li><li><div class="ico-edit" data-url="/files/material/icons/blue/png/edit.png"></div></li><li><div class="ico-envelope" data-url="/files/material/icons/blue/png/envelope.png"></div></li><li><div class="ico-external-link" data-url="/files/material/icons/blue/png/external-link.png"></div></li><li><div class="ico-female" data-url="/files/material/icons/blue/png/female.png"></div></li><li><div class="ico-file" data-url="/files/material/icons/blue/png/file.png"></div></li><li><div class="ico-file2" data-url="/files/material/icons/blue/png/file2.png"></div></li><li><div class="ico-film" data-url="/files/material/icons/blue/png/film.png"></div></li><li><div class="ico-folder-open" data-url="/files/material/icons/blue/png/folder-open.png"></div></li><li><div class="ico-folder" data-url="/files/material/icons/blue/png/folder.png"></div></li><li><div class="ico-food" data-url="/files/material/icons/blue/png/food.png"></div></li><li><div class="ico-food2" data-url="/files/material/icons/blue/png/food2.png"></div></li><li><div class="ico-gift" data-url="/files/material/icons/blue/png/gift.png"></div></li><li><div class="ico-graph" data-url="/files/material/icons/blue/png/graph.png"></div></li><li><div class="ico-heart-empty" data-url="/files/material/icons/blue/png/heart-empty.png"></div></li><li><div class="ico-heart" data-url="/files/material/icons/blue/png/heart.png"></div></li><li><div class="ico-home" data-url="/files/material/icons/blue/png/home.png"></div></li><li><div class="ico-image" data-url="/files/material/icons/blue/png/image.png"></div></li><li><div class="ico-image2" data-url="/files/material/icons/blue/png/image2.png"></div></li><li><div class="ico-info" data-url="/files/material/icons/blue/png/info.png"></div></li><li><div class="ico-info2" data-url="/files/material/icons/blue/png/info2.png"></div></li><li><div class="ico-ipod" data-url="/files/material/icons/blue/png/ipod.png"></div></li><li><div class="ico-lab" data-url="/files/material/icons/blue/png/lab.png"></div></li><li><div class="ico-list-alt" data-url="/files/material/icons/blue/png/list-alt.png"></div></li><li><div class="ico-location" data-url="/files/material/icons/blue/png/location.png"></div></li><li><div class="ico-lock" data-url="/files/material/icons/blue/png/lock.png"></div></li><li><div class="ico-male" data-url="/files/material/icons/blue/png/male.png"></div></li><li><div class="ico-map" data-url="/files/material/icons/blue/png/map.png"></div></li><li><div class="ico-mic" data-url="/files/material/icons/blue/png/mic.png"></div></li><li><div class="ico-mobile" data-url="/files/material/icons/blue/png/mobile.png"></div></li><li><div class="ico-monitor" data-url="/files/material/icons/blue/png/monitor.png"></div></li><li><div class="ico-mug" data-url="/files/material/icons/blue/png/mug.png"></div></li><li><div class="ico-music" data-url="/files/material/icons/blue/png/music.png"></div></li><li><div class="ico-newspaper" data-url="/files/material/icons/blue/png/newspaper.png"></div></li><li><div class="ico-notebook" data-url="/files/material/icons/blue/png/notebook.png"></div></li><li><div class="ico-notification" data-url="/files/material/icons/blue/png/notification.png"></div></li><li><div class="ico-numbered-list" data-url="/files/material/icons/blue/png/numbered-list.png"></div></li><li><div class="ico-office" data-url="/files/material/icons/blue/png/office.png"></div></li><li><div class="ico-phone-sign" data-url="/files/material/icons/blue/png/phone-sign.png"></div></li><li><div class="ico-phone" data-url="/files/material/icons/blue/png/phone.png"></div></li><li><div class="ico-picture" data-url="/files/material/icons/blue/png/picture.png"></div></li><li><div class="ico-pie" data-url="/files/material/icons/blue/png/pie.png"></div></li><li><div class="ico-play" data-url="/files/material/icons/blue/png/play.png"></div></li><li><div class="ico-print" data-url="/files/material/icons/blue/png/print.png"></div></li><li><div class="ico-profile" data-url="/files/material/icons/blue/png/profile.png"></div></li><li><div class="ico-qrcode" data-url="/files/material/icons/blue/png/qrcode.png"></div></li><li><div class="ico-question" data-url="/files/material/icons/blue/png/question.png"></div></li><li><div class="ico-quote-left" data-url="/files/material/icons/blue/png/quote-left.png"></div></li><li><div class="ico-rss" data-url="/files/material/icons/blue/png/rss.png"></div></li><li><div class="ico-screen" data-url="/files/material/icons/blue/png/screen.png"></div></li><li><div class="ico-search" data-url="/files/material/icons/blue/png/search.png"></div></li><li><div class="ico-signup" data-url="/files/material/icons/blue/png/signup.png"></div></li><li><div class="ico-smiley" data-url="/files/material/icons/blue/png/smiley.png"></div></li><li><div class="ico-smiley2" data-url="/files/material/icons/blue/png/smiley2.png"></div></li><li><div class="ico-star" data-url="/files/material/icons/blue/png/star.png"></div></li><li><div class="ico-star2" data-url="/files/material/icons/blue/png/star2.png"></div></li><li><div class="ico-star3" data-url="/files/material/icons/blue/png/star3.png"></div></li><li><div class="ico-stats" data-url="/files/material/icons/blue/png/stats.png"></div></li><li><div class="ico-stats2" data-url="/files/material/icons/blue/png/stats2.png"></div></li><li><div class="ico-stopwatch" data-url="/files/material/icons/blue/png/stopwatch.png"></div></li><li><div class="ico-support" data-url="/files/material/icons/blue/png/support.png"></div></li><li><div class="ico-tag" data-url="/files/material/icons/blue/png/tag.png"></div></li><li><div class="ico-target" data-url="/files/material/icons/blue/png/target.png"></div></li><li><div class="ico-thumbs-up" data-url="/files/material/icons/blue/png/thumbs-up.png"></div></li><li><div class="ico-time" data-url="/files/material/icons/blue/png/time.png"></div></li><li><div class="ico-trophy" data-url="/files/material/icons/blue/png/trophy.png"></div></li><li><div class="ico-user" data-url="/files/material/icons/blue/png/user.png"></div></li><li><div class="ico-user2" data-url="/files/material/icons/blue/png/user2.png"></div></li><li><div class="ico-user3" data-url="/files/material/icons/blue/png/user3.png"></div></li><li><div class="ico-users" data-url="/files/material/icons/blue/png/users.png"></div></li><li><div class="ico-users2" data-url="/files/material/icons/blue/png/users2.png"></div></li><li><div class="ico-users3" data-url="/files/material/icons/blue/png/users3.png"></div></li><li><div class="ico-volume-down" data-url="/files/material/icons/blue/png/volume-down.png"></div></li><li><div class="ico-weibo" data-url="/files/material/icons/blue/png/weibo.png"></div></li></ul></div>		                            </div>			                    </div>			                </div>			                <div class="modal-footer">			                    <button data-dismiss="modal" type="button" class="btn btn-cancel">			                        <i class="icon-remove bigger-110"></i>取消			                    </button>			                    <button data-action="selectIcon" class="btn btn-success">			                        <i class="icon-ok bigger-110"></i>确定			                    </button>			                </div>			            </div>			        </div>			    </div>';return e}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.cms.SectionSettingsNew=r.common.BaseView.extend({events:{"keyup input":"_onKeyup","click .btn[data-action=uploadIcon], .btn[data-action=uploadIconBg]":"_uploadIcons","click .btn-cancel":"_cancel",submit:"_save","click [data-action=showIconSelecter]":"_selectIcons",'click [data-block="addSection"] a':"_addSection","click a.accessSectionLink":"_enterSectionLink"},doInitialize:function(e){this.parentSId=this.args.parentSectionId,this._initIconSelecterModal(),this.iconHandlers={},this.bgHandlers={},this.$form=this.$el.html(o(this.parentSId)).find("form"),this.$addSection=this.$('[data-block="addSection"]'),this.$sectionList=this.$('[data-block="sectionList"]'),this._renderSList(),this.changedSections={},this.changedLength=0,t.Events.on("previewer.loaded",n.bind(this._onPreviewerLoaded,this)),t.Events.on("section.updated",n.bind(this._onSectionUpdated,this)),t.Events.on("section-structure.changed",n.bind(this._onSectionUpdated,this)),t.Events.on("section.removed",n.bind(this._onSectionRemoved,this)),this.parentSId||t.Events.on("app.settings.updated",n.bind(this.templateUpdated,this))},_initIconSelecterModal:function(){var t=this,r="home";this.parentSId&&(r="sectionSet");var i="modal-iconSelecter-"+r;e(i).length<=0&&e("body").append(s(i)),this.$iconSelecter=e("#"+i),this.$iconSelecter.off("click").off("shown").on("shown.bs.modal",n.bind(this._onIconSelecterModalShown,this)),this.$iconSelecter.on("click","ul.iconSelecter-inner li",n.bind(this._onIconSelected,this)),this.$iconSelecter.on("click",'[data-toggle="tab"]',function(n){n.preventDefault(),e(this).parent().addClass("active").siblings(".active").removeClass("active");var r=t.$iconSelecter.find(e(this).attr("href"));r.show().siblings().hide()}),this.$iconSelecter.on("click",".btn[data-action=selectIcon]",n.bind(this._selectIcon,this))},_onSectionUpdated:function(e,t){if(t=="sectionSettingList")return;this._renderSList()},_onSectionRemoved:function(e){this._renderSList()},templateUpdated:function(){this.handleSectionDescp()},handleSectionDescp:function(){var e=r.App.config.currentApp.home.option_id,t=this.$("[data-block=sectionDescp]");!this.parentSId&&e=="layout12"?t.removeClass("hide"):t.addClass("hide")},_renderSList:function(){var e=[];this.parentSId?e=r.App.util.getSecondLevelSections(this.parentSId):e=r.App.util.getFirstLevelSections();if(!n.isEmpty(e))this.$sectionList.removeClass("hide"),this.$addSection.addClass("hide"),this.$('[data-block="sList"]').empty().html(u(e)),this._initImgHandlers(e),this.handleSectionDescp();else{var t=this.$addSection.find('[data-item="sectionSet"]');this.parentSId&&t.remove(),this.$sectionList.addClass("hide"),this.$addSection.removeClass("hide")}},scrollToSection:function(e){e&&(location.href="#",location.href="#"+e,this.$el.find("#"+e).addClass("active").siblings().removeClass("active"))},_initImgHandlers:function(t){var i=this;console.time("init img uploaders"),this.$('[data-block="sList"] li').each(function(s,o){var u=e(this),a=u.data("id"),f=t[a];if(!f)return;var l=i.iconHandlers[a]=new r.modules.common.ImageUploader({wrapperView:i,el:u.find("img[data-action=uploadIcon]"),uploadUrl:r.api("/files"),removeUrl:r.api("/sections/"+a+"/icon"),onsuccess:n.bind(i._onIconUploaded,i),onremoved:n.bind(i._onIconRemoved,i),callbackOpt:a,imgCrop:!0,cropWidth:0,cropHeight:0});l.setImgSrc(f.icon_url);var c=i.bgHandlers[a]=new r.modules.common.ImageUploader({wrapperView:i,el:u.find("img[data-action=uploadIconBg]"),uploadUrl:r.api("/files"),removeUrl:r.api("/sections/"+a+"/icon_bg"),onsuccess:n.bind(i._onIconBgUploaded,i),onremoved:n.bind(i._onIconBgRemoved,i),callbackOpt:a,imgCrop:!0,cropWidth:0,cropHeight:0});c.setImgSrc(f.background_url)}),console.timeEnd("init img uploaders")},_resetImgSrc:function(){var e=this;n.each(this.changedSections,function(t){if(t&&t.id){var n=e.iconHandlers[t.id],i=r.App.util.getSectionInfoById(t.id);n.setImgSrc(i.icon_url)}})},_addSection:function(t){t.preventDefault();var n=e(t.target);n=n.is("a")?n:n.parents("a");var i={view:"form",title:"添加栏目 > "+n.data().sectionName,sectionType:{type:n.data().sectionType,name:n.data().sectionName},hideGuideAction:!0,doNotEnterSection:!0};this.parentSId&&(i.parentSection=r.modules.cms.SectionModule.currentSection),new r.modules.cms.SectionCreationDialog(i)},_enterSectionLink:function(t){t.preventDefault(),r.navigate(e(t.target).attr("href"))},isChanged:function(){return this._contentModifiedDt||this._templateModifiedDt},onHide:function(){this.isChanged()&&this._cancel()},onShow:function(){},_onIconSelecterModalShown:function(e){var t=this._tmpIconSelected=this.currIconImgHandler.getImgSrc(),n="icons-black";if(t&&t.indexOf("material")>=0){var r=this.$iconSelecter.find('li div[data-url="'+t+'"]'),i=r.parent("li");i.click(),n=i.closest(".tab-pane").attr("id")}var s=this.$iconSelecter.find('ul.nav-tabs a[href="#'+n+'"]');s.click()},_onIconSelected:function(t){var n=e(t.target).closest("li"),r=n.find("div").data("url");e("div.tab-content li.active").removeClass("active"),n.addClass("active"),this._tmpIconSelected=r},_selectIcon:function(){this.$iconSelecter.modal("hide");if(!this._tmpIconSelected||this.currIconImgHandler.getImgSrc()==this._tmpIconSelected)return;var e=this._tmpIconSelected;this.currIconImgHandler.setImgSrc(e),this._onIconUploaded({},{url:e},{callbackOpt:this.currImgSectionId})},onRemove:function(){this.isChanged()&&this._cancel(),t.Events.off("previewer.loaded",this._onPreviewerLoaded)},_findTemplatesByType:function(e,t){var i=n.find(r.App.config.sectionTypes,function(t){return t.code==e});return i?n.filter(i.templates,function(e){return e.type==t}):[]},_selectIcons:function(t){var n=e(t.target),r=n.closest("li").data("id"),i=this.currIconImgHandler=this.iconHandlers[r];if(!i)return;this.currImgSectionId=r,this.$iconSelecter.modal("show")},_uploadIcons:function(t){var n=e(t.target).data().action||e(t.target).parent().data().action;e(t.target).closest("li").find("img[data-action="+n+"]").trigger("click")},_cancel:function(e){this._resetImgSrc(),this._contentChanged(!1),this._cancelFireEvent()},_save:function(i){function f(n){if(!n||!n.id)return;var l=n.id,c=/(.*)\?v=\d*$/gi,h=c.exec(n.iconUrl);c.lastIndex=0;var p=c.exec(n.backgroundUrl);n.iconUrl=h?h[1]:n.iconUrl,n.backgroundUrl=p?p[1]:n.backgroundUrl;var d={id:l,name:n.name,descp:n.descp,icon_url:n.iconUrl,background_url:n.backgroundUrl};r.showProgressIndicator(n.name+"设置保存中..."),e.post(r.api("/sections/"+l),d).done(function(e){if(e.code==400){r.showMessage("ERROR",n.name+"设置有些表单项填写不正确",!0);return}var t=s.iconHandlers[l];t.getImgSrc()!=e.section.icon_url&&t.setImgSrc(e.section.icon_url);var i=s.bgHandlers[l];i.getImgSrc()!=e.section.background_url&&i.setImgSrc(e.section.background_url),r.App.util.updateSection(e.section),s.changedSections[l]=undefined,a++,r.showMessage("INFO",n.name+"设置成功",!0)}).error(function(e){r.showMessage("ERROR",n.name+"保存出错!",!0)}).always(function(){if(o.length<=0){a<u?s._contentChanged(!0):s._contentChanged(!1),t.Events.trigger("sections.updated",{from:"sectionSettingList"}),r.closeProgressIndicator(),i&&i();return}var e=o.pop();f(e)})}if(this.checkIsUploading())return i&&i(),!1;this._removeValidationErrorOnFormActions();var s=this,o=[];n.each(this.changedSections,function(e){e&&e.id&&o.unshift(e)});var u=o.length;if(u<=0){i&&i();return}var a=0;f(o.pop())},_handleValidationErrors:function(e){var t=this.$form;n.each(e,function(e){t.find("[name="+e.key+"]").siblings(".validation-tips").addClass("hide").end().after('<div class="validation-error">'+e.message+"</div>").parents(".form-group").addClass("has-error")}),t.find(".form-actions").addClass("has-error").prepend('<span class="validation-error">有些项填写不正确，请根据指示检查.</span>')},_removeValidationErrorOnFormActions:function(){this.$form.find("div.has-error").removeClass("has-error"),this.$form.find(".validation-error").remove(),this.$formActions||(this.$formActions=this.$el.find(".form-actions")),this.$formActions.removeClass("has-error").find(".validation-error").remove()},_contentChanged:function(e,t){e!=undefined||(e=!0),e?(this._contentModifiedDt=(new Date).getTime(),this._enableFormActions()):(this._contentModifiedDt=null,this._disableFormActionsIfNecessary()),this.args.onContentChanged&&this.args.onContentChanged(e),this._fireSettingsChangedEvent(t)},_enableFormActions:function(){this.$form.find(".form-actions .btn").enable()},_disableFormActionsIfNecessary:function(){!this._contentModifiedDt&&!this._templateModifiedDt&&this.$form.find(".form-actions .btn").button("reset").disable()},_onKeyup:function(t){e(t.target).parents(".form-group").removeClass("has-error").end().siblings(".validation-tips").removeClass("hide").end().next(".validation-error").remove();var n=e(t.target).closest("li").data("id");this._removeValidationErrorOnFormActions(),this._contentChanged(!0,n)},_onIconUploaded:function(e,t,n){this._contentChanged(!0,n.callbackOpt)},_onIconRemoved:function(e){this._contentChanged(!0,e.callbackOpt)},_onIconBgUploaded:function(e,t,n){this._contentChanged(!0,n.callbackOpt)},_onIconBgRemoved:function(e){this._contentChanged(!0,e.callbackOpt)},_onPreviewerLoaded:function(){this.isChanged()&&(this._fireSettingsChangedEvent(),this._fireTemplateChangedEvent())},_fireSettingsChangedEvent:function(e){var t=this,i=r.modules.cms.ClientUtils.getCurrentAppSections();if(e){var s=this.changedSections[e]={id:e};this._setSectionData(s,"previewer")}n.each(i,function(e){var r=e.id,i=t.changedSections[r];i&&n.extend(e,i)}),r.modules.AppPreviewer.sectionSettingsChanged(i)},_cancelFireEvent:function(){var e=this,t=r.modules.cms.ClientUtils.getCurrentAppSections();r.modules.AppPreviewer.sectionSettingsChanged(t)},_setSectionData:function(e,t){t=t||"cms";var n=e.id,r=this.$('[data-block="sList"]').find('li[data-id="'+n+'"]');if(r.length<=0)return e;var i,s,o,u;i=r.find('input[name="name"]').val(),u=r.find('input[name="descp"]').val(),s=this.iconHandlers[n]&&this.iconHandlers[n].getImgSrc(),o=this.bgHandlers[n]&&this.bgHandlers[n].getImgSrc(),t=="cms"?(e.name=i,e.descp=u,e.icon_url=s,e.background_url=o):t=="previewer"&&(e.name=i,e.descp=u,e.iconUrl=s,e.backgroundUrl=o)}});var i=function(e){return"SECTION_SET"==e.type.code?!0:n.find(r.App.config.currentApp.sections,function(t){return t.parent_id==e.id})},s=function(e){var t='<div id="'+e+'" class="modal" aria-hidden="false">			        <div class="modal-dialog iconSelecter">			            <div class="modal-content">			                <div class="modal-header lighter blue">选择图标			                    <span class="close" data-dismiss="modal">×</span>			                </div>			                <div class="modal-body">			                    <div class="tabbable">			                        <ul class="nav nav-tabs">			                            <li class="active"><a data-toggle="tab" href="#icons-black"><span class="color-black"></span></a></li><li class=""><a data-toggle="tab" href="#icons-grey"><span class="color-grey"></span></a></li><li><a data-toggle="tab" href="#icons-white"><span class="color-white"></span></a></li><li><a data-toggle="tab" href="#icons-red"><span class="color-red"></span></a></li><li><a data-toggle="tab" href="#icons-yellow"><span class="color-yellow"></span></a></li><li><a data-toggle="tab" href="#icons-green"><span class="color-green"></span></a></li><li class=""><a data-toggle="tab" href="#icons-blue"><span class="color-blue"></span></a></li>			                        </ul>			                        <div class="tab-content clearfix">		                            	<div id="icons-black" class="tab-pane active"><ul class="iconSelecter-inner icons-black clearfix"><li><div class="ico-address-book" data-url="/files/material/icons/black/png/address-book.png"></div></li><li><div class="ico-addressbook" data-url="/files/material/icons/black/png/addressbook.png"></div></li><li><div class="ico-airplane" data-url="/files/material/icons/black/png/airplane.png"></div></li><li><div class="ico-apple" data-url="/files/material/icons/black/png/apple.png"></div></li><li><div class="ico-barcode" data-url="/files/material/icons/black/png/barcode.png"></div></li><li><div class="ico-bars" data-url="/files/material/icons/black/png/bars.png"></div></li><li><div class="ico-bars2" data-url="/files/material/icons/black/png/bars2.png"></div></li><li><div class="ico-book" data-url="/files/material/icons/black/png/book.png"></div></li><li><div class="ico-bookmark" data-url="/files/material/icons/black/png/bookmark.png"></div></li><li><div class="ico-bubble" data-url="/files/material/icons/black/png/bubble.png"></div></li><li><div class="ico-calculate" data-url="/files/material/icons/black/png/calculate.png"></div></li><li><div class="ico-calendar" data-url="/files/material/icons/black/png/calendar.png"></div></li><li><div class="ico-calendar2" data-url="/files/material/icons/black/png/calendar2.png"></div></li><li><div class="ico-camera" data-url="/files/material/icons/black/png/camera.png"></div></li><li><div class="ico-camera2" data-url="/files/material/icons/black/png/camera2.png"></div></li><li><div class="ico-cancel" data-url="/files/material/icons/black/png/cancel.png"></div></li><li><div class="ico-cart" data-url="/files/material/icons/black/png/cart.png"></div></li><li><div class="ico-cart2" data-url="/files/material/icons/black/png/cart2.png"></div></li><li><div class="ico-checkmark" data-url="/files/material/icons/black/png/checkmark.png"></div></li><li><div class="ico-clipboard" data-url="/files/material/icons/black/png/clipboard.png"></div></li><li><div class="ico-coffee" data-url="/files/material/icons/black/png/coffee.png"></div></li><li><div class="ico-cog" data-url="/files/material/icons/black/png/cog.png"></div></li><li><div class="ico-cogs" data-url="/files/material/icons/black/png/cogs.png"></div></li><li><div class="ico-compass" data-url="/files/material/icons/black/png/compass.png"></div></li><li><div class="ico-credit" data-url="/files/material/icons/black/png/credit.png"></div></li><li><div class="ico-disk" data-url="/files/material/icons/black/png/disk.png"></div></li><li><div class="ico-earth" data-url="/files/material/icons/black/png/earth.png"></div></li><li><div class="ico-edit" data-url="/files/material/icons/black/png/edit.png"></div></li><li><div class="ico-envelope" data-url="/files/material/icons/black/png/envelope.png"></div></li><li><div class="ico-external-link" data-url="/files/material/icons/black/png/external-link.png"></div></li><li><div class="ico-female" data-url="/files/material/icons/black/png/female.png"></div></li><li><div class="ico-file" data-url="/files/material/icons/black/png/file.png"></div></li><li><div class="ico-file2" data-url="/files/material/icons/black/png/file2.png"></div></li><li><div class="ico-film" data-url="/files/material/icons/black/png/film.png"></div></li><li><div class="ico-folder-open" data-url="/files/material/icons/black/png/folder-open.png"></div></li><li><div class="ico-folder" data-url="/files/material/icons/black/png/folder.png"></div></li><li><div class="ico-food" data-url="/files/material/icons/black/png/food.png"></div></li><li><div class="ico-food2" data-url="/files/material/icons/black/png/food2.png"></div></li><li><div class="ico-gift" data-url="/files/material/icons/black/png/gift.png"></div></li><li><div class="ico-graph" data-url="/files/material/icons/black/png/graph.png"></div></li><li><div class="ico-heart-empty" data-url="/files/material/icons/black/png/heart-empty.png"></div></li><li><div class="ico-heart" data-url="/files/material/icons/black/png/heart.png"></div></li><li><div class="ico-home" data-url="/files/material/icons/black/png/home.png"></div></li><li><div class="ico-image" data-url="/files/material/icons/black/png/image.png"></div></li><li><div class="ico-image2" data-url="/files/material/icons/black/png/image2.png"></div></li><li><div class="ico-info" data-url="/files/material/icons/black/png/info.png"></div></li><li><div class="ico-info2" data-url="/files/material/icons/black/png/info2.png"></div></li><li><div class="ico-ipod" data-url="/files/material/icons/black/png/ipod.png"></div></li><li><div class="ico-lab" data-url="/files/material/icons/black/png/lab.png"></div></li><li><div class="ico-list-alt" data-url="/files/material/icons/black/png/list-alt.png"></div></li><li><div class="ico-location" data-url="/files/material/icons/black/png/location.png"></div></li><li><div class="ico-lock" data-url="/files/material/icons/black/png/lock.png"></div></li><li><div class="ico-male" data-url="/files/material/icons/black/png/male.png"></div></li><li><div class="ico-map" data-url="/files/material/icons/black/png/map.png"></div></li><li><div class="ico-mic" data-url="/files/material/icons/black/png/mic.png"></div></li><li><div class="ico-mobile" data-url="/files/material/icons/black/png/mobile.png"></div></li><li><div class="ico-monitor" data-url="/files/material/icons/black/png/monitor.png"></div></li><li><div class="ico-mug" data-url="/files/material/icons/black/png/mug.png"></div></li><li><div class="ico-music" data-url="/files/material/icons/black/png/music.png"></div></li><li><div class="ico-newspaper" data-url="/files/material/icons/black/png/newspaper.png"></div></li><li><div class="ico-notebook" data-url="/files/material/icons/black/png/notebook.png"></div></li><li><div class="ico-notification" data-url="/files/material/icons/black/png/notification.png"></div></li><li><div class="ico-numbered-list" data-url="/files/material/icons/black/png/numbered-list.png"></div></li><li><div class="ico-office" data-url="/files/material/icons/black/png/office.png"></div></li><li><div class="ico-phone-sign" data-url="/files/material/icons/black/png/phone-sign.png"></div></li><li><div class="ico-phone" data-url="/files/material/icons/black/png/phone.png"></div></li><li><div class="ico-picture" data-url="/files/material/icons/black/png/picture.png"></div></li><li><div class="ico-pie" data-url="/files/material/icons/black/png/pie.png"></div></li><li><div class="ico-play" data-url="/files/material/icons/black/png/play.png"></div></li><li><div class="ico-print" data-url="/files/material/icons/black/png/print.png"></div></li><li><div class="ico-profile" data-url="/files/material/icons/black/png/profile.png"></div></li><li><div class="ico-qrcode" data-url="/files/material/icons/black/png/qrcode.png"></div></li><li><div class="ico-question" data-url="/files/material/icons/black/png/question.png"></div></li><li><div class="ico-quote-left" data-url="/files/material/icons/black/png/quote-left.png"></div></li><li><div class="ico-rss" data-url="/files/material/icons/black/png/rss.png"></div></li><li><div class="ico-screen" data-url="/files/material/icons/black/png/screen.png"></div></li><li><div class="ico-search" data-url="/files/material/icons/black/png/search.png"></div></li><li><div class="ico-signup" data-url="/files/material/icons/black/png/signup.png"></div></li><li><div class="ico-smiley" data-url="/files/material/icons/black/png/smiley.png"></div></li><li><div class="ico-smiley2" data-url="/files/material/icons/black/png/smiley2.png"></div></li><li><div class="ico-star" data-url="/files/material/icons/black/png/star.png"></div></li><li><div class="ico-star2" data-url="/files/material/icons/black/png/star2.png"></div></li><li><div class="ico-star3" data-url="/files/material/icons/black/png/star3.png"></div></li><li><div class="ico-stats" data-url="/files/material/icons/black/png/stats.png"></div></li><li><div class="ico-stats2" data-url="/files/material/icons/black/png/stats2.png"></div></li><li><div class="ico-stopwatch" data-url="/files/material/icons/black/png/stopwatch.png"></div></li><li><div class="ico-support" data-url="/files/material/icons/black/png/support.png"></div></li><li><div class="ico-tag" data-url="/files/material/icons/black/png/tag.png"></div></li><li><div class="ico-target" data-url="/files/material/icons/black/png/target.png"></div></li><li><div class="ico-thumbs-up" data-url="/files/material/icons/black/png/thumbs-up.png"></div></li><li><div class="ico-time" data-url="/files/material/icons/black/png/time.png"></div></li><li><div class="ico-trophy" data-url="/files/material/icons/black/png/trophy.png"></div></li><li><div class="ico-user" data-url="/files/material/icons/black/png/user.png"></div></li><li><div class="ico-user2" data-url="/files/material/icons/black/png/user2.png"></div></li><li><div class="ico-user3" data-url="/files/material/icons/black/png/user3.png"></div></li><li><div class="ico-users" data-url="/files/material/icons/black/png/users.png"></div></li><li><div class="ico-users2" data-url="/files/material/icons/black/png/users2.png"></div></li><li><div class="ico-users3" data-url="/files/material/icons/black/png/users3.png"></div></li><li><div class="ico-volume-down" data-url="/files/material/icons/black/png/volume-down.png"></div></li><li><div class="ico-weibo" data-url="/files/material/icons/black/png/weibo.png"></div></li></ul></div><div id="icons-grey" class="tab-pane"><ul class="iconSelecter-inner icons-grey clearfix"><li><div class="ico-address-book" data-url="/files/material/icons/grey/png/address-book.png"></div></li><li><div class="ico-addressbook" data-url="/files/material/icons/grey/png/addressbook.png"></div></li><li><div class="ico-airplane" data-url="/files/material/icons/grey/png/airplane.png"></div></li><li><div class="ico-apple" data-url="/files/material/icons/grey/png/apple.png"></div></li><li><div class="ico-barcode" data-url="/files/material/icons/grey/png/barcode.png"></div></li><li><div class="ico-bars" data-url="/files/material/icons/grey/png/bars.png"></div></li><li><div class="ico-bars2" data-url="/files/material/icons/grey/png/bars2.png"></div></li><li><div class="ico-book" data-url="/files/material/icons/grey/png/book.png"></div></li><li><div class="ico-bookmark" data-url="/files/material/icons/grey/png/bookmark.png"></div></li><li><div class="ico-bubble" data-url="/files/material/icons/grey/png/bubble.png"></div></li><li><div class="ico-calculate" data-url="/files/material/icons/grey/png/calculate.png"></div></li><li><div class="ico-calendar" data-url="/files/material/icons/grey/png/calendar.png"></div></li><li><div class="ico-calendar2" data-url="/files/material/icons/grey/png/calendar2.png"></div></li><li><div class="ico-camera" data-url="/files/material/icons/grey/png/camera.png"></div></li><li><div class="ico-camera2" data-url="/files/material/icons/grey/png/camera2.png"></div></li><li><div class="ico-cancel" data-url="/files/material/icons/grey/png/cancel.png"></div></li><li><div class="ico-cart" data-url="/files/material/icons/grey/png/cart.png"></div></li><li><div class="ico-cart2" data-url="/files/material/icons/grey/png/cart2.png"></div></li><li><div class="ico-checkmark" data-url="/files/material/icons/grey/png/checkmark.png"></div></li><li><div class="ico-clipboard" data-url="/files/material/icons/grey/png/clipboard.png"></div></li><li><div class="ico-coffee" data-url="/files/material/icons/grey/png/coffee.png"></div></li><li><div class="ico-cog" data-url="/files/material/icons/grey/png/cog.png"></div></li><li><div class="ico-cogs" data-url="/files/material/icons/grey/png/cogs.png"></div></li><li><div class="ico-compass" data-url="/files/material/icons/grey/png/compass.png"></div></li><li><div class="ico-credit" data-url="/files/material/icons/grey/png/credit.png"></div></li><li><div class="ico-disk" data-url="/files/material/icons/grey/png/disk.png"></div></li><li><div class="ico-earth" data-url="/files/material/icons/grey/png/earth.png"></div></li><li><div class="ico-edit" data-url="/files/material/icons/grey/png/edit.png"></div></li><li><div class="ico-envelope" data-url="/files/material/icons/grey/png/envelope.png"></div></li><li><div class="ico-external-link" data-url="/files/material/icons/grey/png/external-link.png"></div></li><li><div class="ico-female" data-url="/files/material/icons/grey/png/female.png"></div></li><li><div class="ico-file" data-url="/files/material/icons/grey/png/file.png"></div></li><li><div class="ico-file2" data-url="/files/material/icons/grey/png/file2.png"></div></li><li><div class="ico-film" data-url="/files/material/icons/grey/png/film.png"></div></li><li><div class="ico-folder-open" data-url="/files/material/icons/grey/png/folder-open.png"></div></li><li><div class="ico-folder" data-url="/files/material/icons/grey/png/folder.png"></div></li><li><div class="ico-food" data-url="/files/material/icons/grey/png/food.png"></div></li><li><div class="ico-food2" data-url="/files/material/icons/grey/png/food2.png"></div></li><li><div class="ico-gift" data-url="/files/material/icons/grey/png/gift.png"></div></li><li><div class="ico-graph" data-url="/files/material/icons/grey/png/graph.png"></div></li><li><div class="ico-heart-empty" data-url="/files/material/icons/grey/png/heart-empty.png"></div></li><li><div class="ico-heart" data-url="/files/material/icons/grey/png/heart.png"></div></li><li><div class="ico-home" data-url="/files/material/icons/grey/png/home.png"></div></li><li><div class="ico-image" data-url="/files/material/icons/grey/png/image.png"></div></li><li><div class="ico-image2" data-url="/files/material/icons/grey/png/image2.png"></div></li><li><div class="ico-info" data-url="/files/material/icons/grey/png/info.png"></div></li><li><div class="ico-info2" data-url="/files/material/icons/grey/png/info2.png"></div></li><li><div class="ico-ipod" data-url="/files/material/icons/grey/png/ipod.png"></div></li><li><div class="ico-lab" data-url="/files/material/icons/grey/png/lab.png"></div></li><li><div class="ico-list-alt" data-url="/files/material/icons/grey/png/list-alt.png"></div></li><li><div class="ico-location" data-url="/files/material/icons/grey/png/location.png"></div></li><li><div class="ico-lock" data-url="/files/material/icons/grey/png/lock.png"></div></li><li><div class="ico-male" data-url="/files/material/icons/grey/png/male.png"></div></li><li><div class="ico-map" data-url="/files/material/icons/grey/png/map.png"></div></li><li><div class="ico-mic" data-url="/files/material/icons/grey/png/mic.png"></div></li><li><div class="ico-mobile" data-url="/files/material/icons/grey/png/mobile.png"></div></li><li><div class="ico-monitor" data-url="/files/material/icons/grey/png/monitor.png"></div></li><li><div class="ico-mug" data-url="/files/material/icons/grey/png/mug.png"></div></li><li><div class="ico-music" data-url="/files/material/icons/grey/png/music.png"></div></li><li><div class="ico-newspaper" data-url="/files/material/icons/grey/png/newspaper.png"></div></li><li><div class="ico-notebook" data-url="/files/material/icons/grey/png/notebook.png"></div></li><li><div class="ico-notification" data-url="/files/material/icons/grey/png/notification.png"></div></li><li><div class="ico-numbered-list" data-url="/files/material/icons/grey/png/numbered-list.png"></div></li><li><div class="ico-office" data-url="/files/material/icons/grey/png/office.png"></div></li><li><div class="ico-phone-sign" data-url="/files/material/icons/grey/png/phone-sign.png"></div></li><li><div class="ico-phone" data-url="/files/material/icons/grey/png/phone.png"></div></li><li><div class="ico-picture" data-url="/files/material/icons/grey/png/picture.png"></div></li><li><div class="ico-pie" data-url="/files/material/icons/grey/png/pie.png"></div></li><li><div class="ico-play" data-url="/files/material/icons/grey/png/play.png"></div></li><li><div class="ico-print" data-url="/files/material/icons/grey/png/print.png"></div></li><li><div class="ico-profile" data-url="/files/material/icons/grey/png/profile.png"></div></li><li><div class="ico-qrcode" data-url="/files/material/icons/grey/png/qrcode.png"></div></li><li><div class="ico-question" data-url="/files/material/icons/grey/png/question.png"></div></li><li><div class="ico-quote-left" data-url="/files/material/icons/grey/png/quote-left.png"></div></li><li><div class="ico-rss" data-url="/files/material/icons/grey/png/rss.png"></div></li><li><div class="ico-screen" data-url="/files/material/icons/grey/png/screen.png"></div></li><li><div class="ico-search" data-url="/files/material/icons/grey/png/search.png"></div></li><li><div class="ico-signup" data-url="/files/material/icons/grey/png/signup.png"></div></li><li><div class="ico-smiley" data-url="/files/material/icons/grey/png/smiley.png"></div></li><li><div class="ico-smiley2" data-url="/files/material/icons/grey/png/smiley2.png"></div></li><li><div class="ico-star" data-url="/files/material/icons/grey/png/star.png"></div></li><li><div class="ico-star2" data-url="/files/material/icons/grey/png/star2.png"></div></li><li><div class="ico-star3" data-url="/files/material/icons/grey/png/star3.png"></div></li><li><div class="ico-stats" data-url="/files/material/icons/grey/png/stats.png"></div></li><li><div class="ico-stats2" data-url="/files/material/icons/grey/png/stats2.png"></div></li><li><div class="ico-stopwatch" data-url="/files/material/icons/grey/png/stopwatch.png"></div></li><li><div class="ico-support" data-url="/files/material/icons/grey/png/support.png"></div></li><li><div class="ico-tag" data-url="/files/material/icons/grey/png/tag.png"></div></li><li><div class="ico-target" data-url="/files/material/icons/grey/png/target.png"></div></li><li><div class="ico-thumbs-up" data-url="/files/material/icons/grey/png/thumbs-up.png"></div></li><li><div class="ico-time" data-url="/files/material/icons/grey/png/time.png"></div></li><li><div class="ico-trophy" data-url="/files/material/icons/grey/png/trophy.png"></div></li><li><div class="ico-user" data-url="/files/material/icons/grey/png/user.png"></div></li><li><div class="ico-user2" data-url="/files/material/icons/grey/png/user2.png"></div></li><li><div class="ico-user3" data-url="/files/material/icons/grey/png/user3.png"></div></li><li><div class="ico-users" data-url="/files/material/icons/grey/png/users.png"></div></li><li><div class="ico-users2" data-url="/files/material/icons/grey/png/users2.png"></div></li><li><div class="ico-users3" data-url="/files/material/icons/grey/png/users3.png"></div></li><li><div class="ico-volume-down" data-url="/files/material/icons/grey/png/volume-down.png"></div></li><li><div class="ico-weibo" data-url="/files/material/icons/grey/png/weibo.png"></div></li></ul></div><div id="icons-white" class="tab-pane"><ul class="iconSelecter-inner icons-white clearfix"><li><div class="ico-address-book" data-url="/files/material/icons/white/png/address-book.png"></div></li><li><div class="ico-addressbook" data-url="/files/material/icons/white/png/addressbook.png"></div></li><li><div class="ico-airplane" data-url="/files/material/icons/white/png/airplane.png"></div></li><li><div class="ico-apple" data-url="/files/material/icons/white/png/apple.png"></div></li><li><div class="ico-barcode" data-url="/files/material/icons/white/png/barcode.png"></div></li><li><div class="ico-bars" data-url="/files/material/icons/white/png/bars.png"></div></li><li><div class="ico-bars2" data-url="/files/material/icons/white/png/bars2.png"></div></li><li><div class="ico-book" data-url="/files/material/icons/white/png/book.png"></div></li><li><div class="ico-bookmark" data-url="/files/material/icons/white/png/bookmark.png"></div></li><li><div class="ico-bubble" data-url="/files/material/icons/white/png/bubble.png"></div></li><li><div class="ico-calculate" data-url="/files/material/icons/white/png/calculate.png"></div></li><li><div class="ico-calendar" data-url="/files/material/icons/white/png/calendar.png"></div></li><li><div class="ico-calendar2" data-url="/files/material/icons/white/png/calendar2.png"></div></li><li><div class="ico-camera" data-url="/files/material/icons/white/png/camera.png"></div></li><li><div class="ico-camera2" data-url="/files/material/icons/white/png/camera2.png"></div></li><li><div class="ico-cancel" data-url="/files/material/icons/white/png/cancel.png"></div></li><li><div class="ico-cart" data-url="/files/material/icons/white/png/cart.png"></div></li><li><div class="ico-cart2" data-url="/files/material/icons/white/png/cart2.png"></div></li><li><div class="ico-checkmark" data-url="/files/material/icons/white/png/checkmark.png"></div></li><li><div class="ico-clipboard" data-url="/files/material/icons/white/png/clipboard.png"></div></li><li><div class="ico-coffee" data-url="/files/material/icons/white/png/coffee.png"></div></li><li><div class="ico-cog" data-url="/files/material/icons/white/png/cog.png"></div></li><li><div class="ico-cogs" data-url="/files/material/icons/white/png/cogs.png"></div></li><li><div class="ico-compass" data-url="/files/material/icons/white/png/compass.png"></div></li><li><div class="ico-credit" data-url="/files/material/icons/white/png/credit.png"></div></li><li><div class="ico-disk" data-url="/files/material/icons/white/png/disk.png"></div></li><li><div class="ico-earth" data-url="/files/material/icons/white/png/earth.png"></div></li><li><div class="ico-edit" data-url="/files/material/icons/white/png/edit.png"></div></li><li><div class="ico-envelope" data-url="/files/material/icons/white/png/envelope.png"></div></li><li><div class="ico-external-link" data-url="/files/material/icons/white/png/external-link.png"></div></li><li><div class="ico-female" data-url="/files/material/icons/white/png/female.png"></div></li><li><div class="ico-file" data-url="/files/material/icons/white/png/file.png"></div></li><li><div class="ico-file2" data-url="/files/material/icons/white/png/file2.png"></div></li><li><div class="ico-film" data-url="/files/material/icons/white/png/film.png"></div></li><li><div class="ico-folder-open" data-url="/files/material/icons/white/png/folder-open.png"></div></li><li><div class="ico-folder" data-url="/files/material/icons/white/png/folder.png"></div></li><li><div class="ico-food" data-url="/files/material/icons/white/png/food.png"></div></li><li><div class="ico-food2" data-url="/files/material/icons/white/png/food2.png"></div></li><li><div class="ico-gift" data-url="/files/material/icons/white/png/gift.png"></div></li><li><div class="ico-graph" data-url="/files/material/icons/white/png/graph.png"></div></li><li><div class="ico-heart-empty" data-url="/files/material/icons/white/png/heart-empty.png"></div></li><li><div class="ico-heart" data-url="/files/material/icons/white/png/heart.png"></div></li><li><div class="ico-home" data-url="/files/material/icons/white/png/home.png"></div></li><li><div class="ico-image" data-url="/files/material/icons/white/png/image.png"></div></li><li><div class="ico-image2" data-url="/files/material/icons/white/png/image2.png"></div></li><li><div class="ico-info" data-url="/files/material/icons/white/png/info.png"></div></li><li><div class="ico-info2" data-url="/files/material/icons/white/png/info2.png"></div></li><li><div class="ico-ipod" data-url="/files/material/icons/white/png/ipod.png"></div></li><li><div class="ico-lab" data-url="/files/material/icons/white/png/lab.png"></div></li><li><div class="ico-list-alt" data-url="/files/material/icons/white/png/list-alt.png"></div></li><li><div class="ico-location" data-url="/files/material/icons/white/png/location.png"></div></li><li><div class="ico-lock" data-url="/files/material/icons/white/png/lock.png"></div></li><li><div class="ico-male" data-url="/files/material/icons/white/png/male.png"></div></li><li><div class="ico-map" data-url="/files/material/icons/white/png/map.png"></div></li><li><div class="ico-mic" data-url="/files/material/icons/white/png/mic.png"></div></li><li><div class="ico-mobile" data-url="/files/material/icons/white/png/mobile.png"></div></li><li><div class="ico-monitor" data-url="/files/material/icons/white/png/monitor.png"></div></li><li><div class="ico-mug" data-url="/files/material/icons/white/png/mug.png"></div></li><li><div class="ico-music" data-url="/files/material/icons/white/png/music.png"></div></li><li><div class="ico-newspaper" data-url="/files/material/icons/white/png/newspaper.png"></div></li><li><div class="ico-notebook" data-url="/files/material/icons/white/png/notebook.png"></div></li><li><div class="ico-notification" data-url="/files/material/icons/white/png/notification.png"></div></li><li><div class="ico-numbered-list" data-url="/files/material/icons/white/png/numbered-list.png"></div></li><li><div class="ico-office" data-url="/files/material/icons/white/png/office.png"></div></li><li><div class="ico-phone-sign" data-url="/files/material/icons/white/png/phone-sign.png"></div></li><li><div class="ico-phone" data-url="/files/material/icons/white/png/phone.png"></div></li><li><div class="ico-picture" data-url="/files/material/icons/white/png/picture.png"></div></li><li><div class="ico-pie" data-url="/files/material/icons/white/png/pie.png"></div></li><li><div class="ico-play" data-url="/files/material/icons/white/png/play.png"></div></li><li><div class="ico-print" data-url="/files/material/icons/white/png/print.png"></div></li><li><div class="ico-profile" data-url="/files/material/icons/white/png/profile.png"></div></li><li><div class="ico-qrcode" data-url="/files/material/icons/white/png/qrcode.png"></div></li><li><div class="ico-question" data-url="/files/material/icons/white/png/question.png"></div></li><li><div class="ico-quote-left" data-url="/files/material/icons/white/png/quote-left.png"></div></li><li><div class="ico-rss" data-url="/files/material/icons/white/png/rss.png"></div></li><li><div class="ico-screen" data-url="/files/material/icons/white/png/screen.png"></div></li><li><div class="ico-search" data-url="/files/material/icons/white/png/search.png"></div></li><li><div class="ico-signup" data-url="/files/material/icons/white/png/signup.png"></div></li><li><div class="ico-smiley" data-url="/files/material/icons/white/png/smiley.png"></div></li><li><div class="ico-smiley2" data-url="/files/material/icons/white/png/smiley2.png"></div></li><li><div class="ico-star" data-url="/files/material/icons/white/png/star.png"></div></li><li><div class="ico-star2" data-url="/files/material/icons/white/png/star2.png"></div></li><li><div class="ico-star3" data-url="/files/material/icons/white/png/star3.png"></div></li><li><div class="ico-stats" data-url="/files/material/icons/white/png/stats.png"></div></li><li><div class="ico-stats2" data-url="/files/material/icons/white/png/stats2.png"></div></li><li><div class="ico-stopwatch" data-url="/files/material/icons/white/png/stopwatch.png"></div></li><li><div class="ico-support" data-url="/files/material/icons/white/png/support.png"></div></li><li><div class="ico-tag" data-url="/files/material/icons/white/png/tag.png"></div></li><li><div class="ico-target" data-url="/files/material/icons/white/png/target.png"></div></li><li><div class="ico-thumbs-up" data-url="/files/material/icons/white/png/thumbs-up.png"></div></li><li><div class="ico-time" data-url="/files/material/icons/white/png/time.png"></div></li><li><div class="ico-trophy" data-url="/files/material/icons/white/png/trophy.png"></div></li><li><div class="ico-user" data-url="/files/material/icons/white/png/user.png"></div></li><li><div class="ico-user2" data-url="/files/material/icons/white/png/user2.png"></div></li><li><div class="ico-user3" data-url="/files/material/icons/white/png/user3.png"></div></li><li><div class="ico-users" data-url="/files/material/icons/white/png/users.png"></div></li><li><div class="ico-users2" data-url="/files/material/icons/white/png/users2.png"></div></li><li><div class="ico-users3" data-url="/files/material/icons/white/png/users3.png"></div></li><li><div class="ico-volume-down" data-url="/files/material/icons/white/png/volume-down.png"></div></li><li><div class="ico-weibo" data-url="/files/material/icons/white/png/weibo.png"></div></li></ul></div><div id="icons-red" class="tab-pane"><ul class="iconSelecter-inner icons-red clearfix"><li><div class="ico-address-book" data-url="/files/material/icons/red/png/address-book.png"></div></li><li><div class="ico-addressbook" data-url="/files/material/icons/red/png/addressbook.png"></div></li><li><div class="ico-airplane" data-url="/files/material/icons/red/png/airplane.png"></div></li><li><div class="ico-apple" data-url="/files/material/icons/red/png/apple.png"></div></li><li><div class="ico-barcode" data-url="/files/material/icons/red/png/barcode.png"></div></li><li><div class="ico-bars" data-url="/files/material/icons/red/png/bars.png"></div></li><li><div class="ico-bars2" data-url="/files/material/icons/red/png/bars2.png"></div></li><li><div class="ico-book" data-url="/files/material/icons/red/png/book.png"></div></li><li><div class="ico-bookmark" data-url="/files/material/icons/red/png/bookmark.png"></div></li><li><div class="ico-bubble" data-url="/files/material/icons/red/png/bubble.png"></div></li><li><div class="ico-calculate" data-url="/files/material/icons/red/png/calculate.png"></div></li><li><div class="ico-calendar" data-url="/files/material/icons/red/png/calendar.png"></div></li><li><div class="ico-calendar2" data-url="/files/material/icons/red/png/calendar2.png"></div></li><li><div class="ico-camera" data-url="/files/material/icons/red/png/camera.png"></div></li><li><div class="ico-camera2" data-url="/files/material/icons/red/png/camera2.png"></div></li><li><div class="ico-cancel" data-url="/files/material/icons/red/png/cancel.png"></div></li><li><div class="ico-cart" data-url="/files/material/icons/red/png/cart.png"></div></li><li><div class="ico-cart2" data-url="/files/material/icons/red/png/cart2.png"></div></li><li><div class="ico-checkmark" data-url="/files/material/icons/red/png/checkmark.png"></div></li><li><div class="ico-clipboard" data-url="/files/material/icons/red/png/clipboard.png"></div></li><li><div class="ico-coffee" data-url="/files/material/icons/red/png/coffee.png"></div></li><li><div class="ico-cog" data-url="/files/material/icons/red/png/cog.png"></div></li><li><div class="ico-cogs" data-url="/files/material/icons/red/png/cogs.png"></div></li><li><div class="ico-compass" data-url="/files/material/icons/red/png/compass.png"></div></li><li><div class="ico-credit" data-url="/files/material/icons/red/png/credit.png"></div></li><li><div class="ico-disk" data-url="/files/material/icons/red/png/disk.png"></div></li><li><div class="ico-earth" data-url="/files/material/icons/red/png/earth.png"></div></li><li><div class="ico-edit" data-url="/files/material/icons/red/png/edit.png"></div></li><li><div class="ico-envelope" data-url="/files/material/icons/red/png/envelope.png"></div></li><li><div class="ico-external-link" data-url="/files/material/icons/red/png/external-link.png"></div></li><li><div class="ico-female" data-url="/files/material/icons/red/png/female.png"></div></li><li><div class="ico-file" data-url="/files/material/icons/red/png/file.png"></div></li><li><div class="ico-file2" data-url="/files/material/icons/red/png/file2.png"></div></li><li><div class="ico-film" data-url="/files/material/icons/red/png/film.png"></div></li><li><div class="ico-folder-open" data-url="/files/material/icons/red/png/folder-open.png"></div></li><li><div class="ico-folder" data-url="/files/material/icons/red/png/folder.png"></div></li><li><div class="ico-food" data-url="/files/material/icons/red/png/food.png"></div></li><li><div class="ico-food2" data-url="/files/material/icons/red/png/food2.png"></div></li><li><div class="ico-gift" data-url="/files/material/icons/red/png/gift.png"></div></li><li><div class="ico-graph" data-url="/files/material/icons/red/png/graph.png"></div></li><li><div class="ico-heart-empty" data-url="/files/material/icons/red/png/heart-empty.png"></div></li><li><div class="ico-heart" data-url="/files/material/icons/red/png/heart.png"></div></li><li><div class="ico-home" data-url="/files/material/icons/red/png/home.png"></div></li><li><div class="ico-image" data-url="/files/material/icons/red/png/image.png"></div></li><li><div class="ico-image2" data-url="/files/material/icons/red/png/image2.png"></div></li><li><div class="ico-info" data-url="/files/material/icons/red/png/info.png"></div></li><li><div class="ico-info2" data-url="/files/material/icons/red/png/info2.png"></div></li><li><div class="ico-ipod" data-url="/files/material/icons/red/png/ipod.png"></div></li><li><div class="ico-lab" data-url="/files/material/icons/red/png/lab.png"></div></li><li><div class="ico-list-alt" data-url="/files/material/icons/red/png/list-alt.png"></div></li><li><div class="ico-location" data-url="/files/material/icons/red/png/location.png"></div></li><li><div class="ico-lock" data-url="/files/material/icons/red/png/lock.png"></div></li><li><div class="ico-male" data-url="/files/material/icons/red/png/male.png"></div></li><li><div class="ico-map" data-url="/files/material/icons/red/png/map.png"></div></li><li><div class="ico-mic" data-url="/files/material/icons/red/png/mic.png"></div></li><li><div class="ico-mobile" data-url="/files/material/icons/red/png/mobile.png"></div></li><li><div class="ico-monitor" data-url="/files/material/icons/red/png/monitor.png"></div></li><li><div class="ico-mug" data-url="/files/material/icons/red/png/mug.png"></div></li><li><div class="ico-music" data-url="/files/material/icons/red/png/music.png"></div></li><li><div class="ico-newspaper" data-url="/files/material/icons/red/png/newspaper.png"></div></li><li><div class="ico-notebook" data-url="/files/material/icons/red/png/notebook.png"></div></li><li><div class="ico-notification" data-url="/files/material/icons/red/png/notification.png"></div></li><li><div class="ico-numbered-list" data-url="/files/material/icons/red/png/numbered-list.png"></div></li><li><div class="ico-office" data-url="/files/material/icons/red/png/office.png"></div></li><li><div class="ico-phone-sign" data-url="/files/material/icons/red/png/phone-sign.png"></div></li><li><div class="ico-phone" data-url="/files/material/icons/red/png/phone.png"></div></li><li><div class="ico-picture" data-url="/files/material/icons/red/png/picture.png"></div></li><li><div class="ico-pie" data-url="/files/material/icons/red/png/pie.png"></div></li><li><div class="ico-play" data-url="/files/material/icons/red/png/play.png"></div></li><li><div class="ico-print" data-url="/files/material/icons/red/png/print.png"></div></li><li><div class="ico-profile" data-url="/files/material/icons/red/png/profile.png"></div></li><li><div class="ico-qrcode" data-url="/files/material/icons/red/png/qrcode.png"></div></li><li><div class="ico-question" data-url="/files/material/icons/red/png/question.png"></div></li><li><div class="ico-quote-left" data-url="/files/material/icons/red/png/quote-left.png"></div></li><li><div class="ico-rss" data-url="/files/material/icons/red/png/rss.png"></div></li><li><div class="ico-screen" data-url="/files/material/icons/red/png/screen.png"></div></li><li><div class="ico-search" data-url="/files/material/icons/red/png/search.png"></div></li><li><div class="ico-signup" data-url="/files/material/icons/red/png/signup.png"></div></li><li><div class="ico-smiley" data-url="/files/material/icons/red/png/smiley.png"></div></li><li><div class="ico-smiley2" data-url="/files/material/icons/red/png/smiley2.png"></div></li><li><div class="ico-star" data-url="/files/material/icons/red/png/star.png"></div></li><li><div class="ico-star2" data-url="/files/material/icons/red/png/star2.png"></div></li><li><div class="ico-star3" data-url="/files/material/icons/red/png/star3.png"></div></li><li><div class="ico-stats" data-url="/files/material/icons/red/png/stats.png"></div></li><li><div class="ico-stats2" data-url="/files/material/icons/red/png/stats2.png"></div></li><li><div class="ico-stopwatch" data-url="/files/material/icons/red/png/stopwatch.png"></div></li><li><div class="ico-support" data-url="/files/material/icons/red/png/support.png"></div></li><li><div class="ico-tag" data-url="/files/material/icons/red/png/tag.png"></div></li><li><div class="ico-target" data-url="/files/material/icons/red/png/target.png"></div></li><li><div class="ico-thumbs-up" data-url="/files/material/icons/red/png/thumbs-up.png"></div></li><li><div class="ico-time" data-url="/files/material/icons/red/png/time.png"></div></li><li><div class="ico-trophy" data-url="/files/material/icons/red/png/trophy.png"></div></li><li><div class="ico-user" data-url="/files/material/icons/red/png/user.png"></div></li><li><div class="ico-user2" data-url="/files/material/icons/red/png/user2.png"></div></li><li><div class="ico-user3" data-url="/files/material/icons/red/png/user3.png"></div></li><li><div class="ico-users" data-url="/files/material/icons/red/png/users.png"></div></li><li><div class="ico-users2" data-url="/files/material/icons/red/png/users2.png"></div></li><li><div class="ico-users3" data-url="/files/material/icons/red/png/users3.png"></div></li><li><div class="ico-volume-down" data-url="/files/material/icons/red/png/volume-down.png"></div></li><li><div class="ico-weibo" data-url="/files/material/icons/red/png/weibo.png"></div></li></ul></div><div id="icons-yellow" class="tab-pane"><ul class="iconSelecter-inner icons-yellow clearfix"><li><div class="ico-address-book" data-url="/files/material/icons/yellow/png/address-book.png"></div></li><li><div class="ico-addressbook" data-url="/files/material/icons/yellow/png/addressbook.png"></div></li><li><div class="ico-airplane" data-url="/files/material/icons/yellow/png/airplane.png"></div></li><li><div class="ico-apple" data-url="/files/material/icons/yellow/png/apple.png"></div></li><li><div class="ico-barcode" data-url="/files/material/icons/yellow/png/barcode.png"></div></li><li><div class="ico-bars" data-url="/files/material/icons/yellow/png/bars.png"></div></li><li><div class="ico-bars2" data-url="/files/material/icons/yellow/png/bars2.png"></div></li><li><div class="ico-book" data-url="/files/material/icons/yellow/png/book.png"></div></li><li><div class="ico-bookmark" data-url="/files/material/icons/yellow/png/bookmark.png"></div></li><li><div class="ico-bubble" data-url="/files/material/icons/yellow/png/bubble.png"></div></li><li><div class="ico-calculate" data-url="/files/material/icons/yellow/png/calculate.png"></div></li><li><div class="ico-calendar" data-url="/files/material/icons/yellow/png/calendar.png"></div></li><li><div class="ico-calendar2" data-url="/files/material/icons/yellow/png/calendar2.png"></div></li><li><div class="ico-camera" data-url="/files/material/icons/yellow/png/camera.png"></div></li><li><div class="ico-camera2" data-url="/files/material/icons/yellow/png/camera2.png"></div></li><li><div class="ico-cancel" data-url="/files/material/icons/yellow/png/cancel.png"></div></li><li><div class="ico-cart" data-url="/files/material/icons/yellow/png/cart.png"></div></li><li><div class="ico-cart2" data-url="/files/material/icons/yellow/png/cart2.png"></div></li><li><div class="ico-checkmark" data-url="/files/material/icons/yellow/png/checkmark.png"></div></li><li><div class="ico-clipboard" data-url="/files/material/icons/yellow/png/clipboard.png"></div></li><li><div class="ico-coffee" data-url="/files/material/icons/yellow/png/coffee.png"></div></li><li><div class="ico-cog" data-url="/files/material/icons/yellow/png/cog.png"></div></li><li><div class="ico-cogs" data-url="/files/material/icons/yellow/png/cogs.png"></div></li><li><div class="ico-compass" data-url="/files/material/icons/yellow/png/compass.png"></div></li><li><div class="ico-credit" data-url="/files/material/icons/yellow/png/credit.png"></div></li><li><div class="ico-disk" data-url="/files/material/icons/yellow/png/disk.png"></div></li><li><div class="ico-earth" data-url="/files/material/icons/yellow/png/earth.png"></div></li><li><div class="ico-edit" data-url="/files/material/icons/yellow/png/edit.png"></div></li><li><div class="ico-envelope" data-url="/files/material/icons/yellow/png/envelope.png"></div></li><li><div class="ico-external-link" data-url="/files/material/icons/yellow/png/external-link.png"></div></li><li><div class="ico-female" data-url="/files/material/icons/yellow/png/female.png"></div></li><li><div class="ico-file" data-url="/files/material/icons/yellow/png/file.png"></div></li><li><div class="ico-file2" data-url="/files/material/icons/yellow/png/file2.png"></div></li><li><div class="ico-film" data-url="/files/material/icons/yellow/png/film.png"></div></li><li><div class="ico-folder-open" data-url="/files/material/icons/yellow/png/folder-open.png"></div></li><li><div class="ico-folder" data-url="/files/material/icons/yellow/png/folder.png"></div></li><li><div class="ico-food" data-url="/files/material/icons/yellow/png/food.png"></div></li><li><div class="ico-food2" data-url="/files/material/icons/yellow/png/food2.png"></div></li><li><div class="ico-gift" data-url="/files/material/icons/yellow/png/gift.png"></div></li><li><div class="ico-graph" data-url="/files/material/icons/yellow/png/graph.png"></div></li><li><div class="ico-heart-empty" data-url="/files/material/icons/yellow/png/heart-empty.png"></div></li><li><div class="ico-heart" data-url="/files/material/icons/yellow/png/heart.png"></div></li><li><div class="ico-home" data-url="/files/material/icons/yellow/png/home.png"></div></li><li><div class="ico-image" data-url="/files/material/icons/yellow/png/image.png"></div></li><li><div class="ico-image2" data-url="/files/material/icons/yellow/png/image2.png"></div></li><li><div class="ico-info" data-url="/files/material/icons/yellow/png/info.png"></div></li><li><div class="ico-info2" data-url="/files/material/icons/yellow/png/info2.png"></div></li><li><div class="ico-ipod" data-url="/files/material/icons/yellow/png/ipod.png"></div></li><li><div class="ico-lab" data-url="/files/material/icons/yellow/png/lab.png"></div></li><li><div class="ico-list-alt" data-url="/files/material/icons/yellow/png/list-alt.png"></div></li><li><div class="ico-location" data-url="/files/material/icons/yellow/png/location.png"></div></li><li><div class="ico-lock" data-url="/files/material/icons/yellow/png/lock.png"></div></li><li><div class="ico-male" data-url="/files/material/icons/yellow/png/male.png"></div></li><li><div class="ico-map" data-url="/files/material/icons/yellow/png/map.png"></div></li><li><div class="ico-mic" data-url="/files/material/icons/yellow/png/mic.png"></div></li><li><div class="ico-mobile" data-url="/files/material/icons/yellow/png/mobile.png"></div></li><li><div class="ico-monitor" data-url="/files/material/icons/yellow/png/monitor.png"></div></li><li><div class="ico-mug" data-url="/files/material/icons/yellow/png/mug.png"></div></li><li><div class="ico-music" data-url="/files/material/icons/yellow/png/music.png"></div></li><li><div class="ico-newspaper" data-url="/files/material/icons/yellow/png/newspaper.png"></div></li><li><div class="ico-notebook" data-url="/files/material/icons/yellow/png/notebook.png"></div></li><li><div class="ico-notification" data-url="/files/material/icons/yellow/png/notification.png"></div></li><li><div class="ico-numbered-list" data-url="/files/material/icons/yellow/png/numbered-list.png"></div></li><li><div class="ico-office" data-url="/files/material/icons/yellow/png/office.png"></div></li><li><div class="ico-phone-sign" data-url="/files/material/icons/yellow/png/phone-sign.png"></div></li><li><div class="ico-phone" data-url="/files/material/icons/yellow/png/phone.png"></div></li><li><div class="ico-picture" data-url="/files/material/icons/yellow/png/picture.png"></div></li><li><div class="ico-pie" data-url="/files/material/icons/yellow/png/pie.png"></div></li><li><div class="ico-play" data-url="/files/material/icons/yellow/png/play.png"></div></li><li><div class="ico-print" data-url="/files/material/icons/yellow/png/print.png"></div></li><li><div class="ico-profile" data-url="/files/material/icons/yellow/png/profile.png"></div></li><li><div class="ico-qrcode" data-url="/files/material/icons/yellow/png/qrcode.png"></div></li><li><div class="ico-question" data-url="/files/material/icons/yellow/png/question.png"></div></li><li><div class="ico-quote-left" data-url="/files/material/icons/yellow/png/quote-left.png"></div></li><li><div class="ico-rss" data-url="/files/material/icons/yellow/png/rss.png"></div></li><li><div class="ico-screen" data-url="/files/material/icons/yellow/png/screen.png"></div></li><li><div class="ico-search" data-url="/files/material/icons/yellow/png/search.png"></div></li><li><div class="ico-signup" data-url="/files/material/icons/yellow/png/signup.png"></div></li><li><div class="ico-smiley" data-url="/files/material/icons/yellow/png/smiley.png"></div></li><li><div class="ico-smiley2" data-url="/files/material/icons/yellow/png/smiley2.png"></div></li><li><div class="ico-star" data-url="/files/material/icons/yellow/png/star.png"></div></li><li><div class="ico-star2" data-url="/files/material/icons/yellow/png/star2.png"></div></li><li><div class="ico-star3" data-url="/files/material/icons/yellow/png/star3.png"></div></li><li><div class="ico-stats" data-url="/files/material/icons/yellow/png/stats.png"></div></li><li><div class="ico-stats2" data-url="/files/material/icons/yellow/png/stats2.png"></div></li><li><div class="ico-stopwatch" data-url="/files/material/icons/yellow/png/stopwatch.png"></div></li><li><div class="ico-support" data-url="/files/material/icons/yellow/png/support.png"></div></li><li><div class="ico-tag" data-url="/files/material/icons/yellow/png/tag.png"></div></li><li><div class="ico-target" data-url="/files/material/icons/yellow/png/target.png"></div></li><li><div class="ico-thumbs-up" data-url="/files/material/icons/yellow/png/thumbs-up.png"></div></li><li><div class="ico-time" data-url="/files/material/icons/yellow/png/time.png"></div></li><li><div class="ico-trophy" data-url="/files/material/icons/yellow/png/trophy.png"></div></li><li><div class="ico-user" data-url="/files/material/icons/yellow/png/user.png"></div></li><li><div class="ico-user2" data-url="/files/material/icons/yellow/png/user2.png"></div></li><li><div class="ico-user3" data-url="/files/material/icons/yellow/png/user3.png"></div></li><li><div class="ico-users" data-url="/files/material/icons/yellow/png/users.png"></div></li><li><div class="ico-users2" data-url="/files/material/icons/yellow/png/users2.png"></div></li><li><div class="ico-users3" data-url="/files/material/icons/yellow/png/users3.png"></div></li><li><div class="ico-volume-down" data-url="/files/material/icons/yellow/png/volume-down.png"></div></li><li><div class="ico-weibo" data-url="/files/material/icons/yellow/png/weibo.png"></div></li></ul></div><div id="icons-green" class="tab-pane"><ul class="iconSelecter-inner icons-green clearfix"><li><div class="ico-address-book" data-url="/files/material/icons/green/png/address-book.png"></div></li><li><div class="ico-addressbook" data-url="/files/material/icons/green/png/addressbook.png"></div></li><li><div class="ico-airplane" data-url="/files/material/icons/green/png/airplane.png"></div></li><li><div class="ico-apple" data-url="/files/material/icons/green/png/apple.png"></div></li><li><div class="ico-barcode" data-url="/files/material/icons/green/png/barcode.png"></div></li><li><div class="ico-bars" data-url="/files/material/icons/green/png/bars.png"></div></li><li><div class="ico-bars2" data-url="/files/material/icons/green/png/bars2.png"></div></li><li><div class="ico-book" data-url="/files/material/icons/green/png/book.png"></div></li><li><div class="ico-bookmark" data-url="/files/material/icons/green/png/bookmark.png"></div></li><li><div class="ico-bubble" data-url="/files/material/icons/green/png/bubble.png"></div></li><li><div class="ico-calculate" data-url="/files/material/icons/green/png/calculate.png"></div></li><li><div class="ico-calendar" data-url="/files/material/icons/green/png/calendar.png"></div></li><li><div class="ico-calendar2" data-url="/files/material/icons/green/png/calendar2.png"></div></li><li><div class="ico-camera" data-url="/files/material/icons/green/png/camera.png"></div></li><li><div class="ico-camera2" data-url="/files/material/icons/green/png/camera2.png"></div></li><li><div class="ico-cancel" data-url="/files/material/icons/green/png/cancel.png"></div></li><li><div class="ico-cart" data-url="/files/material/icons/green/png/cart.png"></div></li><li><div class="ico-cart2" data-url="/files/material/icons/green/png/cart2.png"></div></li><li><div class="ico-checkmark" data-url="/files/material/icons/green/png/checkmark.png"></div></li><li><div class="ico-clipboard" data-url="/files/material/icons/green/png/clipboard.png"></div></li><li><div class="ico-coffee" data-url="/files/material/icons/green/png/coffee.png"></div></li><li><div class="ico-cog" data-url="/files/material/icons/green/png/cog.png"></div></li><li><div class="ico-cogs" data-url="/files/material/icons/green/png/cogs.png"></div></li><li><div class="ico-compass" data-url="/files/material/icons/green/png/compass.png"></div></li><li><div class="ico-credit" data-url="/files/material/icons/green/png/credit.png"></div></li><li><div class="ico-disk" data-url="/files/material/icons/green/png/disk.png"></div></li><li><div class="ico-earth" data-url="/files/material/icons/green/png/earth.png"></div></li><li><div class="ico-edit" data-url="/files/material/icons/green/png/edit.png"></div></li><li><div class="ico-envelope" data-url="/files/material/icons/green/png/envelope.png"></div></li><li><div class="ico-external-link" data-url="/files/material/icons/green/png/external-link.png"></div></li><li><div class="ico-female" data-url="/files/material/icons/green/png/female.png"></div></li><li><div class="ico-file" data-url="/files/material/icons/green/png/file.png"></div></li><li><div class="ico-file2" data-url="/files/material/icons/green/png/file2.png"></div></li><li><div class="ico-film" data-url="/files/material/icons/green/png/film.png"></div></li><li><div class="ico-folder-open" data-url="/files/material/icons/green/png/folder-open.png"></div></li><li><div class="ico-folder" data-url="/files/material/icons/green/png/folder.png"></div></li><li><div class="ico-food" data-url="/files/material/icons/green/png/food.png"></div></li><li><div class="ico-food2" data-url="/files/material/icons/green/png/food2.png"></div></li><li><div class="ico-gift" data-url="/files/material/icons/green/png/gift.png"></div></li><li><div class="ico-graph" data-url="/files/material/icons/green/png/graph.png"></div></li><li><div class="ico-heart-empty" data-url="/files/material/icons/green/png/heart-empty.png"></div></li><li><div class="ico-heart" data-url="/files/material/icons/green/png/heart.png"></div></li><li><div class="ico-home" data-url="/files/material/icons/green/png/home.png"></div></li><li><div class="ico-image" data-url="/files/material/icons/green/png/image.png"></div></li><li><div class="ico-image2" data-url="/files/material/icons/green/png/image2.png"></div></li><li><div class="ico-info" data-url="/files/material/icons/green/png/info.png"></div></li><li><div class="ico-info2" data-url="/files/material/icons/green/png/info2.png"></div></li><li><div class="ico-ipod" data-url="/files/material/icons/green/png/ipod.png"></div></li><li><div class="ico-lab" data-url="/files/material/icons/green/png/lab.png"></div></li><li><div class="ico-list-alt" data-url="/files/material/icons/green/png/list-alt.png"></div></li><li><div class="ico-location" data-url="/files/material/icons/green/png/location.png"></div></li><li><div class="ico-lock" data-url="/files/material/icons/green/png/lock.png"></div></li><li><div class="ico-male" data-url="/files/material/icons/green/png/male.png"></div></li><li><div class="ico-map" data-url="/files/material/icons/green/png/map.png"></div></li><li><div class="ico-mic" data-url="/files/material/icons/green/png/mic.png"></div></li><li><div class="ico-mobile" data-url="/files/material/icons/green/png/mobile.png"></div></li><li><div class="ico-monitor" data-url="/files/material/icons/green/png/monitor.png"></div></li><li><div class="ico-mug" data-url="/files/material/icons/green/png/mug.png"></div></li><li><div class="ico-music" data-url="/files/material/icons/green/png/music.png"></div></li><li><div class="ico-newspaper" data-url="/files/material/icons/green/png/newspaper.png"></div></li><li><div class="ico-notebook" data-url="/files/material/icons/green/png/notebook.png"></div></li><li><div class="ico-notification" data-url="/files/material/icons/green/png/notification.png"></div></li><li><div class="ico-numbered-list" data-url="/files/material/icons/green/png/numbered-list.png"></div></li><li><div class="ico-office" data-url="/files/material/icons/green/png/office.png"></div></li><li><div class="ico-phone-sign" data-url="/files/material/icons/green/png/phone-sign.png"></div></li><li><div class="ico-phone" data-url="/files/material/icons/green/png/phone.png"></div></li><li><div class="ico-picture" data-url="/files/material/icons/green/png/picture.png"></div></li><li><div class="ico-pie" data-url="/files/material/icons/green/png/pie.png"></div></li><li><div class="ico-play" data-url="/files/material/icons/green/png/play.png"></div></li><li><div class="ico-print" data-url="/files/material/icons/green/png/print.png"></div></li><li><div class="ico-profile" data-url="/files/material/icons/green/png/profile.png"></div></li><li><div class="ico-qrcode" data-url="/files/material/icons/green/png/qrcode.png"></div></li><li><div class="ico-question" data-url="/files/material/icons/green/png/question.png"></div></li><li><div class="ico-quote-left" data-url="/files/material/icons/green/png/quote-left.png"></div></li><li><div class="ico-rss" data-url="/files/material/icons/green/png/rss.png"></div></li><li><div class="ico-screen" data-url="/files/material/icons/green/png/screen.png"></div></li><li><div class="ico-search" data-url="/files/material/icons/green/png/search.png"></div></li><li><div class="ico-signup" data-url="/files/material/icons/green/png/signup.png"></div></li><li><div class="ico-smiley" data-url="/files/material/icons/green/png/smiley.png"></div></li><li><div class="ico-smiley2" data-url="/files/material/icons/green/png/smiley2.png"></div></li><li><div class="ico-star" data-url="/files/material/icons/green/png/star.png"></div></li><li><div class="ico-star2" data-url="/files/material/icons/green/png/star2.png"></div></li><li><div class="ico-star3" data-url="/files/material/icons/green/png/star3.png"></div></li><li><div class="ico-stats" data-url="/files/material/icons/green/png/stats.png"></div></li><li><div class="ico-stats2" data-url="/files/material/icons/green/png/stats2.png"></div></li><li><div class="ico-stopwatch" data-url="/files/material/icons/green/png/stopwatch.png"></div></li><li><div class="ico-support" data-url="/files/material/icons/green/png/support.png"></div></li><li><div class="ico-tag" data-url="/files/material/icons/green/png/tag.png"></div></li><li><div class="ico-target" data-url="/files/material/icons/green/png/target.png"></div></li><li><div class="ico-thumbs-up" data-url="/files/material/icons/green/png/thumbs-up.png"></div></li><li><div class="ico-time" data-url="/files/material/icons/green/png/time.png"></div></li><li><div class="ico-trophy" data-url="/files/material/icons/green/png/trophy.png"></div></li><li><div class="ico-user" data-url="/files/material/icons/green/png/user.png"></div></li><li><div class="ico-user2" data-url="/files/material/icons/green/png/user2.png"></div></li><li><div class="ico-user3" data-url="/files/material/icons/green/png/user3.png"></div></li><li><div class="ico-users" data-url="/files/material/icons/green/png/users.png"></div></li><li><div class="ico-users2" data-url="/files/material/icons/green/png/users2.png"></div></li><li><div class="ico-users3" data-url="/files/material/icons/green/png/users3.png"></div></li><li><div class="ico-volume-down" data-url="/files/material/icons/green/png/volume-down.png"></div></li><li><div class="ico-weibo" data-url="/files/material/icons/green/png/weibo.png"></div></li></ul></div><div id="icons-blue" class="tab-pane"><ul class="iconSelecter-inner icons-blue clearfix"><li><div class="ico-address-book" data-url="/files/material/icons/blue/png/address-book.png"></div></li><li><div class="ico-addressbook" data-url="/files/material/icons/blue/png/addressbook.png"></div></li><li><div class="ico-airplane" data-url="/files/material/icons/blue/png/airplane.png"></div></li><li><div class="ico-apple" data-url="/files/material/icons/blue/png/apple.png"></div></li><li><div class="ico-barcode" data-url="/files/material/icons/blue/png/barcode.png"></div></li><li><div class="ico-bars" data-url="/files/material/icons/blue/png/bars.png"></div></li><li><div class="ico-bars2" data-url="/files/material/icons/blue/png/bars2.png"></div></li><li><div class="ico-book" data-url="/files/material/icons/blue/png/book.png"></div></li><li><div class="ico-bookmark" data-url="/files/material/icons/blue/png/bookmark.png"></div></li><li><div class="ico-bubble" data-url="/files/material/icons/blue/png/bubble.png"></div></li><li><div class="ico-calculate" data-url="/files/material/icons/blue/png/calculate.png"></div></li><li><div class="ico-calendar" data-url="/files/material/icons/blue/png/calendar.png"></div></li><li><div class="ico-calendar2" data-url="/files/material/icons/blue/png/calendar2.png"></div></li><li><div class="ico-camera" data-url="/files/material/icons/blue/png/camera.png"></div></li><li><div class="ico-camera2" data-url="/files/material/icons/blue/png/camera2.png"></div></li><li><div class="ico-cancel" data-url="/files/material/icons/blue/png/cancel.png"></div></li><li><div class="ico-cart" data-url="/files/material/icons/blue/png/cart.png"></div></li><li><div class="ico-cart2" data-url="/files/material/icons/blue/png/cart2.png"></div></li><li><div class="ico-checkmark" data-url="/files/material/icons/blue/png/checkmark.png"></div></li><li><div class="ico-clipboard" data-url="/files/material/icons/blue/png/clipboard.png"></div></li><li><div class="ico-coffee" data-url="/files/material/icons/blue/png/coffee.png"></div></li><li><div class="ico-cog" data-url="/files/material/icons/blue/png/cog.png"></div></li><li><div class="ico-cogs" data-url="/files/material/icons/blue/png/cogs.png"></div></li><li><div class="ico-compass" data-url="/files/material/icons/blue/png/compass.png"></div></li><li><div class="ico-credit" data-url="/files/material/icons/blue/png/credit.png"></div></li><li><div class="ico-disk" data-url="/files/material/icons/blue/png/disk.png"></div></li><li><div class="ico-earth" data-url="/files/material/icons/blue/png/earth.png"></div></li><li><div class="ico-edit" data-url="/files/material/icons/blue/png/edit.png"></div></li><li><div class="ico-envelope" data-url="/files/material/icons/blue/png/envelope.png"></div></li><li><div class="ico-external-link" data-url="/files/material/icons/blue/png/external-link.png"></div></li><li><div class="ico-female" data-url="/files/material/icons/blue/png/female.png"></div></li><li><div class="ico-file" data-url="/files/material/icons/blue/png/file.png"></div></li><li><div class="ico-file2" data-url="/files/material/icons/blue/png/file2.png"></div></li><li><div class="ico-film" data-url="/files/material/icons/blue/png/film.png"></div></li><li><div class="ico-folder-open" data-url="/files/material/icons/blue/png/folder-open.png"></div></li><li><div class="ico-folder" data-url="/files/material/icons/blue/png/folder.png"></div></li><li><div class="ico-food" data-url="/files/material/icons/blue/png/food.png"></div></li><li><div class="ico-food2" data-url="/files/material/icons/blue/png/food2.png"></div></li><li><div class="ico-gift" data-url="/files/material/icons/blue/png/gift.png"></div></li><li><div class="ico-graph" data-url="/files/material/icons/blue/png/graph.png"></div></li><li><div class="ico-heart-empty" data-url="/files/material/icons/blue/png/heart-empty.png"></div></li><li><div class="ico-heart" data-url="/files/material/icons/blue/png/heart.png"></div></li><li><div class="ico-home" data-url="/files/material/icons/blue/png/home.png"></div></li><li><div class="ico-image" data-url="/files/material/icons/blue/png/image.png"></div></li><li><div class="ico-image2" data-url="/files/material/icons/blue/png/image2.png"></div></li><li><div class="ico-info" data-url="/files/material/icons/blue/png/info.png"></div></li><li><div class="ico-info2" data-url="/files/material/icons/blue/png/info2.png"></div></li><li><div class="ico-ipod" data-url="/files/material/icons/blue/png/ipod.png"></div></li><li><div class="ico-lab" data-url="/files/material/icons/blue/png/lab.png"></div></li><li><div class="ico-list-alt" data-url="/files/material/icons/blue/png/list-alt.png"></div></li><li><div class="ico-location" data-url="/files/material/icons/blue/png/location.png"></div></li><li><div class="ico-lock" data-url="/files/material/icons/blue/png/lock.png"></div></li><li><div class="ico-male" data-url="/files/material/icons/blue/png/male.png"></div></li><li><div class="ico-map" data-url="/files/material/icons/blue/png/map.png"></div></li><li><div class="ico-mic" data-url="/files/material/icons/blue/png/mic.png"></div></li><li><div class="ico-mobile" data-url="/files/material/icons/blue/png/mobile.png"></div></li><li><div class="ico-monitor" data-url="/files/material/icons/blue/png/monitor.png"></div></li><li><div class="ico-mug" data-url="/files/material/icons/blue/png/mug.png"></div></li><li><div class="ico-music" data-url="/files/material/icons/blue/png/music.png"></div></li><li><div class="ico-newspaper" data-url="/files/material/icons/blue/png/newspaper.png"></div></li><li><div class="ico-notebook" data-url="/files/material/icons/blue/png/notebook.png"></div></li><li><div class="ico-notification" data-url="/files/material/icons/blue/png/notification.png"></div></li><li><div class="ico-numbered-list" data-url="/files/material/icons/blue/png/numbered-list.png"></div></li><li><div class="ico-office" data-url="/files/material/icons/blue/png/office.png"></div></li><li><div class="ico-phone-sign" data-url="/files/material/icons/blue/png/phone-sign.png"></div></li><li><div class="ico-phone" data-url="/files/material/icons/blue/png/phone.png"></div></li><li><div class="ico-picture" data-url="/files/material/icons/blue/png/picture.png"></div></li><li><div class="ico-pie" data-url="/files/material/icons/blue/png/pie.png"></div></li><li><div class="ico-play" data-url="/files/material/icons/blue/png/play.png"></div></li><li><div class="ico-print" data-url="/files/material/icons/blue/png/print.png"></div></li><li><div class="ico-profile" data-url="/files/material/icons/blue/png/profile.png"></div></li><li><div class="ico-qrcode" data-url="/files/material/icons/blue/png/qrcode.png"></div></li><li><div class="ico-question" data-url="/files/material/icons/blue/png/question.png"></div></li><li><div class="ico-quote-left" data-url="/files/material/icons/blue/png/quote-left.png"></div></li><li><div class="ico-rss" data-url="/files/material/icons/blue/png/rss.png"></div></li><li><div class="ico-screen" data-url="/files/material/icons/blue/png/screen.png"></div></li><li><div class="ico-search" data-url="/files/material/icons/blue/png/search.png"></div></li><li><div class="ico-signup" data-url="/files/material/icons/blue/png/signup.png"></div></li><li><div class="ico-smiley" data-url="/files/material/icons/blue/png/smiley.png"></div></li><li><div class="ico-smiley2" data-url="/files/material/icons/blue/png/smiley2.png"></div></li><li><div class="ico-star" data-url="/files/material/icons/blue/png/star.png"></div></li><li><div class="ico-star2" data-url="/files/material/icons/blue/png/star2.png"></div></li><li><div class="ico-star3" data-url="/files/material/icons/blue/png/star3.png"></div></li><li><div class="ico-stats" data-url="/files/material/icons/blue/png/stats.png"></div></li><li><div class="ico-stats2" data-url="/files/material/icons/blue/png/stats2.png"></div></li><li><div class="ico-stopwatch" data-url="/files/material/icons/blue/png/stopwatch.png"></div></li><li><div class="ico-support" data-url="/files/material/icons/blue/png/support.png"></div></li><li><div class="ico-tag" data-url="/files/material/icons/blue/png/tag.png"></div></li><li><div class="ico-target" data-url="/files/material/icons/blue/png/target.png"></div></li><li><div class="ico-thumbs-up" data-url="/files/material/icons/blue/png/thumbs-up.png"></div></li><li><div class="ico-time" data-url="/files/material/icons/blue/png/time.png"></div></li><li><div class="ico-trophy" data-url="/files/material/icons/blue/png/trophy.png"></div></li><li><div class="ico-user" data-url="/files/material/icons/blue/png/user.png"></div></li><li><div class="ico-user2" data-url="/files/material/icons/blue/png/user2.png"></div></li><li><div class="ico-user3" data-url="/files/material/icons/blue/png/user3.png"></div></li><li><div class="ico-users" data-url="/files/material/icons/blue/png/users.png"></div></li><li><div class="ico-users2" data-url="/files/material/icons/blue/png/users2.png"></div></li><li><div class="ico-users3" data-url="/files/material/icons/blue/png/users3.png"></div></li><li><div class="ico-volume-down" data-url="/files/material/icons/blue/png/volume-down.png"></div></li><li><div class="ico-weibo" data-url="/files/material/icons/blue/png/weibo.png"></div></li></ul></div>		                            </div>			                    </div>			                </div>			                <div class="modal-footer">			                    <button data-dismiss="modal" type="button" class="btn btn-cancel">			                        <i class="icon-remove bigger-110"></i>取消			                    </button>			                    <button data-action="selectIcon" class="btn btn-success">			                        <i class="icon-ok bigger-110"></i>确定			                    </button>			                </div>			            </div>			        </div>			    </div>';return t},o=function(e){var t="";e?t="此栏目集还没有子栏目哦.<br>现在就从下面的列表中选择一种栏目类型，创建一个子栏目吧.":t="您还没有添加栏目哦.<br>现在就从下面的列表中选择一种栏目类型，开始创建你的微站吧.";var n='<hr>				<div class="row hide" data-block="addSection">					<div class="col-sm-12">			            <div class="alert alert-info noSection">			                <p>'+t+'</p>			                <ul>			                    <li class="pre_folder disc" data-item="sectionSet">			                        <a href="#" class="folder" data-section-type="SECTION_SET" data-section-name="栏目集">			                            <i class="icon-folder-open bigger-300">			                                <span>栏目集</span>			                            </i>			                        </a>			                    </li>			                    <li class="pre_news w2">			                        <a href="#" class="btn btn-app btn-light radius-4" data-section-type="NEWS" data-section-name="有列表图文">			                            <i class="icon-rss bigger-160">			                            </i>			                            有列表图文			                        </a>			                    </li>			                    <li class="pre_custom_page">			                        <a href="#" class="btn btn-app btn-light radius-4" data-section-type="CUSTOM_PAGE" data-section-name="无列表图文">			                            <i class="icon-file-text bigger-160">			                            </i>			                            无列表图文			                        </a>			                    </li>			                    <li class="pre_gallery w2">			                        <a href="#" class="btn btn-app btn-light radius-4" data-section-type="GALLERY" data-section-name="图集">			                            <i class="icon-picture bigger-160">			                            </i>			                            图集			                        </a>			                    </li>			                    <li class="pre_tel disc">			                        <a href="#" class="btn btn-app btn-light radius-4" data-section-type="TEL" data-section-name="拨打电话">			                            <i class="icon-phone bigger-160">			                            </i>			                            拨打电话			                        </a>			                    </li>			                    <li class="pre_branch">			                        <a href="#" class="btn btn-app btn-light radius-4" data-section-type="BRANCH" data-section-name="网点">			                            <i class="icon-map-marker bigger-160">			                            </i>			                            网点			                        </a>			                    </li>			                    <li class="pre_contact_way">			                        <a href="#" class="btn btn-app btn-light radius-4" data-section-type="CONTACT_WAY" data-section-name="联系方式">			                            <i class="icon-user bigger-160">			                            </i>			                            联系方式			                        </a>			                    </li>			                    <li class="pre_event w2">			                        <a href="#" class="btn btn-app btn-light radius-4" data-section-type="EVENT" data-section-name="活动">			                            <i class="icon-volume-down bigger-160">			                            </i>			                            活动			                        </a>			                    </li>			                    <li class="pre_appointment">			                        <a href="#" class="btn btn-app btn-light radius-4" data-section-type="APPOINTMENT" data-section-name="预约">			                            <i class="icon-time bigger-160">			                            </i>			                            预约			                        </a>			                    </li>			                    <li class="pre_product w2">			                        <a href="#" class="btn btn-app btn-light radius-4" data-section-type="PRODUCT" data-section-name="商城">			                            <i class="icon-shopping-cart bigger-160">			                            </i>			                            商城			                        </a>			                    </li>			                    <li class="pre_link disc">			                    	<a href="#" class="btn btn-app btn-light radius-4" data-section-type="LINK" data-section-name="外部链接">			                    	<i class="icon-link bigger-160">			                    	</i>			                    	外部链接			                    	</a>			                    </li>			                </ul>			            </div>			        </div>			    </div>			    <div class="sectionList-inner hide" data-block="sectionList">					<div class="sectionList-title">栏目列表</div>					<div class="space-4"></div>				    <ul data-block="sList"></ul>			    </div>';return n},u=function(e){console.log(e);var t="",i;return n.each(e,function(e,n){i='<li data-id="'+e.id+'" id="section-li-'+e.id+'">		            <form action="" class="form-horizontal">		                <div class="col-sm-6">		                    <div class="form-group">		                        <label class="col-sm-3 no-padding-left control-label no-padding-right grey">		                            栏目名称		                        </label>		                        <div class="col-sm-9">		                            <input type="text" class="col-sm-12" name="name" placeholder="栏目名称" value="'+e.name+'">		                        </div>		                    </div>		                </div>		                <div class="col-sm-6 accessSection">	                        <a href="/builder/'+r.App.config.currentApp.id+"/cms/"+e.id+'/content" class="accessSectionLink">进入栏目</a>	                    </div>		                <div class="clearfix"></div>		                <div class="col-sm-10 no-padding-left" data-block="sectionDescp">		                    <div class="form-group">		                        <label class="col-sm-2 no-padding-left control-label no-padding-right grey">		                            栏目描述		                        </label>		                        <div class="col-sm-10">		                            <input type="text" class="col-sm-12" name="descp" placeholder="栏目描述" value="'+(e.descp||"")+'">		                        </div>		                    </div>		                </div>		                <div class="clearfix"></div>		                <div class="col-sm-6">		                    <div class="form-group">		                        <label class="col-sm-3 no-padding-left control-label no-padding-right grey">		                            图标		                        </label>		                        <div class="col-sm-9 clearfix">		                            <div class="widget-fgp-image" style="width:180px;">		                                <div class="pull-left">		                                    <img data-src="holder.js/100x100/text:最大尺寸 200x200" data-action="uploadIcon" alt="最大尺寸 200x200" src="">		                                </div>		                                <div class="pull-right">		                                    <button type="button" class="btn btn-xs btn-default" data-action="showIconSelecter">		                                        <i class="icon-th bigger-125">		                                        </i>		                                        选择		                                    </button>		                                    <br>		                                    <div class="space-4"></div>		                                    <button type="button" class="btn btn-xs btn-default" data-action="uploadIcon">		                                        <i class="icon-arrow-up bigger-125">		                                        </i>		                                        上传		                                    </button>		                                </div>		                            </div>		                        </div>		                    </div>		                </div>		                <div class="col-sm-6">		                    <div class="form-group">		                        <label class="col-sm-3 no-padding-left control-label no-padding-right grey">	                            		栏目图片		                        </label>		                        <div class="col-sm-9 clearfix">		                            <div class="widget-fgp-image" style="width:180px;">		                                <div class="pull-left">		                                    <img data-src="holder.js/100x100/text:最大尺寸 400x330" data-action="uploadIconBg" alt="最大尺寸 400x330" src="">		                                </div>		                                <div class="pull-right">		                                    <button type="button" class="btn btn-xs btn-default" data-action="uploadIconBg">		                                        <i class="icon-arrow-up bigger-125"></i>上传		                                    </button>		                                </div>		                            </div>		                        </div>		                    </div>		                </div>		                <div class="clearfix"></div>		            </form>			    </li>',t+=i}),t}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.cms.Sidebar=r.common.BaseView.extend({events:{"click li>a":"_openSection","click a[data-action=navAppHome]":"_navAppHome","click .sidebar-shortcuts .btn[data-action=createSection]":"_createSection","click .sidebar-shortcuts .btn[data-action=sort]":"_sortSections","click .sidebar-shortcuts .btn[data-action=cancelSort]":"_cacelSort","click i[data-action=addChildSection]":"_newChildSection","click i[data-action=delete]":"_deleteSection"},doInitialize:function(){this.$el.append('<div class="sidebar-inner"/>'),this._render(),this.setCurrentMenu(this.args.sectionId),t.Events.on("sections.updated",this._onSectionsUpdated=n.bind(this._onSectionsUpdated,this)),t.Events.on("section.updated",this._onSectionUpdated=n.bind(this._onSectionUpdated,this)),t.Events.on("section.removed",this._onSectionRemoved=n.bind(this._onSectionRemoved,this)),t.Events.on("cms.section.show",this._onSectionModuleOpened=n.bind(this._onSectionModuleOpened,this)),t.Events.on("cms.home.show",this._onHomePageOpened=n.bind(this._onHomePageOpened,this))},viewport:function(){return this.$el},onRemove:function(){t.Events.off("sections.updated",this._onSectionsUpdated),t.Events.off("section.updated",this._onSectionUpdated),t.Events.off("section.removed",this._onSectionRemoved),t.Events.off("cms.section.show",this._onSectionModuleOpened)},setCurrentMenu:function(e){this.currMenu=e?this._findSectionById(e):"home"},_render:function(){var e=r.App.config.currentApp.sections;this.$el.html(i(e)),this._sortableSections()},_sortableSections:function(){this.$el.find(".nav-list").nestedSortable({attribute:"sort-data",forcePlaceholderSize:!0,listType:"ul",handle:".sort-handler-bg",helper:"clone",items:"li",opacity:.6,placeholder:"placeholder",revert:250,tabSize:25,scroll:!1,tolerance:"pointer",toleranceElement:">.sort-handler-bg",disableNestingClass:"no-nesting",maxLevels:2,isAllowed:this._isNestedOperationAllowed,start:n.bind(this._onSectionDragStart,this),stop:n.bind(this._onSectionDragStop,this)}).nestedSortable("disable")},_navAppHome:function(e){e.preventDefault(),r.modules.AppPreviewer.navHome(),r.navigate("/builder/"+r.App.config.currentApp.id+"/cms/home"),t.Events.trigger("cms.home.show")},_openSection:function(t){t.preventDefault();var n=e(t.target).parent("a");n.length||(n=e(t.target)),this.currMenu=this._findSectionById(e(t.target).closest("li").data("section-id"));if(this.currMenu.type.name=="分享活动"){window.location="/marketing/activity/edit/"+this.currMenu.share_item_id;return}r.navigate(n.attr("href").replace(r.App.config.root,"")),r.modules.AppPreviewer.navSection({sectionId:e(t.target).closest("li").attr("data-section-id")})},_newChildSection:function(t){t.preventDefault(),t.stopPropagation();var n=e(t.target).parents("li[data-section-id]").data().sectionId;new r.modules.cms.SectionCreationDialog({parentSection:this._findSectionById(n)})},_deleteSection:function(t){t.preventDefault(),t.stopPropagation();var i=e(t.target).parents("li[data-section-id]").data().sectionId,s=this._findSectionById(i),o=n.find(r.App.config.currentApp.sections,function(e){return e.parent_id==s.id}),u=this;r.confirm("删除栏目【"+s.name+"】","删除后无法恢复，确定要删除这个栏目及栏目中所有内容吗?",function(){u._doDeleteSection(s)})},_doDeleteSection:function(n){var i=this;e.ajax(r.api("/sections/"+n.id),{type:"DELETE",data:{authenticityToken:r.App.config.authToken}}).done(function(e){if(e.code&&e.code!=200){r.showMessage("ERROR","栏目【"+i._section.name+"】删除失败, 请先删除关联的内容和子栏目.",!1);return}t.Events.trigger("section.removed",n)}).error(function(){r.showMessage("ERROR","栏目【"+n.name+"】删除失败",!0)})},_createSection:function(e){e.preventDefault(),new r.modules.cms.SectionCreationDialog},_sortSections:function(t){if(r.App.currentView()&&r.App.currentView().isChanged()){r.showMessage("ERROR","<strong>你当前还有未保存的修改内容</Strong>. 请先保存你的修改内容.",!0);return}var n=e(t.target).is(".btn")?e(t.target):e(t.target).parent(),i=this.$el.find(".nav-list");i.hasClass("sorting")?(i.nestedSortable("disable").removeClass("sorting"),i.find("li[sort-data] .sort-handler-bg").hide(),this._saveSortResult()):(n.button("sorting"),n.siblings(".btn[data-action=createSection]").addClass("hide"),n.siblings(".btn[data-action=cancelSort]").removeClass("hide"),i.nestedSortable("enable").addClass("sorting"),i.find("li[sort-data] .sort-handler-bg").show())},_cacelSort:function(t){var n=e(t.target).is(".btn")?e(t.target):e(t.target).parent(),r=this.$el.find(".nav-list");r.nestedSortable("disable").removeClass("sorting"),r.find("li[sort-data] .sort-handler-bg").hide(),n.button("reset"),n.siblings(".btn[data-action=createSection]").removeClass("hide"),n.siblings(".btn[data-action=cancelSort]").addClass("hide"),this._render()},_saveSortResult:function(i){var s=this.$el.find(".sidebar-shortcuts .btn[data-action=sort]").button("loading"),o=this.$el.find(".nav-list").nestedSortable("toHierarchy"),u=[];this._buildSortResultArray(o,u);var a={authenticityToken:r.App.config.authToken,app_id:r.App.config.currentApp.id,sections:JSON.stringify(u)},f=this;e.post(r.api("/sections/sort"),a).done(function(e){n.each(u,function(e){var t=f._findSectionById(e.id);t.list_index=e.list_index,t.parent_list_index=e.parent_list_index,t.parent_id=e.parent_id,t.parent_id&&(t.parent_cas_code=f._findSectionById(t.parent_id).cas_code),t.tree_level=t.list_index.length/3}),r.App.config.currentApp.sections=n.sortBy(r.App.config.currentApp.sections,function(e){return e.list_index}),f._fireSectionStructureChangedEvent(),t.Events.trigger("section-structure.changed")}).error(function(e){r.showMessage("ERROR","排序失败, 可能你遭遇了网络问题，请稍后尝试.",!0)}).complete(function(){s.button("reset"),s.siblings(".btn[data-action=createSection]").removeClass("hide"),s.siblings(".btn[data-action=cancelSort]").addClass("hide")})},_findSectionById:function(e){return n.find(r.App.config.currentApp.sections,function(t){return t.id==e})},_buildSortResultArray:function(e,t,r){var i=this;n.each(e,function(e,n){var s={id:e.id,list_index:i._calculateSectionListIndex(e,n,r)};r&&(s.parent_id=r.id,s.parent_list_index=r.list_index),t.push(s),e.children&&i._buildSortResultArray(e.children,t,s)})},_calculateSectionListIndex:function(e,t,n){var r=t+1;return r<10?r="00"+r:r<100&&(r="0"+r),n?n.list_index+r:r},_onSectionUpdated:function(e,t){var i=n.find(r.App.config.currentApp.sections,function(t){return t.id==e.id});if(i){var s=n.indexOf(r.App.config.currentApp.sections,i);r.App.config.currentApp.sections[s]=e}else r.App.config.currentApp.sections.push(e),r.App.config.currentApp.sections=n.sortBy(r.App.config.currentApp.sections,function(e){return e.list_index}),this._fireSectionStructureChangedEvent();this._render()},_onSectionsUpdated:function(){this._render(),this.activeMenu()},_onSectionRemoved:function(e){var t=r.App.config.currentApp.sections,i=n.filter(t,function(t){return t.parent_id==e.id}),s=[e.id];for(var o in i)s.push(i[o].id);r.App.config.currentApp.sections=t=n.difference(t,e,i),this._render(),this._fireSectionStructureChangedEvent();var u=r.modules.cms.SectionModule.currentSection,a=u&&u.id;if(!n.contains(s,a))return;var f;n.each(t,function(t,n){f==undefined&&t.list_index>e.list_index&&(f=n)}),f!=undefined||!t.length||(f=t.length),f>0&&f--;if(f>=0){var l=t[f];this.$el.find('li[data-section-id="'+l.id+'"] >a').trigger("click")}else r.navigate("/builder/"+r.App.config.currentApp.id+"/cms/welcome")},_onHomePageOpened:function(){this.currMenu="home",this._activeHome(),r.modules.AppPreviewer.navHome()},_onSectionModuleOpened:function(e){this.currMenu=e,this.activeMenu(e);if(t.history.fragment.indexOf("/new")>=0)return;r.modules.AppPreviewer.navSection({sectionId:e.id})},activeMenu:function(e){e?e=="home"?this._activeHome():this._activeSection(e):!this.currMenu||this.currMenu=="home"?this._activeHome():this._activeSection(this.currMenu)},_activeHome:function(){this.$el.find(".nav-list li").removeClass("active").removeClass("open"),this.$el.find("div.navAppHome").addClass("active")},_activeSection:function(e){e=e||{},this.$el.find(".nav-list li").removeClass("active").removeClass("open"),this.$el.find("div.navAppHome").removeClass("active"),this.$el.find('.nav-list li[data-section-id="'+e.id+'"]').addClass("active"),this.$el.find('.nav-list li[data-section-id="'+e.id+'"]').parents("li").addClass("active open")},_onSectionDragStart:function(e,t){this._draggedSectionParentElement=t.item.parent().is(".submenu")&&t.item.parents("li")},_onSectionDragStop:function(e,t){if(!t.item.parent().is(".nav-list")){var n=t.item.parent().addClass("submenu").show().prev("a");n.find("i[data-action=expand]").length||n.append('<i class="arrow icon-angle-down" data-action="expand"></i>')}this._draggedSectionParentElement&&(this._draggedSectionParentElement.find("li").length||this._draggedSectionParentElement.find(">a i[data-action=expand]").remove())},_isNestedOperationAllowed:function(e,t,n){var r=n.hasClass("folder");return r&&t?!1:!0},_fireSectionStructureChangedEvent:function(){var e=r.modules.cms.ClientUtils.getCurrentAppSections();r.modules.AppPreviewer.sectionSettingsChanged(e)}});var i=function(e){var t='<div class="sidebar-inner">            <div class="navAppHome">                <a href="#" data-action="navAppHome">                    <i class="icon-home"></i>首页                </a>            </div>            <div class="sidebar-shortcuts">                <div class="sidebar-shortcuts-large">                    <div class="btn btn-danger btn-xs tooltip-error" data-action="createSection" data-rel="tooltip" data-placement="top" data-original-title="创建栏目" style="width:70px" data-toggle="modal">                        <i class="icon-plus"></i>创建栏目                    </div>                    <div class="btn hide" data-action="cancelSort">取消</div>                    <div class="sectionOrderBtn btn btn-success btn-xs tooltip-success" data-rel="tooltip" data-placement="top" data-original-title="调整结构" style="width:70px" data-action="sort" data-loading-text="保存中..." data-sorting-text="确定">                        <i class="icon-align-justify" ></i>                    </div>                </div>                <div class="sidebar-shortcuts-mini">                    <span class="btn btn-success"></span>                    <span class="btn btn-info"></span>                </div>            </div>            <ul class="nav nav-list">',r=n.filter(e,function(e){return e.tree_level==1}),i=0;while(i<e.length){var s=e[i],a=e[i+1]&&e[i+1].tree_level>1;if(!a)t+=o(s),i++;else{var f=n.filter(e,function(e){return e.parent_id==s.id});t+=u(s,f),i+=f.length+1}}return t+="</ul></div>",t},s=function(e,t){return r.App.config.root+"/builder/"+r.App.config.currentApp.id+"/cms/"+e.id+(t?"/"+t:"/content")},o=function(e){var t="";return r.assetLink(e.icon_url)==""?t="":t='style="background-image:url('+r.assetLink(e.icon_url)+')"','<li sort-data="id='+e.id+'" data-section-id="'+e.id+'" class="'+a(e)+'">                <div class="sort-handler-bg"><i class="sort-handler"></i></div>                <a href="'+s(e)+'" >                	<div class="icon" '+t+'></div>                    <span class="menu-text">'+e.name+'</span>                    <div class="section-settings">'+f(e)+'<i class="icon-remove bigger-120" data-action="delete" data-rel="tooltip" data-placement="left" data-original-title="删除"></i>                    </div>                </a>            </li>'},u=function(e,t){var i="";r.assetLink(e.icon_url)==""?i="":i='style="background-image:url('+r.assetLink(e.icon_url)+')"';var o='<li sort-data="id='+e.id+'" data-section-id="'+e.id+'" class="'+a(e)+'">                <div class="sort-handler-bg"><i class="sort-handler"></i></div>                <a href="'+s(e,"settings")+'" >                    <div class="icon" '+i+'></div>                    <span class="menu-text">'+e.name+'</span>                    <i class="arrow icon-angle-down" data-action="expand"></i>                    <div class="section-settings">'+f(e)+'<i class="icon-remove bigger-120" data-action="delete" data-rel="tooltip" data-placement="left" data-original-title="删除"></i>                    </div>                </a>                <ul class="submenu">';return n.each(t,function(e){o+=l(e)}),o+=" </ul>            </li>",o},a=function(e){return e.type.code=="SECTION_SET"?"folder":"no-nesting"},f=function(e){return e.type.code=="SECTION_SET"?'<i class="icon-plus bigger-120" data-action="addChildSection" data-rel="tooltip" data-placement="left" data-original-title="添加子栏目"></i>':""},l=function(e){var t="";return r.assetLink(e.icon_url)==""?t="":t='style="background-image:url('+r.assetLink(e.icon_url)+')"','<li sort-data="id='+e.id+'" data-section-id="'+e.id+'">            <div class="sort-handler-bg"><i class="sort-handler"></i></div>            <a href="'+s(e)+'" >                <div class="icon subIcon" '+t+'></div>                <span class="menu-text" data-rel="tooltip" data-placement="bottom">'+e.name+'</span>                <div class="section-settings">'+f(e)+'<i class="icon-remove bigger-120" data-action="delete" data-rel="tooltip" data-placement="left" data-original-title="删除"></i>                </div>            </a>        </li>'}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf"),i=3;r.modules.cms.TemplateConfigurator=r.common.BaseView.extend({events:{"click .layoutImg":"_selectTemplate"},doInitialize:function(e){this._data||(this._data={}),this._data.templates=e.templates||{},this._data.selectedTemplate={},e.selectedTemplateId&&(this._data.selectedTemplate.id=e.selectedTemplateId,this._data.selectedTemplate.optionId=this._getTemplateOptionId(e.selectedTemplateId)),this._originalSelectedTemplateId=this._data.selectedTemplate.id,this._computeData(),this._render()},getSelectedTemplate:function(){var e=this._data;return{id:e.selectedTemplate.id,optionId:e.selectedTemplate.optionId}},selectTemplate:function(e){this._originalSelectedTemplateId=e,this._data.selectedTemplate={id:this._originalSelectedTemplateId,optionId:this._getTemplateOptionId(this._originalSelectedTemplateId)},this._computeData();var t=this._data.selectedTemplate.slideIndex==undefined?0:this._data.selectedTemplate.slideIndex;this.$el.find(".layoutImg").removeClass("checked").end().find(".layoutImg[data-template-id="+this._data.selectedTemplate.id+"]").addClass("checked"),this.$el.carousel(t).carousel("pause")},reset:function(){this.selectTemplate(this._originalSelectedTemplateId)},_computeData:function(){var e=this._data,t=this;e.slides=[],n.each(this._data.templates,function(t,n){var r=parseInt(n/i);e.slides[r]||(e.slides[r]=[]),e.slides[r].push(t),e.selectedTemplate.id&&t.id==e.selectedTemplate.id&&(e.selectedTemplate.index=n,e.selectedTemplate.slideIndex=r)})},_render:function(){var e=this._data.selectedTemplate.slideIndex==undefined?0:this._data.selectedTemplate.slideIndex;this.$el.html(s(this._data)).carousel("pause").carousel("prev").carousel(e)},_getTemplateOptionId:function(e){var t=n.find(this._data.templates,function(t){return t.id==e});return t?t.option_id:null},_selectTemplate:function(t){var n=e(t.target).data().templateId?e(t.target):e(t.target).parent();if(this._data.selectedTemplate.id==n.data().templateId)return;this._data.selectedTemplate={id:n.data().templateId,optionId:n.data().optionId},this._computeData(),this.$el.find(".layoutImg").removeClass("checked"),n.addClass("checked"),this._fireTemplateSettingsUpdatedEvent()},_fireTemplateSettingsUpdatedEvent:function(){this.trigger("templateSettings.updated",this.getSelectedTemplate())}});var s=function(e){var t="templates"+n.uniqueId("t_slides"),r='<div id="'+t+'" class="layoutSelecter carousel slide">		    <ol class="carousel-indicators">';return r+=o(t,e),r+='</ol>		    <div class="carousel-inner">',r+=u(e),r+='</div>		    <i class="left carousel-control" data-target="#'+t+'" data-slide="prev"><span class="icon-chevron-left'+(e.slides.length<=1?"hide":"")+'"></span></i>		    <i class="right carousel-control" data-target="#'+t+'" data-slide="next"><span class="icon-chevron-right '+(e.slides.length<=1?"hide":"")+'"></span></i>		</div>',r},o=function(e,t){var r="";return n.each(t.slides,function(n,i){r+='<li data-target="#'+e+'" data-slide-to="'+i+'" '+(i==t.selectedTemplate.slideIndex?' class="active"':"")+"></li>"}),r},u=function(e){var t="";return n.each(e.slides,function(i,s){t+='<div class="item clearfix '+(e.selectedTemplate.slideIndex==s?"active":"")+'">',n.each(e.slides[s],function(n){t+='<div class="col-sm-4 no-padding">			        <div class="layoutImg '+(e.selectedTemplate.id==n.id?"checked":"")+'" data-template-id="'+n.id+'" data-option-id="'+n.option_id+'">			       		<img src="'+r.assetLink(n.thumbnail_url)+'">			       		<span>'+n.name+"</span>			        </div>			    </div>"}),t+="</div>"}),t}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.cms.telEditor=r.common.BaseView.extend({events:{"keyup input":"_onKeyup",submit:"_save"},doInitialize:function(){this._section=r.modules.cms.SectionModule.currentSection,this.$form=this.$el.html(i(this._section)).find("form"),this.$form.find("input[name=telephone]").val(n.unescape(this._section.telephone)),t.Events.on("previewer.loaded",n.bind(this._onPreviewerLoaded,this))},setCallbacks:function(e,t){this[e]=t},isChanged:function(){return this._contentModifiedDt||this._templateModifiedDt},onHide:function(){this.isChanged()&&this._cancel()},onRemove:function(){this.isChanged()&&this._cancel(),t.Events.off("previewer.loaded",this._onPreviewerLoaded)},_cancel:function(e){this.$form.find("input[name=telephone]").val(n.unescape(this._section.telephone))},_save:function(n){n&&n.preventDefault&&n.preventDefault(),this._removeValidationErrorOnFormActions(),r.showProgressIndicator("电话保存中..."),this.$form.find("input[name=telephone]").val(this.$form.find("input[name=telephone]").val().trim());var i={id:this._section.id,name:this._section.name,telephone:this.$form.find("input[name=telephone]").val()};this.$form.find(".form-group").removeClass("has-error").find(".validation-tips").removeClass("hide");var s=this;e.post(r.api("/sections/"+this._section.id),i).done(function(e){if(e.code==400){s._handleValidationErrors(e.errors),r.closeProgressIndicator(),r.showMessage("ERROR","电话保存出错",!0),s._contentChanged(!0);return}r.showMessage("SUCCESS","电话保存成功!",!0),r.modules.cms.SectionModule.currentSection=s._section=e.section,t.Events.trigger("section.updated",e.section),s._contentChanged(!1),r.closeProgressIndicator()}).error(function(e){r.closeProgressIndicator(),s._contentChanged(!1),r.showMessage("ERROR","电话保存出错!",!0)})},_handleValidationErrors:function(e){var t=this.$form;n.each(e,function(e){t.find("[name="+e.key+"]").siblings(".validation-tips").addClass("hide").end().after('<div class="validation-error">'+e.message+"</div>").parents(".form-group").addClass("has-error")}),t.find(".form-actions").addClass("has-error").prepend('<span class="validation-error">有些项填写不正确，请根据指示检查.</span>')},_removeValidationErrorOnFormActions:function(){this.$form.find("div.has-error").removeClass("has-error"),this.$form.find(".validation-error").remove(),this.$formActions||(this.$formActions=this.$el.find(".form-actions")),this.$formActions.removeClass("has-error").find(".validation-error").remove()},_contentChanged:function(e){e!=undefined||(e=!0),e?this._contentModifiedDt=(new Date).getTime():this._contentModifiedDt=null,this._fireSettingsChangedEvent(),this.onContentChanged&&this.onContentChanged(e)},_onKeyup:function(t){e(t.target).parents(".form-group").removeClass("has-error").end().siblings(".validation-tips").removeClass("hide").end().next(".validation-error").remove(),this._removeValidationErrorOnFormActions(),this._contentChanged()},_fireSettingsChangedEvent:function(){var e=this,t=r.modules.cms.ClientUtils.getCurrentAppSections(),i=n.find(t,function(t){return t.id==e._section.id});i.telephone=e.$form.find("input[name=telephone]").val(),r.modules.AppPreviewer.sectionSettingsChanged(t)},_onPreviewerLoaded:function(){this.isChanged()&&(this._fireSettingsChangedEvent(),this._fireTemplateChangedEvent())}});var i=function(e){var t='<form class="form-horizontal">					<input type="hidden" name="authentictyToken"/>					<input type="hidden" name="id"/>					<h3 class="header smaller light-grey" data-type="basic">电话号码</h3>					<div class="form-group required">							<label class="col-sm-2 control-label no-padding-right grey">电话号码</label>							<div class="col-sm-6">								<input type="text" name="telephone" placeholder="请输入电话号码" class="form-control">								<div class="validation-tips">								例如: 手机号码 13112345678, 电话号码: 028-85148898								</div>							</div>					</div>				</form>';return t}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.cms.linkEditor=r.common.BaseView.extend({events:{"keyup input":"_onKeyup",submit:"_save"},doInitialize:function(){this._section=r.modules.cms.SectionModule.currentSection,this.$form=this.$el.html(i(this._section)).find("form"),this.$form.find("input[name=link]").val(n.unescape(this._section.link)),t.Events.on("previewer.loaded",n.bind(this._onPreviewerLoaded,this))},setCallbacks:function(e,t){this[e]=t},isChanged:function(){return this._contentModifiedDt||this._templateModifiedDt},onHide:function(){this.isChanged()&&this._cancel()},onRemove:function(){this.isChanged()&&this._cancel(),t.Events.off("previewer.loaded",this._onPreviewerLoaded)},_cancel:function(e){this.$form.find("input[name=link]").val(n.unescape(this._section.link))},_save:function(n){n&&n.preventDefault&&n.preventDefault(),this._removeValidationErrorOnFormActions(),r.showProgressIndicator("链接保存中..."),this.$form.find("input[name=link]").val(this.$form.find("input[name=link]").val().trim());var i={id:this._section.id,name:this._section.name,link:this.$form.find("input[name=link]").val()};this.$form.find(".form-group").removeClass("has-error").find(".validation-tips").removeClass("hide");var s=this;e.post(r.api("/sections/"+this._section.id),i).done(function(e){if(e.code==400){s._handleValidationErrors(e.errors),r.closeProgressIndicator(),r.showMessage("ERROR","链接保存出错",!0),s._contentChanged(!0);return}r.showMessage("SUCCESS","链接保存成功!",!0),r.modules.cms.SectionModule.currentSection=s._section=e.section,t.Events.trigger("section.updated",e.section),s._contentChanged(!1),r.closeProgressIndicator()}).error(function(e){r.closeProgressIndicator(),s._contentChanged(!1),r.showMessage("ERROR","链接保存出错!",!0)})},_handleValidationErrors:function(e){var t=this.$form;n.each(e,function(e){t.find("[name="+e.key+"]").siblings(".validation-tips").addClass("hide").end().after('<div class="validation-error">'+e.message+"</div>").parents(".form-group").addClass("has-error")}),t.find(".form-actions").addClass("has-error").prepend('<span class="validation-error">有些项填写不正确，请根据指示检查.</span>')},_removeValidationErrorOnFormActions:function(){this.$form.find("div.has-error").removeClass("has-error"),this.$form.find(".validation-error").remove(),this.$formActions||(this.$formActions=this.$el.find(".form-actions")),this.$formActions.removeClass("has-error").find(".validation-error").remove()},_contentChanged:function(e){e!=undefined||(e=!0),e?this._contentModifiedDt=(new Date).getTime():this._contentModifiedDt=null,this._fireSettingsChangedEvent(),this.onContentChanged&&this.onContentChanged(e)},_onKeyup:function(t){e(t.target).parents(".form-group").removeClass("has-error").end().siblings(".validation-tips").removeClass("hide").end().next(".validation-error").remove(),this._removeValidationErrorOnFormActions(),this._contentChanged()},_fireSettingsChangedEvent:function(){var e=this,t=r.modules.cms.ClientUtils.getCurrentAppSections(),i=n.find(t,function(t){return t.id==e._section.id});i.link=e.$form.find("input[name=link]").val(),r.modules.AppPreviewer.sectionSettingsChanged(t)},_onPreviewerLoaded:function(){this.isChanged()&&(this._fireSettingsChangedEvent(),this._fireTemplateChangedEvent())}});var i=function(e){var t='<form class="form-horizontal">					<input type="hidden" name="authentictyToken"/>					<input type="hidden" name="id"/>					<h3 class="header smaller light-grey" data-type="basic">外部链接</h3>					<div class="form-group required">							<label class="col-sm-2 control-label no-padding-right grey">外部链接</label>							<div class="col-sm-6">								<input type="text" name="link" placeholder="请输入外部链接地址" class="form-control">								<div class="validation-tips">								例如: http://www.baidu.com								</div>							</div>					</div>				</form>';return t}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.cms.InfoContentEditor=r.common.BaseView.extend({events:{"click .section-list :checkbox":"_contentChanged",submit:"_save","click .form-actions .btn[data-action=reset]":"_cancel"},doInitialize:function(){this._section=r.modules.cms.SectionModule.currentSection,this.$form=this.$el.html(i(this._section)).find(".info-content-editor"),this._isNewItem()&&(this._item=this._createNewItem(),this._render()),this._editor=new r.modules.cms.editor.RichEditor({el:this.$form.find("textarea[name=content]"),bigToolbar:!0}),this._editor.on("changed",n.bind(this._contentChanged,this));var t=this;this._editor.onEditorReady(function(){t._timer=setInterval(n.bind(t._preview,t),400)}),e(window).bind("scroll",this._onScroll=n.bind(this._onScroll,this))},setCallbacks:function(e,t){this[e]=t},onShow:function(){if(this._isNewItem())return;var t=this;e.get(r.api("/items/"+this._section.last_item_id)).done(function(e){t._item=e.item,t._render()}).error(function(e){r.showMessage("ERROR","内容装载失败",!0)})},onRemove:function(){clearInterval(this._timer),this._editor.off("changed",this._contentChanged),e(window).unbind("scroll",this._onScroll),this._preview(!0,!0),this._editor.remove()},onHide:function(){this.isChanged()&&this._cancel(),this._editor.hide()},onRecover:function(){this._editor.recover()},isChanged:function(){return this._lastModifiedDt},_isNewItem:function(){return!this._section.last_item_id},_createNewItem:function(){return{id:"new",section_type:this._section.type.code,statuses:[{app_id:r.App.config.currentApp.id,section_id:this._section.id,section_cas_code:this._section.case_code,section_type:this._section.type.code,status:"ENABLE"}]}},_render:function(){var e=this._item;e.id!="new"?(this.$form.find("input[name=id]").val(e.id),this.$form.find("input[name=app_id]").val(e.app_id),this._editor.initContent(e.content),this._lastModifiedDt=null,this._lastPreviewerSyncDt=(new Date).getTime()):this._editor&&this._editor.initContent(""),this._renderAvailableSections()},_save:function(t){t&&t.preventDefault&&t.preventDefault(),r.showMessage("INFO","内容正在保存..."),this.$form.find(".validation-error").remove(),this.$form.find("input[name=authenticityToken]").val(r.App.config.authToken),this.$form.find("input[name=app_id]").val(r.App.config.currentApp.id),this.$form.find("input[name=section_type]").val(this._section.type.code),this.$form.find("input[name=title]").val(this._section.name);var n=this;e.post(r.api("/items/"+this._item.id),this.$form.serialize()).done(function(e){if(e.code==200){n._section.last_item_id=e.item.id,n._item=e.item,n._preview(!0,!0),n._contentChanged(!1);return}n._handleValdiationErrors(e.errors),n.onContentChanged(!0)}).error(function(){r.showMessage("ERROR","内容保存出错!",!0),n._contentChanged(!0)}).complete(function(e){r.closeMessage()})},_handleValdiationErrors:function(e){var t=this.$form;n.each(e,function(e){e.key=="content"&&t.find("[name="+e.key+"]").parent(".form-group").append('<div class="validation-error red">'+e.message+"</div>").addClass("has-error")})},_cancel:function(e){this._render(),this._preview(!0,!1),this._contentChanged(!1)},_renderAvailableSections:function(){this.$form.find(".section-list").html(s(this._item,this._section,r.App.config.currentApp.sections))},_preview:function(e,t){if(this._lastModifiedDt==this._lastPreviewerSyncDt&&!e)return;this._lastPreviewerSyncDt=this._lastModifiedDt;var i=r.modules.cms.SectionModule.currentSection,s=n.extend({optionId:i.content_template.option_id,sectionId:i.id,itemId:i.last_item_id,properties:{title:i.name,content:this._parseContent(this._editor.getContent())}});!t||(s.completed=!0),r.modules.AppPreviewer.itemContentChanged(s)},_parseContent:function(t){var n=e("<div/>").append(t),r=n[0].firstChild,i=this;return this._cleanImgTags(n),n.find("img:not([data-video-type])").each(function(){i._wrapImgTag(this)}),n.find("img[data-video-type]").each(function(){i._setVideoTag(this)}),n.find('a[href^="tel:"]').each(function(){e(this).removeAttr("title").prepend("<i/>")}),n.html()},_cleanImgTags:function(t){t.find('img[data-video-type=""]').each(function(){var t=e(this);t.removeAttr("data-video-type").removeAttr("data-video-id").removeAttr("data-video-thumbnail-url").removeAttr("data-video-url")})},_wrapImgTag:function(t){var n=e(t);n.attr("data-src")||(n.attr("data-src",n.attr("src")),n.removeAttr("src"));if(t.tagName=="IMG"&&t.className=="editorPic"&&t.width<50&&t.height<50){t.classList.add("display-inline");return}t.tagName=="IMG"&&(t.parentNode.tagName!="DIV"||!t.parentNode.className.match(/contentImg/))&&n.wrap('<div class="contentImg"/>')},_setVideoTag:function(t){var n=e(t);n.replaceWith('<div class="video-info" data-video-type="'+n.data().videoType+'" 				data-video-id="'+n.data().videoId+'" 				data-thumbnail-url="'+n.data().videoThumbnailUrl+'"></div>')},_removeValidationErrorOnFormActions:function(){this.$formActions||(this.$formActions=this.$form),this.$formActions.removeClass("has-error").find(".validation-error").remove()},_contentChanged:function(e){e!=undefined||(e=!0),e?(this._lastModifiedDt=(new Date).getTime(),this.$form.find("textarea[name=content]").next(".validation-error").remove().parents(".form-group").removeClass("has-error"),this._removeValidationErrorOnFormActions(),this.$form.find(".form-actions .btn").enable()):(this._lastModifiedDt=null,this._lastPreviewerSyncDt=null,this.$form.find(".form-actions .btn").button("reset").disable()),this.onContentChanged&&this.onContentChanged(e)},_onScroll:function(e){}});var i=function(e){return'<form class="info-content-editor">		  <input type="hidden" name="authenticityToken"/>		  <input type="hidden" name="section_type"/>		  <input type="hidden" name="app_id"/>		  <input type="hidden" name="title"/>		  <input type="hidden" name="section_cas_code" value="'+e.cas_code+'"/>		  <div class="form-group">		  	<textarea name="content" class="form-control html-editor" placeholder="内容"></textarea>		  </div>		  <div class="form-group hide">		    <div class="control-label light-grey">栏目</div>		    <div class="section-list">		      <label class="checkbox-inline">		        <input type="checkbox" name="section_case_code"/>		      </label>		    </div>		  </div>		  <!--<div class="form-group form-actions">		      <button type="reset" class="btn btn-cancel disabled" disabled data-action="reset">		        <i class="icon-remove bigger-110"></i>取消		      </button>		      <button class="btn btn-primary disabled" disabled data-loading-text="保存中..." data-action="save">		        <i class="icon-ok bigger-110"></i>保存		      </button>		  </div>-->		</form>'},s=function(e,t,r){var i="";return n.each(r,function(e){if(e.id!=t.id)return;i+='<label class="checkbox-inline">					<input type="checkbox" name="section_cas_code" value="'+e.cas_code+'" checked disabled'+"/> "+e.name+"				</label>"}),i},o=function(e,t){return n.any(t,function(t){return t.parent_id==e.id})},u=function(e,t){return n.any(e.statuses,function(e){return e.section_id==t.id})}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.cms.ClientUtils=function(){},r.modules.cms.ClientUtils.getCurrentAppSections=function(){var e=[],t=this;return n.each(r.App.config.currentApp.sections,function(t){var n={id:t.id,parentId:t.parent_id,type:t.type.code,name:t.name,caseCode:t.cas_code,parentCasCode:t.parent_cas_code,iconUrl:t.icon_url,backgroundUrl:t.background_url,sort:parseInt(t.list_index),treeLevel:t.tree_level,lastItemId:t.last_item_id,lastUpdateDate:t.last_update_date,navTemplate:{optionId:t.nav_template.option_id},listTemplate:{optionId:t.list_template.option_id},contentTemplate:{optionId:t.content_template.option_id},focusEnabled:t.focus_enabled,topImagesForPreview:t.top_images};e.push(n)}),e}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf"),i=6,s="product_img";r.modules.cms.ItemImagesUploader=r.common.BaseView.extend({doInitialize:function(t){this._fieldName=t.fieldName||s,this._maxFiles=t.maxFiles||i,t.previewZone?this.$preview=e(o()).appendTo(e(t.previewZone)):this.$preview=e(o()).insertAfter(this.$el),this._uploader=this.$el.uploader({url:t.uploadUrl,multipleFiles:!0,accept:n.bind(this._acceptFile,this),params:{authenticityToken:r.App.config.authToken},handlers:{sending:n.bind(this._onSending,this),uploadprogress:n.bind(this._onUploadProgress,this),complete:n.bind(this._onComplete,this),success:n.bind(this._onSuccess,this),error:n.bind(this._onError,this),successmultiple:n.bind(this._onSuccessMultiple,this),completemultiple:n.bind(this._onCompleteMultiple,this)}}).uploader("getInstance")},onRemove:function(){},getImages:function(){var t=[];return this.$preview.find("li[data-file-status=UPLOADED]").each(function(){t.push(e(this).find("img").attr("data-url"))}),t},setImages:function(e){this._uploader.removeAllFiles(!0);var t="",r=this;n.each(e,function(e){var i={ctx:{id:n.unique("fs"),url:e,status:"UPLOADED"}};t+=u(i,r._fieldName)}),this.$preview.html(t).find("[data-action=remove]").click(n.bind(this._removeFileDirectly,this))},_acceptFile:function(t,r){var i=this._uploader.getAcceptedFiles(),s=i.length;this.$preview.find("li").each(function(){var t=e(this).data().fileId,r=n.find(i,function(e){return e.ctx&&e.ctx.id==t});r||s++}),s>this._maxFiles-1&&r("达到最多允许"+this._maxFiles+" 张图片的限制了."),r()},_removeFile:function(e){this._uploader.removeFile(e),e.ctx.$previewElement.remove(),self.args.onremoved&&self.args.onremoved(e)},_removeFileDirectly:function(t){e(t.target).parents("li").remove(),this.args.onremoved&&this.args.onremoved()},_createThumbnail:function(e){if(!window.FileReader)return;var t=new FileReader;t.onload=function(){e.ctx.$previewElement.find("img").attr({src:t.result}),t=null},t.readAsDataURL(e)},_onSending:function(t,r,i){t.ctx={},t.ctx.id=n.uniqueId("f"),t.ctx.$previewElement=e(u(t,this._fieldName)).appendTo(this.$preview),this._createThumbnail(t);var s=this;t.ctx.$previewElement.find("[data-action=remove]").click(function(){s._removeFile(t)}),this.args.onsending&&this.args.onsending(t,i)},_onUploadProgress:function(e,t,n){e.ctx.$previewElement.attr("data-file-status")!="UPLOADING"&&e.ctx.$previewElement.attr({"data-file-status":"UPLOADING"}),e.ctx.$previewElement.find(".progress-bar").width(t+"%"),this.args.onuploadprogress&&this.args.onuploadprogress(e,t,n)},_onComplete:function(t){t.ctx.$previewElement.find(".progress").fadeOut(800,function(){e(this).remove()}),this.args.oncomplete&&this.args.oncomplete(t)},_onSuccess:function(e,t){e.ctx.$previewElement.attr({"data-file-status":"UPLOADED"});var n=e.ctx.$previewElement.find("img");n.attr("src")||n.attr({src:t.url}),n.attr({"data-url":t.url}),e.ctx.$previewElement.find("input[name="+this._fieldName+"]").val(t.url),this.args.onsuccess&&this.args.onsuccess(e,t)},_onCanceled:function(e){e.ctx.$previewElement.attr({"data-file-status":"CANCELLED"}),this.args.oncanceled&&this.args.oncanceled(e)},_onError:function(e,t){this.args.onerror&&this.args.onerror()},_onSuccessMultiple:function(){},_onCompleteMultiple:function(){}});var o=function(){return'<ul class="product-imgs"></ul>'},u=function(e,t){return t||(t="product_img"),'<li data-file-id="'+e.ctx.id+'" data-file-status="'+(e.ctx.status?e.ctx.status:"QUEUED")+'">			<input type="hidden" name="'+t+'" value="'+(e.ctx.url?e.ctx.url:"")+'"/>			<img class="thumb" src="'+(e.ctx.url?e.ctx.url:"")+'" data-url="'+(e.ctx.url?e.ctx.url:"")+'"/>			<div class="progress progress-striped active img-progress-bar"><div class="progress-bar"></div></div>			<i class="icon-remove white" data-action="remove"></i>		</li>'}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.cms.TopImageConfigurator=r.common.BaseView.extend({events:{"click .addImg [data-action=selectTopImages]":"_selectTopImages","click .topImg [data-action=delete]":"_deleteTopImage","click .topImg [data-action=edit]":"_editTopImage","click [data-input=status]":"_toggleTopImgPanel"},doInitialize:function(e){this.type=e.type||"section",this.type=="section"?this._resetSection(e.section):this._resetApp(e.app),this._resetData(),this.$items=this.$el.html(this.mainTpl()).find('[data-block="imgList"]'),this.$addTopImg=this.$items.find('[data-item="addImg"]'),this._render(),new r.modules.cms.TopImageUploader({el:this.$el.find(".addImg .btn[data-action=uploadTopImages]"),container:this.$items,uploadUrl:r.api("/files"),done:n.bind(this._onTopImagesUploaded,this)}),this.topImgChanged=!1,this.on("topImages.changed",n.bind(this._onTopImgChanged,this))},_resetApp:function(e){this._app=e},_resetSection:function(e){this._section=e},_resetTopImages:function(){var e;this.type=="section"&&(e=this._section.top_images);if(this.type=="home"){var t=this._app.top_img_url,n=this._app.home_focus;(!n||n&&n.length<=0)&&t?e=[{title:"",picture_url:t}]:e=n}this._topImages=this._cloneSectionTopImages(e)||[],this.focusEnabled=!0,this.type=="section"&&(this.focusEnabled=!!this._section.focus_enabled)},_resetData:function(){this._resetTopImages()},_cloneSectionTopImages:function(e){var t=[];return n.each(e,function(e){t.push(n.clone(e))}),t},_toggleTopImgPanel:function(e){var t=e.target,n=this.$('[data-type="topImageListPanel"]');t.checked?(this.focusEnabled=!0,n.removeClass("hide")):(this.focusEnabled=!1,n.addClass("hide")),this._onTopImgChanged()},_onTopImgChanged:function(e){e===undefined&&(e=!0),this.topImgChanged=e,this._firePreviewEvent(),this.args.onTopImgChanged&&this.args.onTopImgChanged(e),this.args.onAppSettingChanged&&this.args.onAppSettingChanged(e)},_cancel:function(e){if(!this.topImgChanged)return;e&&e.preventDefault(),this._resetData(),this._firePreviewEvent(!0)},_save:function(t){if(!this.topImgChanged){t&&t();return}var i=n.clone(this._section);i.top_images=JSON.stringify(this.getImages()),i.focus_enabled=this.focusEnabled;var s=this;r.showProgressIndicator("轮播图保存中..."),e.post(r.api("/sections/"+this._section.id),i).done(function(e){if(e.code==400){r.closeProgressIndicator(),r.showMessage("ERROR","轮播图保存出错，请检查数据重试",!0),s._onTopImgChanged(!0);return}console.log(e),r.App.util.updateSection(e.section),r.modules.cms.SectionModule.currentSection=s._section=e.section,s._resetData(e.section.top_images),s._render(),s._onTopImgChanged(!1),r.showMessage("INFO","轮播图保存成功",!0)}).error(function(e){r.closeProgressIndicator(),r.showMessage("ERROR","轮播图保存出错!",!0),s._onTopImgChanged(!0)}).always(function(){t&&t()})},onRemove:function(){},getCurrLength:function(){return this._topImages.length},getImages:function(){var e=[];return n.each(this._topImages,function(t){e.push({id:t.id,title:t.title,link:t.link,picture_url:t.picture_url,item_id:t.item_id,section_id:t.section_id})}),e},setImages:function(e){var t=[];n.each(e,function(e){t.push(n.clone(e))}),this._topImages=t,this._render()},_render:function(){this.$items.children("li:not(.addImg)").remove(),this._topImages.length>=6?this.$addTopImg.addClass("hide"):this.$addTopImg.removeClass("hide"),e(i(this._topImages)).insertAfter(this.$addTopImg)},_selectTopImages:function(e){this.newDialog=new r.modules.cms.TopImagesHomeSelect({section:r.modules.cms.SectionModule.currentSection,done:n.bind(this._onTopImagesSelected,this),container:this.$items})},_deleteTopImage:function(t){var n=e(t.target).parents(".topImg"),r=n.data("index");if(r===undefined)return;r=parseInt(r),this._topImages.splice(r,1),this._render(),this.trigger("topImages.changed")},_editTopImage:function(t){var i=e(t.target).parents(".topImg"),s=i.data("index");if(s===undefined)return;s=parseInt(s);var o=n.clone(this._topImages[s]);o._idx=s,new r.modules.cms.TopImageUploadProgressDialog({files:[o],type:"edit",done:n.bind(this._onTopImageEditDone,this)})},_onTopImageEditDone:function(e){var t=e[0];this._topImages[t._idx].title=t.title,this._topImages[t._idx].section_id=t.section_id,this._topImages[t._idx].item_id=t.item_id,this._topImages[t._idx].link=t.link,this._render(),this.trigger("topImages.changed")},_onTopImagesSelected:function(e){this._processNewTopImages(e)},_onTopImagesUploaded:function(e){this._processNewTopImages(e)},_processNewTopImages:function(e){if(this._topImages.length>=6)return;this._topImages=this._topImages.concat(e),this._render(),this.trigger("topImages.changed")},_firePreviewEvent:function(e){if(this.type=="section"){var t=this._section.id,n={sectionId:t,doNotEnterSection:e,info:{focusEnabled:this.focusEnabled,topImagesForPreview:this._topImages}};r.modules.AppPreviewer.sectionFocusChanged(n)}},mainTpl:function(){var e=this.focusEnabled?'checked="checked"':"",t=this.focusEnabled?"":"hide",n=this.type=="section"?"withoutSelect":"",r="";return this.type=="section"&&(r+='<h4 class="grey">轮播图片		            <label>		                <input class="ace ace-switch ace-switch-5" type="checkbox" '+e+' data-input="status">		                <span class="lbl">		                </span>		            </label>		        </h4>'),r+='<div class="form-group '+t+'" data-type="topImageListPanel">		            <div class="topImgsWrapper">		                <ul class="topImgs" data-block="imgList">		                	<li class="topImg addImg" data-item="addImg">								<div class="addImgInner '+n+'">									<i class="icon-plus"></i>									<div>										<button type="button" class="btn btn-xs" data-action="selectTopImages">选择</button>									</div>									<div>										<button type="button" class="btn btn-primary btn-xs" data-action="uploadTopImages">上传</button>									</div>								</div>							</li>							<div class="clearfix"></div>		                </ul>		            </div>		        </div>		        <hr>',r}});var i=function(e){var t="",r=0;n.each(e,function(e){r++;if(r>6)return;t+='<li class="topImg" data-item="topImg" data-index="'+(r-1)+'">				<div class="topImgInner">					<div class="title">'+e.title+'</div>					<img src="'+e.picture_url+'"/>					<div class="tools">						<i class="icon-pencil" data-action="edit"></i>						<i class="icon-remove red" data-action="delete"></i>					</div>				</div>			</li>'});while(6-r>1)t+='<li class="topImg"></li>',r++;return t}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf"),i=6,s="product_img";r.modules.cms.TopImagesSelectDialog=r.modules.common.Dialog.extend({events:{"click .modal-header .close":"close","click .tree li .item-name":"_loadItems","click .more-items":"_loadMoreData","click .item .img":"_selectItem","click .chosen .img [data-action=remove]":"_removeSelectedItem","click .modal-footer [data-action=cancel]":"close","click .modal-footer [data-action=save]":"_save"},internalInitialize:function(){this._done=n.isFunction(this.args.done)?this.args.done:null,this.$el.find(".modal").addClass("topImg-modal"),this.viewport().html(o()),this.$tree=this.$el.find(".tree[data-type=sections]").html(u(this._getAvailableSections())),this.$list=this.$el.find(".itemsInner"),this.$selectedItems=this.$el.find(".chosen .imgs")},title:function(){return"选择顶部图片"},onShow:function(){var e=this._findFirstLeafSection();if(e){var t=this;r.doJob(function(){t.$tree.find('.tree-item[data-section-id="'+e.id+'"] .item-name').trigger("click")},50)}},onClose:function(){},_getAvailableSections:function(){var e=r.App.config.currentApp.sections;return n.reject(e,function(t){var r=n.find(e,function(e){return e.parent_id==t.id});return!r&&t.type.code=="CUSTOM_PAGE"})},_loadItems:function(t){var n=e(t.target).parents(".tree-item");if(n.children("ul").length)return;this.$tree.find(".tree-item").removeClass("active"),n.addClass("active"),this._pageData={pno:0,psize:15,totalCount:100},this.$list.next(".more-items").remove(),this.$list.html(""),this._sectionCasCode=n.attr("data-section-cas-code"),this._loadMoreData()},_loadMoreData:function(){if(!this._hasMoreItems())return;this._pageData.pno++,this._showLoader();var t=this;e.get(r.api("/items:pictures"),{app_id:r.App.config.currentApp.id,section_cas_code:this._sectionCasCode,pno:this._pageData.pno,psize:this._pageData.psize}).done(function(e){t._pageData={pno:e.pno,psize:e.psize,totalCount:e.total_count},t._appendItems(e.items),t._hideLoader()}).error(function(){t._hideLoader()})},_appendItems:function(e){this.$list.append(l(e)),this.$list.next(".more-items").remove(),this._hasMoreItems()&&this.$list.after(p())},_hasMoreItems:function(){return this._pageData.pno*this._pageData.psize<this._pageData.totalCount},_isLoadingFirstPage:function(){return this._pageData.pno==1},_showLoader:function(){this._isLoadingFirstPage()?this.$list.parent().spin():this.$list.next(".more-items").find(".more-items-inner").html("").spin({length:3,width:4,radius:5})},_hideLoader:function(){this._isLoadingFirstPage()?this.$list.parent().spin("stop"):this.$list.next(".more-items").find(".more-items-inner").spin("stop").html("更多内容")},_getSelectedImages:function(){var t=[],n=this;return this.$selectedItems.find(".img").each(function(){var n=e(this);t.push({item_id:n.data().itemId,picture_url:n.find("img").attr("src"),title:n.find("input[name=title]").val()})}),t},_save:function(e){this._done&&this._done(this._getSelectedImages()),this.close()},_countOfSelectedImages:function(){return this.$selectedItems.children(".img").length},_selectItem:function(t){if(this._countOfSelectedImages()==6)return;var n=e(t.target).parents(".item"),r=e(t.target).is(".img")?e(t.target):e(t.target).parents(".img"),i=r.data().imageId,s=r.find("img").attr("src");if(r.hasClass("active"))r.removeClass("active"),this.$selectedItems.find('.img[data-item-id="'+n.data().itemId+'"][data-image-id="'+i+'"]').remove();else{r.addClass("active");var o={id:n.data().itemId,title:n.find(".title").text(),imageId:i,picture:s};this.$selectedItems.append(h(o))}},_removeSelectedItem:function(t){var n=e(t.target).parents(".img"),r=n.data().itemId,i=n.data().imageId;e(t.target).parents(".img").remove(),this.$list.find('.item[data-item-id="'+r+'"] .img[data-image-id="'+i+'"]').removeClass("active")},_findFirstLeafSection:function(e){var t=this._getAvailableSections();return n.find(t,function(e){var r=n.find(t,function(t){return t.parent_id==e.id});return!r})}});var o=function(){return'<div class="modal-body">			<div class="tree-wrapper">				<ul class="tree tree-unselectable" data-type="sections"></ul>			</div>			<div>				<div class="items"><div class="itemsInner"></div></div>				<div class="chosen"><ul class="imgs"></ul></div>			</div>		</div>		<div class="modal-footer">			<button class="btn" data-action="cancel"><i class="icon-remove"></i>取消</button>			<button class="btn btn-primary" data-action="save"><i class="icon-remove"></i>确定</button>		</div>'},u=function(e){var t="",r=0;while(r<e.length){var i=e[r];if(e[r+1]&&e[r+1].tree_level>i.tree_level){var s=n.filter(e,function(e){return e.parent_id==i.id});t+=f(i,s),r+=s.length+1}else t+=a(i),r++}return t},a=function(e){return'<li class="tree-item" data-section-id="'+e.id+'" data-section-cas-code="'+e.cas_code+'">			<div class="tree-item-name item-name">'+e.name+"</div>		</li>"},f=function(e,t){var r='<li class="tree-folder" data-section-id="'+e.id+'" data-section-cas-code="'+e.cas_code+'">			<div class="tree-folder-header">				<div class="tree-folder-name item-name">'+e.name+'</div>			</div>			<ul class="tree-folder-content">';return n.each(t,function(e){r+='<li class="tree-item" data-section-id="'+e.id+'" data-section-cas-code="'+e.cas_code+'">				<div class="tree-item-name item-name">'+e.name+"</div>			</li>"}),r+="</ul></li>",r},l=function(e){var t="";return n.each(e,function(e){t+='<div class="item" data-item-id="'+e.id+'">				<div class="title">'+e.title+'</div>				<ul class="imgs">',t+=c(e.pictures),t+="</ul>			</div>"}),t},c=function(e){var t="";return n.each(e,function(e,n){t+='<li class="img" data-image-id="'+(n+1)+'">				<div><img src="'+r.assetLink(e)+'"/></div>				<i class="icon-ok" data-action="select"></i>			</li>'}),t},h=function(e){return'<li class="img" data-item-id="'+e.id+'" data-image-id="'+e.imageId+'">			<input type="hidden" name="title" value="'+e.title+'"/>			<div class="tools"><i class="icon-remove red" data-action="remove"></i></div>			<img src="'+r.assetLink(e.picture)+'"/>		</li>'},p=function(){return'<div class="more-items"><div class="more-items-inner">更多内容</div></div>'}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf"),i=6,s="product_img";r.modules.cms.TopImagesHomeSelect=r.modules.common.Dialog.extend({events:{"click .modal-header .close":"close","click .modal-footer [data-action=cancel]":"close","click .modal-footer [data-action=save]":"_save","click ul.bgiSelecter-inner li":"_onTopImgSelected","click .btn[data-action=selectTopImg]":"_selectTopImg"},internalInitialize:function(e){this._done=n.isFunction(this.args.done)?this.args.done:null,this._app=r.App.config.currentApp,this.$container=e.container,this.$topImgSelecter=this.viewport().html(o()),console.log(this.$topImgSelecter),this._onTopImgSelecterShown()},title:function(){return"选择顶部图片"},_onTopImgSelecterShown:function(e){var t=this._app.top_img_url;if(t&&t.indexOf("material")>=0){var n=this.$topImgSelecter.find('li div[data-url="'+t+'"]'),r=n.parent("li");r.click()}},_onTopImgSelected:function(t){var n=e(t.target).closest("li"),s=this.$topImgSelecter.find("li.active").length+this.$container.children('[data-item="topImg"]').length;if(n.hasClass("active"))n.removeClass("active");else{if(s>=i){r.showMessage("error","最多选择6张图片",!0);return}n.addClass("active")}},_selectTopImg:function(){this.$topImgSelecter.modal("hide");if(!this._tmpTopImgUrl)return;var e=this._tmpTopImgUrl;this._onHomeTopImgUploaded({},{url:e}),this.$el.find("img[data-action=uploadTopImg]").attr({src:e})},_onHomeTopImgUploaded:function(e,t){this._setImgInputVal("home_top_img_url",t.url)},_setImgInputVal:function(e,t){this.$form.find("input[name="+e+"]").val(t)},_getSelectedImages:function(){var t=[],n=this;return this.$topImgSelecter.find(".active").each(function(){var n=e(this).children("div");t.push({title:"",picture_url:n.data("url")})}),t},_save:function(e){new r.modules.cms.TopImageUploadProgressDialog({files:this._getSelectedImages(),type:"select",done:n.bind(this._done,this)}),this.close()}});var o=function(){var e='<div class="bgiSelecter">				        <div class="modal-content">				            <div class="modal-body">				                <div>				                    <ul class="bgiSelecter-inner clearfix">				                    	<li><div class="bgi-101@2x~iphone" data-url="/files/material/bgis/640/101@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/101@2x~iphone.jpg)"></div></li><li><div class="bgi-102@2x~iphone" data-url="/files/material/bgis/640/102@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/102@2x~iphone.jpg)"></div></li><li><div class="bgi-103@2x~iphone" data-url="/files/material/bgis/640/103@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/103@2x~iphone.jpg)"></div></li><li><div class="bgi-104@2x~iphone" data-url="/files/material/bgis/640/104@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/104@2x~iphone.jpg)"></div></li><li><div class="bgi-105@2x~iphone" data-url="/files/material/bgis/640/105@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/105@2x~iphone.jpg)"></div></li><li><div class="bgi-106@2x~iphone" data-url="/files/material/bgis/640/106@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/106@2x~iphone.jpg)"></div></li><li><div class="bgi-107@2x~iphone" data-url="/files/material/bgis/640/107@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/107@2x~iphone.jpg)"></div></li><li><div class="bgi-108@2x~iphone" data-url="/files/material/bgis/640/108@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/108@2x~iphone.jpg)"></div></li><li><div class="bgi-109@2x~iphone" data-url="/files/material/bgis/640/109@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/109@2x~iphone.jpg)"></div></li><li><div class="bgi-110@2x~iphone" data-url="/files/material/bgis/640/110@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/110@2x~iphone.jpg)"></div></li><li><div class="bgi-111@2x~iphone" data-url="/files/material/bgis/640/111@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/111@2x~iphone.jpg)"></div></li><li><div class="bgi-112@2x~iphone" data-url="/files/material/bgis/640/112@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/112@2x~iphone.jpg)"></div></li><li><div class="bgi-113@2x~iphone" data-url="/files/material/bgis/640/113@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/113@2x~iphone.jpg)"></div></li><li><div class="bgi-114@2x~iphone" data-url="/files/material/bgis/640/114@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/114@2x~iphone.jpg)"></div></li><li><div class="bgi-115@2x~iphone" data-url="/files/material/bgis/640/115@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/115@2x~iphone.jpg)"></div></li><li><div class="bgi-116@2x~iphone" data-url="/files/material/bgis/640/116@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/116@2x~iphone.jpg)"></div></li><li><div class="bgi-117@2x~iphone" data-url="/files/material/bgis/640/117@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/117@2x~iphone.jpg)"></div></li><li><div class="bgi-118@2x~iphone" data-url="/files/material/bgis/640/118@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/118@2x~iphone.jpg)"></div></li><li><div class="bgi-119@2x~iphone" data-url="/files/material/bgis/640/119@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/119@2x~iphone.jpg)"></div></li><li><div class="bgi-120@2x~iphone" data-url="/files/material/bgis/640/120@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/120@2x~iphone.jpg)"></div></li><li><div class="bgi-121@2x~iphone" data-url="/files/material/bgis/640/121@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/121@2x~iphone.jpg)"></div></li><li><div class="bgi-122@2x~iphone" data-url="/files/material/bgis/640/122@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/122@2x~iphone.jpg)"></div></li><li><div class="bgi-123@2x~iphone" data-url="/files/material/bgis/640/123@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/123@2x~iphone.jpg)"></div></li><li><div class="bgi-124@2x~iphone" data-url="/files/material/bgis/640/124@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/124@2x~iphone.jpg)"></div></li><li><div class="bgi-125@2x~iphone" data-url="/files/material/bgis/640/125@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/125@2x~iphone.jpg)"></div></li><li><div class="bgi-126@2x~iphone" data-url="/files/material/bgis/640/126@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/126@2x~iphone.jpg)"></div></li><li><div class="bgi-127@2x~iphone" data-url="/files/material/bgis/640/127@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/127@2x~iphone.jpg)"></div></li><li><div class="bgi-200@2x~iphone" data-url="/files/material/bgis/640/200@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/200@2x~iphone.jpg)"></div></li><li><div class="bgi-201@2x~iphone" data-url="/files/material/bgis/640/201@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/201@2x~iphone.jpg)"></div></li><li><div class="bgi-202@2x~iphone" data-url="/files/material/bgis/640/202@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/202@2x~iphone.jpg)"></div></li><li><div class="bgi-203@2x~iphone" data-url="/files/material/bgis/640/203@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/203@2x~iphone.jpg)"></div></li><li><div class="bgi-204@2x~iphone" data-url="/files/material/bgis/640/204@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/204@2x~iphone.jpg)"></div></li><li><div class="bgi-205@2x~iphone" data-url="/files/material/bgis/640/205@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/205@2x~iphone.jpg)"></div></li>				                    </ul>				                </div>				            </div>				            <div class="modal-footer">				                <button type="button" class="btn btn-cancel" data-action="cancel" data-dismiss="modal">				                    <i class="icon-remove bigger-110"></i>取消				                </button>				                <button class="btn btn-success" data-action="save">				                    <i class="icon-ok bigger-110"></i>确定				                </button>				            </div>				        </div>				    </div>';return e}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.cms.TopImageEditor=r.modules.common.Dialog.extend({events:{"click .close, .btn[data-action=cancel]":"close",submit:"_save"},internalInitialize:function(){this._topImage=n.clone(this.args.topImage)||{},this.$el.find(".modal").addClass("topImageEditor"),this.viewport().html(i(this._topImage))},title:function(){return"修改顶部图片"},onShow:function(){this.viewport().find("input[name=title]").focus()},_save:function(e){e.preventDefault(),this._topImage.title=this.$el.find("input[name=title]").val(),this.args.done&&this.args.done(this._topImage),this.close()}});var i=function(e){return'<form>			<div class="modal-body">				<div>					<input type="text" class="form-control input-lg" name="title" placeholder="图标标题" value="'+n.unescape(e.title)+'"/>				</div>				<div class="imgWrapper">					<img src="'+r.assetLink(e.picture_url)+'"/>				</div>			</div>			<div class="modal-footer">				<button type="button" class="btn" data-action="cancel"><i class="icon-remove"></i> 取消</button>				<button type="submit" class="btn btn-primary"><i class="icon-ok icon-white"></i> 确定</button>			</div>		</form>'}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf"),i=6;r.modules.cms.TopImageUploader=r.common.BaseView.extend({doInitialize:function(t){this._maxFiles=t.maxFiles||i,this.$container=e(t.container),this._uploader=this.$el.uploader({url:t.uploadUrl,multipleFiles:!1,maxFiles:1,accept:n.bind(this._acceptFile,this),params:{authenticityToken:r.App.config.authToken},handlers:{processing:this._onProcessingFile=n.bind(this._onProcessingFile,this),error:this._onError=n.bind(this._onError,this)}}).uploader("getInstance")},_acceptFile:function(e,t){var n=this._uploader.getAcceptedFiles(),r=n.length+this.$container.children('[data-item="topImg"]').length;r>this._maxFiles-1&&t("达到最多允许"+this._maxFiles+" 张图片的限制了."),t()},_onProcessingFile:function(e){if(this._dialog)return;this._dialog=new r.modules.cms.TopImageUploadProgressDialog({uploader:this._uploader,done:n.bind(this._onUploadResultConfirmed,this),cancel:n.bind(this._onUploadResultCanceled,this),imgCrop:!0,cropWidth:240,cropHeight:135})},_onError:function(e,t){this._uploader.removeFile(e)},_onUploadResultCanceled:function(){delete this._dialog},_onUploadResultConfirmed:function(e){this.args.done&&this.args.done(e),delete this._dialog}})}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.cms.TopImageUploadProgressDialog=r.modules.common.Dialog.extend({events:{"click .close, .btn[data-action=cancel]":"close","click .list-group-item [data-action=cutImage]":"_cutImage","click .btn[data-action=save]":"_ok","change input[name=optionsRadios]":"tabInput","click input[name=optionsRadios]":"tabInput","change select.section-level-one":"getLevelTwo","change select.section-level-two":"getItems"},internalInitialize:function(){var t=this,r=this.args;this.type=r.type||"upload",this.$el.find(".modal").addClass("topImageUploadDialog"),this.$items=this.viewport().html(i()).find(".list-group"),this.cropWidth=r.cropWidth||300,this.cropHeight=r.cropHeight||300,this.minWidth=r.minWidth||0,this.minHeight=r.minHeight||0;if(this.type=="upload"){e(".optionsRadios1").click(),this.tabInput({srcElement:e(".optionsRadios1")}),this._uploader=this.args.uploader,this.completed=0,this._uploader.on("sending",this._onSending=n.bind(this._onSending,this)).on("uploadprogress",this._onUploadProgress=n.bind(this._onUploadProgress,this)).on("complete",this._onComplete=n.bind(this._onComplete,this)).on("success",this._onSuccess=n.bind(this._onSuccess,this)).on("error",this._onError=n.bind(this._onError,this));return}this._topImages=r.files||[],console.log(this._topImages);if(this.type=="edit"||this.type=="select"){this.$items.empty();var o;n.each(this._topImages,function(e,n){o=s(e,n),console.log(e),t.$items.append(o)}),this.$('[data-action="save"]').removeClass("disabled")}this._initLinkEditors()},_initLinkEditors:function(){var t=r.App.util.getFirstLevelSections(),n;n=this.selectOption(t);if(this.type=="select"){e(".section-level-one").append(n);return}e(".section-level-one:last").append(n);if(this.type=="edit"){if(this._topImages[0].link){e(".optionsRadios2").click(),this.tabInput({srcElement:e(".optionsRadios2")}),e(".inputlink").val(this._topImages[0].link);return}this._topImages[0].section_id&&this.editShowSelect()}},itemListCache:{},title:function(){return"编辑轮播图片"},onClose:function(){this.type=="upload"&&(this._uploader.off("sending",this._onSending).off("uploadprogress",this._onUploadProgress).off("complete",this._onComplete).off("success",this._onSuccess).off("error",this._onError),this._uploader.removeAllFiles(!0)),this.args.cancel&&this.args.cancel()},_ok:function(t){var n=[],r=this;if(this.type=="edit"){n=this._topImages;var i=this.$items.children('[data-file-status="UPLOADED"]').eq(0),s=this.getSection();n[0].title=i.find("input[name=title]").val(),n[0].picture_url=i.find("img").attr("data-url"),n[0].section_id=e(s).children(":selected").val(),n[0].item_id=e(".section-level-three").children(":selected").val(),n[0].link=e(".inputlink").val()}else this.$items.children("[data-file-status=UPLOADED]").each(function(){var t=e(this),i=r.getSection(t);n.push({title:t.find("input[name=title]").val(),picture_url:t.find("img").attr("data-url"),section_id:e(i).children(":selected").val(),item_id:t.find(".section-level-three").children(":selected").val(),link:t.find(".inputlink").val()})});this.args.done&&this.args.done(n),this.close()},_getFileById:function(e){return n.find(this._uploader.getAcceptedFiles(),function(t){return t.ctx&&t.ctx.id==e})},_cutImage:function(e){this.args.imgCrop&&(this.$el.find(".modal-dialog").css("display","none"),this._imageCrop=new r.modules.common.ImageCrop({url:this.url,width:this.cropWidth,height:this.cropHeight,minWidth:this.minWidth,minHeight:this.minHeight,callback:n.bind(this.cropSuccess,this),setImg:n.bind(this.setImgSrc,this)}))},_createThumbnail:function(e){if(!window.FileReader)return;var t=new FileReader;t.onload=function(){e.ctx.$element.find("img").attr({src:t.result}),t=null},t.readAsDataURL(e)},_onSending:function(t,r,i){t.ctx={id:n.uniqueId("topImg_")},t.ctx.$element=e(s(t)).appendTo(this.$items).attr({"data-file-status":"UPLOADING"}),this.$img=t.ctx.$element,this._createThumbnail(t),this._initLinkEditors()},_onUploadProgress:function(e,t,n){e.ctx.$element.find(".progress-bar").width(t+"%")},_onComplete:function(t){this.completed++,this.completed>=this._uploader.files.length&&this.$('[data-action="save"]').removeClass("disabled"),t.ctx.$element.find(".progress").fadeOut(800,function(){e(this).remove()})},_onSuccess:function(e,t){e.ctx.$element.attr({"data-file-status":"UPLOADED"}),this.url=t.url;var n=e.ctx.$element.find("img"),r=e.ctx.$element.find(".imgprew");n.attr("src")||n.attr({src:t.url}),r.css({"background-image":"url("+t.url+")"}),n.attr({"data-url":t.url})},cropSuccess:function(){this.$el.find(".modal-dialog").css("display","block")},setImgSrc:function(e){var t=this.$img.find("img"),n=this.$img.find(".imgprew");t.attr({src:e}),n.css({"background-image":"url("+e+")"}),t.attr({"data-url":e})},_onCanceled:function(e){e.ctx.$element.attr({"data-file-status":"CANCELLED"})},_onError:function(e,t){e.ctx.$element.attr({"data-file-status":"ERROR"})},tabInput:function(t){var n=e(t.srcElement).parents(".list-group-item"),r=e(t.srcElement).val();n.find("."+r).addClass("hide").siblings(".hide").removeClass("hide")},selectOption:function(e){var t='<option value="">请选择</option>';return n.each(e,function(e){t=t+'<option value="'+e.id+'">'+e.name+"</option>"}),t},getLevelTwo:function(t){if(typeof t=="string")var n=t,i=this.$el;else var n=e(t.srcElement).children(":selected").val(),i=e(t.srcElement).parent(".all-select");if(!r.App.util.hasSecondSection(n)){this.getItems(n,i);return}var s=r.App.util.getSecondLevelSections(n),o;o=this.selectOption(s),i.find(".section-level-two").html(o).removeClass("hide"),this.type=="edit"&&this._topImages},setItemListCache:function(e,t){this.itemListCache[e]=t},getItemListCache:function(e){return this.itemListCache[e]||!1},getItems:function(t,i){if(typeof t=="string")var s=t,o=i;else{console.log(t);var s=e(t.srcElement).children(":selected").val(),o=e(t.srcElement).parent(".all-select")}if(!r.App.util.hasItemSection(s)){o.find(".section-level-three").removeClass("hide");return}var u={appId:r.App.config.currentApp.id,securityKey:r.App.config.currentApp.security_key,cas_code:r.App.util.getSectionInfoById(s).cas_code,pageSize:1e4,pno:1,sectionId:s},a=this,f=this.getItemListCache(s),l;if(f){l=this.selectOption(f),o.find(".section-level-three").html(l).removeClass("hide");return}e.get("/api/client/items",u).done(function(e){if(e.code==200){var t=[];n.each(e.result,function(e){var n={id:e.id,name:e.title};t.push(n)}),console.log(t),l=a.selectOption(t),o.find(".section-level-three").html(l).removeClass("hide"),a.setItemListCache(s,t);if(a.type=="edit"){var r=a._topImages[0].item_id||"";a.showItems(r)}}else o.find(".section-level-three").removeClass("hide")})},editShowSelect:function(){e(".optionsRadios1").click(),this.tabInput({srcElement:e(".optionsRadios1")});var t=r.App.util.getSectionInfoById(this._topImages[0].section_id),n=t.parent_id||t.id,i=t.tree_level==2&&t.id,s=this._topImages[0].item_id||"";this.showLevelOne(n),i?(this.getLevelTwo(n),this.showLevelTwo(i),this.getItems(i,this.viewport()),this.showItems(s)):(this.getItems(n,this.viewport()),this.showItems(s))},showLevelOne:function(t){e(".section-level-one").children("option[value="+t+"]").attr("selected","selected")},showLevelTwo:function(t){e(".section-level-two").children("option[value="+t+"]").attr("selected","selected")},showItems:function(t){e(".section-level-three").children("option[value="+t+"]").attr("selected","selected")},getSection:function(e){var t=e||this.$el,n=t.find(".section-level-two").hasClass("hide")?t.find(".section-level-one"):t.find(".section-level-two");return n}});var i=function(){return'<div class="modal-body">			<ul class="list-group"></ul>		</div>		<div class="modal-footer">			<button type="button" class="btn" data-action="cancel"><i class="icon-remove"></i> 取消</button>			<button type="submit" class="btn btn-primary disabled" data-action="save"><i class="icon-ok icon-white"></i> 确定</button>		</div>'},s=function(e,t){var n=e.ctx&&e.ctx.id||e.id||"file_"+t,r=e.ctx?"":'data-file-status="UPLOADED"',i=e.ctx?"":"hide",s=e.title||"";return'<li class="list-group-item" data-file-id="'+n+'" '+r+'>			 <div class="imgprew" style="background-image:url('+(e.picture_url||"")+')">			 	<a class="btn btn-info btn-xs '+i+'" title="图片裁剪" data-action="cutImage">裁剪图片</a>				<img src="'+(e.picture_url||"")+'" class="hide"  data-url="'+e.picture_url+'"/>			</div>			<div class="progress progress-striped active img-progress-bar '+i+'"><div class="progress-bar"></div></div>			<input type="text" class="form-control" name="title" value="'+s+'" placeholder="图标标题"/>			<br><form>			<div class="radio-inline">			   <label><input type="radio" name="optionsRadios" class="optionsRadios1" value="select-input" checked>微站栏目</label>			</div>			<div class="radio-inline">			   <label><input type="radio" name="optionsRadios" class="optionsRadios2" value="all-select">外部链接</label>			</div>			<br>			<div class="select-input hide"><input class="inputlink" type="text" name="outlink" placeholder="http://"></div>			<div class="all-select"><select class="section-level-one">			</select><select class="section-level-two hide"><option>二级栏目</option></select>			<select class="section-level-three hide"><option value="">无栏目</option></select></form></div>		</li>'}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.cms.PublishDialog=r.modules.common.Dialog.extend({events:{"click .close, .btn[data-action=cancel]":"close",submit:"_publish","keydown input":"_onKeydown"},internalInitialize:function(){this.appInfo=this.args.appInfo||{};if(!this.appInfo.id)return;this.$form=this.viewport().html(i()).find("form"),jQuery("body").addClass("modal-open")},title:function(){return"修改个性化域名"},onClose:function(){jQuery("body").removeClass("modal-open")},_onKeydown:function(t){if(t.keyCode==r.constants.enter||t.keyCode==r.constants.tab)return;e(t.target).parents(".form-group").removeClass("has-error").end().next(".validation-error").remove()},_publish:function(i){i.preventDefault(),this._removeValidationErrorOnFormActions(),this.$form.find("input[name=authenticityToken]").val(r.App.config.authToken);var s=this.$form.find(".btn[data-action=publish]").button("loading"),o=this,u=this.$form.serialize();console.log(u),e.post(r.api("/apps/"+o.appInfo.id+"/code"),u).done(function(e){console.log(e);if(e.code==200){s.button("reset"),o.close(),e.app&&(n.extend(o.appInfo,e.app),t.Events.trigger("app.settings.bindDomain",e.app)),r.showMessage("INFO","个性域名修改成功",!0),jQuery("body").removeClass("modal-open");return}s.button("reset"),o._handleValdiationErrors(e)}).error(function(){s.button("reset"),o.close(),r.showMessage("ERROR","修改失败!你很可能遭遇了系统异常，请联系管理员.",!0)})},_removeValidationErrorOnFormActions:function(){this.$form.find("div.has-error").removeClass("has-error"),this.$form.find(".validation-error").remove(),this.$formActions||(this.$formActions=this.$el.find(".form-group")),this.$formActions.removeClass("has-error").find(".validation-error").remove()},_handleValdiationErrors:function(e){var t=this.$form,r=this;e.errors&&n.each(e.errors,function(e,t){r.$el.find("[name="+t+"]").after('<div class="validation-error">'+e+"</div>").parents(".form-group").addClass("has-error")}),e.message&&r.$el.find("[name=appCode]").after('<div class="validation-error">'+e.message+"</div>").parents(".form-group").addClass("has-error"),t.find(".form-actions").addClass("has-error").prepend('<span class="validation-error">有些项填写不正确，请根据指示检查.</span>')}});var i=function(){return'<form class="form-horizontal publish-dialog">			<input type="hidden" name="authenticityToken"/>			<input type="hidden" name="action" value="set_code"/>				<div class="modal-body">					<div class="form-group">						<label class="col-sm-3 control-label no-padding-right">个性域名:</label>						<div class="col-sm-9">							'+s()+'<input type="text" name="appCode" placeholder="微站唯一标识"/>						</div>					</div>					<div class="form-group">						<div class="col-sm-9 col-sm-offset-2 grey">							1、个性域名是指向微站的web地址，可用于微信公众账号菜单链接、微博、微信的分享。<br>							2、个性域名为4至20位的英文和数字（必须以英文字符开头），不支持纯数字，不支持大写字母。<br>							3、个性域名是掌卡唯一指定的特有地址，一旦发布将不可更改。<br>							4、每个微站只能修改一次个性化域名。<br>						</div>					</div>				</div>				<div class="modal-footer">					<button class="btn" type="button" data-action="cancel"><i class="icon-remove"></i>取消</button>					<button class="btn btn-primary" data-action="publish" data-loading-text="修改中..."><i class="icon-circle-arrow-up"></i>修改</button>				</div>			</form>'},s=function(){var e=r.App.config.hostDomain+"/apps/";return e}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf"),i=20;r.modules.cms.GalleryImageUploader=r.common.BaseView.extend({doInitialize:function(t){this._maxFiles=t.maxFiles||i,this.$container=e(t.container),this._uploader=this.$el.uploader({url:t.uploadUrl,multipleFiles:!0,accept:n.bind(this._acceptFile,this),params:{authenticityToken:r.App.config.authToken},handlers:{processing:this._onProcessingFile=n.bind(this._onProcessingFile,this),error:this._onError=n.bind(this._onError,this)}}).uploader("getInstance")},_acceptFile:function(e,t){var n=this._uploader.getAcceptedFiles(),r=n.length+this.$container.children(":not(.addImg)").length;r>this._maxFiles-1&&t("达到最多允许"+this._maxFiles+" 张图片的限制了."),t()},_onProcessingFile:function(e){if(this._dialog)return;this._dialog=new r.modules.cms.GalleryImageUploadProgressDialog({uploader:this._uploader,done:n.bind(this._onUploadResultConfirmed,this),cancel:n.bind(this._onUploadResultCanceled,this)})},_onError:function(e,t){this._uploader.removeFile(e)},_onUploadResultCanceled:function(){delete this._dialog},_onUploadResultConfirmed:function(e){this.args.done&&this.args.done(e),delete this._dialog}})}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.cms.GalleryImageUploadProgressDialog=r.modules.common.Dialog.extend({events:{"click .close, .btn[data-action=cancel]":"close","click .list-group-item i[data-action=removeFile]":"_removeFile","click .btn[data-action=save]":"_ok"},internalInitialize:function(){this._uploader=this.args.uploader,this.completed=0,this.$el.find(".modal").addClass("topImageUploadDialog").addClass("imageList"),this.$items=this.viewport().html(i()).find(".list-group"),this._uploader.on("sending",this._onSending=n.bind(this._onSending,this)).on("uploadprogress",this._onUploadProgress=n.bind(this._onUploadProgress,this)).on("complete",this._onComplete=n.bind(this._onComplete,this)).on("success",this._onSuccess=n.bind(this._onSuccess,this)).on("error",this._onError=n.bind(this._onError,this))},title:function(){return"上传图集图片(每次最多允许上传20张图片)"},onClose:function(){this._uploader.off("sending",this._onSending).off("uploadprogress",this._onUploadProgress).off("complete",this._onComplete).off("success",this._onSuccess).off("error",this._onError),this._uploader.removeAllFiles(!0),this.args.cancel&&this.args.cancel()},_ok:function(t){var n=[];this.$items.children("[data-file-status=UPLOADED]").each(function(){var t=e(this);n.push({title:t.find("input[name=title]").val(),digest:t.find("input[name=digest]").val(),picture_url:t.find("img").attr("data-url")})}),this.args.done&&this.args.done(n),this.close()},_getFileById:function(e){return n.find(this._uploader.getAcceptedFiles(),function(t){return t.ctx&&t.ctx.id==e})},_removeFile:function(t){var n=e(t.target).parents("li"),r=n.data().fileId,i=this._getFileById(r);this._uploader.removeFile(i),n.remove()},_createThumbnail:function(e){if(!window.FileReader)return;var t=new FileReader;t.onload=function(){e.ctx.$element.find("img").attr({src:t.result}),t=null},t.readAsDataURL(e)},_onSending:function(t,r,i){t.ctx={id:n.uniqueId("topImg_")},t.ctx.$element=e(s(t)).appendTo(this.$items).attr({"data-file-status":"UPLOADING"}),this._createThumbnail(t)},_onUploadProgress:function(e,t,n){e.ctx.$element.find(".progress-bar").width(t+"%")},_onComplete:function(t){this.completed++,this.completed>=this._uploader.files.length&&this.$('[data-action="save"]').removeClass("disabled"),t.ctx.$element.find(".progress").fadeOut(800,function(){e(this).remove()})},_onSuccess:function(e,t){e.ctx.$element.attr({"data-file-status":"UPLOADED"});var n=e.ctx.$element.find("img");n.attr("src")||n.attr({src:t.url}),n.attr({"data-url":t.url})},_onCanceled:function(e){e.ctx.$element.attr({"data-file-status":"CANCELLED"})},_onError:function(e,t){e.ctx.$element.attr({"data-file-status":"ERROR"})}});var i=function(){return'<div class="modal-body">			<ul class="list-group"></ul>		</div>		<div class="modal-footer">			<button type="button" class="btn" data-action="cancel"><i class="icon-remove"></i> 取消</button>			<button type="submit" class="btn btn-primary disabled" data-action="save"><i class="icon-ok icon-white"></i> 确定</button>		</div>'},s=function(e){return'<li class="list-group-item" data-file-id="'+e.ctx.id+'">			<i class="icon icon-remove" data-action="removeFile"></i>			<img src=""/>			<div class="progress progress-striped active img-progress-bar"><div class="progress-bar"></div></div>			<input type="text" class="form-control" name="title" placeholder="图片标题"/>			<br>			<input type="text" class="form-control" name="digest" placeholder="图片说明"/>		</li>'}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.cms.PictureLightBox=r.modules.common.Dialog.extend({events:{"click .modal":"close"},internalInitialize:function(){this.$el.find(".modal").addClass("pictureLightBox").addClass("fade").find(".modal-header").remove(),this.viewport().html("").spin({length:3,width:4,radius:5,color:"white"}),this._loadImage();var e=this.$el.find(".modal").show(),t=this;r.doJob(function(){e.addClass("in"),t.adjustLocation()},30)},internalDialogShow:function(){},close:function(){this.$el.find(".modal").removeClass("in").addClass("out");var e=this;r.doJob(function(){r.modules.common.Dialog.prototype.close.apply(e)},200)},_loadImage:function(){var e=new Image,t=this;e.onload=function(){t.viewport().html(e),t.adjustLocation()},e.src=this.args.picUrl}})}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.cms.ContactWayEditor=r.common.BaseView.extend({events:{"keydown input, textarea":"_onKeydown",submit:"_save","click .form-actions .btn[data-action=reset]":"_cancel"},doInitialize:function(t){this._section=r.modules.cms.SectionModule.currentSection,this.$el.html(a(r.modules.cms.SectionModule.currentSection)),this.$form=this.$el.find("#contactWayForm"),this._isNewItem()&&(this._item=this._createNewItem(),this._render()),this._editor=new r.modules.cms.editor.RichEditor({el:this.$form.find("textarea[name=content]"),bigToolbar:!0});var i=this;this._editor.onEditorReady(function(){i._timer=setInterval(n.bind(i._preview,i),400)}),this._editor.on("changed",n.bind(this._contentChanged,this)),e(window).bind("scroll",this._onScroll=n.bind(this._onScroll,this))},setCallbacks:function(e,t){this[e]=t},onShow:function(e){if(this._isNewItem())return;this._loadData()},onRemove:function(){clearInterval(this._timer),this._editor.off("changed",this._onContentChanged),e(window).unbind("scroll",this._onScroll),this._editor.remove(),this._preview(!0,!0)},onRecover:function(){this._editor.recover()},onHide:function(){this.isChanged()&&this._cancel(),this._editor.hide()},isChanged:function(){return this._lastModifiedDt},_isNewItem:function(){return!this._section.last_item_id},_createNewItem:function(){var e=r.modules.cms.SectionModule.currentSection,t={id:"new",section_type:e.type.code,statuses:[{app_id:r.App.config.currentApp.id,section_id:e.id,section_cas_code:e.case_code,section_type:e.type.code,status:"ENABLE"}]};return this._sectionType()=="CONTACT_WAY"&&(t.attributes={}),t},_onKeydown:function(t){if(t.keyCode==r.constants.enter||t.keyCode==r.constants.tab)return;this._contentChanged(!0),e(t.target).parents(".form-group").removeClass("has-error").end().siblings(".validation-tips").removeClass("hide").end().next(".validation-error").remove(),this._removeValidationErrorOnFormActions()},_onContentChanged:function(e){this._lastModifiedDt=(new Date).getTime(),this.$form.find("textarea[name=content]").next(".validation-error").remove().parents(".form-group").removeClass("has-error"),this._removeValidationErrorOnFormActions()},_loadData:function(){if(this._isNewItem()){this._preview(!0,!1);return}r.showProgressIndicator("装载内容...");var t=this;e.get(r.api("/items/"+this._section.last_item_id)).done(function(e){t._cacheItem=e.item,t._item=e.item,t._render(),r.closeProgressIndicator()}).error(function(e){r.closeProgressIndicator(),r.showMessage("ERROR","内容装载出错",!0)})},_cancel:function(e){e&&e.preventDefault(),this._item=this._cacheItem;var t=this.$form.find(".has-error");t.removeClass("has-error").find(".validation-error").remove(),t.find(".validation-tips").removeClass("hide"),this._contentChanged(!1),this._render()},_save:function(t){t&&t.preventDefault&&t.preventDefault(),r.showProgressIndicator("联系方式保存中...");var n=this.$form.find(".btn-primary").button("loading"),i=this.$form.find(".has-error");i.removeClass("has-error").find(".validation-error").remove(),i.find(".validation-tips").removeClass("hide"),this.$form.find("input[name=authenticityToken]").val(r.App.config.authToken),this.$form.find("input[name=app_id]").val(r.App.config.currentApp.id),this.$form.find("input[name=section_type]").val(r.modules.cms.SectionModule.currentSection.type.code),this._sectionType()=="CONTACT_WAY"&&this.$form.find("input[name=coordinate]").val(this._item.attributes.coordinate);var s=this;e.post(r.api("/items/"+this._item.id),this.$form.serialize()).done(function(e){if(e.code==200){s._cacheItem=e.item,s._section.last_item_id=e.item.id,s._item=e.item,s._lastModifiedDt=null,s._contentChanged(!1),s._preview(!0,!0),s._contentChanged(!1),r.showMessage("INFO","联系方式保存成功",!0),r.closeProgressIndicator();return}s._handleValdiationErrors(e.errors),r.closeProgressIndicator(),r.showMessage("ERROR","有些项填写不正确，请根据提示进行检查.",!0);return}).fail(function(){r.showMessage("ERROR","联系方式保存出错!",!0),s._contentChanged(!0)}).always(function(e){})},_render:function(){this._updateFormBySectionType(this._sectionType());var e=this._item,t=this;e.id!="new"&&(this.$form.find("input[name=id]").val(e.id),this.$form.find("input[name=app_id]").val(e.app_id),e.focus_id&&this.$form.find("input[name=focus_id]").val(e.focus_id),e.author&&this.$form.find("input[name=author]").val(n.unescape(e.author)),e.source&&this.$form.find("input[name=source]").val(n.unescape(e.source)),this.$form.find("input[name=title]").val(n.unescape(e.title)),this.$form.find("textarea[name=summary]").val(n.unescape(e.summary)),this.$form.find("input[name=contacts]").val(n.unescape(e.attributes.contacts)),this.$form.find("input[name=postCode]").val(n.unescape(e.attributes.postCode)),this.$form.find("input[name=qq]").val(n.unescape(e.attributes.qq)),this.$form.find("input[name=fax]").val(n.unescape(e.attributes.fax)),this.$form.find("input[name=email]").val(n.unescape(e.attributes.email)),this.$form.find("input[name=xnweibo]").val(n.unescape(e.attributes.xnweibo)),this.$form.find("input[name=txweibo]").val(n.unescape(e.attributes.txweibo)),this.$form.find("input[name=weixin]").val(n.unescape(e.attributes.weixin)),this._editor.initContent(e.content),this._renerSectionTypeRelatedProperties(e),this._lastModifiedDt=null,this._lastPreviewerSyncDt=(new Date).getTime()),this._renderAvailableSections()},_updateFormBySectionType:function(e){e=="CONTACT_WAY"&&!this._locationPicker&&(this._locationPicker=new r.modules.cms.LocationPicker({item:this._item,container:this.$form.find("div.location-picker"),editor:this}))},_renerSectionTypeRelatedProperties:function(e){e.section_type=="CONTACT_WAY"&&(this.$form.find("input[name=phones]").val(e.attributes.phones),this.$form.find("input[name=branchAddress]").val(e.attributes.address),this.$form.find("input[name=coordinate]").val(e.attributes.coordinate))},_sectionType:function(){return r.modules.cms.SectionModule.currentSection.type.code},_renderAvailableSections:function(){this.$form.find(".section-list").html(s(this._item,r.App.config.currentApp.sections))},_preview:function(e,t){if(this._lastModifiedDt==this._lastPreviewerSyncDt&&!e)return;this._lastPreviewerSyncDt=this._lastModifiedDt;var i=r.modules.cms.SectionModule.currentSection,s=n.extend({optionId:i.content_template.option_id,sectionId:i.id,itemId:i.last_item_id,properties:{title:this.$form.find("input[name=title]").val(),content:this.$form.find("textarea[name=content]").val()}});!t||(s.completed=!0),this._handlePreviewerTypeRelatedProperties(s),r.modules.AppPreviewer.itemContentChanged(s)},_contentChanged:function(e){e!=undefined||(e=!0),e?(this._lastModifiedDt=(new Date).getTime(),this.$form.find("textarea[name=content]").next(".validation-error").remove().parents(".form-group").removeClass("has-error"),this._removeValidationErrorOnFormActions(),this.$form.find(".form-actions .btn").enable()):(this._lastModifiedDt=null,this._lastPreviewerSyncDt=null,this.$form.find(".form-actions .btn").button("reset").disable()),this.onContentChanged&&this.onContentChanged(e)},_handlePreviewerTypeRelatedProperties:function(e){e.properties.attributes={address:this.$form.find("input[name=branchAddress]").val(),mapInfo:this.$form.find("input[name=coordinate]").val(),email:this.$form.find("input[name=email]").val(),fax:this.$form.find("input[name=fax]").val(),phone:this.$form.find("input[name=phones]").val(),QQ:this.$form.find("input[name=qq]").val(),contacts:this.$form.find("input[name=contacts]").val(),zipCode:this.$form.find("input[name=postCode]").val(),txWeibo:this.$form.find("input[name=txweibo]").val(),weixin:this.$form.find("input[name=weixin]").val(),weibo:this.$form.find("input[name=xnweibo]").val()}},_handleValdiationErrors:function(e){r.closeProgressIndicator();var t=this;n.each(e,function(e){e.key=="title"?t.$el.find("[name="+e.key+"]").after('<div class="validation-error">'+e.message+"</div>").parents(".form-group").addClass("has-error"):t.$el.find("[name="+e.key+"]").siblings(".validation-tips").addClass("hide").end().closest("div.form-group-control").append('<div class="validation-error">'+e.message+"</div>").parents(".form-group").addClass("has-error")})},_removeValidationErrorOnFormActions:function(){this.$formActions||(this.$formActions=this.$form),this.$formActions.removeClass("has-error").find(".validation-error").remove()},_onScroll:function(e){}});var i=function(e){return r.App.config.root+"/builder/"+r.App.config.currentApp.id+"/cms/"+e.id+"/content"},s=function(e,t){var i="";return n.each(t,function(n){if(n.type.code!=e.section_type||o(n,t))return;i+='<label class="checkbox-inline">					<input type="checkbox" name="section_cas_code" value="'+n.cas_code+'" '+(u(e,n)?"checked":"")+" "+(r.modules.cms.SectionModule.currentSection.id==n.id?"disabled":"")+"/> "+n.name+"				</label>"}),i},o=function(e,t){return n.any(t,function(t){return t.parent_id==e.id})},u=function(e,t){return n.any(e.statuses,function(e){return e.section_id==t.id})},a=function(e){return'<div class="page-content">			<div class="page-content">				<form id="contactWayForm">				<input type="hidden" name="app_id"/>				<input type="hidden" name="section_type"/>				<input type="hidden" name="section_cas_code" value="'+e.cas_code+'"/>				<input type="hidden" name="id"/>				<input type="hidden" name="authenticityToken"/>				<input type="hidden" name="coordinate"/>				<div class="form-group-set">						<div class="form-group enhanced required">							<label class="form-group-label">单位名称</label>							<div class="form-group-control">								<input type="text" class="form-control" name="title">							</div>						</div>						<div class="location-picker required"></div>						<div class="form-group enhanced required">							<label class="form-group-label">电话</label>							<div class="form-group-control">								<input type="text" name="phones" class="form-control"/>								<div class="validation-tips">										例如: 手机号码 13112345678, 电话号码: 028-85148898								</div>							</div>						</div>						<div class="form-group enhanced">							<label class="form-group-label">联系人</label>							<div class="form-group-control">								<input type="text" class="form-control" name="contacts"/>							</div>						</div>						<div class="form-group enhanced">							<label class="form-group-label">邮编</label>							<div class="form-group-control">								<input type="text" name="postCode" class="form-control"/>							</div>						</div>						<div class="form-group enhanced">							<label class="form-group-label">传真</label>							<div class="form-group-control">								<input type="text" name="fax" class="form-control"/>								<div class="validation-tips">										例如:传真号码  028-85148898								</div>							</div>						</div>						<div class="form-group enhanced">							<label class="form-group-label">邮件</label>							<div class="form-group-control">								<input type="text" name="email" class="form-control"/>							</div>						</div>						<div class="form-group enhanced">							<label class="form-group-label">QQ</label>							<div class="form-group-control">								<input type="text" name="qq" class="form-control"/>							</div>						</div>						<div class="form-group enhanced">							<label class="form-group-label">微信</label>							<div class="form-group-control">								<input type="text" name="weixin" class="form-control"/>							</div>						</div>						<div class="form-group enhanced">							<label class="form-group-label">新浪微博</label>							<div class="form-group-control">								<input type="text" name="xnweibo" placeholder="请输入微博账号，且长度不超过20个字符" class="form-control"/>							</div>						</div>						<div class="form-group enhanced">							<label class="form-group-label">腾讯微博</label>							<div class="form-group-control">								<input type="text" name="txweibo" placeholder="请输入微博账号，且长度不超过20个字符" class="form-control"/>							</div>						</div>						<div class="form-group enhanced required">							<label class="form-group-label">联系方式描述</label>							<div class="form-group-control">								<textarea name="content" class="form-control html-editor" placeholder="联系方式描述"></textarea>							</div>						</div>					</div>					<!--<div class="form-group form-actions">							<button type="reset" class="btn btn-cancel" data-action="reset">								<i class="icon-remove bigger-110"></i>取消							</button>							<button class="btn btn-primary" data-loading-text="保存中...">								<i class="icon-ok bigger-110"></i>保存							</button>					</div>-->				</form>			</div>		</div>'},f=function(){return"<div/>"}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.cms.AppointmentEditor=r.common.BaseView.extend({events:{"keydown input, textarea":"_onKeydown","click input[type=checkbox]":"_contentChanged","click input[name=allowPhoneCall]":"_showAllowPhoneCall","click input[name=allowOnline]":"_showAllowOnline",submit:"_save","click .form-actions .btn[data-action=reset]":"_cancel"},doInitialize:function(t){this._section=r.modules.cms.SectionModule.currentSection,this.$el.html(a(r.modules.cms.SectionModule.currentSection)),this.$form=this.$el.find("form"),this._isNewItem()&&(this._item=this._createNewItem(),this._render()),this._editor=new r.modules.cms.editor.RichEditor({el:this.$form.find("textarea[name=content]"),bigToolbar:!0});var i=this;this._editor.onEditorReady(function(){i._timer=setInterval(n.bind(i._preview,i),400)}),this._editor.on("changed",n.bind(this._contentChanged,this)),e(window).bind("scroll",this._onScroll=n.bind(this._onScroll,this))},setCallbacks:function(e,t){this[e]=t},onShow:function(e){if(this._isNewItem())return;this._loadData()},onRemove:function(){clearInterval(this._timer),this._editor.off("changed",this._onContentChanged),e(window).unbind("scroll",this._onScroll),this._editor.remove(),this._preview(!0,!0)},onRecover:function(){this._editor.recover()},isChanged:function(){return this._lastModifiedDt},_isNewItem:function(){return!this._section.last_item_id},_createNewItem:function(){var e=r.modules.cms.SectionModule.currentSection,t={id:"new",section_type:e.type.code,statuses:[{app_id:r.App.config.currentApp.id,section_id:e.id,section_cas_code:e.case_code,section_type:e.type.code,status:"ENABLE"}]};return this._sectionType()=="APPOINTMENT"&&(t.attributes={}),t},_onKeydown:function(t){if(t.keyCode==r.constants.enter||t.keyCode==r.constants.tab)return;this._contentChanged(!0),e(t.target).parents(".form-group").removeClass("has-error").end().siblings(".validation-tips").removeClass("hide").end().next(".validation-error").remove(),this._removeValidationErrorOnFormActions()},_onContentChanged:function(e){this._lastModifiedDt=(new Date).getTime(),this.$form.find("textarea[name=content]").next(".validation-error").remove().parents(".form-group").removeClass("has-error"),this._removeValidationErrorOnFormActions()},onHide:function(){this.isChanged()&&this._cancel(),this._editor.hide()},_loadData:function(){if(this._isNewItem()){this._preview(!0,!1);return}r.showProgressIndicator("装载内容...");var t=this;e.get(r.api("/items/"+this._section.last_item_id)).done(function(e){t._cacheItem=e.item,t._item=e.item,t._render(),r.closeProgressIndicator()}).error(function(e){r.closeProgressIndicator(),r.showMessage("ERROR","内容装载出错",!0)})},_cancel:function(e){e&&e.preventDefault(),this._isNewItem()?this._item=this._createNewItem():this._item=this._cacheItem;var t=this.$form.find(".has-error");t.removeClass("has-error").find(".validation-error").remove(),t.find(".validation-tips").removeClass("hide"),this._contentChanged(!0),this._render()},_showAllowPhoneCall:function(e){this.$form.find(".allowPhoneCall").toggleClass("hide"),this.$form.find(".allowPhone input[type='checkbox']").is(":checked")||this.$form.find("input[name=allowPhoneCall]").val(this._cacheItem.attributes.phone)},_showAllowOnline:function(e){this.$form.find(".allowOnline input[type='checkbox']").is(":checked")?(this.$form.find(".mustLogin").removeClass("hide"),this._cacheItem!=undefined&&this._cacheItem.attributes.must_login?this.$form.find("input[name=mustLogin]").attr("checked",!0):this.$form.find("input[name=mustLogin]").attr("checked",!1)):(this.$form.find(".mustLogin").addClass("hide"),this.$form.find("input[name=mustLogin]").val(this._cacheItem.attributes.must_login))},_resetCheckedData:function(e){return this.$form.find(".allowPhone input[type='checkbox']").is(":checked")||this.$form.find("input[name=phone]").val(""),this.$form.find(".allowOnline input[type='checkbox']").is(":checked")||this.$form.find("input[name=mustLogin]").val(""),!this.$form.find(".allowPhone input[type='checkbox']").is(":checked")&&!this.$form.find(".allowOnline input[type='checkbox']").is(":checked")?!0:!1},_save:function(t){t&&t.preventDefault&&t.preventDefault();if(this._resetCheckedData(t)){r.showMessage("ERROR","电话预约,在线预约必选期中一,请根据提示进行检查.",!0);return}r.showProgressIndicator("预约保存中...");var n=this.$form.find(".has-error");n.removeClass("has-error").find(".validation-error").remove(),n.find(".validation-tips").removeClass("hide"),this.$form.find("input[name=authenticityToken]").val(r.App.config.authToken),this.$form.find("input[name=app_id]").val(r.App.config.currentApp.id),this.$form.find("input[name=section_type]").val(r.modules.cms.SectionModule.currentSection.type.code);var i=this;e.post(r.api("/items/"+this._item.id),this.$form.serialize()).done(function(e){if(e.code==200){i._cacheItem=e.item,i._section.last_item_id=e.item.id,i._item=e.item,i._lastModifiedDt=null,i._contentChanged(!1),i._preview(!0,!0),r.showMessage("INFO","预约保存成功!",!0),r.closeProgressIndicator();return}i._handleValdiationErrors(e.errors),r.closeProgressIndicator(),i.onContentChanged(!0),r.showMessage("ERROR","有些项填写不正确，请根据提示进行检查.",!0)}).fail(function(){r.showMessage("ERROR","预约保存出错!",!0),i._contentChanged(!0)}).always(function(e){})},_onScroll:function(e){},_render:function(){var e=this._item,t=this;e!=undefined&&e.id!="new"&&(this.$form.find("input[name=id]").val(e.id),this.$form.find("input[name=app_id]").val(e.app_id),this.$form.find("input[name=title]").val(n.unescape(e.title)),this.$form.find("textarea[name=summary]").val(n.unescape(e.summary)),this._renerSectionTypeRelatedProperties(e),this._lastModifiedDt=null,this._lastPreviewerSyncDt=(new Date).getTime(),this._editor.initContent(e.content)),this._renderAvailableSections()},_renerSectionTypeRelatedProperties:function(e){e.section_type=="APPOINTMENT"&&(this.$form.find("input[name=phone]").val(e.attributes.phone),e.attributes.allow_phone_call?(this.$form.find(".allowPhoneCall").removeClass("hide"),this.$form.find("input[name=allowPhoneCall]").attr("checked",!0)):(this.$form.find(".allowPhoneCall").addClass("hide"),this.$form.find("input[name=allowPhoneCall]").attr("checked",!1)),e.attributes.allow_online?(this.$form.find(".mustLogin").removeClass("hide"),this.$form.find("input[name=allowOnline]").attr("checked",!0),e.attributes.must_login?this.$form.find("input[name=mustLogin]").attr("checked",!0):this.$form.find("input[name=mustLogin]").attr("checked",!1)):this.$form.find(".mustLogin").addClass("hide"))},_sectionType:function(){return r.modules.cms.SectionModule.currentSection.type.code},_renderAvailableSections:function(){this.$form.find(".section-list").html(s(this._item,r.App.config.currentApp.sections))},_preview:function(e,t){if(this._lastModifiedDt==this._lastPreviewerSyncDt&&!e)return;this._lastPreviewerSyncDt=this._lastModifiedDt;var i=r.modules.cms.SectionModule.currentSection,s=n.extend({optionId:i.content_template.option_id,sectionId:i.id,itemId:i.last_item_id,properties:{title:this.$form.find("input[name=title]").val(),content:this.$form.find("textarea[name=content]").val(),summary:this.$form.find("input[name=summary]").val()}});!t||(s.completed=!0),this._handlePreviewerTypeRelatedProperties(s),r.modules.AppPreviewer.itemContentChanged(s)},_contentChanged:function(e){e!=undefined||(e=!0),e?(this._lastModifiedDt=(new Date).getTime(),this.$form.find("textarea[name=content]").next(".validation-error").remove().parents(".form-group").removeClass("has-error"),this._removeValidationErrorOnFormActions(),this.$form.find(".form-actions .btn").enable()):(this._lastModifiedDt=null,this._lastPreviewerSyncDt=null,this.$form.find(".form-actions .btn").button("reset").disable()),this.onContentChanged&&this.onContentChanged(e)},_handlePreviewerTypeRelatedProperties:function(e){e.properties.attributes={mustLogin:this.$form.find("input[name=mustLogin]").is(":checked")?!0:!1,allowPhoneCall:this.$form.find("input[name=allowPhoneCall]").is(":checked")?!0:!1,allowOnline:this.$form.find("input[name=allowOnline]").is(":checked")?!0:!1,phone:this.$form.find("input[name=phone]").val()}},_handleValdiationErrors:function(e){var t=this.$form;n.each(e,function(e){e.key=="title"?t.find("[name="+e.key+"]").after('<div class="validation-error">'+e.message+"</div>").parents(".form-group").addClass("has-error"):t.find("[name="+e.key+"]").siblings(".validation-tips").addClass("hide").end().closest("div.form-group-control").append('<div class="validation-error">'+e.message+"</div>").parents(".form-group").addClass("has-error")}),t.find(".form-actions").addClass("has-error").prepend('<span class="validation-error">有些项填写不正确，请根据指示检查.</span>')},_removeValidationErrorOnFormActions:function(){this.$formActions||(this.$formActions=this.$form),this.$formActions.removeClass("has-error").find(".validation-error").remove()}});var i=function(e){return r.App.config.root+"/builder/"+r.App.config.currentApp.id+"/cms/"+e.id+"/content"},s=function(e,t){var i="";return n.each(t,function(n){if(e!=undefined&&n.type.code!=e.section_type||o(n,t))return;i+='<label class="checkbox-inline">					<input type="checkbox" name="section_cas_code" value="'+n.cas_code+'" '+(u(e,n)?"checked":"")+" "+(r.modules.cms.SectionModule.currentSection.id==n.id?"disabled":"")+"/> "+n.name+"				</label>"}),i},o=function(e,t){return n.any(t,function(t){return t.parent_id==e.id})},u=function(e,t){return e==undefined?!1:n.any(e.statuses,function(e){return e.section_id==t.id})},a=function(e){return'<div class="page-content">			<div class="page-content">				<form>				<input type="hidden" name="app_id"/>				<input type="hidden" name="section_type"/>				<input type="hidden" name="section_cas_code" value="'+e.cas_code+'"/>				<input type="hidden" name="id"/>				<input type="hidden" name="authenticityToken"/>				<div class="form-group-set">						<div class="form-group enhanced required">							<label class="form-group-label">预约名称</label>							<div class="form-group-control">								<input type="text" class="form-control" name="title">							</div>						</div>						<div class="form-group enhanced allowPhone">							<label class="form-group-label">电话预约</label>							<div class="form-group-static">								<label class="checkbox-inline"><input class="dynaCheckbox" type="checkbox" name="allowPhoneCall"></label>							</div>						</div>						<div class="form-group enhanced required hide allowPhoneCall">							<label class="form-group-label">电话</label>							<div class="form-group-control">								<input type="text" name="phone" class="form-control"/>								<div class="validation-tips">										例如: 手机号码 13112345678, 电话号码: 028-85148898								</div>							</div>						</div>						<div class="form-group enhanced allowOnline">							<label class="form-group-label">在线预约</label>							<div class="form-group-static">								<label class="checkbox-inline"><input class="dynaCheckbox" type="checkbox" name="allowOnline"></label>							</div>						</div>						<div class="form-group enhanced hide mustLogin">							<label class="form-group-label">登录后预约</label>							<div class="form-group-static">								<label class="checkbox-inline"><input class="dynaCheckbox" type="checkbox" name="mustLogin"></label>							</div>						</div>						<div class="form-group enhanced required">							<label class="form-group-label">预约描述</label>							<div class="form-group-control">								<textarea name="content" class="form-control html-editor" placeholder="预约描述"></textarea>							</div>						</div>					</div>					<!--<div class="form-group form-actions">							<button type="reset" class="btn btn-cancel" data-action="reset">								<i class="icon-remove bigger-110"></i>取消							</button>							<button class="btn btn-primary" data-loading-text="保存中...">								<i class="icon-ok bigger-110"></i>保存							</button>					</div>-->				</form>			</div>		</div>'},f=function(){return"<div/>"}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.cms.CmsLayout=r.common.BaseView.extend({doInitialize:function(){this.$el=this.$el.html(i()),this._appSettings=new r.modules.AppSettings({el:this.$el.find("[data-type=mainHome]")})},onShow:function(){}});var i=function(){return'<div class="page-content">						<div data-type="mainHome"></div>				    </div>				</div>'}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.cms.SectionLayout=r.common.BaseView.extend({doInitialize:function(){this.$el=this.$el.html(i()),this._sectionSettings=new r.modules.cms.SectionSettings({el:this.$el.find("[data-type=mainHome]")})},onShow:function(){}});var i=function(){return'<div class="page-content">						<div data-type="mainHome"></div>				    </div>				</div>'}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.cms.LocationPicker=r.common.BaseView.extend({doInitialize:function(t){this.$container=e(t.container),this.$container.html(i());var n=this,r=setInterval(function(){BMap&&new BMap.Map&&(n._map=new BMap.Map("baiduMap",{enableMapClick:!1}),n._Initialize(t),clearInterval(r),console.log("1"))},100)},_Initialize:function(t){var n=new BMap.Geocoder,r=this;this._ac=new BMap.Autocomplete({input:"branchAddress",location:this._map}),this._ac.addEventListener("onhighlight",function(e){r._ac.setInputValue(e.toitem.value.business)}),this._ac.addEventListener("onconfirm",function(e){r._coordinate(e.item.value.business)});var i=function(){r._coordinate(r.$container.find("#branchAddress").val())};e("#branchAddress").keyup(function(e){e.keyCode==13&&i()}),this.$container.find(".btn[data-action=coordinate]").click(i),this._item=t.item,this._editor=t.editor;var s;if(this._item.id!="new"){var o=this._item.attributes.coordinate.split(",");s=new BMap.Point(o[0],o[1])}else s=new BMap.Point(116.404161,39.92153);this._map.centerAndZoom(s,12),this._map.enableScrollWheelZoom(),this._map.addControl(new BMap.NavigationControl),this._map.addEventListener("click",function(e){r._item.attributes.coordinate=r._getCoordinateString(e.point),r._editor.$form.find("input[name=coordinate]").val(r._item.attributes.coordinate),r._map.clearOverlays(),r._map.addOverlay(new BMap.Marker(e.point)),n.getLocation(e.point,function(e){if(!e)return;r._ac.setInputValue(e.address),r._editor.$form.find("textarea[name=summary]").val(e.address),r._editor._preview(!0,!1),r.$container.find("#branchAddress").closest("div.input-group").siblings("div.validation-error").remove(),r.$container.find("#branchAddress").closest("div.form-group").removeClass("has-error")})}),this._item.id!="new"&&this._ac.setInputValue(this._item.attributes.address);if(this._item.attributes.coordinate){var u=new BMap.Marker(s);this._map.addOverlay(u)}},_coordinate:function(e){this._ac.setInputValue(e),this._map.clearOverlays();var t=new BMap.LocalSearch(this._map,{renderOptions:{map:this._map}}),n=this;t.setMarkersSetCallback(function(e){if(e.length==0)return n.$container.find("#branchAddress").closest("div.input-group").siblings("div.validation-error").remove().end().after("<div class='validation-error'>定位失败，请重新输入详细地址或直接点击地图选择地点！</div>"),n.$container.find("#branchAddress").closest("div.form-group").addClass("has-error"),!1;for(var t=0;t<e.length;t++)t==0&&(n._item.attributes.coordinate=n._getCoordinateString(e[0].point)),e[t].marker.addEventListener("click",function(e){n._item.attributes.coordinate=n._getCoordinateString(e.target.getPosition(0))})}),t.search(e)},_getCoordinateString:function(e){return e.lng+","+e.lat}});var i=function(){return'<div class="form-group enhanced">					<label class="form-group-label">详细地址</label>					<div class="form-group-control">						<div class="input-group">							<input id="branchAddress" type="text" name="branchAddress" class="form-control" placeholder="详细地址（若详细地址无法定位,请点击地图定位）"/>							<span class="input-group-btn">								<button class="btn btn-sm btn-default" type="button" data-action="coordinate">									<i class="icon-map-marker bigger-110"></i>									定位								</button>							</span>						</div>					</div>				</div>				<div id="baiduMap" class="baiduMap"></div>				<div class="clearfix"></div>'}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");window.CKEDITOR_BASEPATH="/assets/lib/ckeditor/",r.modules.cms||(r.modules.cms={}),r.modules.cms.editor||(r.modules.cms.editor={})}(),function(){if(window.CKEDITOR&&window.CKEDITOR.dom)return;window.CKEDITOR||(window.CKEDITOR=function(){var e=/(^|.*[\\\/])ckeditor\.js(?:\?.*|;.*)?$/i,t={timestamp:"E7KD",version:"4.4.4",revision:"1ba5105",rnd:Math.floor(900*Math.random())+100,_:{pending:[],basePathSrcPattern:e},status:"unloaded",basePath:function(){var t=window.CKEDITOR_BASEPATH||"";if(!t)for(var n=document.getElementsByTagName("script"),r=0;r<n.length;r++){var i=n[r].src.match(e);if(i){t=i[1];break}}-1==t.indexOf(":/")&&"//"!=t.slice(0,2)&&(t=0===t.indexOf("/")?location.href.match(/^.*?:\/\/[^\/]*/)[0]+t:location.href.match(/^[^\?]*\/(?:)/)[0]+t);if(!t)throw'The CKEditor installation path could not be automatically detected. Please set the global variable "CKEDITOR_BASEPATH" before creating editor instances.';return t}(),getUrl:function(e){return-1==e.indexOf(":/")&&0!==e.indexOf("/")&&(e=this.basePath+e),this.timestamp&&"/"!=e.charAt(e.length-1)&&!/[&?]t=/.test(e)&&(e+=(0<=e.indexOf("?")?"&":"?")+"t="+this.timestamp),e},domReady:function(){function e(){try{document.addEventListener?(document.removeEventListener("DOMContentLoaded",e,!1),t()):document.attachEvent&&"complete"===document.readyState&&(document.detachEvent("onreadystatechange",e),t())}catch(n){}}function t(){for(var e;e=n.shift();)e()}var n=[];return function(t){n.push(t),"complete"===document.readyState&&setTimeout(e,1);if(1==n.length)if(document.addEventListener)document.addEventListener("DOMContentLoaded",e,!1),window.addEventListener("load",e,!1);else if(document.attachEvent){document.attachEvent("onreadystatechange",e),window.attachEvent("onload",e),t=!1;try{t=!window.frameElement}catch(r){}if(document.documentElement.doScroll&&t){var i=function(){try{document.documentElement.doScroll("left")}catch(t){setTimeout(i,1);return}e()};i()}}}}()},n=window.CKEDITOR_GETURL;if(n){var r=t.getUrl;t.getUrl=function(e){return n.call(t,e)||r.call(t,e)}}return t}()),CKEDITOR.event||(CKEDITOR.event=function(){},CKEDITOR.event.implementOn=function(e){var t=CKEDITOR.event.prototype,n;for(n in t)e[n]==void 0&&(e[n]=t[n])},CKEDITOR.event.prototype=function(){function e(e){var r=t(this);return r[e]||(r[e]=new n(e))}var t=function(e){return e=e.getPrivate&&e.getPrivate()||e._||(e._={}),e.events||(e.events={})},n=function(e){this.name=e,this.listeners=[]};return n.prototype={getListenerIndex:function(e){for(var t=0,n=this.listeners;t<n.length;t++)if(n[t].fn==e)return t;return-1}},{define:function(t,n){var r=e.call(this,t);CKEDITOR.tools.extend(r,n,!0)},on:function(t,n,r,i,s){function o(e,s,o,a){return e={name:t,sender:this,editor:e,data:s,listenerData:i,stop:o,cancel:a,removeListener:u},n.call(r,e)===!1?!1:e.data}function u(){l.removeListener(t,n)}var f=e.call(this,t);if(f.getListenerIndex(n)<0){f=f.listeners,r||(r=this),isNaN(s)&&(s=10);var l=this;o.fn=n,o.priority=s;for(var c=f.length-1;c>=0;c--)if(f[c].priority<=s)return f.splice(c+1,0,o),{removeListener:u};f.unshift(o)}return{removeListener:u}},once:function(){var e=arguments[1];return arguments[1]=function(t){return t.removeListener(),e.apply(this,arguments)},this.on.apply(this,arguments)},capture:function(){CKEDITOR.event.useCapture=1;var e=this.on.apply(this,arguments);return CKEDITOR.event.useCapture=0,e},fire:function(){var e=0,n=function(){e=1},r=0,i=function(){r=1};return function(s,o,u){var l=t(this)[s],s=e,c=r;e=r=0;if(l){var h=l.listeners;if(h.length)for(var h=h.slice(0),p,v=0;v<h.length;v++){if(l.errorProof)try{p=h[v].call(this,u,o,n,i)}catch(m){}else p=h[v].call(this,u,o,n,i);p===!1?r=1:typeof p!="undefined"&&(o=p);if(e||r)break}}return o=r?!1:typeof o=="undefined"?!0:o,e=s,r=c,o}}(),fireOnce:function(e,n,r){return n=this.fire(e,n,r),delete t(this)[e],n},removeListener:function(e,n){var r=t(this)[e];if(r){var i=r.getListenerIndex(n);i>=0&&r.listeners.splice(i,1)}},removeAllListeners:function(){var e=t(this),n;for(n in e)delete e[n]},hasListeners:function(e){return(e=t(this)[e])&&e.listeners.length>0}}}()),CKEDITOR.editor||(CKEDITOR.editor=function(){CKEDITOR._.pending.push([this,arguments]),CKEDITOR.event.call(this)},CKEDITOR.editor.prototype.fire=function(e,t){return e in{instanceReady:1,loaded:1}&&(this[e]=!0),CKEDITOR.event.prototype.fire.call(this,e,t,this)},CKEDITOR.editor.prototype.fireOnce=function(e,t){return e in{instanceReady:1,loaded:1}&&(this[e]=!0),CKEDITOR.event.prototype.fireOnce.call(this,e,t,this)},CKEDITOR.event.implementOn(CKEDITOR.editor.prototype)),CKEDITOR.env||(CKEDITOR.env=function(){var e=navigator.userAgent.toLowerCase(),t={ie:e.indexOf("trident/")>-1,webkit:e.indexOf(" applewebkit/")>-1,air:e.indexOf(" adobeair/")>-1,mac:e.indexOf("macintosh")>-1,quirks:document.compatMode=="BackCompat"&&(!document.documentMode||document.documentMode<10),mobile:e.indexOf("mobile")>-1,iOS:/(ipad|iphone|ipod)/.test(e),isCustomDomain:function(){if(!this.ie)return!1;var e=document.domain,t=window.location.hostname;return e!=t&&e!="["+t+"]"},secure:location.protocol=="https:"};t.gecko=navigator.product=="Gecko"&&!t.webkit&&!t.ie,t.webkit&&(e.indexOf("chrome")>-1?t.chrome=!0:t.safari=!0);var n=0;t.ie&&(n=t.quirks||!document.documentMode?parseFloat(e.match(/msie (\d+)/)[1]):document.documentMode,t.ie9Compat=n==9,t.ie8Compat=n==8,t.ie7Compat=n==7,t.ie6Compat=n<7||t.quirks);if(t.gecko){var r=e.match(/rv:([\d\.]+)/);r&&(r=r[1].split("."),n=r[0]*1e4+(r[1]||0)*100+(r[2]||0)*1)}return t.air&&(n=parseFloat(e.match(/ adobeair\/(\d+)/)[1])),t.webkit&&(n=parseFloat(e.match(/ applewebkit\/(\d+)/)[1])),t.version=n,t.isCompatible=t.iOS&&n>=534||!t.mobile&&(t.ie&&n>6||t.gecko&&n>=2e4||t.air&&n>=1||t.webkit&&n>=522||!1),t.hidpi=window.devicePixelRatio>=2,t.needsBrFiller=t.gecko||t.webkit||t.ie&&n>10,t.needsNbspFiller=t.ie&&n<11,t.cssClass="cke_browser_"+(t.ie?"ie":t.gecko?"gecko":t.webkit?"webkit":"unknown"),t.quirks&&(t.cssClass=t.cssClass+" cke_browser_quirks"),t.ie&&(t.cssClass=t.cssClass+(" cke_browser_ie"+(t.quirks?"6 cke_browser_iequirks":t.version))),t.air&&(t.cssClass=t.cssClass+" cke_browser_air"),t.iOS&&(t.cssClass=t.cssClass+" cke_browser_ios"),t.hidpi&&(t.cssClass=t.cssClass+" cke_hidpi"),t}()),"unloaded"==CKEDITOR.status&&function(){CKEDITOR.event.implementOn(CKEDITOR),CKEDITOR.loadFullCore=function(){if(CKEDITOR.status!="basic_ready")CKEDITOR.loadFullCore._load=1;else{delete CKEDITOR.loadFullCore;var e=document.createElement("script");e.type="text/javascript",e.src=CKEDITOR.basePath+"ckeditor.js",document.getElementsByTagName("head")[0].appendChild(e)}},CKEDITOR.loadFullCoreTimeout=0,CKEDITOR.add=function(e){(this._.pending||(this._.pending=[])).push(e)},function(){CKEDITOR.domReady(function(){var e=CKEDITOR.loadFullCore,t=CKEDITOR.loadFullCoreTimeout;e&&(CKEDITOR.status="basic_ready",e&&e._load?e():t&&setTimeout(function(){CKEDITOR.loadFullCore&&CKEDITOR.loadFullCore()},t*1e3))})}(),CKEDITOR.status="basic_loaded"}(),CKEDITOR.dom={},function(){var e=[],t=CKEDITOR.env.gecko?"-moz-":CKEDITOR.env.webkit?"-webkit-":CKEDITOR.env.ie?"-ms-":"",n=/&/g,r=/>/g,i=/</g,s=/"/g,o=/&amp;/g,u=/&gt;/g,a=/&lt;/g,f=/&quot;/g;CKEDITOR.on("reset",function(){e=[]}),CKEDITOR.tools={arrayCompare:function(e,t){if(!e&&!t)return!0;if(!e||!t||e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!=t[n])return!1;return!0},clone:function(e){var t;if(e&&e instanceof Array){t=[];for(var n=0;n<e.length;n++)t[n]=CKEDITOR.tools.clone(e[n]);return t}if(e===null||typeof e!="object"||e instanceof String||e instanceof Number||e instanceof Boolean||e instanceof Date||e instanceof RegExp||e.nodeType||e.window===e)return e;t=new e.constructor;for(n in e)t[n]=CKEDITOR.tools.clone(e[n]);return t},capitalize:function(e,t){return e.charAt(0).toUpperCase()+(t?e.slice(1):e.slice(1).toLowerCase())},extend:function(e){var t=arguments.length,n,r;typeof (n=arguments[t-1])=="boolean"?t--:typeof (n=arguments[t-2])=="boolean"&&(r=arguments[t-1],t-=2);for(var i=1;i<t;i++){var s=arguments[i],o;for(o in s)if(n===!0||e[o]==void 0)if(!r||o in r)e[o]=s[o]}return e},prototypedCopy:function(e){var t=function(){};return t.prototype=e,new t},copy:function(e){var t={},n;for(n in e)t[n]=e[n];return t},isArray:function(e){return Object.prototype.toString.call(e)=="[object Array]"},isEmpty:function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},cssVendorPrefix:function(e,n,r){return r?t+e+":"+n+";"+e+":"+n:(r={},r[e]=n,r[t+e]=n,r)},cssStyleToDomStyle:function(){var e=document.createElement("div").style,t=typeof e.cssFloat!="undefined"?"cssFloat":typeof e.styleFloat!="undefined"?"styleFloat":"float";return function(e){return e=="float"?t:e.replace(/-./g,function(e){return e.substr(1).toUpperCase()})}}(),buildStyleHtml:function(e){for(var e=[].concat(e),t,n=[],r=0;r<e.length;r++)if(t=e[r])/@import|[{}]/.test(t)?n.push("<style>"+t+"</style>"):n.push('<link type="text/css" rel=stylesheet href="'+t+'">');return n.join("")},htmlEncode:function(e){return(""+e).replace(n,"&amp;").replace(r,"&gt;").replace(i,"&lt;")},htmlDecode:function(e){return e.replace(o,"&").replace(u,">").replace(a,"<")},htmlEncodeAttr:function(e){return e.replace(s,"&quot;").replace(i,"&lt;").replace(r,"&gt;")},htmlDecodeAttr:function(e){return e.replace(f,'"').replace(a,"<").replace(u,">")},getNextNumber:function(){var e=0;return function(){return++e}}(),getNextId:function(){return"cke_"+this.getNextNumber()},override:function(e,t){var n=t(e);return n.prototype=e.prototype,n},setTimeout:function(e,t,n,r,i){return i||(i=window),n||(n=i),i.setTimeout(function(){r?e.apply(n,[].concat(r)):e.apply(n)},t||0)},trim:function(){var e=/(?:^[ \t\n\r]+)|(?:[ \t\n\r]+$)/g;return function(t){return t.replace(e,"")}}(),ltrim:function(){var e=/^[ \t\n\r]+/g;return function(t){return t.replace(e,"")}}(),rtrim:function(){var e=/[ \t\n\r]+$/g;return function(t){return t.replace(e,"")}}(),indexOf:function(e,t){if(typeof t=="function"){for(var n=0,r=e.length;n<r;n++)if(t(e[n]))return n}else{if(e.indexOf)return e.indexOf(t);n=0;for(r=e.length;n<r;n++)if(e[n]===t)return n}return-1},search:function(e,t){var n=CKEDITOR.tools.indexOf(e,t);return n>=0?e[n]:null},bind:function(e,t){return function(){return e.apply(t,arguments)}},createClass:function(e){var t=e.$,n=e.base,r=e.privates||e._,i=e.proto,e=e.statics;!t&&(t=function(){n&&this.base.apply(this,arguments)});if(r)var s=t,t=function(){var e=this._||(this._={}),t;for(t in r){var n=r[t];e[t]=typeof n=="function"?CKEDITOR.tools.bind(n,this):n}s.apply(this,arguments)};return n&&(t.prototype=this.prototypedCopy(n.prototype),t.prototype.constructor=t,t.base=n,t.baseProto=n.prototype,t.prototype.base=function(){this.base=n.prototype.base,n.apply(this,arguments),this.base=arguments.callee}),i&&this.extend(t.prototype,i,!0),e&&this.extend(t,e,!0),t},addFunction:function(t,n){return e.push(function(){return t.apply(n||this,arguments)})-1},removeFunction:function(t){e[t]=null},callFunction:function(t){var n=e[t];return n&&n.apply(window,Array.prototype.slice.call(arguments,1))},cssLength:function(){var e=/^-?\d+\.?\d*px$/,t;return function(n){return t=CKEDITOR.tools.trim(n+"")+"px",e.test(t)?t:n||""}}(),convertToPx:function(){var e;return function(t){return e||(e=CKEDITOR.dom.element.createFromHtml('<div style="position:absolute;left:-9999px;top:-9999px;margin:0px;padding:0px;border:0px;"></div>',CKEDITOR.document),CKEDITOR.document.getBody().append(e)),/%$/.test(t)?t:(e.setStyle("width",t),e.$.clientWidth)}}(),repeat:function(e,t){return Array(t+1).join(e)},tryThese:function(){for(var e,t=0,n=arguments.length;t<n;t++){var r=arguments[t];try{e=r();break}catch(i){}}return e},genKey:function(){return Array.prototype.slice.call(arguments).join("-")},defer:function(e){return function(){var t=arguments,n=this;window.setTimeout(function(){e.apply(n,t)},0)}},normalizeCssText:function(e,t){var n=[],r,i=CKEDITOR.tools.parseCssText(e,!0,t);for(r in i)n.push(r+":"+i[r]);return n.sort(),n.length?n.join(";")+";":""},convertRgbToHex:function(e){return e.replace(/(?:rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\))/gi,function(e,t,n,r){e=[t,n,r];for(t=0;t<3;t++)e[t]=("0"+parseInt(e[t],10).toString(16)).slice(-2);return"#"+e.join("")})},parseCssText:function(e,t,n){var r={};return n&&(n=new CKEDITOR.dom.element("span"),n.setAttribute("style",e),e=CKEDITOR.tools.convertRgbToHex(n.getAttribute("style")||"")),!e||e==";"?r:(e.replace(/&quot;/g,'"').replace(/\s*([^:;\s]+)\s*:\s*([^;]+)\s*(?=;|$)/g,function(e,n,i){t&&(n=n.toLowerCase(),n=="font-family"&&(i=i.toLowerCase().replace(/["']/g,"").replace(/\s*,\s*/g,",")),i=CKEDITOR.tools.trim(i)),r[n]=i}),r)},writeCssText:function(e,t){var n,r=[];for(n in e)r.push(n+":"+e[n]);return t&&r.sort(),r.join("; ")},objectCompare:function(e,t,n){var r;if(!e&&!t)return!0;if(!e||!t)return!1;for(r in e)if(e[r]!=t[r])return!1;if(!n)for(r in t)if(e[r]!=t[r])return!1;return!0},objectKeys:function(e){var t=[],n;for(n in e)t.push(n);return t},convertArrayToObject:function(e,t){var n={};arguments.length==1&&(t=!0);for(var r=0,i=e.length;r<i;++r)n[e[r]]=t;return n},fixDomain:function(){for(var e;;)try{e=window.parent.document.domain;break}catch(t){e=e?e.replace(/.+?(?:\.|$)/,""):document.domain;if(!e)break;document.domain=e}return!!e},eventsBuffer:function(e,t){function n(){i=(new Date).getTime(),r=!1,t()}var r,i=0;return{input:function(){if(!r){var t=(new Date).getTime()-i;t<e?r=setTimeout(n,e-t):n()}},reset:function(){r&&clearTimeout(r),r=i=0}}},enableHtml5Elements:function(e,t){for(var n=["abbr","article","aside","audio","bdi","canvas","data","datalist","details","figcaption","figure","footer","header","hgroup","mark","meter","nav","output","progress","section","summary","time","video"],r=n.length,i;r--;)i=e.createElement(n[r]),t&&e.appendChild(i)},checkIfAnyArrayItemMatches:function(e,t){for(var n=0,r=e.length;n<r;++n)if(e[n].match(t))return!0;return!1},checkIfAnyObjectPropertyMatches:function(e,t){for(var n in e)if(n.match(t))return!0;return!1},transparentImageData:"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="}}(),CKEDITOR.dtd=function(){var e=CKEDITOR.tools.extend,t=function(e,t){for(var n=CKEDITOR.tools.clone(e),r=1;r<arguments.length;r++){var t=arguments[r],i;for(i in t)delete n[i]}return n},n={},r={},i={address:1,article:1,aside:1,blockquote:1,details:1,div:1,dl:1,fieldset:1,figure:1,footer:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,header:1,hgroup:1,hr:1,menu:1,nav:1,ol:1,p:1,pre:1,section:1,table:1,ul:1},s={command:1,link:1,meta:1,noscript:1,script:1,style:1},o={},u={"#":1},a={center:1,dir:1,noframes:1};return e(n,{a:1,abbr:1,area:1,audio:1,b:1,bdi:1,bdo:1,br:1,button:1,canvas:1,cite:1,code:1,command:1,datalist:1,del:1,dfn:1,em:1,embed:1,i:1,iframe:1,img:1,input:1,ins:1,kbd:1,keygen:1,label:1,map:1,mark:1,meter:1,noscript:1,object:1,output:1,progress:1,q:1,ruby:1,s:1,samp:1,script:1,select:1,small:1,span:1,strong:1,sub:1,sup:1,textarea:1,time:1,u:1,"var":1,video:1,wbr:1},u,{acronym:1,applet:1,basefont:1,big:1,font:1,isindex:1,strike:1,style:1,tt:1}),e(r,i,n,a),t={a:t(n,{a:1,button:1}),abbr:n,address:r,area:o,article:e({style:1},r),aside:e({style:1},r),audio:e({source:1,track:1},r),b:n,base:o,bdi:n,bdo:n,blockquote:r,body:r,br:o,button:t(n,{a:1,button:1}),canvas:n,caption:r,cite:n,code:n,col:o,colgroup:{col:1},command:o,datalist:e({option:1},n),dd:r,del:n,details:e({summary:1},r),dfn:n,div:e({style:1},r),dl:{dt:1,dd:1},dt:r,em:n,embed:o,fieldset:e({legend:1},r),figcaption:r,figure:e({figcaption:1},r),footer:r,form:r,h1:n,h2:n,h3:n,h4:n,h5:n,h6:n,head:e({title:1,base:1},s),header:r,hgroup:{h1:1,h2:1,h3:1,h4:1,h5:1,h6:1},hr:o,html:e({head:1,body:1},r,s),i:n,iframe:u,img:o,input:o,ins:n,kbd:n,keygen:o,label:n,legend:n,li:r,link:o,map:r,mark:n,menu:e({li:1},r),meta:o,meter:t(n,{meter:1}),nav:r,noscript:e({link:1,meta:1,style:1},n),object:e({param:1},n),ol:{li:1},optgroup:{option:1},option:u,output:n,p:n,param:o,pre:n,progress:t(n,{progress:1}),q:n,rp:n,rt:n,ruby:e({rp:1,rt:1},n),s:n,samp:n,script:u,section:e({style:1},r),select:{optgroup:1,option:1},small:n,source:o,span:n,strong:n,style:u,sub:n,summary:n,sup:n,table:{caption:1,colgroup:1,thead:1,tfoot:1,tbody:1,tr:1},tbody:{tr:1},td:r,textarea:u,tfoot:{tr:1},th:r,thead:{tr:1},time:t(n,{time:1}),title:u,tr:{th:1,td:1},track:o,u:n,ul:{li:1},"var":n,video:e({source:1,track:1},r),wbr:o,acronym:n,applet:e({param:1},r),basefont:o,big:n,center:r,dialog:o,dir:{li:1},font:n,isindex:o,noframes:r,strike:n,tt:n},e(t,{$block:e({audio:1,dd:1,dt:1,figcaption:1,li:1,video:1},i,a),$blockLimit:{article:1,aside:1,audio:1,body:1,caption:1,details:1,dir:1,div:1,dl:1,fieldset:1,figcaption:1,figure:1,footer:1,form:1,header:1,hgroup:1,menu:1,nav:1,ol:1,section:1,table:1,td:1,th:1,tr:1,ul:1,video:1},$cdata:{script:1,style:1},$editable:{address:1,article:1,aside:1,blockquote:1,body:1,details:1,div:1,fieldset:1,figcaption:1,footer:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,header:1,hgroup:1,nav:1,p:1,pre:1,section:1},$empty:{area:1,base:1,basefont:1,br:1,col:1,command:1,dialog:1,embed:1,hr:1,img:1,input:1,isindex:1,keygen:1,link:1,meta:1,param:1,source:1,track:1,wbr:1},$inline:n,$list:{dl:1,ol:1,ul:1},$listItem:{dd:1,dt:1,li:1},$nonBodyContent:e({body:1,head:1,html:1},t.head),$nonEditable:{applet:1,audio:1,button:1,embed:1,iframe:1,map:1,object:1,option:1,param:1,script:1,textarea:1,video:1},$object:{applet:1,audio:1,button:1,hr:1,iframe:1,img:1,input:1,object:1,select:1,table:1,textarea:1,video:1},$removeEmpty:{abbr:1,acronym:1,b:1,bdi:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,mark:1,meter:1,output:1,q:1,ruby:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,time:1,tt:1,u:1,"var":1},$tabIndex:{a:1,area:1,button:1,input:1,object:1,select:1,textarea:1},$tableContent:{caption:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1},$transparent:{a:1,audio:1,canvas:1,del:1,ins:1,map:1,noscript:1,object:1,video:1},$intermediate:{caption:1,colgroup:1,dd:1,dt:1,figcaption:1,legend:1,li:1,optgroup:1,option:1,rp:1,rt:1,summary:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1}}),t}(),CKEDITOR.dom.event=function(e){this.$=e},CKEDITOR.dom.event.prototype={getKey:function(){return this.$.keyCode||this.$.which},getKeystroke:function(){var e=this.getKey();if(this.$.ctrlKey||this.$.metaKey)e+=CKEDITOR.CTRL;return this.$.shiftKey&&(e+=CKEDITOR.SHIFT),this.$.altKey&&(e+=CKEDITOR.ALT),e},preventDefault:function(e){var t=this.$;t.preventDefault?t.preventDefault():t.returnValue=!1,e&&this.stopPropagation()},stopPropagation:function(){var e=this.$;e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},getTarget:function(){var e=this.$.target||this.$.srcElement;return e?new CKEDITOR.dom.node(e):null},getPhase:function(){return this.$.eventPhase||2},getPageOffset:function(){var e=this.getTarget().getDocument().$;return{x:this.$.pageX||this.$.clientX+(e.documentElement.scrollLeft||e.body.scrollLeft),y:this.$.pageY||this.$.clientY+(e.documentElement.scrollTop||e.body.scrollTop)}}},CKEDITOR.CTRL=1114112,CKEDITOR.SHIFT=2228224,CKEDITOR.ALT=4456448,CKEDITOR.EVENT_PHASE_CAPTURING=1,CKEDITOR.EVENT_PHASE_AT_TARGET=2,CKEDITOR.EVENT_PHASE_BUBBLING=3,CKEDITOR.dom.domObject=function(e){e&&(this.$=e)},CKEDITOR.dom.domObject.prototype=function(){var e=function(e,t){return function(n){typeof CKEDITOR!="undefined"&&e.fire(t,new CKEDITOR.dom.event(n))}};return{getPrivate:function(){var e;return(e=this.getCustomData("_"))||this.setCustomData("_",e={}),e},on:function(t){var n=this.getCustomData("_cke_nativeListeners");return n||(n={},this.setCustomData("_cke_nativeListeners",n)),n[t]||(n=n[t]=e(this,t),this.$.addEventListener?this.$.addEventListener(t,n,!!CKEDITOR.event.useCapture):this.$.attachEvent&&this.$.attachEvent("on"+t,n)),CKEDITOR.event.prototype.on.apply(this,arguments)},removeListener:function(e){CKEDITOR.event.prototype.removeListener.apply(this,arguments);if(!this.hasListeners(e)){var t=this.getCustomData("_cke_nativeListeners"),n=t&&t[e];n&&(this.$.removeEventListener?this.$.removeEventListener(e,n,!1):this.$.detachEvent&&this.$.detachEvent("on"+e,n),delete t[e])}},removeAllListeners:function(){var e=this.getCustomData("_cke_nativeListeners"),t;for(t in e){var n=e[t];this.$.detachEvent?this.$.detachEvent("on"+t,n):this.$.removeEventListener&&this.$.removeEventListener(t,n,!1),delete e[t]}CKEDITOR.event.prototype.removeAllListeners.call(this)}}}(),function(e){var t={};CKEDITOR.on("reset",function(){t={}}),e.equals=function(e){try{return e&&e.$===this.$}catch(t){return!1}},e.setCustomData=function(e,n){var r=this.getUniqueId();return(t[r]||(t[r]={}))[e]=n,this},e.getCustomData=function(e){var n=this.$["data-cke-expando"];return(n=n&&t[n])&&e in n?n[e]:null},e.removeCustomData=function(e){var n=this.$["data-cke-expando"],n=n&&t[n],r,i;return n&&(r=n[e],i=e in n,delete n[e]),i?r:null},e.clearCustomData=function(){this.removeAllListeners();var e=this.$["data-cke-expando"];e&&delete t[e]},e.getUniqueId=function(){return this.$["data-cke-expando"]||(this.$["data-cke-expando"]=CKEDITOR.tools.getNextNumber())},CKEDITOR.event.implementOn(e)}(CKEDITOR.dom.domObject.prototype),CKEDITOR.dom.node=function(e){return e?new CKEDITOR.dom[e.nodeType==CKEDITOR.NODE_DOCUMENT?"document":e.nodeType==CKEDITOR.NODE_ELEMENT?"element":e.nodeType==CKEDITOR.NODE_TEXT?"text":e.nodeType==CKEDITOR.NODE_COMMENT?"comment":e.nodeType==CKEDITOR.NODE_DOCUMENT_FRAGMENT?"documentFragment":"domObject"](e):this},CKEDITOR.dom.node.prototype=new CKEDITOR.dom.domObject,CKEDITOR.NODE_ELEMENT=1,CKEDITOR.NODE_DOCUMENT=9,CKEDITOR.NODE_TEXT=3,CKEDITOR.NODE_COMMENT=8,CKEDITOR.NODE_DOCUMENT_FRAGMENT=11,CKEDITOR.POSITION_IDENTICAL=0,CKEDITOR.POSITION_DISCONNECTED=1,CKEDITOR.POSITION_FOLLOWING=2,CKEDITOR.POSITION_PRECEDING=4,CKEDITOR.POSITION_IS_CONTAINED=8,CKEDITOR.POSITION_CONTAINS=16,CKEDITOR.tools.extend(CKEDITOR.dom.node.prototype,{appendTo:function(e,t){return e.append(this,t),e},clone:function(e,t){var n=this.$.cloneNode(e),r=function(n){n["data-cke-expando"]&&(n["data-cke-expando"]=!1);if(n.nodeType==CKEDITOR.NODE_ELEMENT){t||n.removeAttribute("id",!1);if(e)for(var n=n.childNodes,i=0;i<n.length;i++)r(n[i])}};return r(n),new CKEDITOR.dom.node(n)},hasPrevious:function(){return!!this.$.previousSibling},hasNext:function(){return!!this.$.nextSibling},insertAfter:function(e){return e.$.parentNode.insertBefore(this.$,e.$.nextSibling),e},insertBefore:function(e){return e.$.parentNode.insertBefore(this.$,e.$),e},insertBeforeMe:function(e){return this.$.parentNode.insertBefore(e.$,this.$),e},getAddress:function(e){for(var t=[],n=this.getDocument().$.documentElement,r=this.$;r&&r!=n;){var i=r.parentNode;i&&t.unshift(this.getIndex.call({$:r},e)),r=i}return t},getDocument:function(){return new CKEDITOR.dom.document(this.$.ownerDocument||this.$.parentNode.ownerDocument)},getIndex:function(e){var t=this.$,n=-1,r;if(!this.$.parentNode)return n;do if(!e||t==this.$||t.nodeType!=CKEDITOR.NODE_TEXT||!r&&!!t.nodeValue)n++,r=t.nodeType==CKEDITOR.NODE_TEXT;while(t=t.previousSibling);return n},getNextSourceNode:function(e,t,n){if(n&&!n.call)var r=n,n=function(e){return!e.equals(r)};var e=!e&&this.getFirst&&this.getFirst(),i;if(!e){if(this.type==CKEDITOR.NODE_ELEMENT&&n&&n(this,!0)===!1)return null;e=this.getNext()}for(;!e&&(i=(i||this).getParent());){if(n&&n(i,!0)===!1)return null;e=i.getNext()}return!e||n&&n(e)===!1?null:t&&t!=e.type?e.getNextSourceNode(!1,t,n):e},getPreviousSourceNode:function(e,t,n){if(n&&!n.call)var r=n,n=function(e){return!e.equals(r)};var e=!e&&this.getLast&&this.getLast(),i;if(!e){if(this.type==CKEDITOR.NODE_ELEMENT&&n&&n(this,!0)===!1)return null;e=this.getPrevious()}for(;!e&&(i=(i||this).getParent());){if(n&&n(i,!0)===!1)return null;e=i.getPrevious()}return!e||n&&n(e)===!1?null:t&&e.type!=t?e.getPreviousSourceNode(!1,t,n):e},getPrevious:function(e){var t=this.$,n;do n=(t=t.previousSibling)&&t.nodeType!=10&&new CKEDITOR.dom.node(t);while(n&&e&&!e(n));return n},getNext:function(e){var t=this.$,n;do n=(t=t.nextSibling)&&new CKEDITOR.dom.node(t);while(n&&e&&!e(n));return n},getParent:function(e){var t=this.$.parentNode;return t&&(t.nodeType==CKEDITOR.NODE_ELEMENT||e&&t.nodeType==CKEDITOR.NODE_DOCUMENT_FRAGMENT)?new CKEDITOR.dom.node(t):null},getParents:function(e){var t=this,n=[];do n[e?"push":"unshift"](t);while(t=t.getParent());return n},getCommonAncestor:function(e){if(e.equals(this))return this;if(e.contains&&e.contains(this))return e;var t=this.contains?this:this.getParent();do if(t.contains(e))return t;while(t=t.getParent());return null},getPosition:function(e){var t=this.$,n=e.$;if(t.compareDocumentPosition)return t.compareDocumentPosition(n);if(t==n)return CKEDITOR.POSITION_IDENTICAL;if(this.type==CKEDITOR.NODE_ELEMENT&&e.type==CKEDITOR.NODE_ELEMENT){if(t.contains){if(t.contains(n))return CKEDITOR.POSITION_CONTAINS+CKEDITOR.POSITION_PRECEDING;if(n.contains(t))return CKEDITOR.POSITION_IS_CONTAINED+CKEDITOR.POSITION_FOLLOWING}if("sourceIndex"in t)return t.sourceIndex<0||n.sourceIndex<0?CKEDITOR.POSITION_DISCONNECTED:t.sourceIndex<n.sourceIndex?CKEDITOR.POSITION_PRECEDING:CKEDITOR.POSITION_FOLLOWING}for(var t=this.getAddress(),e=e.getAddress(),n=Math.min(t.length,e.length),r=0;r<=n-1;r++)if(t[r]!=e[r]){if(r<n)return t[r]<e[r]?CKEDITOR.POSITION_PRECEDING:CKEDITOR.POSITION_FOLLOWING;break}return t.length<e.length?CKEDITOR.POSITION_CONTAINS+CKEDITOR.POSITION_PRECEDING:CKEDITOR.POSITION_IS_CONTAINED+CKEDITOR.POSITION_FOLLOWING},getAscendant:function(e,t){var n=this.$,r;t||(n=n.parentNode);for(;n;){if(n.nodeName&&(r=n.nodeName.toLowerCase(),typeof e=="string"?r==e:r in e))return new CKEDITOR.dom.node(n);try{n=n.parentNode}catch(i){n=null}}return null},hasAscendant:function(e,t){var n=this.$;t||(n=n.parentNode);for(;n;){if(n.nodeName&&n.nodeName.toLowerCase()==e)return!0;n=n.parentNode}return!1},move:function(e,t){e.append(this.remove(),t)},remove:function(e){var t=this.$,n=t.parentNode;if(n){if(e)for(;e=t.firstChild;)n.insertBefore(t.removeChild(e),t);n.removeChild(t)}return this},replace:function(e){this.insertBefore(e),e.remove()},trim:function(){this.ltrim(),this.rtrim()},ltrim:function(){for(var e;this.getFirst&&(e=this.getFirst());){if(e.type==CKEDITOR.NODE_TEXT){var t=CKEDITOR.tools.ltrim(e.getText()),n=e.getLength();if(!t){e.remove();continue}t.length<n&&(e.split(n-t.length),this.$.removeChild(this.$.firstChild))}break}},rtrim:function(){for(var e;this.getLast&&(e=this.getLast());){if(e.type==CKEDITOR.NODE_TEXT){var t=CKEDITOR.tools.rtrim(e.getText()),n=e.getLength();if(!t){e.remove();continue}t.length<n&&(e.split(t.length),this.$.lastChild.parentNode.removeChild(this.$.lastChild))}break}CKEDITOR.env.needsBrFiller&&(e=this.$.lastChild)&&e.type==1&&e.nodeName.toLowerCase()=="br"&&e.parentNode.removeChild(e)},isReadOnly:function(){var e=this;this.type!=CKEDITOR.NODE_ELEMENT&&(e=this.getParent());if(e&&typeof e.$.isContentEditable!="undefined")return!e.$.isContentEditable&&!e.data("cke-editable");for(;e;){if(e.data("cke-editable"))break;if(e.getAttribute("contentEditable")=="false")return!0;if(e.getAttribute("contentEditable")=="true")break;e=e.getParent()}return!e}}),CKEDITOR.dom.window=function(e){CKEDITOR.dom.domObject.call(this,e)},CKEDITOR.dom.window.prototype=new CKEDITOR.dom.domObject,CKEDITOR.tools.extend(CKEDITOR.dom.window.prototype,{focus:function(){this.$.focus()},getViewPaneSize:function(){var e=this.$.document,t=e.compatMode=="CSS1Compat";return{width:(t?e.documentElement.clientWidth:e.body.clientWidth)||0,height:(t?e.documentElement.clientHeight:e.body.clientHeight)||0}},getScrollPosition:function(){var e=this.$;return"pageXOffset"in e?{x:e.pageXOffset||0,y:e.pageYOffset||0}:(e=e.document,{x:e.documentElement.scrollLeft||e.body.scrollLeft||0,y:e.documentElement.scrollTop||e.body.scrollTop||0})},getFrame:function(){var e=this.$.frameElement;return e?new CKEDITOR.dom.element.get(e):null}}),CKEDITOR.dom.document=function(e){CKEDITOR.dom.domObject.call(this,e)},CKEDITOR.dom.document.prototype=new CKEDITOR.dom.domObject,CKEDITOR.tools.extend(CKEDITOR.dom.document.prototype,{type:CKEDITOR.NODE_DOCUMENT,appendStyleSheet:function(e){if(this.$.createStyleSheet)this.$.createStyleSheet(e);else{var t=new CKEDITOR.dom.element("link");t.setAttributes({rel:"stylesheet",type:"text/css",href:e}),this.getHead().append(t)}},appendStyleText:function(e){if(this.$.createStyleSheet){var t=this.$.createStyleSheet("");t.cssText=e}else{var n=new CKEDITOR.dom.element("style",this);n.append(new CKEDITOR.dom.text(e,this)),this.getHead().append(n)}return t||n.$.sheet},createElement:function(e,t){var n=new CKEDITOR.dom.element(e,this);return t&&(t.attributes&&n.setAttributes(t.attributes),t.styles&&n.setStyles(t.styles)),n},createText:function(e){return new CKEDITOR.dom.text(e,this)},focus:function(){this.getWindow().focus()},getActive:function(){var e;try{e=this.$.activeElement}catch(t){return null}return new CKEDITOR.dom.element(e)},getById:function(e){return(e=this.$.getElementById(e))?new CKEDITOR.dom.element(e):null},getByAddress:function(e,t){for(var n=this.$.documentElement,r=0;n&&r<e.length;r++){var i=e[r];if(t)for(var s=-1,o=0;o<n.childNodes.length;o++){var u=n.childNodes[o];if(t!==!0||u.nodeType!=3||!u.previousSibling||u.previousSibling.nodeType!=3){s++;if(s==i){n=u;break}}}else n=n.childNodes[i]}return n?new CKEDITOR.dom.node(n):null},getElementsByTag:function(e,t){return(!CKEDITOR.env.ie||document.documentMode>8)&&t&&(e=t+":"+e),new CKEDITOR.dom.nodeList(this.$.getElementsByTagName(e))},getHead:function(){var e=this.$.getElementsByTagName("head")[0];return e=e?new CKEDITOR.dom.element(e):this.getDocumentElement().append(new CKEDITOR.dom.element("head"),!0)},getBody:function(){return new CKEDITOR.dom.element(this.$.body)},getDocumentElement:function(){return new CKEDITOR.dom.element(this.$.documentElement)},getWindow:function(){return new CKEDITOR.dom.window(this.$.parentWindow||this.$.defaultView)},write:function(e){this.$.open("text/html","replace"),CKEDITOR.env.ie&&(e=e.replace(/(?:^\s*<!DOCTYPE[^>]*?>)|^/i,'$&\n<script data-cke-temp="1">('+CKEDITOR.tools.fixDomain+")();</script>")),this.$.write(e),this.$.close()},find:function(e){return new CKEDITOR.dom.nodeList(this.$.querySelectorAll(e))},findOne:function(e){return(e=this.$.querySelector(e))?new CKEDITOR.dom.element(e):null},_getHtml5ShivFrag:function(){var e=this.getCustomData("html5ShivFrag");return e||(e=this.$.createDocumentFragment(),CKEDITOR.tools.enableHtml5Elements(e,!0),this.setCustomData("html5ShivFrag",e)),e}}),CKEDITOR.dom.nodeList=function(e){this.$=e},CKEDITOR.dom.nodeList.prototype={count:function(){return this.$.length},getItem:function(e){return e<0||e>=this.$.length?null:(e=this.$[e])?new CKEDITOR.dom.node(e):null}},CKEDITOR.dom.element=function(e,t){typeof e=="string"&&(e=(t?t.$:document).createElement(e)),CKEDITOR.dom.domObject.call(this,e)},CKEDITOR.dom.element.get=function(e){return(e=typeof e=="string"?document.getElementById(e)||document.getElementsByName(e)[0]:e)&&(e.$?e:new CKEDITOR.dom.element(e))},CKEDITOR.dom.element.prototype=new CKEDITOR.dom.node,CKEDITOR.dom.element.createFromHtml=function(e,t){var n=new CKEDITOR.dom.element("div",t);return n.setHtml(e),n.getFirst().remove()},CKEDITOR.dom.element.setMarker=function(e,t,n,r){var i=t.getCustomData("list_marker_id")||t.setCustomData("list_marker_id",CKEDITOR.tools.getNextNumber()).getCustomData("list_marker_id"),s=t.getCustomData("list_marker_names")||t.setCustomData("list_marker_names",{}).getCustomData("list_marker_names");return e[i]=t,s[n]=1,t.setCustomData(n,r)},CKEDITOR.dom.element.clearAllMarkers=function(e){for(var t in e)CKEDITOR.dom.element.clearMarkers(e,e[t],1)},CKEDITOR.dom.element.clearMarkers=function(e,t,n){var r=t.getCustomData("list_marker_names"),i=t.getCustomData("list_marker_id"),s;for(s in r)t.removeCustomData(s);t.removeCustomData("list_marker_names"),n&&(t.removeCustomData("list_marker_id"),delete e[i])},function(){function e(e){var t=!0;return e.$.id||(e.$.id="cke_tmp_"+CKEDITOR.tools.getNextNumber(),t=!1),function(){t||e.removeAttribute("id")}}function t(e,t){return"#"+e.$.id+" "+t.split(/,\s*/).join(", #"+e.$.id+" ")}function n(e){for(var t=0,n=0,i=r[e].length;n<i;n++)t+=parseInt(this.getComputedStyle(r[e][n])||0,10)||0;return t}CKEDITOR.tools.extend(CKEDITOR.dom.element.prototype,{type:CKEDITOR.NODE_ELEMENT,addClass:function(e){var t=this.$.className;return t&&(RegExp("(?:^|\\s)"+e+"(?:\\s|$)","").test(t)||(t+=" "+e)),this.$.className=t||e,this},removeClass:function(e){var t=this.getAttribute("class");return t&&(e=RegExp("(?:^|\\s+)"+e+"(?=\\s|$)","i"),e.test(t)&&((t=t.replace(e,"").replace(/^\s+/,""))?this.setAttribute("class",t):this.removeAttribute("class"))),this},hasClass:function(e){return RegExp("(?:^|\\s+)"+e+"(?=\\s|$)","").test(this.getAttribute("class"))},append:function(e,t){return typeof e=="string"&&(e=this.getDocument().createElement(e)),t?this.$.insertBefore(e.$,this.$.firstChild):this.$.appendChild(e.$),e},appendHtml:function(e){if(this.$.childNodes.length){var t=new CKEDITOR.dom.element("div",this.getDocument());t.setHtml(e),t.moveChildren(this)}else this.setHtml(e)},appendText:function(e){this.$.text!=void 0?this.$.text=this.$.text+e:this.append(new CKEDITOR.dom.text(e))},appendBogus:function(e){if(e||CKEDITOR.env.needsBrFiller){for(e=this.getLast();e&&e.type==CKEDITOR.NODE_TEXT&&!CKEDITOR.tools.rtrim(e.getText());)e=e.getPrevious();if(!e||!e.is||!e.is("br"))e=this.getDocument().createElement("br"),CKEDITOR.env.gecko&&e.setAttribute("type","_moz"),this.append(e)}},breakParent:function(e){var t=new CKEDITOR.dom.range(this.getDocument());t.setStartAfter(this),t.setEndAfter(e),e=t.extractContents(),t.insertNode(this.remove()),e.insertAfterNode(this)},contains:CKEDITOR.env.ie||CKEDITOR.env.webkit?function(e){var t=this.$;return e.type!=CKEDITOR.NODE_ELEMENT?t.contains(e.getParent().$):t!=e.$&&t.contains(e.$)}:function(e){return!!(this.$.compareDocumentPosition(e.$)&16)},focus:function(){function e(){try{this.$.focus()}catch(e){}}return function(t){t?CKEDITOR.tools.setTimeout(e,100,this):e.call(this)}}(),getHtml:function(){var e=this.$.innerHTML;return CKEDITOR.env.ie?e.replace(/<\?[^>]*>/g,""):e},getOuterHtml:function(){if(this.$.outerHTML)return this.$.outerHTML.replace(/<\?[^>]*>/,"");var e=this.$.ownerDocument.createElement("div");return e.appendChild(this.$.cloneNode(!0)),e.innerHTML},getClientRect:function(){var e=CKEDITOR.tools.extend({},this.$.getBoundingClientRect());return!e.width&&(e.width=e.right-e.left),!e.height&&(e.height=e.bottom-e.top),e},setHtml:CKEDITOR.env.ie&&CKEDITOR.env.version<9?function(e){try{var t=this.$;if(this.getParent())return t.innerHTML=e;var n=this.getDocument()._getHtml5ShivFrag();return n.appendChild(t),t.innerHTML=e,n.removeChild(t),e}catch(r){this.$.innerHTML="",t=new CKEDITOR.dom.element("body",this.getDocument()),t.$.innerHTML=e;for(t=t.getChildren();t.count();)this.append(t.getItem(0));return e}}:function(e){return this.$.innerHTML=e},setText:function(){var e=document.createElement("p");return e.innerHTML="x",e=e.textContent,function(t){this.$[e?"textContent":"innerText"]=t}}(),getAttribute:function(){var e=function(e){return this.$.getAttribute(e,2)};return CKEDITOR.env.ie&&(CKEDITOR.env.ie7Compat||CKEDITOR.env.quirks)?function(e){switch(e){case"class":e="className";break;case"http-equiv":e="httpEquiv";break;case"name":return this.$.name;case"tabindex":return e=this.$.getAttribute(e,2),e!==0&&this.$.tabIndex===0&&(e=null),e;case"checked":return e=this.$.attributes.getNamedItem(e),(e.specified?e.nodeValue:this.$.checked)?"checked":null;case"hspace":case"value":return this.$[e];case"style":return this.$.style.cssText;case"contenteditable":case"contentEditable":return this.$.attributes.getNamedItem("contentEditable").specified?this.$.getAttribute("contentEditable"):null}return this.$.getAttribute(e,2)}:e}(),getChildren:function(){return new CKEDITOR.dom.nodeList(this.$.childNodes)},getComputedStyle:CKEDITOR.env.ie?function(e){return this.$.currentStyle[CKEDITOR.tools.cssStyleToDomStyle(e)]}:function(e){var t=this.getWindow().$.getComputedStyle(this.$,null);return t?t.getPropertyValue(e):""},getDtd:function(){var e=CKEDITOR.dtd[this.getName()];return this.getDtd=function(){return e},e},getElementsByTag:CKEDITOR.dom.document.prototype.getElementsByTag,getTabIndex:CKEDITOR.env.ie?function(){var e=this.$.tabIndex;return e===0&&!CKEDITOR.dtd.$tabIndex[this.getName()]&&parseInt(this.getAttribute("tabindex"),10)!==0&&(e=-1),e}:CKEDITOR.env.webkit?function(){var e=this.$.tabIndex;return e==void 0&&(e=parseInt(this.getAttribute("tabindex"),10),isNaN(e)&&(e=-1)),e}:function(){return this.$.tabIndex},getText:function(){return this.$.textContent||this.$.innerText||""},getWindow:function(){return this.getDocument().getWindow()},getId:function(){return this.$.id||null},getNameAtt:function(){return this.$.name||null},getName:function(){var e=this.$.nodeName.toLowerCase();if(CKEDITOR.env.ie&&!(document.documentMode>8)){var t=this.$.scopeName;t!="HTML"&&(e=t.toLowerCase()+":"+e)}return(this.getName=function(){return e})()},getValue:function(){return this.$.value},getFirst:function(e){var t=this.$.firstChild;return(t=t&&new CKEDITOR.dom.node(t))&&e&&!e(t)&&(t=t.getNext(e)),t},getLast:function(e){var t=this.$.lastChild;return(t=t&&new CKEDITOR.dom.node(t))&&e&&!e(t)&&(t=t.getPrevious(e)),t},getStyle:function(e){return this.$.style[CKEDITOR.tools.cssStyleToDomStyle(e)]},is:function(){var e=this.getName();if(typeof arguments[0]=="object")return!!arguments[0][e];for(var t=0;t<arguments.length;t++)if(arguments[t]==e)return!0;return!1},isEditable:function(e){var t=this.getName();return this.isReadOnly()||this.getComputedStyle("display")=="none"||this.getComputedStyle("visibility")=="hidden"||CKEDITOR.dtd.$nonEditable[t]||CKEDITOR.dtd.$empty[t]||this.is("a")&&(this.data("cke-saved-name")||this.hasAttribute("name"))&&!this.getChildCount()?!1:e!==!1?(e=CKEDITOR.dtd[t]||CKEDITOR.dtd.span,!!e&&!!e["#"]):!0},isIdentical:function(e){var t=this.clone(0,1),e=e.clone(0,1);t.removeAttributes(["_moz_dirty","data-cke-expando","data-cke-saved-href","data-cke-saved-name"]),e.removeAttributes(["_moz_dirty","data-cke-expando","data-cke-saved-href","data-cke-saved-name"]);if(t.$.isEqualNode)return t.$.style.cssText=CKEDITOR.tools.normalizeCssText(t.$.style.cssText),e.$.style.cssText=CKEDITOR.tools.normalizeCssText(e.$.style.cssText),t.$.isEqualNode(e.$);t=t.getOuterHtml(),e=e.getOuterHtml();if(CKEDITOR.env.ie&&CKEDITOR.env.version<9&&this.is("a")){var n=this.getParent();n.type==CKEDITOR.NODE_ELEMENT&&(n=n.clone(),n.setHtml(t),t=n.getHtml(),n.setHtml(e),e=n.getHtml())}return t==e},isVisible:function(){var e=(this.$.offsetHeight||this.$.offsetWidth)&&this.getComputedStyle("visibility")!="hidden",t,n;return e&&CKEDITOR.env.webkit&&(t=this.getWindow(),!t.equals(CKEDITOR.document.getWindow())&&(n=t.$.frameElement)&&(e=(new CKEDITOR.dom.element(n)).isVisible())),!!e},isEmptyInlineRemoveable:function(){if(!CKEDITOR.dtd.$removeEmpty[this.getName()])return!1;for(var e=this.getChildren(),t=0,n=e.count();t<n;t++){var r=e.getItem(t);if((r.type!=CKEDITOR.NODE_ELEMENT||!r.data("cke-bookmark"))&&(r.type==CKEDITOR.NODE_ELEMENT&&!r.isEmptyInlineRemoveable()||r.type==CKEDITOR.NODE_TEXT&&CKEDITOR.tools.trim(r.getText())))return!1}return!0},hasAttributes:CKEDITOR.env.ie&&(CKEDITOR.env.ie7Compat||CKEDITOR.env.quirks)?function(){for(var e=this.$.attributes,t=0;t<e.length;t++){var n=e[t];switch(n.nodeName){case"class":if(this.getAttribute("class"))return!0;case"data-cke-expando":continue;default:if(n.specified)return!0}}return!1}:function(){var e=this.$.attributes,t=e.length,n={"data-cke-expando":1,_moz_dirty:1};return t>0&&(t>2||!n[e[0].nodeName]||t==2&&!n[e[1].nodeName])},hasAttribute:function(){function e(e){var t=this.$.attributes.getNamedItem(e);if(this.getName()=="input")switch(e){case"class":return this.$.className.length>0;case"checked":return!!this.$.checked;case"value":return e=this.getAttribute("type"),e=="checkbox"||e=="radio"?this.$.value!="on":!!this.$.value}return t?t.specified:!1}return CKEDITOR.env.ie?CKEDITOR.env.version<8?function(t){return t=="name"?!!this.$.name:e.call(this,t)}:e:function(e){return!!this.$.attributes.getNamedItem(e)}}(),hide:function(){this.setStyle("display","none")},moveChildren:function(e,t){var n=this.$,e=e.$;if(n!=e){var r;if(t)for(;r=n.lastChild;)e.insertBefore(n.removeChild(r),e.firstChild);else for(;r=n.firstChild;)e.appendChild(n.removeChild(r))}},mergeSiblings:function(){function e(e,t,n){if(t&&t.type==CKEDITOR.NODE_ELEMENT){for(var r=[];t.data("cke-bookmark")||t.isEmptyInlineRemoveable();){r.push(t),t=n?t.getNext():t.getPrevious();if(!t||t.type!=CKEDITOR.NODE_ELEMENT)return}if(e.isIdentical(t)){for(var i=n?e.getLast():e.getFirst();r.length;)r.shift().move(e,!n);t.moveChildren(e,!n),t.remove(),i&&i.type==CKEDITOR.NODE_ELEMENT&&i.mergeSiblings()}}}return function(t){if(t===!1||CKEDITOR.dtd.$removeEmpty[this.getName()]||this.is("a"))e(this,this.getNext(),!0),e(this,this.getPrevious())}}(),show:function(){this.setStyles({display:"",visibility:""})},setAttribute:function(){var e=function(e,t){return this.$.setAttribute(e,t),this};return CKEDITOR.env.ie&&(CKEDITOR.env.ie7Compat||CKEDITOR.env.quirks)?function(t,n){return t=="class"?this.$.className=n:t=="style"?this.$.style.cssText=n:t=="tabindex"?this.$.tabIndex=n:t=="checked"?this.$.checked=n:t=="contenteditable"?e.call(this,"contentEditable",n):e.apply(this,arguments),this}:CKEDITOR.env.ie8Compat&&CKEDITOR.env.secure?function(t,n){if(t=="src"&&n.match(/^http:\/\//))try{e.apply(this,arguments)}catch(r){}else e.apply(this,arguments);return this}:e}(),setAttributes:function(e){for(var t in e)this.setAttribute(t,e[t]);return this},setValue:function(e){return this.$.value=e,this},removeAttribute:function(){var e=function(e){this.$.removeAttribute(e)};return CKEDITOR.env.ie&&(CKEDITOR.env.ie7Compat||CKEDITOR.env.quirks)?function(e){e=="class"?e="className":e=="tabindex"?e="tabIndex":e=="contenteditable"&&(e="contentEditable"),this.$.removeAttribute(e)}:e}(),removeAttributes:function(e){if(CKEDITOR.tools.isArray(e))for(var t=0;t<e.length;t++)this.removeAttribute(e[t]);else for(t in e)e.hasOwnProperty(t)&&this.removeAttribute(t)},removeStyle:function(e){var t=this.$.style;if(!!t.removeProperty||e!="border"&&e!="margin"&&e!="padding")t.removeProperty?t.removeProperty(e):t.removeAttribute(CKEDITOR.tools.cssStyleToDomStyle(e)),this.$.style.cssText||this.removeAttribute("style");else{var n=["top","left","right","bottom"],r;e=="border"&&(r=["color","style","width"]);for(var t=[],i=0;i<n.length;i++)if(r)for(var s=0;s<r.length;s++)t.push([e,n[i],r[s]].join("-"));else t.push([e,n[i]].join("-"));for(e=0;e<t.length;e++)this.removeStyle(t[e])}},setStyle:function(e,t){return this.$.style[CKEDITOR.tools.cssStyleToDomStyle(e)]=t,this},setStyles:function(e){for(var t in e)this.setStyle(t,e[t]);return this},setOpacity:function(e){CKEDITOR.env.ie&&CKEDITOR.env.version<9?(e=Math.round(e*100),this.setStyle("filter",e>=100?"":"progid:DXImageTransform.Microsoft.Alpha(opacity="+e+")")):this.setStyle("opacity",e)},unselectable:function(){this.setStyles(CKEDITOR.tools.cssVendorPrefix("user-select","none"));if(CKEDITOR.env.ie){this.setAttribute("unselectable","on");for(var e,t=this.getElementsByTag("*"),n=0,r=t.count();n<r;n++)e=t.getItem(n),e.setAttribute("unselectable","on")}},getPositionedAncestor:function(){for(var e=this;e.getName()!="html";){if(e.getComputedStyle("position")!="static")return e;e=e.getParent()}return null},getDocumentPosition:function(e){var t=0,n=0,r=this.getDocument(),i=r.getBody(),s=r.$.compatMode=="BackCompat";if(document.documentElement.getBoundingClientRect){var o=this.$.getBoundingClientRect(),u=r.$.documentElement,a=u.clientTop||i.$.clientTop||0,f=u.clientLeft||i.$.clientLeft||0,l=!0;CKEDITOR.env.ie&&(l=r.getDocumentElement().contains(this),r=r.getBody().contains(this),l=s&&r||!s&&l),l&&(t=o.left+(!s&&u.scrollLeft||i.$.scrollLeft),t-=f,n=o.top+(!s&&u.scrollTop||i.$.scrollTop),n-=a)}else{i=this;for(r=null;i&&i.getName()!="body"&&i.getName()!="html";){t+=i.$.offsetLeft-i.$.scrollLeft,n+=i.$.offsetTop-i.$.scrollTop,i.equals(this)||(t+=i.$.clientLeft||0,n+=i.$.clientTop||0);for(;r&&!r.equals(i);)t-=r.$.scrollLeft,n-=r.$.scrollTop,r=r.getParent();r=i,i=(o=i.$.offsetParent)?new CKEDITOR.dom.element(o):null}}return e&&(i=this.getWindow(),r=e.getWindow(),!i.equals(r)&&i.$.frameElement&&(e=(new CKEDITOR.dom.element(i.$.frameElement)).getDocumentPosition(e),t+=e.x,n+=e.y)),!document.documentElement.getBoundingClientRect&&CKEDITOR.env.gecko&&!s&&(t+=this.$.clientLeft?1:0,n+=this.$.clientTop?1:0),{x:t,y:n}},scrollIntoView:function(e){var t=this.getParent();if(t)do{(t.$.clientWidth&&t.$.clientWidth<t.$.scrollWidth||t.$.clientHeight&&t.$.clientHeight<t.$.scrollHeight)&&!t.is("body")&&this.scrollIntoParent(t,e,1);if(t.is("html")){var n=t.getWindow();try{var r=n.$.frameElement;r&&(t=new CKEDITOR.dom.element(r))}catch(i){}}}while(t=t.getParent())},scrollIntoParent:function(e,t,n){function u(t,n){/body|html/.test(e.getName())?e.getWindow().$.scrollBy(t,n):(e.$.scrollLeft=e.$.scrollLeft+t,e.$.scrollTop=e.$.scrollTop+n)}function a(e,t){var n={x:0,y:0};if(!e.is(l?"body":"html")){var r=e.$.getBoundingClientRect();n.x=r.left,n.y=r.top}return r=e.getWindow(),r.equals(t)||(r=a(CKEDITOR.dom.element.get(r.$.frameElement),t),n.x=n.x+r.x,n.y=n.y+r.y),n}function f(e,t){return parseInt(e.getComputedStyle("margin-"+t)||0,10)||0}var r,i,s,o;!e&&(e=this.getWindow()),s=e.getDocument();var l=s.$.compatMode=="BackCompat";e instanceof CKEDITOR.dom.window&&(e=l?s.getBody():s.getDocumentElement()),s=e.getWindow(),i=a(this,s);var c=a(e,s),h=this.$.offsetHeight;r=this.$.offsetWidth;var p=e.$.clientHeight,d=e.$.clientWidth;s=i.x-f(this,"left")-c.x||0,o=i.y-f(this,"top")-c.y||0,r=i.x+r+f(this,"right")-(c.x+d)||0,i=i.y+h+f(this,"bottom")-(c.y+p)||0,(o<0||i>0)&&u(0,t===!0?o:t===!1?i:o<0?o:i),n&&(s<0||r>0)&&u(s<0?s:r,0)},setState:function(e,t,n){t=t||"cke";switch(e){case CKEDITOR.TRISTATE_ON:this.addClass(t+"_on"),this.removeClass(t+"_off"),this.removeClass(t+"_disabled"),n&&this.setAttribute("aria-pressed",!0),n&&this.removeAttribute("aria-disabled");break;case CKEDITOR.TRISTATE_DISABLED:this.addClass(t+"_disabled"),this.removeClass(t+"_off"),this.removeClass(t+"_on"),n&&this.setAttribute("aria-disabled",!0),n&&this.removeAttribute("aria-pressed");break;default:this.addClass(t+"_off"),this.removeClass(t+"_on"),this.removeClass(t+"_disabled"),n&&this.removeAttribute("aria-pressed"),n&&this.removeAttribute("aria-disabled")}},getFrameDocument:function(){var e=this.$;try{e.contentWindow.document}catch(t){e.src=e.src}return e&&new CKEDITOR.dom.document(e.contentWindow.document)},copyAttributes:function(e,t){for(var n=this.$.attributes,t=t||{},r=0;r<n.length;r++){var i=n[r],s=i.nodeName.toLowerCase(),o;if(!(s in t))if(s=="checked"&&(o=this.getAttribute(s)))e.setAttribute(s,o);else if(!CKEDITOR.env.ie||this.hasAttribute(s))o=this.getAttribute(s),o===null&&(o=i.nodeValue),e.setAttribute(s,o)}this.$.style.cssText!==""&&(e.$.style.cssText=this.$.style.cssText)},renameNode:function(e){if(this.getName()!=e){var t=this.getDocument(),e=new CKEDITOR.dom.element(e,t);this.copyAttributes(e),this.moveChildren(e),this.getParent()&&this.$.parentNode.replaceChild(e.$,this.$),e.$["data-cke-expando"]=this.$["data-cke-expando"],this.$=e.$,delete this.getName}},getChild:function(){function e(e,t){var n=e.childNodes;if(t>=0&&t<n.length)return n[t]}return function(t){var n=this.$;if(t.slice)for(;t.length>0&&n;)n=e(n,t.shift());else n=e(n,t);return n?new CKEDITOR.dom.node(n):null}}(),getChildCount:function(){return this.$.childNodes.length},disableContextMenu:function(){this.on("contextmenu",function(e){e.data.getTarget().hasClass("cke_enable_context_menu")||e.data.preventDefault()})},getDirection:function(e){return e?this.getComputedStyle("direction")||this.getDirection()||this.getParent()&&this.getParent().getDirection(1)||this.getDocument().$.dir||"ltr":this.getStyle("direction")||this.getAttribute("dir")},data:function(e,t){return e="data-"+e,t===void 0?this.getAttribute(e):(t===!1?this.removeAttribute(e):this.setAttribute(e,t),null)},getEditor:function(){var e=CKEDITOR.instances,t,n;for(t in e){n=e[t];if(n.element.equals(this)&&n.elementMode!=CKEDITOR.ELEMENT_MODE_APPENDTO)return n}return null},find:function(n){var r=e(this),n=new CKEDITOR.dom.nodeList(this.$.querySelectorAll(t(this,n)));return r(),n},findOne:function(n){var r=e(this),n=this.$.querySelector(t(this,n));return r(),n?new CKEDITOR.dom.element(n):null},forEach:function(e,t,n){if(!n&&(!t||this.type==t))var r=e(this);if(r!==!1)for(var n=this.getChildren(),i=0;i<n.count();i++)r=n.getItem(i),r.type==CKEDITOR.NODE_ELEMENT?r.forEach(e,t):(!t||r.type==t)&&e(r)}});var r={width:["border-left-width","border-right-width","padding-left","padding-right"],height:["border-top-width","border-bottom-width","padding-top","padding-bottom"]};CKEDITOR.dom.element.prototype.setSize=function(e,t,r){typeof t=="number"&&(r&&(!CKEDITOR.env.ie||!CKEDITOR.env.quirks)&&(t-=n.call(this,e)),this.setStyle(e,t+"px"))},CKEDITOR.dom.element.prototype.getSize=function(e,t){var r=Math.max(this.$["offset"+CKEDITOR.tools.capitalize(e)],this.$["client"+CKEDITOR.tools.capitalize(e)])||0;return t&&(r-=n.call(this,e)),r}}(),CKEDITOR.dom.documentFragment=function(e){e=e||CKEDITOR.document,this.$=e.type==CKEDITOR.NODE_DOCUMENT?e.$.createDocumentFragment():e},CKEDITOR.tools.extend(CKEDITOR.dom.documentFragment.prototype,CKEDITOR.dom.element.prototype,{type:CKEDITOR.NODE_DOCUMENT_FRAGMENT,insertAfterNode:function(e){e=e.$,e.parentNode.insertBefore(this.$,e.nextSibling)}},!0,{append:1,appendBogus:1,getFirst:1,getLast:1,getParent:1,getNext:1,getPrevious:1,appendTo:1,moveChildren:1,insertBefore:1,insertAfterNode:1,replace:1,trim:1,type:1,ltrim:1,rtrim:1,getDocument:1,getChildCount:1,getChild:1,getChildren:1}),function(){function e(e,t){var n=this.range;if(this._.end)return null;if(!this._.start){this._.start=1;if(n.collapsed)return this.end(),null;n.optimize()}var r,i=n.startContainer;r=n.endContainer;var s=n.startOffset,o=n.endOffset,u,a=this.guard,f=this.type,l=e?"getPreviousSourceNode":"getNextSourceNode";if(!e&&!this._.guardLTR){var c=r.type==CKEDITOR.NODE_ELEMENT?r:r.getParent(),h=r.type==CKEDITOR.NODE_ELEMENT?r.getChild(o):r.getNext();this._.guardLTR=function(e,t){return(!t||!c.equals(e))&&(!h||!e.equals(h))&&(e.type!=CKEDITOR.NODE_ELEMENT||!t||!e.equals(n.root))}}if(e&&!this._.guardRTL){var p=i.type==CKEDITOR.NODE_ELEMENT?i:i.getParent(),d=i.type==CKEDITOR.NODE_ELEMENT?s?i.getChild(s-1):null:i.getPrevious();this._.guardRTL=function(e,t){return(!t||!p.equals(e))&&(!d||!e.equals(d))&&(e.type!=CKEDITOR.NODE_ELEMENT||!t||!e.equals(n.root))}}var v=e?this._.guardRTL:this._.guardLTR;u=a?function(e,t){return v(e,t)===!1?!1:a(e,t)}:v,this.current?r=this.current[l](!1,f,u):(e?r.type==CKEDITOR.NODE_ELEMENT&&(r=o>0?r.getChild(o-1):u(r,!0)===!1?null:r.getPreviousSourceNode(!0,f,u)):(r=i,r.type==CKEDITOR.NODE_ELEMENT&&!(r=r.getChild(s))&&(r=u(i,!0)===!1?null:i.getNextSourceNode(!0,f,u))),r&&u(r)===!1&&(r=null));for(;r&&!this._.end;){this.current=r;if(!this.evaluator||this.evaluator(r)!==!1){if(!t)return r}else if(t&&this.evaluator)return!1;r=r[l](!1,f,u)}return this.end(),this.current=null}function t(t){for(var n,r=null;n=e.call(this,t);)r=n;return r}function n(e){if(f(e))return!1;if(e.type==CKEDITOR.NODE_TEXT)return!0;if(e.type==CKEDITOR.NODE_ELEMENT){if(e.is(CKEDITOR.dtd.$inline)||e.is("hr")||e.getAttribute("contenteditable")=="false")return!0;var t;if(t=!CKEDITOR.env.needsBrFiller)if(t=e.is(l))e:{t=0;for(var n=e.getChildCount();t<n;++t)if(!f(e.getChild(t))){t=!1;break e}t=!0}if(t)return!0}return!1}CKEDITOR.dom.walker=CKEDITOR.tools.createClass({$:function(e){this.range=e,this._={}},proto:{end:function(){this._.end=1},next:function(){return e.call(this)},previous:function(){return e.call(this,1)},checkForward:function(){return e.call(this,0,1)!==!1},checkBackward:function(){return e.call(this,1,1)!==!1},lastForward:function(){return t.call(this)},lastBackward:function(){return t.call(this,1)},reset:function(){delete this.current,this._={}}}});var r={block:1,"list-item":1,table:1,"table-row-group":1,"table-header-group":1,"table-footer-group":1,"table-row":1,"table-column-group":1,"table-column":1,"table-cell":1,"table-caption":1},i={absolute:1,fixed:1};CKEDITOR.dom.element.prototype.isBlockBoundary=function(e){return this.getComputedStyle("float")!="none"||this.getComputedStyle("position")in i||!r[this.getComputedStyle("display")]?!!(this.is(CKEDITOR.dtd.$block)||e&&this.is(e)):!0},CKEDITOR.dom.walker.blockBoundary=function(e){return function(t){return t.type!=CKEDITOR.NODE_ELEMENT||!t.isBlockBoundary(e)}},CKEDITOR.dom.walker.listItemBoundary=function(){return this.blockBoundary({br:1})},CKEDITOR.dom.walker.bookmark=function(e,t){function n(e){return e&&e.getName&&e.getName()=="span"&&e.data("cke-bookmark")}return function(r){var i,s;return i=r&&r.type!=CKEDITOR.NODE_ELEMENT&&(s=r.getParent())&&n(s),i=e?i:i||n(r),!!(t^i)}},CKEDITOR.dom.walker.whitespaces=function(e){return function(t){var n;return t&&t.type==CKEDITOR.NODE_TEXT&&(n=!CKEDITOR.tools.trim(t.getText())||CKEDITOR.env.webkit&&t.getText()=="​"),!!(e^n)}},CKEDITOR.dom.walker.invisible=function(e){var t=CKEDITOR.dom.walker.whitespaces();return function(n){return t(n)?n=1:(n.type==CKEDITOR.NODE_TEXT&&(n=n.getParent()),n=!n.$.offsetHeight),!!(e^n)}},CKEDITOR.dom.walker.nodeType=function(e,t){return function(n){return!!(t^n.type==e)}},CKEDITOR.dom.walker.bogus=function(e){function t(e){return!o(e)&&!u(e)}return function(n){var r=CKEDITOR.env.needsBrFiller?n.is&&n.is("br"):n.getText&&s.test(n.getText());return r&&(r=n.getParent(),n=n.getNext(t),r=r.isBlockBoundary()&&(!n||n.type==CKEDITOR.NODE_ELEMENT&&n.isBlockBoundary())),!!(e^r)}},CKEDITOR.dom.walker.temp=function(e){return function(t){return t.type!=CKEDITOR.NODE_ELEMENT&&(t=t.getParent()),t=t&&t.hasAttribute("data-cke-temp"),!!(e^t)}};var s=/^[\t\r\n ]*(?:&nbsp;|\xa0)$/,o=CKEDITOR.dom.walker.whitespaces(),u=CKEDITOR.dom.walker.bookmark(),a=CKEDITOR.dom.walker.temp();CKEDITOR.dom.walker.ignored=function(e){return function(t){return t=o(t)||u(t)||a(t),!!(e^t)}};var f=CKEDITOR.dom.walker.ignored(),l=function(e){var t={},n;for(n in e)CKEDITOR.dtd[n]["#"]&&(t[n]=1);return t}(CKEDITOR.dtd.$block);CKEDITOR.dom.walker.editable=function(e){return function(t){return!!(e^n(t))}},CKEDITOR.dom.element.prototype.getBogus=function(){var e=this;do e=e.getPreviousSourceNode();while(u(e)||o(e)||e.type==CKEDITOR.NODE_ELEMENT&&e.is(CKEDITOR.dtd.$inline)&&!e.is(CKEDITOR.dtd.$empty));return e&&(CKEDITOR.env.needsBrFiller?e.is&&e.is("br"):e.getText&&s.test(e.getText()))?e:!1}}(),CKEDITOR.dom.range=function(e){this.endOffset=this.endContainer=this.startOffset=this.startContainer=null,this.collapsed=!0;var t=e instanceof CKEDITOR.dom.document;this.document=t?e:e.getDocument(),this.root=t?e.getBody():e},function(){function e(){var e=!1,t=CKEDITOR.dom.walker.whitespaces(),n=CKEDITOR.dom.walker.bookmark(!0),r=CKEDITOR.dom.walker.bogus();return function(i){return n(i)||t(i)?!0:r(i)&&!e?e=!0:i.type==CKEDITOR.NODE_TEXT&&(i.hasAscendant("pre")||CKEDITOR.tools.trim(i.getText()).length)||i.type==CKEDITOR.NODE_ELEMENT&&!i.is(s)?!1:!0}}function t(e){var t=CKEDITOR.dom.walker.whitespaces(),n=CKEDITOR.dom.walker.bookmark(1);return function(r){return n(r)||t(r)?!0:!e&&o(r)||r.type==CKEDITOR.NODE_ELEMENT&&r.is(CKEDITOR.dtd.$removeEmpty)}}function n(e){return function(){var t;return this[e?"getPreviousNode":"getNextNode"](function(e){return!t&&f(e)&&(t=e),a(e)&&(!o(e)||!e.equals(t))})}}var r=function(e){e.collapsed=e.startContainer&&e.endContainer&&e.startContainer.equals(e.endContainer)&&e.startOffset==e.endOffset},i=function(e,t,n,r){e.optimizeBookmark();var i=e.startContainer,s=e.endContainer,o=e.startOffset,u=e.endOffset,a,f;s.type==CKEDITOR.NODE_TEXT?s=s.split(u):s.getChildCount()>0&&(u>=s.getChildCount()?(s=s.append(e.document.createText("")),f=!0):s=s.getChild(u)),i.type==CKEDITOR.NODE_TEXT?(i.split(o),i.equals(s)&&(s=i.getNext())):o?o>=i.getChildCount()?(i=i.append(e.document.createText("")),a=!0):i=i.getChild(o).getPrevious():(i=i.append(e.document.createText(""),1),a=!0);var o=i.getParents(),u=s.getParents(),l,c,h;for(l=0;l<o.length;l++){c=o[l],h=u[l];if(!c.equals(h))break}for(var p=n,d,v,m,g=l;g<o.length;g++){d=o[g],p&&!d.equals(i)&&(v=p.append(d.clone()));for(d=d.getNext();d;){if(d.equals(u[g])||d.equals(s))break;m=d.getNext(),t==2?p.append(d.clone(!0)):(d.remove(),t==1&&p.append(d)),d=m}p&&(p=v)}p=n;for(n=l;n<u.length;n++){d=u[n],t>0&&!d.equals(s)&&(v=p.append(d.clone()));if(!o[n]||d.$.parentNode!=o[n].$.parentNode)for(d=d.getPrevious();d;){if(d.equals(o[n])||d.equals(i))break;m=d.getPrevious(),t==2?p.$.insertBefore(d.$.cloneNode(!0),p.$.firstChild):(d.remove(),t==1&&p.$.insertBefore(d.$,p.$.firstChild)),d=m}p&&(p=v)}t==2?(c=e.startContainer,c.type==CKEDITOR.NODE_TEXT&&(c.$.data=c.$.data+c.$.nextSibling.data,c.$.parentNode.removeChild(c.$.nextSibling)),e=e.endContainer,e.type==CKEDITOR.NODE_TEXT&&e.$.nextSibling&&(e.$.data=e.$.data+e.$.nextSibling.data,e.$.parentNode.removeChild(e.$.nextSibling))):(c&&h&&(i.$.parentNode!=c.$.parentNode||s.$.parentNode!=h.$.parentNode)&&(t=h.getIndex(),a&&h.$.parentNode==i.$.parentNode&&t--,r&&c.type==CKEDITOR.NODE_ELEMENT?(r=CKEDITOR.dom.element.createFromHtml('<span data-cke-bookmark="1" style="display:none">&nbsp;</span>',e.document),r.insertAfter(c),c.mergeSiblings(!1),e.moveToBookmark({startNode:r})):e.setStart(h.getParent(),t)),e.collapse(!0)),a&&i.remove(),f&&s.$.parentNode&&s.remove()},s={abbr:1,acronym:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1},o=CKEDITOR.dom.walker.bogus(),u=/^[\t\r\n ]*(?:&nbsp;|\xa0)$/,a=CKEDITOR.dom.walker.editable(),f=CKEDITOR.dom.walker.ignored(!0);CKEDITOR.dom.range.prototype={clone:function(){var e=new CKEDITOR.dom.range(this.root);return e.startContainer=this.startContainer,e.startOffset=this.startOffset,e.endContainer=this.endContainer,e.endOffset=this.endOffset,e.collapsed=this.collapsed,e},collapse:function(e){e?(this.endContainer=this.startContainer,this.endOffset=this.startOffset):(this.startContainer=this.endContainer,this.startOffset=this.endOffset),this.collapsed=!0},cloneContents:function(){var e=new CKEDITOR.dom.documentFragment(this.document);return this.collapsed||i(this,2,e),e},deleteContents:function(e){this.collapsed||i(this,0,null,e)},extractContents:function(e){var t=new CKEDITOR.dom.documentFragment(this.document);return this.collapsed||i(this,1,t,e),t},createBookmark:function(e){var t,n,r,i,s=this.collapsed;return t=this.document.createElement("span"),t.data("cke-bookmark",1),t.setStyle("display","none"),t.setHtml("&nbsp;"),e&&(r="cke_bm_"+CKEDITOR.tools.getNextNumber(),t.setAttribute("id",r+(s?"C":"S"))),s||(n=t.clone(),n.setHtml("&nbsp;"),e&&n.setAttribute("id",r+"E"),i=this.clone(),i.collapse(),i.insertNode(n)),i=this.clone(),i.collapse(!0),i.insertNode(t),n?(this.setStartAfter(t),this.setEndBefore(n)):this.moveToPosition(t,CKEDITOR.POSITION_AFTER_END),{startNode:e?r+(s?"C":"S"):t,endNode:e?r+"E":n,serializable:e,collapsed:s}},createBookmark2:function(){function e(e){var t=e.container,n=e.offset,r;r=t;var i=n;r=r.type!=CKEDITOR.NODE_ELEMENT||i===0||i==r.getChildCount()?0:r.getChild(i-1).type==CKEDITOR.NODE_TEXT&&r.getChild(i).type==CKEDITOR.NODE_TEXT,r&&(t=t.getChild(n-1),n=t.getLength()),t.type==CKEDITOR.NODE_ELEMENT&&n>1&&(n=t.getChild(n-1).getIndex(!0)+1);if(t.type==CKEDITOR.NODE_TEXT){r=t;for(i=0;(r=r.getPrevious())&&r.type==CKEDITOR.NODE_TEXT;)i+=r.getLength();n+=i}e.container=t,e.offset=n}return function(t){var n=this.collapsed,r={container:this.startContainer,offset:this.startOffset},i={container:this.endContainer,offset:this.endOffset};return t&&(e(r),n||e(i)),{start:r.container.getAddress(t),end:n?null:i.container.getAddress(t),startOffset:r.offset,endOffset:i.offset,normalized:t,collapsed:n,is2:!0}}}(),moveToBookmark:function(e){if(e.is2){var t=this.document.getByAddress(e.start,e.normalized),n=e.startOffset,r=e.end&&this.document.getByAddress(e.end,e.normalized),e=e.endOffset;this.setStart(t,n),r?this.setEnd(r,e):this.collapse(!0)}else t=(n=e.serializable)?this.document.getById(e.startNode):e.startNode,e=n?this.document.getById(e.endNode):e.endNode,this.setStartBefore(t),t.remove(),e?(this.setEndBefore(e),e.remove()):this.collapse(!0)},getBoundaryNodes:function(){var e=this.startContainer,t=this.endContainer,n=this.startOffset,r=this.endOffset,i;if(e.type==CKEDITOR.NODE_ELEMENT){i=e.getChildCount();if(i>n)e=e.getChild(n);else if(i<1)e=e.getPreviousSourceNode();else{for(e=e.$;e.lastChild;)e=e.lastChild;e=new CKEDITOR.dom.node(e),e=e.getNextSourceNode()||e}}if(t.type==CKEDITOR.NODE_ELEMENT){i=t.getChildCount();if(i>r)t=t.getChild(r).getPreviousSourceNode(!0);else if(i<1)t=t.getPreviousSourceNode();else{for(t=t.$;t.lastChild;)t=t.lastChild;t=new CKEDITOR.dom.node(t)}}return e.getPosition(t)&CKEDITOR.POSITION_FOLLOWING&&(e=t),{startNode:e,endNode:t}},getCommonAncestor:function(e,t){var n=this.startContainer,r=this.endContainer,n=n.equals(r)?e&&n.type==CKEDITOR.NODE_ELEMENT&&this.startOffset==this.endOffset-1?n.getChild(this.startOffset):n:n.getCommonAncestor(r);return t&&!n.is?n.getParent():n},optimize:function(){var e=this.startContainer,t=this.startOffset;e.type!=CKEDITOR.NODE_ELEMENT&&(t?t>=e.getLength()&&this.setStartAfter(e):this.setStartBefore(e)),e=this.endContainer,t=this.endOffset,e.type!=CKEDITOR.NODE_ELEMENT&&(t?t>=e.getLength()&&this.setEndAfter(e):this.setEndBefore(e))},optimizeBookmark:function(){var e=this.startContainer,t=this.endContainer;e.is&&e.is("span")&&e.data("cke-bookmark")&&this.setStartAt(e,CKEDITOR.POSITION_BEFORE_START),t&&t.is&&t.is("span")&&t.data("cke-bookmark")&&this.setEndAt(t,CKEDITOR.POSITION_AFTER_END)},trim:function(e,t){var n=this.startContainer,r=this.startOffset,i=this.collapsed;if((!e||i)&&n&&n.type==CKEDITOR.NODE_TEXT){if(r)if(r>=n.getLength())r=n.getIndex()+1,n=n.getParent();else{var s=n.split(r),r=n.getIndex()+1,n=n.getParent();this.startContainer.equals(this.endContainer)?this.setEnd(s,this.endOffset-this.startOffset):n.equals(this.endContainer)&&(this.endOffset=this.endOffset+1)}else r=n.getIndex(),n=n.getParent();this.setStart(n,r);if(i){this.collapse(!0);return}}n=this.endContainer,r=this.endOffset,!t&&!i&&n&&n.type==CKEDITOR.NODE_TEXT&&(r?(r>=n.getLength()||n.split(r),r=n.getIndex()+1):r=n.getIndex(),n=n.getParent(),this.setEnd(n,r))},enlarge:function(e,t){function n(e){return e&&e.type==CKEDITOR.NODE_ELEMENT&&e.hasAttribute("contenteditable")?null:e}var r=RegExp(/[^\s\ufeff]/);switch(e){case CKEDITOR.ENLARGE_INLINE:var i=1;case CKEDITOR.ENLARGE_ELEMENT:if(this.collapsed)break;var s=this.getCommonAncestor(),o=this.root,u,a,f,l,c,h=!1,p,d;p=this.startContainer;var v=this.startOffset;p.type==CKEDITOR.NODE_TEXT?(v&&(p=!CKEDITOR.tools.trim(p.substring(0,v)).length&&p,h=!!p),p&&!(l=p.getPrevious())&&(f=p.getParent())):(v&&(l=p.getChild(v-1)||p.getLast()),l||(f=p));for(f=n(f);f||l;){if(f&&!l){!c&&f.equals(s)&&(c=!0);if(i?f.isBlockBoundary():!o.contains(f))break;if(!h||f.getComputedStyle("display")!="inline")h=!1,c?u=f:this.setStartBefore(f);l=f.getPrevious()}for(;l;){p=!1;if(l.type==CKEDITOR.NODE_COMMENT)l=l.getPrevious();else{if(l.type==CKEDITOR.NODE_TEXT)d=l.getText(),r.test(d)&&(l=null),p=/[\s\ufeff]$/.test(d);else if((l.$.offsetWidth>0||t&&l.is("br"))&&!l.data("cke-bookmark"))if(h&&CKEDITOR.dtd.$removeEmpty[l.getName()]){d=l.getText();if(r.test(d))l=null;else for(var v=l.$.getElementsByTagName("*"),m=0,g;g=v[m++];)if(!CKEDITOR.dtd.$removeEmpty[g.nodeName.toLowerCase()]){l=null;break}l&&(p=!!d.length)}else l=null;p&&(h?c?u=f:f&&this.setStartBefore(f):h=!0);if(l){p=l.getPrevious();if(!f&&!p){f=l,l=null;break}l=p}else f=null}}f&&(f=n(f.getParent()))}p=this.endContainer,v=this.endOffset,f=l=null,c=h=!1;var y=function(e,t){var n=new CKEDITOR.dom.range(o);n.setStart(e,t),n.setEndAt(o,CKEDITOR.POSITION_BEFORE_END);var n=new CKEDITOR.dom.walker(n),i;for(n.guard=function(e){return e.type!=CKEDITOR.NODE_ELEMENT||!e.isBlockBoundary()};i=n.next();){if(i.type!=CKEDITOR.NODE_TEXT)return!1;d=i!=e?i.getText():i.substring(t);if(r.test(d))return!1}return!0};p.type==CKEDITOR.NODE_TEXT?CKEDITOR.tools.trim(p.substring(v)).length?h=!0:(h=!p.getLength(),v==p.getLength()?(l=p.getNext())||(f=p.getParent()):y(p,v)&&(f=p.getParent())):(l=p.getChild(v))||(f=p);for(;f||l;){if(f&&!l){!c&&f.equals(s)&&(c=!0);if(i?f.isBlockBoundary():!o.contains(f))break;if(!h||f.getComputedStyle("display")!="inline")h=!1,c?a=f:f&&this.setEndAfter(f);l=f.getNext()}for(;l;){p=!1;if(l.type==CKEDITOR.NODE_TEXT)d=l.getText(),y(l,0)||(l=null),p=/^[\s\ufeff]/.test(d);else if(l.type==CKEDITOR.NODE_ELEMENT){if((l.$.offsetWidth>0||t&&l.is("br"))&&!l.data("cke-bookmark"))if(h&&CKEDITOR.dtd.$removeEmpty[l.getName()]){d=l.getText();if(r.test(d))l=null;else{v=l.$.getElementsByTagName("*");for(m=0;g=v[m++];)if(!CKEDITOR.dtd.$removeEmpty[g.nodeName.toLowerCase()]){l=null;break}}l&&(p=!!d.length)}else l=null}else p=1;p&&h&&(c?a=f:this.setEndAfter(f));if(l){p=l.getNext();if(!f&&!p){f=l,l=null;break}l=p}else f=null}f&&(f=n(f.getParent()))}u&&a&&(s=u.contains(a)?a:u,this.setStartBefore(s),this.setEndAfter(s));break;case CKEDITOR.ENLARGE_BLOCK_CONTENTS:case CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS:f=new CKEDITOR.dom.range(this.root),o=this.root,f.setStartAt(o,CKEDITOR.POSITION_AFTER_START),f.setEnd(this.startContainer,this.startOffset),f=new CKEDITOR.dom.walker(f);var b,w,E=CKEDITOR.dom.walker.blockBoundary(e==CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS?{br:1}:null),S=null,x=function(e){if(e.type==CKEDITOR.NODE_ELEMENT&&e.getAttribute("contenteditable")=="false")if(S){if(S.equals(e)){S=null;return}}else S=e;else if(S)return;var t=E(e);return t||(b=e),t},i=function(e){var t=x(e);return!t&&e.is&&e.is("br")&&(w=e),t};f.guard=x,f=f.lastBackward(),b=b||o,this.setStartAt(b,!b.is("br")&&(!f&&this.checkStartOfBlock()||f&&b.contains(f))?CKEDITOR.POSITION_AFTER_START:CKEDITOR.POSITION_AFTER_END);if(e==CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS){f=this.clone(),f=new CKEDITOR.dom.walker(f);var T=CKEDITOR.dom.walker.whitespaces(),N=CKEDITOR.dom.walker.bookmark();f.evaluator=function(e){return!T(e)&&!N(e)};if((f=f.previous())&&f.type==CKEDITOR.NODE_ELEMENT&&f.is("br"))break}f=this.clone(),f.collapse(),f.setEndAt(o,CKEDITOR.POSITION_BEFORE_END),f=new CKEDITOR.dom.walker(f),f.guard=e==CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS?i:x,b=S=w=null,f=f.lastForward(),b=b||o,this.setEndAt(b,!f&&this.checkEndOfBlock()||f&&b.contains(f)?CKEDITOR.POSITION_BEFORE_END:CKEDITOR.POSITION_BEFORE_START),w&&this.setEndAfter(w)}},shrink:function(e,t,n){if(!this.collapsed){var e=e||CKEDITOR.SHRINK_TEXT,r=this.clone(),i=this.startContainer,s=this.endContainer,o=this.startOffset,u=this.endOffset,a=1,f=1;i&&i.type==CKEDITOR.NODE_TEXT&&(o?o>=i.getLength()?r.setStartAfter(i):(r.setStartBefore(i),a=0):r.setStartBefore(i)),s&&s.type==CKEDITOR.NODE_TEXT&&(u?u>=s.getLength()?r.setEndAfter(s):(r.setEndAfter(s),f=0):r.setEndBefore(s));var r=new CKEDITOR.dom.walker(r),l=CKEDITOR.dom.walker.bookmark();r.evaluator=function(t){return t.type==(e==CKEDITOR.SHRINK_ELEMENT?CKEDITOR.NODE_ELEMENT:CKEDITOR.NODE_TEXT)};var c;return r.guard=function(t,r){return l(t)?!0:e==CKEDITOR.SHRINK_ELEMENT&&t.type==CKEDITOR.NODE_TEXT||r&&t.equals(c)||n===!1&&t.type==CKEDITOR.NODE_ELEMENT&&t.isBlockBoundary()||t.type==CKEDITOR.NODE_ELEMENT&&t.hasAttribute("contenteditable")?!1:(!r&&t.type==CKEDITOR.NODE_ELEMENT&&(c=t),!0)},a&&(i=r[e==CKEDITOR.SHRINK_ELEMENT?"lastForward":"next"]())&&this.setStartAt(i,t?CKEDITOR.POSITION_AFTER_START:CKEDITOR.POSITION_BEFORE_START),f&&(r.reset(),(r=r[e==CKEDITOR.SHRINK_ELEMENT?"lastBackward":"previous"]())&&this.setEndAt(r,t?CKEDITOR.POSITION_BEFORE_END:CKEDITOR.POSITION_AFTER_END)),!!a||!!f}},insertNode:function(e){this.optimizeBookmark(),this.trim(!1,!0);var t=this.startContainer,n=t.getChild(this.startOffset);n?e.insertBefore(n):t.append(e),e.getParent()&&e.getParent().equals(this.endContainer)&&this.endOffset++,this.setStartBefore(e)},moveToPosition:function(e,t){this.setStartAt(e,t),this.collapse(!0)},moveToRange:function(e){this.setStart(e.startContainer,e.startOffset),this.setEnd(e.endContainer,e.endOffset)},selectNodeContents:function(e){this.setStart(e,0),this.setEnd(e,e.type==CKEDITOR.NODE_TEXT?e.getLength():e.getChildCount())},setStart:function(e,t){e.type==CKEDITOR.NODE_ELEMENT&&CKEDITOR.dtd.$empty[e.getName()]&&(t=e.getIndex(),e=e.getParent()),this.startContainer=e,this.startOffset=t,this.endContainer||(this.endContainer=e,this.endOffset=t),r(this)},setEnd:function(e,t){e.type==CKEDITOR.NODE_ELEMENT&&CKEDITOR.dtd.$empty[e.getName()]&&(t=e.getIndex()+1,e=e.getParent()),this.endContainer=e,this.endOffset=t,this.startContainer||(this.startContainer=e,this.startOffset=t),r(this)},setStartAfter:function(e){this.setStart(e.getParent(),e.getIndex()+1)},setStartBefore:function(e){this.setStart(e.getParent(),e.getIndex())},setEndAfter:function(e){this.setEnd(e.getParent(),e.getIndex()+1)},setEndBefore:function(e){this.setEnd(e.getParent(),e.getIndex())},setStartAt:function(e,t){switch(t){case CKEDITOR.POSITION_AFTER_START:this.setStart(e,0);break;case CKEDITOR.POSITION_BEFORE_END:e.type==CKEDITOR.NODE_TEXT?this.setStart(e,e.getLength()):this.setStart(e,e.getChildCount());break;case CKEDITOR.POSITION_BEFORE_START:this.setStartBefore(e);break;case CKEDITOR.POSITION_AFTER_END:this.setStartAfter(e)}r(this)},setEndAt:function(e,t){switch(t){case CKEDITOR.POSITION_AFTER_START:this.setEnd(e,0);break;case CKEDITOR.POSITION_BEFORE_END:e.type==CKEDITOR.NODE_TEXT?this.setEnd(e,e.getLength()):this.setEnd(e,e.getChildCount());break;case CKEDITOR.POSITION_BEFORE_START:this.setEndBefore(e);break;case CKEDITOR.POSITION_AFTER_END:this.setEndAfter(e)}r(this)},fixBlock:function(e,t){var n=this.createBookmark(),r=this.document.createElement(t);return this.collapse(e),this.enlarge(CKEDITOR.ENLARGE_BLOCK_CONTENTS),this.extractContents().appendTo(r),r.trim(),r.appendBogus(),this.insertNode(r),this.moveToBookmark(n),r},splitBlock:function(e){var t=new CKEDITOR.dom.elementPath(this.startContainer,this.root),n=new CKEDITOR.dom.elementPath(this.endContainer,this.root),r=t.block,i=n.block,s=null;return t.blockLimit.equals(n.blockLimit)?(e!="br"&&(r||(r=this.fixBlock(!0,e),i=(new CKEDITOR.dom.elementPath(this.endContainer,this.root)).block),i||(i=this.fixBlock(!1,e))),e=r&&this.checkStartOfBlock(),t=i&&this.checkEndOfBlock(),this.deleteContents(),r&&r.equals(i)&&(t?(s=new CKEDITOR.dom.elementPath(this.startContainer,this.root),this.moveToPosition(i,CKEDITOR.POSITION_AFTER_END),i=null):e?(s=new CKEDITOR.dom.elementPath(this.startContainer,this.root),this.moveToPosition(r,CKEDITOR.POSITION_BEFORE_START),r=null):(i=this.splitElement(r),r.is("ul","ol")||r.appendBogus())),{previousBlock:r,nextBlock:i,wasStartOfBlock:e,wasEndOfBlock:t,elementPath:s}):null},splitElement:function(e){if(!this.collapsed)return null;this.setEndAt(e,CKEDITOR.POSITION_BEFORE_END);var t=this.extractContents(),n=e.clone(!1);return t.appendTo(n),n.insertAfter(e),this.moveToPosition(e,CKEDITOR.POSITION_AFTER_END),n},removeEmptyBlocksAtEnd:function(){function e(e){return function(r){return t(r)||n(r)||r.type==CKEDITOR.NODE_ELEMENT&&r.isEmptyInlineRemoveable()||e.is("table")&&r.is("caption")?!1:!0}}var t=CKEDITOR.dom.walker.whitespaces(),n=CKEDITOR.dom.walker.bookmark(!1);return function(t){for(var n=this.createBookmark(),r=this[t?"endPath":"startPath"](),i=r.block||r.blockLimit,s;i&&!i.equals(r.root)&&!i.getFirst(e(i));)s=i.getParent(),this[t?"setEndAt":"setStartAt"](i,CKEDITOR.POSITION_AFTER_END),i.remove(1),i=s;this.moveToBookmark(n)}}(),startPath:function(){return new CKEDITOR.dom.elementPath(this.startContainer,this.root)},endPath:function(){return new CKEDITOR.dom.elementPath(this.endContainer,this.root)},checkBoundaryOfElement:function(e,n){var r=n==CKEDITOR.START,i=this.clone();return i.collapse(r),i[r?"setStartAt":"setEndAt"](e,r?CKEDITOR.POSITION_AFTER_START:CKEDITOR.POSITION_BEFORE_END),i=new CKEDITOR.dom.walker(i),i.evaluator=t(r),i[r?"checkBackward":"checkForward"]()},checkStartOfBlock:function(){var t=this.startContainer,n=this.startOffset;return CKEDITOR.env.ie&&n&&t.type==CKEDITOR.NODE_TEXT&&(t=CKEDITOR.tools.ltrim(t.substring(0,n)),u.test(t)&&this.trim(0,1)),this.trim(),t=new CKEDITOR.dom.elementPath(this.startContainer,this.root),n=this.clone(),n.collapse(!0),n.setStartAt(t.block||t.blockLimit,CKEDITOR.POSITION_AFTER_START),t=new CKEDITOR.dom.walker(n),t.evaluator=e(),t.checkBackward()},checkEndOfBlock:function(){var t=this.endContainer,n=this.endOffset;return CKEDITOR.env.ie&&t.type==CKEDITOR.NODE_TEXT&&(t=CKEDITOR.tools.rtrim(t.substring(n)),u.test(t)&&this.trim(1,0)),this.trim(),t=new CKEDITOR.dom.elementPath(this.endContainer,this.root),n=this.clone(),n.collapse(!1),n.setEndAt(t.block||t.blockLimit,CKEDITOR.POSITION_BEFORE_END),t=new CKEDITOR.dom.walker(n),t.evaluator=e(),t.checkForward()},getPreviousNode:function(e,t,n){var r=this.clone();return r.collapse(1),r.setStartAt(n||this.root,CKEDITOR.POSITION_AFTER_START),n=new CKEDITOR.dom.walker(r),n.evaluator=e,n.guard=t,n.previous()},getNextNode:function(e,t,n){var r=this.clone();return r.collapse(),r.setEndAt(n||this.root,CKEDITOR.POSITION_BEFORE_END),n=new CKEDITOR.dom.walker(r),n.evaluator=e,n.guard=t,n.next()},checkReadOnly:function(){function e(e,t){for(;e;){if(e.type==CKEDITOR.NODE_ELEMENT){if(e.getAttribute("contentEditable")=="false"&&!e.data("cke-editable"))return 0;if(e.is("html")||e.getAttribute("contentEditable")=="true"&&(e.contains(t)||e.equals(t)))break}e=e.getParent()}return 1}return function(){var t=this.startContainer,n=this.endContainer;return!e(t,n)||!e(n,t)}}(),moveToElementEditablePosition:function(e,t){if(e.type==CKEDITOR.NODE_ELEMENT&&!e.isEditable(!1))return this.moveToPosition(e,t?CKEDITOR.POSITION_AFTER_END:CKEDITOR.POSITION_BEFORE_START),!0;for(var n=0;e;){if(e.type==CKEDITOR.NODE_TEXT){t&&this.endContainer&&this.checkEndOfBlock()&&u.test(e.getText())?this.moveToPosition(e,CKEDITOR.POSITION_BEFORE_START):this.moveToPosition(e,t?CKEDITOR.POSITION_AFTER_END:CKEDITOR.POSITION_BEFORE_START),n=1;break}if(e.type==CKEDITOR.NODE_ELEMENT)if(e.isEditable())this.moveToPosition(e,t?CKEDITOR.POSITION_BEFORE_END:CKEDITOR.POSITION_AFTER_START),n=1;else if(t&&e.is("br")&&this.endContainer&&this.checkEndOfBlock())this.moveToPosition(e,CKEDITOR.POSITION_BEFORE_START);else if(e.getAttribute("contenteditable")=="false"&&e.is(CKEDITOR.dtd.$block))return this.setStartBefore(e),this.setEndAfter(e),!0;var r=e,i=n,s=void 0;r.type==CKEDITOR.NODE_ELEMENT&&r.isEditable(!1)&&(s=r[t?"getLast":"getFirst"](f)),!i&&!s&&(s=r[t?"getPrevious":"getNext"](f)),e=s}return!!n},moveToClosestEditablePosition:function(e,t){var n=new CKEDITOR.dom.range(this.root),r=0,i,s=[CKEDITOR.POSITION_AFTER_END,CKEDITOR.POSITION_BEFORE_START];n.moveToPosition(e,s[t?0:1]);if(e.is(CKEDITOR.dtd.$block)){if(i=n[t?"getNextEditableNode":"getPreviousEditableNode"]())r=1,i.type==CKEDITOR.NODE_ELEMENT&&i.is(CKEDITOR.dtd.$block)&&i.getAttribute("contenteditable")=="false"?(n.setStartAt(i,CKEDITOR.POSITION_BEFORE_START),n.setEndAt(i,CKEDITOR.POSITION_AFTER_END)):n.moveToPosition(i,s[t?1:0])}else r=1;return r&&this.moveToRange(n),!!r},moveToElementEditStart:function(e){return this.moveToElementEditablePosition(e)},moveToElementEditEnd:function(e){return this.moveToElementEditablePosition(e,!0)},getEnclosedNode:function(){var e=this.clone();e.optimize();if(e.startContainer.type!=CKEDITOR.NODE_ELEMENT||e.endContainer.type!=CKEDITOR.NODE_ELEMENT)return null;var e=new CKEDITOR.dom.walker(e),t=CKEDITOR.dom.walker.bookmark(!1,!0),n=CKEDITOR.dom.walker.whitespaces(!0);e.evaluator=function(e){return n(e)&&t(e)};var r=e.next();return e.reset(),r&&r.equals(e.previous())?r:null},getTouchedStartNode:function(){var e=this.startContainer;return this.collapsed||e.type!=CKEDITOR.NODE_ELEMENT?e:e.getChild(this.startOffset)||e},getTouchedEndNode:function(){var e=this.endContainer;return this.collapsed||e.type!=CKEDITOR.NODE_ELEMENT?e:e.getChild(this.endOffset-1)||e},getNextEditableNode:n(),getPreviousEditableNode:n(1),scrollIntoView:function(){var e=new CKEDITOR.dom.element.createFromHtml("<span>&nbsp;</span>",this.document),t,n,r,i=this.clone();i.optimize(),(r=i.startContainer.type==CKEDITOR.NODE_TEXT)?(n=i.startContainer.getText(),t=i.startContainer.split(i.startOffset),e.insertAfter(i.startContainer)):i.insertNode(e),e.scrollIntoView(),r&&(i.startContainer.setText(n),t.remove()),e.remove()}}}(),CKEDITOR.POSITION_AFTER_START=1,CKEDITOR.POSITION_BEFORE_END=2,CKEDITOR.POSITION_BEFORE_START=3,CKEDITOR.POSITION_AFTER_END=4,CKEDITOR.ENLARGE_ELEMENT=1,CKEDITOR.ENLARGE_BLOCK_CONTENTS=2,CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS=3,CKEDITOR.ENLARGE_INLINE=4,CKEDITOR.START=1,CKEDITOR.END=2,CKEDITOR.SHRINK_ELEMENT=1,CKEDITOR.SHRINK_TEXT=2,"use strict",function(){function e(e){arguments.length<1||(this.range=e,this.forceBrBreak=0,this.enlargeBr=1,this.enforceRealBlocks=0,this._||(this._={}))}function t(e,t,n){for(e=e.getNextSourceNode(t,null,n);!o(e);)e=e.getNextSourceNode(t,null,n);return e}function n(e){var t=[];return e.forEach(function(e){if(e.getAttribute("contenteditable")=="true")return t.push(e),!1},CKEDITOR.NODE_ELEMENT,!0),t}function r(e,t,i,s){e:{s==void 0&&(s=n(i));for(var o;o=s.shift();)if(o.getDtd().p){s={element:o,remaining:s};break e}s=null}return s?(o=CKEDITOR.filter.instances[s.element.data("cke-filter")])&&!o.check(t)?r(e,t,i,s.remaining):(t=new CKEDITOR.dom.range(s.element),t.selectNodeContents(s.element),t=t.createIterator(),t.enlargeBr=e.enlargeBr,t.enforceRealBlocks=e.enforceRealBlocks,t.activeFilter=t.filter=o,e._.nestedEditable={element:s.element,container:i,remaining:s.remaining,iterator:t},1):0}function i(e,t,n){return t?(e=e.clone(),e.collapse(!n),e.checkBoundaryOfElement(t,n?CKEDITOR.START:CKEDITOR.END)):!1}var s=/^[\r\n\t ]+$/,o=CKEDITOR.dom.walker.bookmark(!1,!0),u=CKEDITOR.dom.walker.whitespaces(!0),a=function(e){return o(e)&&u(e)},f={dd:1,dt:1,li:1};e.prototype={getNextParagraph:function(e){var n,u,p,v,m,e=e||"p";if(this._.nestedEditable){if(n=this._.nestedEditable.iterator.getNextParagraph(e))return this.activeFilter=this._.nestedEditable.iterator.activeFilter,n;this.activeFilter=this.filter;if(r(this,e,this._.nestedEditable.container,this._.nestedEditable.remaining))return this.activeFilter=this._.nestedEditable.iterator.activeFilter,this._.nestedEditable.iterator.getNextParagraph(e);this._.nestedEditable=null}if(!this.range.root.getDtd()[e])return null;if(!this._.started){var y=this.range.clone();u=y.startPath();var b=y.endPath(),w=!y.collapsed&&i(y,u.block),E=!y.collapsed&&i(y,b.block,1);y.shrink(CKEDITOR.SHRINK_ELEMENT,!0),w&&y.setStartAt(u.block,CKEDITOR.POSITION_BEFORE_END),E&&y.setEndAt(b.block,CKEDITOR.POSITION_AFTER_START),u=y.endContainer.hasAscendant("pre",!0)||y.startContainer.hasAscendant("pre",!0),y.enlarge(this.forceBrBreak&&!u||!this.enlargeBr?CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS:CKEDITOR.ENLARGE_BLOCK_CONTENTS);if(!y.collapsed){u=new CKEDITOR.dom.walker(y.clone()),b=CKEDITOR.dom.walker.bookmark(!0,!0),u.evaluator=b,this._.nextNode=u.next(),u=new CKEDITOR.dom.walker(y.clone()),u.evaluator=b,u=u.previous(),this._.lastNode=u.getNextSourceNode(!0),this._.lastNode&&this._.lastNode.type==CKEDITOR.NODE_TEXT&&!CKEDITOR.tools.trim(this._.lastNode.getText())&&this._.lastNode.getParent().isBlockBoundary()&&(b=this.range.clone(),b.moveToPosition(this._.lastNode,CKEDITOR.POSITION_AFTER_END),b.checkEndOfBlock()&&(b=new CKEDITOR.dom.elementPath(b.endContainer,b.root),this._.lastNode=(b.block||b.blockLimit).getNextSourceNode(!0)));if(!this._.lastNode||!y.root.contains(this._.lastNode))this._.lastNode=this._.docEndMarker=y.document.createText(""),this._.lastNode.insertAfter(u);y=null}this._.started=1,u=y}b=this._.nextNode,y=this._.lastNode;for(this._.nextNode=null;b;){var w=0,E=b.hasAscendant("pre"),S=b.type!=CKEDITOR.NODE_ELEMENT,x=0;if(S)b.type==CKEDITOR.NODE_TEXT&&s.test(b.getText())&&(S=0);else{var T=b.getName();if(CKEDITOR.dtd.$block[T]&&b.getAttribute("contenteditable")=="false"){n=b,r(this,e,n);break}if(b.isBlockBoundary(this.forceBrBreak&&!E&&{br:1})){if(T=="br")S=1;else if(!u&&!b.getChildCount()&&T!="hr"){n=b,p=b.equals(y);break}u&&(u.setEndAt(b,CKEDITOR.POSITION_BEFORE_START),T!="br"&&(this._.nextNode=b)),w=1}else{if(b.getFirst()){u||(u=this.range.clone(),u.setStartAt(b,CKEDITOR.POSITION_BEFORE_START)),b=b.getFirst();continue}S=1}}S&&!u&&(u=this.range.clone(),u.setStartAt(b,CKEDITOR.POSITION_BEFORE_START)),p=(!w||S)&&b.equals(y);if(u&&!w)for(;!b.getNext(a)&&!p;){T=b.getParent();if(T.isBlockBoundary(this.forceBrBreak&&!E&&{br:1})){w=1,S=0,p||T.equals(y),u.setEndAt(T,CKEDITOR.POSITION_BEFORE_END);break}b=T,S=1,p=b.equals(y),x=1}S&&u.setEndAt(b,CKEDITOR.POSITION_AFTER_END),b=t(b,x,y);if((p=!b)||w&&u)break}if(!n){if(!u)return this._.docEndMarker&&this._.docEndMarker.remove(),this._.nextNode=null;n=new CKEDITOR.dom.elementPath(u.startContainer,u.root),b=n.blockLimit,w={div:1,th:1,td:1},n=n.block;if(!n&&b&&!this.enforceRealBlocks&&w[b.getName()]&&u.checkStartOfBlock()&&u.checkEndOfBlock()&&!b.equals(u.root))n=b;else if(!n||this.enforceRealBlocks&&n.is(f))n=this.range.document.createElement(e),u.extractContents().appendTo(n),n.trim(),u.insertNode(n),v=m=!0;else if(n.getName()!="li"){if(!u.checkStartOfBlock()||!u.checkEndOfBlock())n=n.clone(!1),u.extractContents().appendTo(n),n.trim(),m=u.splitBlock(),v=!m.wasStartOfBlock,m=!m.wasEndOfBlock,u.insertNode(n)}else p||(this._.nextNode=n.equals(y)?null:t(u.getBoundaryNodes().endNode,1,y))}return v&&(v=n.getPrevious())&&v.type==CKEDITOR.NODE_ELEMENT&&(v.getName()=="br"?v.remove():v.getLast()&&v.getLast().$.nodeName.toLowerCase()=="br"&&v.getLast().remove()),m&&(v=n.getLast())&&v.type==CKEDITOR.NODE_ELEMENT&&v.getName()=="br"&&(!CKEDITOR.env.needsBrFiller||v.getPrevious(o)||v.getNext(o))&&v.remove(),this._.nextNode||(this._.nextNode=p||n.equals(y)||!y?null:t(n,1,y)),n}},CKEDITOR.dom.range.prototype.createIterator=function(){return new e(this)}}(),CKEDITOR.command=function(e,t){this.uiItems=[],this.exec=function(n){return this.state==CKEDITOR.TRISTATE_DISABLED||!this.checkAllowed()?!1:(this.editorFocus&&e.focus(),this.fire("exec")===!1?!0:t.exec.call(this,e,n)!==!1)},this.refresh=function(e,n){return!this.readOnly&&e.readOnly?!0:this.context&&!n.isContextFor(this.context)?(this.disable(),!0):this.checkAllowed(!0)?(this.startDisabled||this.enable(),this.modes&&!this.modes[e.mode]&&this.disable(),this.fire("refresh",{editor:e,path:n})===!1?!0:t.refresh&&t.refresh.apply(this,arguments)!==!1):(this.disable(),!0)};var n;this.checkAllowed=function(t){return!t&&typeof n=="boolean"?n:n=e.activeFilter.checkFeature(this)},CKEDITOR.tools.extend(this,t,{modes:{wysiwyg:1},editorFocus:1,contextSensitive:!!t.context,state:CKEDITOR.TRISTATE_DISABLED}),CKEDITOR.event.call(this)},CKEDITOR.command.prototype={enable:function(){this.state==CKEDITOR.TRISTATE_DISABLED&&this.checkAllowed()&&this.setState(!this.preserveState||typeof this.previousState=="undefined"?CKEDITOR.TRISTATE_OFF:this.previousState)},disable:function(){this.setState(CKEDITOR.TRISTATE_DISABLED)},setState:function(e){return this.state==e||e!=CKEDITOR.TRISTATE_DISABLED&&!this.checkAllowed()?!1:(this.previousState=this.state,this.state=e,this.fire("state"),!0)},toggleState:function(){this.state==CKEDITOR.TRISTATE_OFF?this.setState(CKEDITOR.TRISTATE_ON):this.state==CKEDITOR.TRISTATE_ON&&this.setState(CKEDITOR.TRISTATE_OFF)}},CKEDITOR.event.implementOn(CKEDITOR.command.prototype),CKEDITOR.ENTER_P=1,CKEDITOR.ENTER_BR=2,CKEDITOR.ENTER_DIV=3,CKEDITOR.config={customConfig:"config.js",autoUpdateElement:!0,language:"",defaultLanguage:"en",contentsLangDirection:"",enterMode:CKEDITOR.ENTER_P,forceEnterMode:!1,shiftEnterMode:CKEDITOR.ENTER_BR,docType:"<!DOCTYPE html>",bodyId:"",bodyClass:"",fullPage:!1,height:200,extraPlugins:"",removePlugins:"",protectedSource:[],tabIndex:0,width:"",baseFloatZIndex:1e4,blockedKeystrokes:[CKEDITOR.CTRL+66,CKEDITOR.CTRL+73,CKEDITOR.CTRL+85]},function(){function e(e,t,n,r,i){var s,u,e=[];for(s in t){u=t[s],u=typeof u=="boolean"?{}:typeof u=="function"?{match:u}:L(u),s.charAt(0)!="$"&&(u.elements=s),n&&(u.featureName=n.toLowerCase());var a=u;a.elements=o(a.elements,/\s+/)||null,a.propertiesOnly=a.propertiesOnly||a.elements===!0;var f=/\s*,\s*/,l=void 0;for(l in _){a[l]=o(a[l],f)||null;var c=a,h=D[l],p=o(a[D[l]],f),d=a[l],v=[],m=!0,y=void 0;p?m=!1:p={};for(y in d)y.charAt(0)=="!"&&(y=y.slice(1),v.push(y),p[y]=!0,m=!1);for(;y=v.pop();)d[y]=d["!"+y],delete d["!"+y];c[h]=(m?!1:p)||null}a.match=a.match||null,r.push(u),e.push(u)}for(var t=i.elements,i=i.generic,b,n=0,r=e.length;n<r;++n){s=L(e[n]),u=s.classes===!0||s.styles===!0||s.attributes===!0,a=s,l=h=f=void 0;for(f in _)a[f]=g(a[f]);c=!0;for(l in D){f=D[l],h=a[f],p=[],d=void 0;for(d in h)d.indexOf("*")>-1?p.push(RegExp("^"+d.replace(/\*/g,".*")+"$")):p.push(d);h=p,h.length&&(a[f]=h,c=!1)}a.nothingRequired=c,a.noProperties=!(a.attributes||a.classes||a.styles);if(s.elements===!0||s.elements===null)i[u?"unshift":"push"](s);else{a=s.elements,delete s.elements;for(b in a)t[b]?t[b][u?"unshift":"push"](s):t[b]=[s]}}}function t(e,t,r,i){if(!e.match||e.match(t))if(i||u(e,t)){e.propertiesOnly||(r.valid=!0),r.allAttributes||(r.allAttributes=n(e.attributes,t.attributes,r.validAttributes)),r.allStyles||(r.allStyles=n(e.styles,t.styles,r.validStyles));if(!r.allClasses){e=e.classes,t=t.classes,i=r.validClasses;if(e)if(e===!0)e=!0;else{for(var s=0,o=t.length,a;s<o;++s)a=t[s],i[a]||(i[a]=e(a));e=!1}else e=!1;r.allClasses=e}}}function n(e,t,n){if(!e)return!1;if(e===!0)return!0;for(var r in t)n[r]||(n[r]=e(r));return!1}function r(e,t,n){if(!e.match||e.match(t)){if(e.noProperties)return!1;n.hadInvalidAttribute=i(e.attributes,t.attributes)||n.hadInvalidAttribute,n.hadInvalidStyle=i(e.styles,t.styles)||n.hadInvalidStyle,e=e.classes,t=t.classes;if(e){for(var r=!1,s=e===!0,o=t.length;o--;)if(s||e(t[o]))t.splice(o,1),r=!0;e=r}else e=!1;n.hadInvalidClass=e||n.hadInvalidClass}}function i(e,t){if(!e)return!1;var n=!1,r=e===!0,i;for(i in t)if(r||e(i))delete t[i],n=!0;return n}function s(e,t,n){return e.disabled||e.customConfig&&!n||!t?!1:(e._.cachedChecks={},!0)}function o(e,t){if(!e)return!1;if(e===!0)return e;if(typeof e=="string")return e=A(e),e=="*"?!0:CKEDITOR.tools.convertArrayToObject(e.split(t));if(CKEDITOR.tools.isArray(e))return e.length?CKEDITOR.tools.convertArrayToObject(e):!1;var n={},r=0,i;for(i in e)n[i]=e[i],r++;return r?n:!1}function u(e,t){if(e.nothingRequired)return!0;var n,r,i,s;if(i=e.requiredClasses){s=t.classes;for(n=0;n<i.length;++n){r=i[n];if(typeof r=="string"){if(CKEDITOR.tools.indexOf(s,r)==-1)return!1}else if(!CKEDITOR.tools.checkIfAnyArrayItemMatches(s,r))return!1}}return a(t.styles,e.requiredStyles)&&a(t.attributes,e.requiredAttributes)}function a(e,t){if(!t)return!0;for(var n=0,r;n<t.length;++n){r=t[n];if(typeof r=="string"){if(!(r in e))return!1}else if(!CKEDITOR.tools.checkIfAnyObjectPropertyMatches(e,r))return!1}return!0}function f(e){if(!e)return{};for(var e=e.split(/\s*,\s*/).sort(),t={};e.length;)t[e.shift()]=O;return t}function l(e){for(var t,n,r,i,s={},o=1,e=A(e);t=e.match(P);)(n=t[2])?(r=c(n,"styles"),i=c(n,"attrs"),n=c(n,"classes")):r=i=n=null,s["$"+o++]={elements:t[1],classes:n,styles:r,attributes:i},e=e.slice(t[0].length);return s}function c(e,t){var n=e.match(H[t]);return n?A(n[1]):null}function h(e){var t=e.styleBackup=e.attributes.style,n=e.classBackup=e.attributes["class"];e.styles||(e.styles=CKEDITOR.tools.parseCssText(t||"",1)),e.classes||(e.classes=n?n.split(/\s+/):[])}function p(e,n,i,s){var o=0,u;s.toHtml&&(n.name=n.name.replace(B,"$1"));if(s.doCallbacks&&e.elementCallbacks){e:for(var a=e.elementCallbacks,f=0,l=a.length,c;f<l;++f)if(c=a[f](n)){u=c;break e}if(u)return u}if(s.doTransform)if(u=e._.transformations[n.name]){h(n);for(a=0;a<u.length;++a)E(e,n,u[a]);v(n)}if(s.doFilter){e:{a=n.name,f=e._,e=f.allowedRules.elements[a],u=f.allowedRules.generic,a=f.disallowedRules.elements[a],f=f.disallowedRules.generic,l=s.skipRequired,c={valid:!1,validAttributes:{},validClasses:{},validStyles:{},allAttributes:!1,allClasses:!1,allStyles:!1,hadInvalidAttribute:!1,hadInvalidClass:!1,hadInvalidStyle:!1};var p,d;if(!e&&!u)e=null;else{h(n);if(a){p=0;for(d=a.length;p<d;++p)if(r(a[p],n,c)===!1){e=null;break e}}if(f){p=0;for(d=f.length;p<d;++p)r(f[p],n,c)}if(e){p=0;for(d=e.length;p<d;++p)t(e[p],n,c,l)}if(u){p=0;for(d=u.length;p<d;++p)t(u[p],n,c,l)}e=c}}if(!e)return i.push(n),k;if(!e.valid)return i.push(n),k;d=e.validAttributes;var g=e.validStyles;u=e.validClasses;var a=n.attributes,y=n.styles,f=n.classes,l=n.classBackup,b=n.styleBackup,w,S,x=[];c=[];var T=/^data-cke-/;p=!1,delete a.style,delete a["class"],delete n.classBackup,delete n.styleBackup;if(!e.allAttributes)for(w in a)d[w]||(T.test(w)?w!=(S=w.replace(/^data-cke-saved-/,""))&&!d[S]&&(delete a[w],p=!0):(delete a[w],p=!0));if(!e.allStyles||e.hadInvalidStyle){for(w in y)e.allStyles||g[w]?x.push(w+":"+y[w]):p=!0;x.length&&(a.style=x.sort().join("; "))}else b&&(a.style=b);if(!e.allClasses||e.hadInvalidClass){for(w=0;w<f.length;++w)(e.allClasses||u[f[w]])&&c.push(f[w]);c.length&&(a["class"]=c.sort().join(" ")),l&&c.length<l.split(/\s+/).length&&(p=!0)}else l&&(a["class"]=l);p&&(o=k);if(!s.skipFinalValidation&&!m(n))return i.push(n),k}return s.toHtml&&(n.name=n.name.replace(j,"cke:$1")),o}function d(e){var t=[],n;for(n in e)n.indexOf("*")>-1&&t.push(n.replace(/\*/g,".*"));return t.length?RegExp("^(?:"+t.join("|")+")$"):null}function v(e){var t=e.attributes,n;delete t.style,delete t["class"];if(n=CKEDITOR.tools.writeCssText(e.styles,!0))t.style=n;e.classes.length&&(t["class"]=e.classes.sort().join(" "))}function m(e){switch(e.name){case"a":if(!e.children.length&&!e.attributes.name)return!1;break;case"img":if(!e.attributes.src)return!1}return!0}function g(e){if(!e)return!1;if(e===!0)return!0;var t=d(e);return function(n){return n in e||t&&n.match(t)}}function y(){return new CKEDITOR.htmlParser.element("br")}function b(e){return e.type==CKEDITOR.NODE_ELEMENT&&(e.name=="br"||C.$block[e.name])}function w(e,t,n){var r=e.name;if(C.$empty[r]||!e.children.length)r=="hr"&&t=="br"?e.replaceWith(y()):(e.parent&&n.push({check:"it",el:e.parent}),e.remove());else if(C.$block[r]||r=="tr")if(t=="br")e.previous&&!b(e.previous)&&(t=y(),t.insertBefore(e)),e.next&&!b(e.next)&&(t=y(),t.insertAfter(e)),e.replaceWithChildren();else{var r=e.children,i;e:{i=C[t];for(var s=0,o=r.length,u;s<o;++s){u=r[s];if(u.type==CKEDITOR.NODE_ELEMENT&&!i[u.name]){i=!1;break e}}i=!0}if(i)e.name=t,e.attributes={},n.push({check:"parent-down",el:e});else{i=e.parent;for(var s=i.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT||i.name=="body",a,o=r.length;o>0;)u=r[--o],s&&(u.type==CKEDITOR.NODE_TEXT||u.type==CKEDITOR.NODE_ELEMENT&&C.$inline[u.name])?(a||(a=new CKEDITOR.htmlParser.element(t),a.insertAfter(e),n.push({check:"parent-down",el:a})),a.add(u,0)):(a=null,u.insertAfter(e),i.type!=CKEDITOR.NODE_DOCUMENT_FRAGMENT&&u.type==CKEDITOR.NODE_ELEMENT&&!C[i.name][u.name]&&n.push({check:"el-up",el:u}));e.remove()}}else r=="style"?e.remove():(e.parent&&n.push({check:"it",el:e.parent}),e.replaceWithChildren())}function E(e,t,n){var r,i;for(r=0;r<n.length;++r){i=n[r];if((!i.check||e.check(i.check,!1))&&(!i.left||i.left(t))){i.right(t,F);break}}}function S(e,t){var n=t.getDefinition(),r=n.attributes,i=n.styles,s,o,u,a;if(e.name!=n.element)return!1;for(s in r)if(s=="class"){n=r[s].split(/\s+/);for(u=e.classes.join("|");a=n.pop();)if(u.indexOf(a)==-1)return!1}else if(e.attributes[s]!=r[s])return!1;for(o in i)if(e.styles[o]!=i[o])return!1;return!0}function x(e,t){var n,r;return typeof e=="string"?n=e:e instanceof CKEDITOR.style?r=e:(n=e[0],r=e[1]),[{element:n,left:r,right:function(e,n){n.transform(e,t)}}]}function T(e){return function(t){return S(t,e)}}function N(e){return function(t,n){n[e](t)}}var C=CKEDITOR.dtd,k=1,L=CKEDITOR.tools.copy,A=CKEDITOR.tools.trim,O="cke-test",M=["","p","br","div"];CKEDITOR.FILTER_SKIP_TREE=2,CKEDITOR.filter=function(e){this.allowedContent=[],this.disallowedContent=[],this.elementCallbacks=null,this.disabled=!1,this.editor=null,this.id=CKEDITOR.tools.getNextNumber(),this._={allowedRules:{elements:{},generic:[]},disallowedRules:{elements:{},generic:[]},transformations:{},cachedTests:{}},CKEDITOR.filter.instances[this.id]=this;if(e instanceof CKEDITOR.editor){e=this.editor=e,this.customConfig=!0;var t=e.config.allowedContent;t===!0?this.disabled=!0:(t||(this.customConfig=!1),this.allow(t,"config",1),this.allow(e.config.extraAllowedContent,"extra",1),this.allow(M[e.enterMode]+" "+M[e.shiftEnterMode],"default",1),this.disallow(e.config.disallowedContent))}else this.customConfig=!1,this.allow(e,"default",1)},CKEDITOR.filter.instances={},CKEDITOR.filter.prototype={allow:function(t,n,r){if(!s(this,t,r))return!1;var i,o;if(typeof t=="string")t=l(t);else if(t instanceof CKEDITOR.style){if(t.toAllowedContentRules)return this.allow(t.toAllowedContentRules(this.editor),n,r);i=t.getDefinition(),t={},r=i.attributes,t[i.element]=i={styles:i.styles,requiredStyles:i.styles&&CKEDITOR.tools.objectKeys(i.styles)},r&&(r=L(r),i.classes=r["class"]?r["class"].split(/\s+/):null,i.requiredClasses=i.classes,delete r["class"],i.attributes=r,i.requiredAttributes=r&&CKEDITOR.tools.objectKeys(r))}else if(CKEDITOR.tools.isArray(t)){for(i=0;i<t.length;++i)o=this.allow(t[i],n,r);return o}return e(this,t,n,this.allowedContent,this._.allowedRules),!0},applyTo:function(e,t,n,r){if(this.disabled)return!1;var i=this,s=[],o=this.editor&&this.editor.config.protectedSource,u,a=!1,f={doFilter:!n,doTransform:!0,doCallbacks:!0,toHtml:t};e.forEach(function(e){if(e.type==CKEDITOR.NODE_ELEMENT){if(e.attributes["data-cke-filter"]=="off")return!1;if(!t||e.name!="span"||!~CKEDITOR.tools.objectKeys(e.attributes).join("|").indexOf("data-cke-")){u=p(i,e,s,f);if(u&k)a=!0;else if(u&2)return!1}}else if(e.type==CKEDITOR.NODE_COMMENT&&e.value.match(/^\{cke_protected\}(?!\{C\})/)){var n;e:{var r=decodeURIComponent(e.value.replace(/^\{cke_protected\}/,""));n=[];var l,c,h;if(o)for(c=0;c<o.length;++c)if((h=r.match(o[c]))&&h[0].length==r.length){n=!0;break e}r=CKEDITOR.htmlParser.fragment.fromHtml(r),r.children.length==1&&(l=r.children[0]).type==CKEDITOR.NODE_ELEMENT&&p(i,l,n,f),n=!n.length}n||s.push(e)}},null,!0),s.length&&(a=!0);for(var l,e=[],r=M[r||(this.editor?this.editor.enterMode:CKEDITOR.ENTER_P)];n=s.pop();)n.type==CKEDITOR.NODE_ELEMENT?w(n,r,e):n.remove();for(;l=e.pop();){n=l.el;if(n.parent)switch(l.check){case"it":C.$removeEmpty[n.name]&&!n.children.length?w(n,r,e):m(n)||w(n,r,e);break;case"el-up":n.parent.type!=CKEDITOR.NODE_DOCUMENT_FRAGMENT&&!C[n.parent.name][n.name]&&w(n,r,e);break;case"parent-down":n.parent.type!=CKEDITOR.NODE_DOCUMENT_FRAGMENT&&!C[n.parent.name][n.name]&&w(n.parent,r,e)}}return a},checkFeature:function(e){return this.disabled||!e?!0:(e.toFeature&&(e=e.toFeature(this.editor)),!e.requiredContent||this.check(e.requiredContent))},disable:function(){this.disabled=!0},disallow:function(t){return s(this,t,!0)?(typeof t=="string"&&(t=l(t)),e(this,t,null,this.disallowedContent,this._.disallowedRules),!0):!1},addContentForms:function(e){if(!this.disabled&&e){var t,n,r=[],i;for(t=0;t<e.length&&!i;++t)n=e[t],(typeof n=="string"||n instanceof CKEDITOR.style)&&this.check(n)&&(i=n);if(i){for(t=0;t<e.length;++t)r.push(x(e[t],i));this.addTransformations(r)}}},addElementCallback:function(e){this.elementCallbacks||(this.elementCallbacks=[]),this.elementCallbacks.push(e)},addFeature:function(e){return this.disabled||!e?!0:(e.toFeature&&(e=e.toFeature(this.editor)),this.allow(e.allowedContent,e.name),this.addTransformations(e.contentTransformations),this.addContentForms(e.contentForms),e.requiredContent&&(this.customConfig||this.disallowedContent.length)?this.check(e.requiredContent):!0)},addTransformations:function(e){var t,n;if(!this.disabled&&e){var r=this._.transformations,i;for(i=0;i<e.length;++i){t=e[i];var s=void 0,o=void 0,u=void 0,a=void 0,f=void 0,l=void 0;n=[];for(o=0;o<t.length;++o)u=t[o],typeof u=="string"?(u=u.split(/\s*:\s*/),a=u[0],f=null,l=u[1]):(a=u.check,f=u.left,l=u.right),s||(s=u,s=s.element?s.element:a?a.match(/^([a-z0-9]+)/i)[0]:s.left.getDefinition().element),f instanceof CKEDITOR.style&&(f=T(f)),n.push({check:a==s?null:a,left:f,right:typeof l=="string"?N(l):l});t=s,r[t]||(r[t]=[]),r[t].push(n)}}},check:function(e,t,n){if(this.disabled)return!0;if(CKEDITOR.tools.isArray(e)){for(var r=e.length;r--;)if(this.check(e[r],t,n))return!0;return!1}var i,s;if(typeof e=="string"){s=e+"<"+(t===!1?"0":"1")+(n?"1":"0")+">";if(s in this._.cachedChecks)return this._.cachedChecks[s];r=l(e).$1,i=r.styles;var o=r.classes;r.name=r.elements,r.classes=o=o?o.split(/\s*,\s*/):[],r.styles=f(i),r.attributes=f(r.attributes),r.children=[],o.length&&(r.attributes["class"]=o.join(" ")),i&&(r.attributes.style=CKEDITOR.tools.writeCssText(r.styles)),i=r}else r=e.getDefinition(),i=r.styles,o=r.attributes||{},i?(i=L(i),o.style=CKEDITOR.tools.writeCssText(i,!0)):i={},i={name:r.element,attributes:o,classes:o["class"]?o["class"].split(/\s+/):[],styles:i,children:[]};var o=CKEDITOR.tools.clone(i),u=[],a;if(t!==!1&&(a=this._.transformations[i.name])){for(r=0;r<a.length;++r)E(this,i,a[r]);v(i)}return p(this,o,u,{doFilter:!0,doTransform:t!==!1,skipRequired:!n,skipFinalValidation:!n}),t=u.length>0?!1:CKEDITOR.tools.objectCompare(i.attributes,o.attributes,!0)?!0:!1,typeof e=="string"&&(this._.cachedChecks[s]=t),t},getAllowedEnterMode:function(){var e=["p","div","br"],t={p:CKEDITOR.ENTER_P,div:CKEDITOR.ENTER_DIV,br:CKEDITOR.ENTER_BR};return function(n,r){var i=e.slice(),s;if(this.check(M[n]))return n;for(r||(i=i.reverse());s=i.pop();)if(this.check(s))return t[s];return CKEDITOR.ENTER_BR}}()};var _={styles:1,attributes:1,classes:1},D={styles:"requiredStyles",attributes:"requiredAttributes",classes:"requiredClasses"},P=/^([a-z0-9*\s]+)((?:\s*\{[!\w\-,\s\*]+\}\s*|\s*\[[!\w\-,\s\*]+\]\s*|\s*\([!\w\-,\s\*]+\)\s*){0,3})(?:;\s*|$)/i,H={styles:/{([^}]+)}/,attrs:/\[([^\]]+)\]/,classes:/\(([^\)]+)\)/},B=/^cke:(object|embed|param)$/,j=/^(object|embed|param)$/,F=CKEDITOR.filter.transformationsTools={sizeToStyle:function(e){this.lengthToStyle(e,"width"),this.lengthToStyle(e,"height")},sizeToAttribute:function(e){this.lengthToAttribute(e,"width"),this.lengthToAttribute(e,"height")},lengthToStyle:function(e,t,n){n=n||t;if(!(n in e.styles)){var r=e.attributes[t];r&&(/^\d+$/.test(r)&&(r+="px"),e.styles[n]=r)}delete e.attributes[t]},lengthToAttribute:function(e,t,n){n=n||t;if(!(n in e.attributes)){var r=e.styles[t],i=r&&r.match(/^(\d+)(?:\.\d*)?px$/);i?e.attributes[n]=i[1]:r==O&&(e.attributes[n]=O)}delete e.styles[t]},alignmentToStyle:function(e){if(!("float"in e.styles)){var t=e.attributes.align;if(t=="left"||t=="right")e.styles["float"]=t}delete e.attributes.align},alignmentToAttribute:function(e){if(!("align"in e.attributes)){var t=e.styles["float"];if(t=="left"||t=="right")e.attributes.align=t}delete e.styles["float"]},matchesStyle:S,transform:function(e,t){if(typeof t=="string")e.name=t;else{var n=t.getDefinition(),r=n.styles,i=n.attributes,s,o,u,a;e.name=n.element;for(s in i)if(s=="class"){n=e.classes.join("|");for(u=i[s].split(/\s+/);a=u.pop();)n.indexOf(a)==-1&&e.classes.push(a)}else e.attributes[s]=i[s];for(o in r)e.styles[o]=r[o]}}}}(),function(){CKEDITOR.focusManager=function(e){return e.focusManager?e.focusManager:(this.hasFocus=!1,this.currentActive=null,this._={editor:e},this)},CKEDITOR.focusManager._={blurDelay:200},CKEDITOR.focusManager.prototype={focus:function(e){this._.timer&&clearTimeout(this._.timer),e&&(this.currentActive=e),!this.hasFocus&&!this._.locked&&((e=CKEDITOR.currentInstance)&&e.focusManager.blur(1),this.hasFocus=!0,(e=this._.editor.container)&&e.addClass("cke_focus"),this._.editor.fire("focus"))},lock:function(){this._.locked=1},unlock:function(){delete this._.locked},blur:function(e){function t(){if(this.hasFocus){this.hasFocus=!1;var e=this._.editor.container;e&&e.removeClass("cke_focus"),this._.editor.fire("blur")}}if(!this._.locked){this._.timer&&clearTimeout(this._.timer);var n=CKEDITOR.focusManager._.blurDelay;e||!n?t.call(this):this._.timer=CKEDITOR.tools.setTimeout(function(){delete this._.timer,t.call(this)},n,this)}},add:function(e,t){var n=e.getCustomData("focusmanager");if(!n||n!=this){n&&n.remove(e);var n="focus",r="blur";t&&(CKEDITOR.env.ie?(n="focusin",r="focusout"):CKEDITOR.event.useCapture=1);var i={blur:function(){e.equals(this.currentActive)&&this.blur()},focus:function(){this.focus(e)}};e.on(n,i.focus,this),e.on(r,i.blur,this),t&&(CKEDITOR.event.useCapture=0),e.setCustomData("focusmanager",this),e.setCustomData("focusmanager_handlers",i)}},remove:function(e){e.removeCustomData("focusmanager");var t=e.removeCustomData("focusmanager_handlers");e.removeListener("blur",t.blur),e.removeListener("focus",t.focus)}}}(),CKEDITOR.keystrokeHandler=function(e){return e.keystrokeHandler?e.keystrokeHandler:(this.keystrokes={},this.blockedKeystrokes={},this._={editor:e},this)},function(){var e,t=function(t){var t=t.data,n=t.getKeystroke(),r=this.keystrokes[n],i=this._.editor;return e=i.fire("key",{keyCode:n,domEvent:t})===!1,e||(r&&(e=i.execCommand(r,{from:"keystrokeHandler"})!==!1),e||(e=!!this.blockedKeystrokes[n])),e&&t.preventDefault(!0),!e},n=function(t){e&&(e=!1,t.data.preventDefault(!0))};CKEDITOR.keystrokeHandler.prototype={attach:function(e){e.on("keydown",t,this),CKEDITOR.env.gecko&&CKEDITOR.env.mac&&e.on("keypress",n,this)}}}(),function(){CKEDITOR.lang={languages:{af:1,ar:1,bg:1,bn:1,bs:1,ca:1,cs:1,cy:1,da:1,de:1,el:1,"en-au":1,"en-ca":1,"en-gb":1,en:1,eo:1,es:1,et:1,eu:1,fa:1,fi:1,fo:1,"fr-ca":1,fr:1,gl:1,gu:1,he:1,hi:1,hr:1,hu:1,id:1,is:1,it:1,ja:1,ka:1,km:1,ko:1,ku:1,lt:1,lv:1,mk:1,mn:1,ms:1,nb:1,nl:1,no:1,pl:1,"pt-br":1,pt:1,ro:1,ru:1,si:1,sk:1,sl:1,sq:1,"sr-latn":1,sr:1,sv:1,th:1,tr:1,tt:1,ug:1,uk:1,vi:1,"zh-cn":1,zh:1},rtl:{ar:1,fa:1,he:1,ku:1,ug:1},load:function(e,t,n){if(!e||!CKEDITOR.lang.languages[e])e=this.detect(t,e);var r=this,t=function(){r[e].dir=r.rtl[e]?"rtl":"ltr",n(e,r[e])};this[e]?t():CKEDITOR.scriptLoader.load(CKEDITOR.getUrl("lang/"+e+".js"),t,this)},detect:function(e,t){var n=this.languages,t=t||navigator.userLanguage||navigator.language||e,r=t.toLowerCase().match(/([a-z]+)(?:-([a-z]+))?/),i=r[1],r=r[2];return n[i+"-"+r]?i=i+"-"+r:n[i]||(i=null),CKEDITOR.lang.detect=i?function(){return i}:function(e){return e},i||e}}}(),CKEDITOR.scriptLoader=function(){var e={},t={};return{load:function(n,r,i,s){var o=typeof n=="string";o&&(n=[n]),i||(i=CKEDITOR);var u=n.length,f=[],l=[],c=function(e){r&&(o?r.call(i,e):r.call(i,f,l))};if(u===0)c(!0);else{var h=function(e,t){(t?f:l).push(e),--u<=0&&(s&&CKEDITOR.document.getDocumentElement().removeStyle("cursor"),c(t))},p=function(n,r){e[n]=1;var i=t[n];delete t[n];for(var s=0;s<i.length;s++)i[s](n,r)},d=function(n){if(e[n])h(n,!0);else{var i=t[n]||(t[n]=[]);i.push(h);if(!(i.length>1)){var s=new CKEDITOR.dom.element("script");s.setAttributes({type:"text/javascript",src:n}),r&&(CKEDITOR.env.ie&&CKEDITOR.env.version<11?s.$.onreadystatechange=function(){if(s.$.readyState=="loaded"||s.$.readyState=="complete")s.$.onreadystatechange=null,p(n,!0)}:(s.$.onload=function(){setTimeout(function(){p(n,!0)},0)},s.$.onerror=function(){p(n,!1)})),s.appendTo(CKEDITOR.document.getHead())}}};s&&CKEDITOR.document.getDocumentElement().setStyle("cursor","wait");for(var v=0;v<u;v++)d(n[v])}},queue:function(){function e(){var e;(e=t[0])&&this.load(e.scriptUrl,e.callback,CKEDITOR,0)}var t=[];return function(n,r){var i=this;t.push({scriptUrl:n,callback:function(){r&&r.apply(this,arguments),t.shift(),e.call(i)}}),t.length==1&&e.call(this)}}()}}(),CKEDITOR.resourceManager=function(e,t){this.basePath=e,this.fileName=t,this.registered={},this.loaded={},this.externals={},this._={waitingList:{}}},CKEDITOR.resourceManager.prototype={add:function(e,t){if(this.registered[e])throw'[CKEDITOR.resourceManager.add] The resource name "'+e+'" is already registered.';var n=this.registered[e]=t||{};return n.name=e,n.path=this.getPath(e),CKEDITOR.fire(e+CKEDITOR.tools.capitalize(this.fileName)+"Ready",n),this.get(e)},get:function(e){return this.registered[e]||null},getPath:function(e){var t=this.externals[e];return CKEDITOR.getUrl(t&&t.dir||this.basePath+e+"/")},getFilePath:function(e){var t=this.externals[e];return CKEDITOR.getUrl(this.getPath(e)+(t?t.file:this.fileName+".js"))},addExternal:function(e,t,n){for(var e=e.split(","),r=0;r<e.length;r++){var i=e[r];n||(t=t.replace(/[^\/]+$/,function(e){return n=e,""})),this.externals[i]={dir:t,file:n||this.fileName+".js"}}},load:function(e,t,n){CKEDITOR.tools.isArray(e)||(e=e?[e]:[]);for(var r=this.loaded,i=this.registered,s=[],o={},u={},a=0;a<e.length;a++){var f=e[a];if(f)if(!r[f]&&!i[f]){var l=this.getFilePath(f);s.push(l),l in o||(o[l]=[]),o[l].push(f)}else u[f]=this.get(f)}CKEDITOR.scriptLoader.load(s,function(e,i){if(i.length)throw'[CKEDITOR.resourceManager.load] Resource name "'+o[i[0]].join(",")+'" was not found at "'+i[0]+'".';for(var s=0;s<e.length;s++)for(var a=o[e[s]],f=0;f<a.length;f++){var l=a[f];u[l]=this.get(l),r[l]=1}t.call(n,u)},this)}},CKEDITOR.plugins=new CKEDITOR.resourceManager("plugins/","plugin"),CKEDITOR.plugins.load=CKEDITOR.tools.override(CKEDITOR.plugins.load,function(e){var t={};return function(n,r,i){var s={},o=function(n){e.call(this,n,function(e){CKEDITOR.tools.extend(s,e);var n=[],u;for(u in e){var a=e[u],l=a&&a.requires;if(!t[u]){if(a.icons)for(var h=a.icons.split(","),p=h.length;p--;)CKEDITOR.skin.addIcon(h[p],a.path+"icons/"+(CKEDITOR.env.hidpi&&a.hidpi?"hidpi/":"")+h[p]+".png");t[u]=1}if(l){l.split&&(l=l.split(","));for(a=0;a<l.length;a++)s[l[a]]||n.push(l[a])}}if(n.length)o.call(this,n);else{for(u in s)a=s[u],a.onLoad&&!a.onLoad._called&&(a.onLoad()===!1&&delete s[u],a.onLoad._called=1);r&&r.call(i||window,s)}},this)};o.call(this,n)}}),CKEDITOR.plugins.setLang=function(e,t,n){var r=this.get(e),e=r.langEntries||(r.langEntries={}),r=r.lang||(r.lang=[]);r.split&&(r=r.split(",")),CKEDITOR.tools.indexOf(r,t)==-1&&r.push(t),e[t]=n},CKEDITOR.ui=function(e){return e.ui?e.ui:(this.items={},this.instances={},this.editor=e,this._={handlers:{}},this)},CKEDITOR.ui.prototype={add:function(e,t,n){n.name=e.toLowerCase();var r=this.items[e]={type:t,command:n.command||null,args:Array.prototype.slice.call(arguments,2)};CKEDITOR.tools.extend(r,n)},get:function(e){return this.instances[e]},create:function(e){var t=this.items[e],n=t&&this._.handlers[t.type],r=t&&t.command&&this.editor.getCommand(t.command),n=n&&n.create.apply(this,t.args);return this.instances[e]=n,r&&r.uiItems.push(n),n&&!n.type&&(n.type=t.type),n},addHandler:function(e,t){this._.handlers[e]=t},space:function(e){return CKEDITOR.document.getById(this.spaceId(e))},spaceId:function(e){return this.editor.id+"_"+e}},CKEDITOR.event.implementOn(CKEDITOR.ui),function(){function e(e,r,s){CKEDITOR.event.call(this),e=e&&CKEDITOR.tools.clone(e);if(r!==void 0){if(!(r instanceof CKEDITOR.dom.element))throw Error("Expect element of type CKEDITOR.dom.element.");if(!s)throw Error("One of the element modes must be specified.");if(CKEDITOR.env.ie&&CKEDITOR.env.quirks&&s==CKEDITOR.ELEMENT_MODE_INLINE)throw Error("Inline element mode is not supported on IE quirks.");if(!(s==CKEDITOR.ELEMENT_MODE_INLINE?r.is(CKEDITOR.dtd.$editable)||r.is("textarea"):s==CKEDITOR.ELEMENT_MODE_REPLACE?!r.is(CKEDITOR.dtd.$nonBodyContent):1))throw Error('The specified element mode is not supported on element: "'+r.getName()+'".');this.element=r,this.elementMode=s,this.name=this.elementMode!=CKEDITOR.ELEMENT_MODE_APPENDTO&&(r.getId()||r.getNameAtt())}else this.elementMode=CKEDITOR.ELEMENT_MODE_NONE;this._={},this.commands={},this.templates={},this.name=this.name||t(),this.id=CKEDITOR.tools.getNextId(),this.status="unloaded",this.config=CKEDITOR.tools.prototypedCopy(CKEDITOR.config),this.ui=new CKEDITOR.ui(this),this.focusManager=new CKEDITOR.focusManager(this),this.keystrokeHandler=new CKEDITOR.keystrokeHandler(this),this.on("readOnly",n),this.on("selectionChange",function(e){i(this,e.data.path)}),this.on("activeFilterChange",function(){i(this,this.elementPath(),!0)}),this.on("mode",n),this.on("instanceReady",function(){this.config.startupFocus&&this.focus()}),CKEDITOR.fire("instanceCreated",null,this),CKEDITOR.add(this),CKEDITOR.tools.setTimeout(function(){o(this,e)},0,this)}function t(){do var e="editor"+ ++h;while(CKEDITOR.instances[e]);return e}function n(){var e=this.commands,t;for(t in e)r(this,e[t])}function r(e,t){t[t.startDisabled?"disable":e.readOnly&&!t.readOnly?"disable":t.modes[e.mode]?"enable":"disable"]()}function i(e,t,n){if(t){var r,i,s=e.commands;for(i in s)r=s[i],(n||r.contextSensitive)&&r.refresh(e,t)}}function s(e){var t=e.config.customConfig;if(!t)return!1;var t=CKEDITOR.getUrl(t),n=p[t]||(p[t]={});return n.fn?(n.fn.call(e,e.config),(CKEDITOR.getUrl(e.config.customConfig)==t||!s(e))&&e.fireOnce("customConfigLoaded")):CKEDITOR.scriptLoader.queue(t,function(){n.fn=CKEDITOR.editorConfig?CKEDITOR.editorConfig:function(){},s(e)}),!0}function o(e,t){e.on("customConfigLoaded",function(){if(t){if(t.on)for(var n in t.on)e.on(n,t.on[n]);CKEDITOR.tools.extend(e.config,t,!0),delete e.config.on}n=e.config,e.readOnly=!!n.readOnly||!!(e.elementMode==CKEDITOR.ELEMENT_MODE_INLINE?e.element.is("textarea")?e.element.hasAttribute("disabled"):e.element.isReadOnly():e.elementMode==CKEDITOR.ELEMENT_MODE_REPLACE&&e.element.hasAttribute("disabled")),e.blockless=e.elementMode==CKEDITOR.ELEMENT_MODE_INLINE?!e.element.is("textarea")&&!CKEDITOR.dtd[e.element.getName()].p:!1,e.tabIndex=n.tabIndex||e.element&&e.element.getAttribute("tabindex")||0,e.activeEnterMode=e.enterMode=e.blockless?CKEDITOR.ENTER_BR:n.enterMode,e.activeShiftEnterMode=e.shiftEnterMode=e.blockless?CKEDITOR.ENTER_BR:n.shiftEnterMode,n.skin&&(CKEDITOR.skinName=n.skin),e.fireOnce("configLoaded"),e.dataProcessor=new CKEDITOR.htmlDataProcessor(e),e.filter=e.activeFilter=new CKEDITOR.filter(e),u(e)}),t&&t.customConfig!=void 0&&(e.config.customConfig=t.customConfig),s(e)||e.fireOnce("customConfigLoaded")}function u(e){CKEDITOR.skin.loadPart("editor",function(){a(e)})}function a(e){CKEDITOR.lang.load(e.config.language,e.config.defaultLanguage,function(t,n){var r=e.config.title;e.langCode=t,e.lang=CKEDITOR.tools.prototypedCopy(n),e.title=typeof r=="string"||r===!1?r:[e.lang.editor,e.name].join(", "),e.config.contentsLangDirection||(e.config.contentsLangDirection=e.elementMode==CKEDITOR.ELEMENT_MODE_INLINE?e.element.getDirection(1):e.lang.dir),e.fire("langLoaded"),f(e)})}function f(e){e.getStylesSet(function(t){e.once("loaded",function(){e.fire("stylesSet",{styles:t})},null,null,1),l(e)})}function l(e){var t=e.config,n=t.plugins,r=t.extraPlugins,i=t.removePlugins;if(r)var s=RegExp("(?:^|,)(?:"+r.replace(/\s*,\s*/g,"|")+")(?=,|$)","g"),n=n.replace(s,""),n=n+(","+r);if(i)var o=RegExp("(?:^|,)(?:"+i.replace(/\s*,\s*/g,"|")+")(?=,|$)","g"),n=n.replace(o,"");CKEDITOR.env.air&&(n+=",adobeair"),CKEDITOR.plugins.load(n.split(","),function(n){var r=[],i=[],s=[];e.plugins=n;for(var u in n){var a=n[u],f=a.lang,l=null,c=a.requires,h;CKEDITOR.tools.isArray(c)&&(c=c.join(","));if(c&&(h=c.match(o)))for(;c=h.pop();)CKEDITOR.tools.setTimeout(function(e,t){throw Error('Plugin "'+e.replace(",","")+'" cannot be removed from the plugins list, because it\'s required by "'+t+'" plugin.')},0,null,[c,u]);f&&!e.lang[u]&&(f.split&&(f=f.split(",")),CKEDITOR.tools.indexOf(f,e.langCode)>=0?l=e.langCode:(l=e.langCode.replace(/-.*/,""),l=l!=e.langCode&&CKEDITOR.tools.indexOf(f,l)>=0?l:CKEDITOR.tools.indexOf(f,"en")>=0?"en":f[0]),!a.langEntries||!a.langEntries[l]?s.push(CKEDITOR.getUrl(a.path+"lang/"+l+".js")):(e.lang[u]=a.langEntries[l],l=null)),i.push(l),r.push(a)}CKEDITOR.scriptLoader.load(s,function(){for(var n=["beforeInit","init","afterInit"],s=0;s<n.length;s++)for(var o=0;o<r.length;o++){var u=r[o];s===0&&i[o]&&u.lang&&u.langEntries&&(e.lang[u.name]=u.langEntries[i[o]]),u[n[s]]&&u[n[s]](e)}e.fireOnce("pluginsLoaded"),t.keystrokes&&e.setKeystroke(e.config.keystrokes);for(o=0;o<e.config.blockedKeystrokes.length;o++)e.keystrokeHandler.blockedKeystrokes[e.config.blockedKeystrokes[o]]=1;e.status="loaded",e.fireOnce("loaded"),CKEDITOR.fire("instanceLoaded",null,e)})})}function c(){var e=this.element;if(e&&this.elementMode!=CKEDITOR.ELEMENT_MODE_APPENDTO){var t=this.getData();return this.config.htmlEncodeOutput&&(t=CKEDITOR.tools.htmlEncode(t)),e.is("textarea")?e.setValue(t):e.setHtml(t),!0}return!1}e.prototype=CKEDITOR.editor.prototype,CKEDITOR.editor=e;var h=0,p={};CKEDITOR.tools.extend(CKEDITOR.editor.prototype,{addCommand:function(e,t){t.name=e.toLowerCase();var n=new CKEDITOR.command(this,t);return this.mode&&r(this,n),this.commands[e]=n},_attachToForm:function(){var e=this,t=e.element,n=new CKEDITOR.dom.element(t.$.form);if(t.is("textarea")&&n){var r=function(n){e.updateElement(),e._.required&&!t.getValue()&&e.fire("required")===!1&&n.data.preventDefault()};n.on("submit",r),n.$.submit&&n.$.submit.call&&n.$.submit.apply&&(n.$.submit=CKEDITOR.tools.override(n.$.submit,function(e){return function(){r(),e.apply?e.apply(this):e()}})),e.on("destroy",function(){n.removeListener("submit",r)})}},destroy:function(e){this.fire("beforeDestroy"),!e&&c.call(this),this.editable(null),this.status="destroyed",this.fire("destroy"),this.removeAllListeners(),CKEDITOR.remove(this),CKEDITOR.fire("instanceDestroyed",null,this)},elementPath:function(e){if(!e){e=this.getSelection();if(!e)return null;e=e.getStartElement()}return e?new CKEDITOR.dom.elementPath(e,this.editable()):null},createRange:function(){var e=this.editable();return e?new CKEDITOR.dom.range(e):null},execCommand:function(e,t){var n=this.getCommand(e),r={name:e,commandData:t,command:n};if(n&&n.state!=CKEDITOR.TRISTATE_DISABLED&&this.fire("beforeCommandExec",r)!==!1){r.returnValue=n.exec(r.commandData);if(!n.async&&this.fire("afterCommandExec",r)!==!1)return r.returnValue}return!1},getCommand:function(e){return this.commands[e]},getData:function(e){!e&&this.fire("beforeGetData");var t=this._.data;return typeof t!="string"&&(t=(t=this.element)&&this.elementMode==CKEDITOR.ELEMENT_MODE_REPLACE?t.is("textarea")?t.getValue():t.getHtml():""),t={dataValue:t},!e&&this.fire("getData",t),t.dataValue},getSnapshot:function(){var e=this.fire("getSnapshot");if(typeof e!="string"){var t=this.element;t&&this.elementMode==CKEDITOR.ELEMENT_MODE_REPLACE&&(e=t.is("textarea")?t.getValue():t.getHtml())}return e},loadSnapshot:function(e){this.fire("loadSnapshot",e)},setData:function(e,t,n){var r=!0,i=t;t&&typeof t=="object"&&(n=t.internal,i=t.callback,r=!t.noSnapshot),!n&&r&&this.fire("saveSnapshot"),(i||!n)&&this.once("dataReady",function(e){!n&&r&&this.fire("saveSnapshot"),i&&i.call(e.editor)}),e={dataValue:e},!n&&this.fire("setData",e),this._.data=e.dataValue,!n&&this.fire("afterSetData",e)},setReadOnly:function(e){e=e==void 0||e,this.readOnly!=e&&(this.readOnly=e,this.keystrokeHandler.blockedKeystrokes[8]=+e,this.editable().setReadOnly(e),this.fire("readOnly"))},insertHtml:function(e,t){this.fire("insertHtml",{dataValue:e,mode:t})},insertText:function(e){this.fire("insertText",e)},insertElement:function(e){this.fire("insertElement",e)},focus:function(){this.fire("beforeFocus")},checkDirty:function(){return this.status=="ready"&&this._.previousValue!==this.getSnapshot()},resetDirty:function(){this._.previousValue=this.getSnapshot()},updateElement:function(){return c.call(this)},setKeystroke:function(){for(var e=this.keystrokeHandler.keystrokes,t=CKEDITOR.tools.isArray(arguments[0])?arguments[0]:[[].slice.call(arguments,0)],n,r,i=t.length;i--;)n=t[i],r=0,CKEDITOR.tools.isArray(n)&&(r=n[1],n=n[0]),r?e[n]=r:delete e[n]},addFeature:function(e){return this.filter.addFeature(e)},setActiveFilter:function(e){e||(e=this.filter),this.activeFilter!==e&&(this.activeFilter=e,this.fire("activeFilterChange"),e===this.filter?this.setActiveEnterMode(null,null):this.setActiveEnterMode(e.getAllowedEnterMode(this.enterMode),e.getAllowedEnterMode(this.shiftEnterMode,!0)))},setActiveEnterMode:function(e,t){e=e?this.blockless?CKEDITOR.ENTER_BR:e:this.enterMode,t=t?this.blockless?CKEDITOR.ENTER_BR:t:this.shiftEnterMode;if(this.activeEnterMode!=e||this.activeShiftEnterMode!=t)this.activeEnterMode=e,this.activeShiftEnterMode=t,this.fire("activeEnterModeChange")}})}(),CKEDITOR.ELEMENT_MODE_NONE=0,CKEDITOR.ELEMENT_MODE_REPLACE=1,CKEDITOR.ELEMENT_MODE_APPENDTO=2,CKEDITOR.ELEMENT_MODE_INLINE=3,CKEDITOR.htmlParser=function(){this._={htmlPartsRegex:RegExp("<(?:(?:\\/([^>]+)>)|(?:!--([\\S|\\s]*?)-->)|(?:([^\\s>]+)\\s*((?:(?:\"[^\"]*\")|(?:'[^']*')|[^\"'>])*)\\/?>))","g")}},function(){var e=/([\w\-:.]+)(?:(?:\s*=\s*(?:(?:"([^"]*)")|(?:'([^']*)')|([^\s>]+)))|(?=\s|$))/g,t={checked:1,compact:1,declare:1,defer:1,disabled:1,ismap:1,multiple:1,nohref:1,noresize:1,noshade:1,nowrap:1,readonly:1,selected:1};CKEDITOR.htmlParser.prototype={onTagOpen:function(){},onTagClose:function(){},onText:function(){},onCDATA:function(){},onComment:function(){},parse:function(n){for(var r,i,s=0,o;r=this._.htmlPartsRegex.exec(n);){i=r.index,i>s&&(s=n.substring(s,i),o?o.push(s):this.onText(s)),s=this._.htmlPartsRegex.lastIndex;if(i=r[1]){i=i.toLowerCase(),o&&CKEDITOR.dtd.$cdata[i]&&(this.onCDATA(o.join("")),o=null);if(!o){this.onTagClose(i);continue}}if(o)o.push(r[0]);else if(i=r[3]){i=i.toLowerCase();if(!/="/.test(i)){var u={},f;r=r[4];var l=!!r&&r.charAt(r.length-1)=="/";if(r)for(;f=e.exec(r);){var c=f[1].toLowerCase();f=f[2]||f[3]||f[4]||"",u[c]=!f&&t[c]?c:CKEDITOR.tools.htmlDecodeAttr(f)}this.onTagOpen(i,u,l),!o&&CKEDITOR.dtd.$cdata[i]&&(o=[])}}else(i=r[2])&&this.onComment(i)}n.length>s&&this.onText(n.substring(s,n.length))}}}(),CKEDITOR.htmlParser.basicWriter=CKEDITOR.tools.createClass({$:function(){this._={output:[]}},proto:{openTag:function(e){this._.output.push("<",e)},openTagClose:function(e,t){t?this._.output.push(" />"):this._.output.push(">")},attribute:function(e,t){typeof t=="string"&&(t=CKEDITOR.tools.htmlEncodeAttr(t)),this._.output.push(" ",e,'="',t,'"')},closeTag:function(e){this._.output.push("</",e,">")},text:function(e){this._.output.push(e)},comment:function(e){this._.output.push("<!--",e,"-->")},write:function(e){this._.output.push(e)},reset:function(){this._.output=[],this._.indent=!1},getHtml:function(e){var t=this._.output.join("");return e&&this.reset(),t}}}),"use strict",function(){CKEDITOR.htmlParser.node=function(){},CKEDITOR.htmlParser.node.prototype={remove:function(){var e=this.parent.children,t=CKEDITOR.tools.indexOf(e,this),n=this.previous,r=this.next;n&&(n.next=r),r&&(r.previous=n),e.splice(t,1),this.parent=null},replaceWith:function(e){var t=this.parent.children,n=CKEDITOR.tools.indexOf(t,this),r=e.previous=this.previous,i=e.next=this.next;r&&(r.next=e),i&&(i.previous=e),t[n]=e,e.parent=this.parent,this.parent=null},insertAfter:function(e){var t=e.parent.children,n=CKEDITOR.tools.indexOf(t,e),r=e.next;t.splice(n+1,0,this),this.next=e.next,this.previous=e,e.next=this,r&&(r.previous=this),this.parent=e.parent},insertBefore:function(e){var t=e.parent.children,n=CKEDITOR.tools.indexOf(t,e);t.splice(n,0,this),this.next=e,(this.previous=e.previous)&&(e.previous.next=this),e.previous=this,this.parent=e.parent},getAscendant:function(e){var t=typeof e=="function"?e:typeof e=="string"?function(t){return t.name==e}:function(t){return t.name in e},n=this.parent;for(;n&&n.type==CKEDITOR.NODE_ELEMENT;){if(t(n))return n;n=n.parent}return null},wrapWith:function(e){return this.replaceWith(e),e.add(this),e},getIndex:function(){return CKEDITOR.tools.indexOf(this.parent.children,this)},getFilterContext:function(e){return e||{}}}}(),"use strict",CKEDITOR.htmlParser.comment=function(e){this.value=e,this._={isBlockLike:!1}},CKEDITOR.htmlParser.comment.prototype=CKEDITOR.tools.extend(new CKEDITOR.htmlParser.node,{type:CKEDITOR.NODE_COMMENT,filter:function(e,t){var n=this.value;return(n=e.onComment(t,n,this))?typeof n!="string"?(this.replaceWith(n),!1):(this.value=n,!0):(this.remove(),!1)},writeHtml:function(e,t){t&&this.filter(t),e.comment(this.value)}}),"use strict",function(){CKEDITOR.htmlParser.text=function(e){this.value=e,this._={isBlockLike:!1}},CKEDITOR.htmlParser.text.prototype=CKEDITOR.tools.extend(new CKEDITOR.htmlParser.node,{type:CKEDITOR.NODE_TEXT,filter:function(e,t){if(!(this.value=e.onText(t,this.value,this)))return this.remove(),!1},writeHtml:function(e,t){t&&this.filter(t),e.text(this.value)}})}(),"use strict",function(){CKEDITOR.htmlParser.cdata=function(e){this.value=e},CKEDITOR.htmlParser.cdata.prototype=CKEDITOR.tools.extend(new CKEDITOR.htmlParser.node,{type:CKEDITOR.NODE_TEXT,filter:function(){},writeHtml:function(e){e.write(this.value)}})}(),"use strict",CKEDITOR.htmlParser.fragment=function(){this.children=[],this.parent=null,this._={isBlockLike:!0,hasInlineStarted:!1}},function(){function e(e){return e.attributes["data-cke-survive"]?!1:e.name=="a"&&e.attributes.href||CKEDITOR.dtd.$removeEmpty[e.name]}var t=CKEDITOR.tools.extend({table:1,ul:1,ol:1,dl:1},CKEDITOR.dtd.table,CKEDITOR.dtd.ul,CKEDITOR.dtd.ol,CKEDITOR.dtd.dl),n={ol:1,ul:1},r=CKEDITOR.tools.extend({},{html:1},CKEDITOR.dtd.html,CKEDITOR.dtd.body,CKEDITOR.dtd.head,{style:1,script:1}),i={ul:"li",ol:"li",dl:"dd",table:"tbody",tbody:"tr",thead:"tr",tfoot:"tr",tr:"td"};CKEDITOR.htmlParser.fragment.fromHtml=function(s,o,u){function l(e){var t;if(w.length>0)for(var n=0;n<w.length;n++){var r=w[n],i=r.name,s=CKEDITOR.dtd[i],o=S.name&&CKEDITOR.dtd[S.name];(!o||o[i])&&(!e||!s||s[e]||!CKEDITOR.dtd[e])?(t||(h(),t=1),r=r.clone(),r.parent=S,S=r,w.splice(n,1),n--):i==S.name&&(d(S,S.parent,1),n--)}}function h(){for(;E.length;)d(E.shift(),S)}function p(e){if(e._.isBlockLike&&e.name!="pre"&&e.name!="textarea"){var t=e.children.length,n=e.children[t-1],r;n&&n.type==CKEDITOR.NODE_TEXT&&((r=CKEDITOR.tools.rtrim(n.value))?n.value=r:e.children.length=t-1)}}function d(t,n,r){var n=n||S||y,i=S;t.previous===void 0&&(v(n,t)&&(S=n,g.onTagOpen(u,{}),t.returnPoint=n=S),p(t),(!e(t)||t.children.length)&&n.add(t),t.name=="pre"&&(T=!1),t.name=="textarea"&&(x=!1)),t.returnPoint?(S=t.returnPoint,delete t.returnPoint):S=r?n:i}function v(e,t){if((e==y||e.name=="body")&&u&&(!e.name||CKEDITOR.dtd[e.name][u])){var n,r;return(n=t.attributes&&(r=t.attributes["data-cke-real-element-type"])?r:t.name)&&n in CKEDITOR.dtd.$inline&&!(n in CKEDITOR.dtd.head)&&!t.isOrphan||t.type==CKEDITOR.NODE_TEXT}}function m(e,t){return e in CKEDITOR.dtd.$listItem||e in CKEDITOR.dtd.$tableContent?e==t||e=="dt"&&t=="dd"||e=="dd"&&t=="dt":!1}var g=new CKEDITOR.htmlParser,y=o instanceof CKEDITOR.htmlParser.element?o:typeof o=="string"?new CKEDITOR.htmlParser.element(o):new CKEDITOR.htmlParser.fragment,w=[],E=[],S=y,x=y.name=="textarea",T=y.name=="pre";g.onTagOpen=function(i,s,o,u){s=new CKEDITOR.htmlParser.element(i,s),s.isUnknown&&o&&(s.isEmpty=!0),s.isOptionalClose=u;if(e(s))w.push(s);else{if(i=="pre")T=!0;else{if(i=="br"&&T){S.add(new CKEDITOR.htmlParser.text("\n"));return}i=="textarea"&&(x=!0)}if(i=="br")E.push(s);else{for(;;){u=(o=S.name)?CKEDITOR.dtd[o]||(S._.isBlockLike?CKEDITOR.dtd.div:CKEDITOR.dtd.span):r;if(!(!s.isUnknown&&!S.isUnknown&&!u[i]))break;if(S.isOptionalClose)g.onTagClose(o);else if(i in n&&o in n)o=S.children,(o=o[o.length-1])&&o.name=="li"||d(o=new CKEDITOR.htmlParser.element("li"),S),!s.returnPoint&&(s.returnPoint=S),S=o;else if(i in CKEDITOR.dtd.$listItem&&!m(i,o))g.onTagOpen(i=="li"?"ul":"dl",{},0,1);else if(o in t&&!m(i,o))!s.returnPoint&&(s.returnPoint=S),S=S.parent;else{o in CKEDITOR.dtd.$inline&&w.unshift(S);if(!S.parent){s.isOrphan=1;break}d(S,S.parent,1)}}l(i),h(),s.parent=S,s.isEmpty?d(s):S=s}}},g.onTagClose=function(e){for(var t=w.length-1;t>=0;t--)if(e==w[t].name){w.splice(t,1);return}for(var n=[],r=[],i=S;i!=y&&i.name!=e;)i._.isBlockLike||r.unshift(i),n.push(i),i=i.returnPoint||i.parent;if(i!=y){for(t=0;t<n.length;t++){var s=n[t];d(s,s.parent)}S=i,i._.isBlockLike&&h(),d(i,i.parent),i==S&&(S=S.parent),w=w.concat(r)}e=="body"&&(u=!1)},g.onText=function(e){if((!S._.hasInlineStarted||E.length)&&!T&&!x){e=CKEDITOR.tools.ltrim(e);if(e.length===0)return}var n=S.name,s=n?CKEDITOR.dtd[n]||(S._.isBlockLike?CKEDITOR.dtd.div:CKEDITOR.dtd.span):r;!x&&!s["#"]&&n in t?(g.onTagOpen(i[n]||""),g.onText(e)):(h(),l(),!T&&!x&&(e=e.replace(/[\t\r\n ]{2,}|[\t\r\n]/g," ")),e=new CKEDITOR.htmlParser.text(e),v(S,e)&&this.onTagOpen(u,{},0,1),S.add(e))},g.onCDATA=function(e){S.add(new CKEDITOR.htmlParser.cdata(e))},g.onComment=function(e){h(),l(),S.add(new CKEDITOR.htmlParser.comment(e))},g.parse(s);for(h();S!=y;)d(S,S.parent,1);return p(y),y},CKEDITOR.htmlParser.fragment.prototype={type:CKEDITOR.NODE_DOCUMENT_FRAGMENT,add:function(e,t){isNaN(t)&&(t=this.children.length);var n=t>0?this.children[t-1]:null;if(n){if(e._.isBlockLike&&n.type==CKEDITOR.NODE_TEXT){n.value=CKEDITOR.tools.rtrim(n.value);if(n.value.length===0){this.children.pop(),this.add(e);return}}n.next=e}e.previous=n,e.parent=this,this.children.splice(t,0,e),this._.hasInlineStarted||(this._.hasInlineStarted=e.type==CKEDITOR.NODE_TEXT||e.type==CKEDITOR.NODE_ELEMENT&&!e._.isBlockLike)},filter:function(e,t){t=this.getFilterContext(t),e.onRoot(t,this),this.filterChildren(e,!1,t)},filterChildren:function(e,t,n){if(this.childrenFilteredBy!=e.id){n=this.getFilterContext(n),t&&!this.parent&&e.onRoot(n,this),this.childrenFilteredBy=e.id;for(t=0;t<this.children.length;t++)this.children[t].filter(e,n)===!1&&t--}},writeHtml:function(e,t){t&&this.filter(t),this.writeChildrenHtml(e)},writeChildrenHtml:function(e,t,n){var r=this.getFilterContext();n&&!this.parent&&t&&t.onRoot(r,this),t&&this.filterChildren(t,!1,r),t=0,n=this.children;for(r=n.length;t<r;t++)n[t].writeHtml(e)},forEach:function(e,t,n){if(!n&&(!t||this.type==t))var r=e(this);if(r!==!1)for(var n=this.children,i=0;i<n.length;i++)r=n[i],r.type==CKEDITOR.NODE_ELEMENT?r.forEach(e,t):(!t||r.type==t)&&e(r)},getFilterContext:function(e){return e||{}}}}(),"use strict",function(){function e(){this.rules=[]}function t(t,n,r,i){var s,o;for(s in n)(o=t[s])||(o=t[s]=new e),o.add(n[s],r,i)}CKEDITOR.htmlParser.filter=CKEDITOR.tools.createClass({$:function(t){this.id=CKEDITOR.tools.getNextNumber(),this.elementNameRules=new e,this.attributeNameRules=new e,this.elementsRules={},this.attributesRules={},this.textRules=new e,this.commentRules=new e,this.rootRules=new e,t&&this.addRules(t,10)},proto:{addRules:function(e,n){var r;typeof n=="number"?r=n:n&&"priority"in n&&(r=n.priority),typeof r!="number"&&(r=10),typeof n!="object"&&(n={}),e.elementNames&&this.elementNameRules.addMany(e.elementNames,r,n),e.attributeNames&&this.attributeNameRules.addMany(e.attributeNames,r,n),e.elements&&t(this.elementsRules,e.elements,r,n),e.attributes&&t(this.attributesRules,e.attributes,r,n),e.text&&this.textRules.add(e.text,r,n),e.comment&&this.commentRules.add(e.comment,r,n),e.root&&this.rootRules.add(e.root,r,n)},applyTo:function(e){e.filter(this)},onElementName:function(e,t){return this.elementNameRules.execOnName(e,t)},onAttributeName:function(e,t){return this.attributeNameRules.execOnName(e,t)},onText:function(e,t,n){return this.textRules.exec(e,t,n)},onComment:function(e,t,n){return this.commentRules.exec(e,t,n)},onRoot:function(e,t){return this.rootRules.exec(e,t)},onElement:function(e,t){for(var n=[this.elementsRules["^"],this.elementsRules[t.name],this.elementsRules.$],r,i=0;i<3;i++)if(r=n[i]){r=r.exec(e,t,this);if(r===!1)return null;if(r&&r!=t)return this.onNode(e,r);if(t.parent&&!t.name)break}return t},onNode:function(e,t){var n=t.type;return n==CKEDITOR.NODE_ELEMENT?this.onElement(e,t):n==CKEDITOR.NODE_TEXT?new CKEDITOR.htmlParser.text(this.onText(e,t.value)):n==CKEDITOR.NODE_COMMENT?new CKEDITOR.htmlParser.comment(this.onComment(e,t.value)):null},onAttribute:function(e,t,n,r){return(n=this.attributesRules[n])?n.exec(e,r,t,this):r}}}),CKEDITOR.htmlParser.filterRulesGroup=e,e.prototype={add:function(e,t,n){this.rules.splice(this.findIndex(t),0,{value:e,priority:t,options:n})},addMany:function(e,t,n){for(var r=[this.findIndex(t),0],i=0,s=e.length;i<s;i++)r.push({value:e[i],priority:t,options:n});this.rules.splice.apply(this.rules,r)},findIndex:function(e){for(var t=this.rules,n=t.length-1;n>=0&&e<t[n].priority;)n--;return n+1},exec:function(e,t){var n=t instanceof CKEDITOR.htmlParser.node||t instanceof CKEDITOR.htmlParser.fragment,r=Array.prototype.slice.call(arguments,1),i=this.rules,s=i.length,o,u,a,f;for(f=0;f<s;f++){n&&(o=t.type,u=t.name),a=i[f];if(!(e.nonEditable&&!a.options.applyToAll||e.nestedEditable&&a.options.excludeNestedEditable)){a=a.value.apply(null,r);if(a===!1||n&&a&&(a.name!=u||a.type!=o))return a;a!=void 0&&(r[0]=t=a)}}return t},execOnName:function(e,t){for(var n=0,r=this.rules,i=r.length,s;t&&n<i;n++)s=r[n],!(e.nonEditable&&!s.options.applyToAll||e.nestedEditable&&s.options.excludeNestedEditable)&&(t=t.replace(s.value[0],s.value[1]));return t}}}(),function(){function e(e,t){function u(e){return e||CKEDITOR.env.needsNbspFiller?new CKEDITOR.htmlParser.text(" "):new CKEDITOR.htmlParser.element("br",{"data-cke-bogus":1})}function a(e,t){return function(i){if(i.type!=CKEDITOR.NODE_DOCUMENT_FRAGMENT){var o=[],a=n(i),l,h;if(a)for(f(a,1)&&o.push(a);a;)s(a)&&(l=r(a))&&f(l)&&((h=r(l))&&!s(h)?o.push(l):(u(c).insertAfter(l),l.remove())),a=a.previous;for(a=0;a<o.length;a++)o[a].remove();if(o=(typeof t=="function"?t(i):t)!==!1)!c&&!CKEDITOR.env.needsBrFiller&&i.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT?o=!1:!c&&!CKEDITOR.env.needsBrFiller&&(document.documentMode>7||i.name in CKEDITOR.dtd.tr||i.name in CKEDITOR.dtd.$listItem)?o=!1:(o=n(i),o=!o||i.name=="form"&&o.name=="input");o&&i.add(u(e))}}}function f(e,t){if((!c||CKEDITOR.env.needsBrFiller)&&e.type==CKEDITOR.NODE_ELEMENT&&e.name=="br"&&!e.attributes["data-cke-eol"])return!0;var n;if(e.type==CKEDITOR.NODE_TEXT&&(n=e.value.match(m))){n.index&&((new CKEDITOR.htmlParser.text(e.value.substring(0,n.index))).insertBefore(e),e.value=n[0]);if(!CKEDITOR.env.needsBrFiller&&c&&(!t||e.parent.name in h))return!0;if(!c)if((n=e.previous)&&n.name=="br"||!n||s(n))return!0}return!1}var l={elements:{}},c=t=="html",h=CKEDITOR.tools.extend({},w),p;for(p in h)"#"in y[p]||delete h[p];for(p in h)l.elements[p]=a(c,e.config.fillEmptyBlocks);return l.root=a(c,!1),l.elements.br=function(e){return function(t){if(t.parent.type!=CKEDITOR.NODE_DOCUMENT_FRAGMENT){var n=t.attributes;if("data-cke-bogus"in n||"data-cke-eol"in n)delete n["data-cke-bogus"];else{for(n=t.next;n&&i(n);)n=n.next;var a=r(t);!n&&s(t.parent)?o(t.parent,u(e)):s(n)&&a&&!s(a)&&u(e).insertBefore(n)}}}}(c),l}function t(e,t){return e!=CKEDITOR.ENTER_BR&&t!==!1?e==CKEDITOR.ENTER_DIV?"div":"p":!1}function n(e){for(e=e.children[e.children.length-1];e&&i(e);)e=e.previous;return e}function r(e){for(e=e.previous;e&&i(e);)e=e.previous;return e}function i(e){return e.type==CKEDITOR.NODE_TEXT&&!CKEDITOR.tools.trim(e.value)||e.type==CKEDITOR.NODE_ELEMENT&&e.attributes["data-cke-bookmark"]}function s(e){return e&&(e.type==CKEDITOR.NODE_ELEMENT&&e.name in w||e.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT)}function o(e,t){var n=e.children[e.children.length-1];e.children.push(t),t.parent=e,n&&(n.next=t,t.previous=n)}function u(e){e=e.attributes,e.contenteditable!="false"&&(e["data-cke-editable"]=e.contenteditable?"true":1),e.contenteditable="false"}function a(e){e=e.attributes;switch(e["data-cke-editable"]){case"true":e.contenteditable="true";break;case"1":delete e.contenteditable}}function f(e){return e.replace(N,function(e,t,n){return"<"+t+n.replace(C,function(e,t){return k.test(t)&&n.indexOf("data-cke-saved-"+t)==-1?" data-cke-saved-"+e+" data-cke-"+CKEDITOR.rnd+"-"+e:e})+">"})}function l(e,t){return e.replace(t,function(e,t,n){return e.indexOf("<textarea")===0&&(e=t+p(n).replace(/</g,"&lt;").replace(/>/g,"&gt;")+"</textarea>"),"<cke:encoded>"+encodeURIComponent(e)+"</cke:encoded>"})}function c(e){return e.replace(O,function(e,t){return decodeURIComponent(t)})}function h(e){return e.replace(/<\!--(?!{cke_protected})[\s\S]+?--\>/g,function(e){return"<!--"+g+"{C}"+encodeURIComponent(e).replace(/--/g,"%2D%2D")+"-->"})}function p(e){return e.replace(/<\!--\{cke_protected\}\{C\}([\s\S]+?)--\>/g,function(e,t){return decodeURIComponent(t)})}function d(e,t){var n=t._.dataStore;return e.replace(/<\!--\{cke_protected\}([\s\S]+?)--\>/g,function(e,t){return decodeURIComponent(t)}).replace(/\{cke_protected_(\d+)\}/g,function(e,t){return n&&n[t]||""})}function v(e,t){for(var n=[],r=t.config.protectedSource,i=t._.dataStore||(t._.dataStore={id:1}),s=/<\!--\{cke_temp(comment)?\}(\d*?)--\>/g,r=[/<script[\s\S]*?<\/script>/gi,/<noscript[\s\S]*?<\/noscript>/gi,/<meta[\s\S]*?\/?>/gi].concat(r),e=e.replace(/<\!--[\s\S]*?--\>/g,function(e){return"<!--{cke_tempcomment}"+(n.push(e)-1)+"-->"}),o=0;o<r.length;o++)e=e.replace(r[o],function(e){return e=e.replace(s,function(e,t,r){return n[r]}),/cke_temp(comment)?/.test(e)?e:"<!--{cke_temp}"+(n.push(e)-1)+"-->"});return e=e.replace(s,function(e,t,r){return"<!--"+g+(t?"{C}":"")+encodeURIComponent(n[r]).replace(/--/g,"%2D%2D")+"-->"}),e=e.replace(/<\w+(?:\s+(?:(?:[^\s=>]+\s*=\s*(?:[^'"\s>]+|'[^']*'|"[^"]*"))|[^\s=>]+))+\s*>/g,function(e){return e.replace(/<\!--\{cke_protected\}([^>]*)--\>/g,function(e,t){return i[i.id]=decodeURIComponent(t),"{cke_protected_"+i.id++ +"}"})}),e=e.replace(/<(title|iframe|textarea)([^>]*)>([\s\S]*?)<\/\1>/g,function(e,n,r,i){return"<"+n+r+">"+d(p(i),t)+"</"+n+">"})}CKEDITOR.htmlDataProcessor=function(n){var r,i,s=this;this.editor=n,this.dataFilter=r=new CKEDITOR.htmlParser.filter,this.htmlFilter=i=new CKEDITOR.htmlParser.filter,this.writer=new CKEDITOR.htmlParser.basicWriter,r.addRules(E),r.addRules(S,{applyToAll:!0}),r.addRules(e(n,"data"),{applyToAll:!0}),i.addRules(x),i.addRules(T,{applyToAll:!0}),i.addRules(e(n,"html"),{applyToAll:!0}),n.on("toHtml",function(e){var e=e.data,r=e.dataValue,r=v(r,n),r=l(r,A),r=f(r),r=l(r,L),r=r.replace(M,"$1cke:$2"),r=r.replace(D,"<cke:$1$2></cke:$1>"),r=r.replace(/(<pre\b[^>]*>)(\r\n|\n)/g,"$1$2$2"),r=r.replace(/([^a-z0-9<\-])(on\w{3,})(?!>)/gi,"$1data-cke-"+CKEDITOR.rnd+"-$2"),i=e.context||n.editable().getName(),s;CKEDITOR.env.ie&&CKEDITOR.env.version<9&&i=="pre"&&(i="div",r="<pre>"+r+"</pre>",s=1),i=n.document.createElement(i),i.setHtml("a"+r),r=i.getHtml().substr(1),r=r.replace(RegExp("data-cke-"+CKEDITOR.rnd+"-","ig"),""),s&&(r=r.replace(/^<pre>|<\/pre>$/gi,"")),r=r.replace(_,"$1$2"),r=c(r),r=p(r),e.dataValue=CKEDITOR.htmlParser.fragment.fromHtml(r,e.context,e.fixForBody===!1?!1:t(e.enterMode,n.config.autoParagraph))},null,null,5),n.on("toHtml",function(e){e.data.filter.applyTo(e.data.dataValue,!0,e.data.dontFilter,e.data.enterMode)&&n.fire("dataFiltered")},null,null,6),n.on("toHtml",function(e){e.data.dataValue.filterChildren(s.dataFilter,!0)},null,null,10),n.on("toHtml",function(e){var e=e.data,t=e.dataValue,n=new CKEDITOR.htmlParser.basicWriter;t.writeChildrenHtml(n),t=n.getHtml(!0),e.dataValue=h(t)},null,null,15),n.on("toDataFormat",function(e){var r=e.data.dataValue;e.data.enterMode!=CKEDITOR.ENTER_BR&&(r=r.replace(/^<br *\/?>/i,"")),e.data.dataValue=CKEDITOR.htmlParser.fragment.fromHtml(r,e.data.context,t(e.data.enterMode,n.config.autoParagraph))},null,null,5),n.on("toDataFormat",function(e){e.data.dataValue.filterChildren(s.htmlFilter,!0)},null,null,10),n.on("toDataFormat",function(e){e.data.filter.applyTo(e.data.dataValue,!1,!0)},null,null,11),n.on("toDataFormat",function(e){var t=e.data.dataValue,r=s.writer;r.reset(),t.writeChildrenHtml(r),t=r.getHtml(!0),t=p(t),t=d(t,n),e.data.dataValue=t},null,null,15)},CKEDITOR.htmlDataProcessor.prototype={toHtml:function(e,t,n,r){var i=this.editor,s,o,u;return t&&typeof t=="object"?(s=t.context,n=t.fixForBody,r=t.dontFilter,o=t.filter,u=t.enterMode):s=t,!s&&s!==null&&(s=i.editable().getName()),i.fire("toHtml",{dataValue:e,context:s,fixForBody:n,dontFilter:r,filter:o||i.filter,enterMode:u||i.enterMode}).dataValue},toDataFormat:function(e,t){var n,r,i;return t&&(n=t.context,r=t.filter,i=t.enterMode),!n&&n!==null&&(n=this.editor.editable().getName()),this.editor.fire("toDataFormat",{dataValue:e,filter:r||this.editor.filter,context:n,enterMode:i||this.editor.enterMode}).dataValue}};var m=/(?:&nbsp;|\xa0)$/,g="{cke_protected}",y=CKEDITOR.dtd,b=["caption","colgroup","col","thead","tfoot","tbody"],w=CKEDITOR.tools.extend({},y.$blockLimit,y.$block),E={elements:{input:u,textarea:u}},S={attributeNames:[[/^on/,"data-cke-pa-on"],[/^data-cke-expando$/,""]]},x={elements:{embed:function(e){var t=e.parent;if(t&&t.name=="object"){var n=t.attributes.width,t=t.attributes.height;n&&(e.attributes.width=n),t&&(e.attributes.height=t)}},a:function(e){if(!e.children.length&&!e.attributes.name&&!e.attributes["data-cke-saved-name"])return!1}}},T={elementNames:[[/^cke:/,""],[/^\?xml:namespace$/,""]],attributeNames:[[/^data-cke-(saved|pa)-/,""],[/^data-cke-.*/,""],["hidefocus",""]],elements:{$:function(e){var t=e.attributes;if(t){if(t["data-cke-temp"])return!1;for(var n=["name","href","src"],r,i=0;i<n.length;i++)r="data-cke-saved-"+n[i],r in t&&delete t[n[i]]}return e},table:function(e){e.children.slice(0).sort(function(e,t){var n,r;return e.type==CKEDITOR.NODE_ELEMENT&&t.type==e.type&&(n=CKEDITOR.tools.indexOf(b,e.name),r=CKEDITOR.tools.indexOf(b,t.name)),n>-1&&r>-1&&n!=r||(n=e.parent?e.getIndex():-1,r=t.parent?t.getIndex():-1),n>r?1:-1})},param:function(e){return e.children=[],e.isEmpty=!0,e},span:function(e){e.attributes["class"]=="Apple-style-span"&&delete e.name},html:function(e){delete e.attributes.contenteditable,delete e.attributes["class"]},body:function(e){delete e.attributes.spellcheck,delete e.attributes.contenteditable},style:function(e){var t=e.children[0];t&&t.value&&(t.value=CKEDITOR.tools.trim(t.value)),e.attributes.type||(e.attributes.type="text/css")},title:function(e){var t=e.children[0];!t&&o(e,t=new CKEDITOR.htmlParser.text),t.value=e.attributes["data-cke-title"]||""},input:a,textarea:a},attributes:{"class":function(e){return CKEDITOR.tools.ltrim(e.replace(/(?:^|\s+)cke_[^\s]*/g,""))||!1}}};CKEDITOR.env.ie&&(T.attributes.style=function(e){return e.replace(/(^|;)([^\:]+)/g,function(e){return e.toLowerCase()})});var N=/<(a|area|img|input|source)\b([^>]*)>/gi,C=/([\w-]+)\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|(?:[^ "'>]+))/gi,k=/^(href|src|name)$/i,L=/(?:<style(?=[ >])[^>]*>[\s\S]*?<\/style>)|(?:<(:?link|meta|base)[^>]*>)/gi,A=/(<textarea(?=[ >])[^>]*>)([\s\S]*?)(?:<\/textarea>)/gi,O=/<cke:encoded>([^<]*)<\/cke:encoded>/gi,M=/(<\/?)((?:object|embed|param|html|body|head|title)[^>]*>)/gi,_=/(<\/?)cke:((?:html|body|head|title)[^>]*>)/gi,D=/<cke:(param|embed)([^>]*?)\/?>(?!\s*<\/cke:\1)/gi}(),"use strict",CKEDITOR.htmlParser.element=function(e,t){this.name=e,this.attributes=t||{},this.children=[];var n=e||"",r=n.match(/^cke:(.*)/);r&&(n=r[1]),n=!(!CKEDITOR.dtd.$nonBodyContent[n]&&!CKEDITOR.dtd.$block[n]&&!CKEDITOR.dtd.$listItem[n]&&!CKEDITOR.dtd.$tableContent[n]&&!CKEDITOR.dtd.$nonEditable[n]&&n!="br"),this.isEmpty=!!CKEDITOR.dtd.$empty[e],this.isUnknown=!CKEDITOR.dtd[e],this._={isBlockLike:n,hasInlineStarted:this.isEmpty||!n}},CKEDITOR.htmlParser.cssStyle=function(e){var t={};return((e instanceof CKEDITOR.htmlParser.element?e.attributes.style:e)||"").replace(/&quot;/g,'"').replace(/\s*([^ :;]+)\s*:\s*([^;]+)\s*(?=;|$)/g,function(e,n,r){n=="font-family"&&(r=r.replace(/["']/g,"")),t[n.toLowerCase()]=r}),{rules:t,populate:function(e){var t=this.toString();t&&(e instanceof CKEDITOR.dom.element?e.setAttribute("style",t):e instanceof CKEDITOR.htmlParser.element?e.attributes.style=t:e.style=t)},toString:function(){var e=[],n;for(n in t)t[n]&&e.push(n,":",t[n],";");return e.join("")}}},function(){function e(e){return function(t){return t.type==CKEDITOR.NODE_ELEMENT&&(typeof e=="string"?t.name==e:t.name in e)}}var t=function(e,t){return e=e[0],t=t[0],e<t?-1:e>t?1:0},n=CKEDITOR.htmlParser.fragment.prototype;CKEDITOR.htmlParser.element.prototype=CKEDITOR.tools.extend(new CKEDITOR.htmlParser.node,{type:CKEDITOR.NODE_ELEMENT,add:n.add,clone:function(){return new CKEDITOR.htmlParser.element(this.name,this.attributes)},filter:function(e,t){var n=this,r,i,t=n.getFilterContext(t);if(t.off)return!0;n.parent||e.onRoot(t,n);for(;;){r=n.name;if(!(i=e.onElementName(t,r)))return this.remove(),!1;n.name=i;if(!(n=e.onElement(t,n)))return this.remove(),!1;if(n!==this)return this.replaceWith(n),!1;if(n.name==r)break;if(n.type!=CKEDITOR.NODE_ELEMENT)return this.replaceWith(n),!1;if(!n.name)return this.replaceWithChildren(),!1}r=n.attributes;var s,o;for(s in r){o=s;for(i=r[s];;){if(!(o=e.onAttributeName(t,s))){delete r[s];break}if(o==s)break;delete r[s],s=o}o&&((i=e.onAttribute(t,n,o,i))===!1?delete r[o]:r[o]=i)}return n.isEmpty||this.filterChildren(e,!1,t),!0},filterChildren:n.filterChildren,writeHtml:function(e,n){n&&this.filter(n);var r=this.name,i=[],s=this.attributes,o,u;e.openTag(r,s);for(o in s)i.push([o,s[o]]);e.sortAttributes&&i.sort(t),o=0;for(u=i.length;o<u;o++)s=i[o],e.attribute(s[0],s[1]);e.openTagClose(r,this.isEmpty),this.writeChildrenHtml(e),this.isEmpty||e.closeTag(r)},writeChildrenHtml:n.writeChildrenHtml,replaceWithChildren:function(){for(var e=this.children,t=e.length;t;)e[--t].insertAfter(this);this.remove()},forEach:n.forEach,getFirst:function(t){if(!t)return this.children.length?this.children[0]:null;typeof t!="function"&&(t=e(t));for(var n=0,r=this.children.length;n<r;++n)if(t(this.children[n]))return this.children[n];return null},getHtml:function(){var e=new CKEDITOR.htmlParser.basicWriter;return this.writeChildrenHtml(e),e.getHtml()},setHtml:function(e){for(var e=this.children=CKEDITOR.htmlParser.fragment.fromHtml(e).children,t=0,n=e.length;t<n;++t)e[t].parent=this},getOuterHtml:function(){var e=new CKEDITOR.htmlParser.basicWriter;return this.writeHtml(e),e.getHtml()},split:function(e){for(var t=this.children.splice(e,this.children.length-e),n=this.clone(),r=0;r<t.length;++r)t[r].parent=n;return n.children=t,t[0]&&(t[0].previous=null),e>0&&(this.children[e-1].next=null),this.parent.add(n,this.getIndex()+1),n},addClass:function(e){if(!this.hasClass(e)){var t=this.attributes["class"]||"";this.attributes["class"]=t+(t?" ":"")+e}},removeClass:function(e){var t=this.attributes["class"];t&&((t=CKEDITOR.tools.trim(t.replace(RegExp("(?:\\s+|^)"+e+"(?:\\s+|$)")," ")))?this.attributes["class"]=t:delete this.attributes["class"])},hasClass:function(e){var t=this.attributes["class"];return t?RegExp("(?:^|\\s)"+e+"(?=\\s|$)").test(t):!1},getFilterContext:function(e){var t=[];e||(e={off:!1,nonEditable:!1,nestedEditable:!1}),!e.off&&this.attributes["data-cke-processor"]=="off"&&t.push("off",!0),!e.nonEditable&&this.attributes.contenteditable=="false"?t.push("nonEditable",!0):e.nonEditable&&!e.nestedEditable&&this.attributes.contenteditable=="true"&&t.push("nestedEditable",!0);if(t.length)for(var e=CKEDITOR.tools.copy(e),n=0;n<t.length;n+=2)e[t[n]]=t[n+1];return e}},!0)}(),function(){var e={},t=/{([^}]+)}/g,n=/([\\'])/g,r=/\n/g,i=/\r/g;CKEDITOR.template=function(s){if(e[s])this.output=e[s];else{var o=s.replace(n,"\\$1").replace(r,"\\n").replace(i,"\\r").replace(t,function(e,t){return"',data['"+t+"']==undefined?'{"+t+"}':data['"+t+"'],'"});this.output=e[s]=Function("data","buffer","return buffer?buffer.push('"+o+"'):['"+o+"'].join('');")}}}(),delete CKEDITOR.loadFullCore,CKEDITOR.instances={},CKEDITOR.document=new CKEDITOR.dom.document(document),CKEDITOR.add=function(e){CKEDITOR.instances[e.name]=e,e.on("focus",function(){CKEDITOR.currentInstance!=e&&(CKEDITOR.currentInstance=e,CKEDITOR.fire("currentInstance"))}),e.on("blur",function(){CKEDITOR.currentInstance==e&&(CKEDITOR.currentInstance=null,CKEDITOR.fire("currentInstance"))}),CKEDITOR.fire("instance",null,e)},CKEDITOR.remove=function(e){delete CKEDITOR.instances[e.name]},function(){var e={};CKEDITOR.addTemplate=function(t,n){var r=e[t];return r?r:(r={name:t,source:n},CKEDITOR.fire("template",r),e[t]=new CKEDITOR.template(r.source))},CKEDITOR.getTemplate=function(t){return e[t]}}(),function(){var e=[];CKEDITOR.addCss=function(t){e.push(t)},CKEDITOR.getCss=function(){return e.join("\n")}}(),CKEDITOR.on("instanceDestroyed",function(){CKEDITOR.tools.isEmpty(this.instances)&&CKEDITOR.fire("reset")}),CKEDITOR.TRISTATE_ON=1,CKEDITOR.TRISTATE_OFF=2,CKEDITOR.TRISTATE_DISABLED=0,function(){CKEDITOR.inline=function(e,t){if(!CKEDITOR.env.isCompatible)return null;e=CKEDITOR.dom.element.get(e);if(e.getEditor())throw'The editor instance "'+e.getEditor().name+'" is already attached to the provided element.';var n=new CKEDITOR.editor(t,e,CKEDITOR.ELEMENT_MODE_INLINE),r=e.is("textarea")?e:null;return r?(n.setData(r.getValue(),null,!0),e=CKEDITOR.dom.element.createFromHtml('<div contenteditable="'+!!n.readOnly+'" class="cke_textarea_inline">'+r.getValue()+"</div>",CKEDITOR.document),e.insertAfter(r),r.hide(),r.$.form&&n._attachToForm()):n.setData(e.getHtml(),null,!0),n.on("loaded",function(){n.fire("uiReady"),n.editable(e),n.container=e,n.setData(n.getData(1)),n.resetDirty(),n.fire("contentDom"),n.mode="wysiwyg",n.fire("mode"),n.status="ready",n.fireOnce("instanceReady"),CKEDITOR.fire("instanceReady",null,n)},null,null,1e4),n.on("destroy",function(){r&&(n.container.clearCustomData(),n.container.remove(),r.show()),n.element.clearCustomData(),delete n.element}),n},CKEDITOR.inlineAll=function(){var e,t,n;for(n in CKEDITOR.dtd.$editable)for(var r=CKEDITOR.document.getElementsByTag(n),i=0,s=r.count();i<s;i++)e=r.getItem(i),e.getAttribute("contenteditable")=="true"&&(t={element:e,config:{}},CKEDITOR.fire("inline",t)!==!1&&CKEDITOR.inline(e,t.config))},CKEDITOR.domReady(function(){!CKEDITOR.disableAutoInline&&CKEDITOR.inlineAll()})}(),CKEDITOR.replaceClass="ckeditor",function(){function e(e,r,i,s){if(!CKEDITOR.env.isCompatible)return null;e=CKEDITOR.dom.element.get(e);if(e.getEditor())throw'The editor instance "'+e.getEditor().name+'" is already attached to the provided element.';var o=new CKEDITOR.editor(r,e,s);return s==CKEDITOR.ELEMENT_MODE_REPLACE&&(e.setStyle("visibility","hidden"),o._.required=e.hasAttribute("required"),e.removeAttribute("required")),i&&o.setData(i,null,!0),o.on("loaded",function(){n(o),s==CKEDITOR.ELEMENT_MODE_REPLACE&&o.config.autoUpdateElement&&e.$.form&&o._attachToForm(),o.setMode(o.config.startupMode,function(){o.resetDirty(),o.status="ready",o.fireOnce("instanceReady"),CKEDITOR.fire("instanceReady",null,o)})}),o.on("destroy",t),o}function t(){var e=this.container,t=this.element;e&&(e.clearCustomData(),e.remove()),t&&(t.clearCustomData(),this.elementMode==CKEDITOR.ELEMENT_MODE_REPLACE&&(t.show(),this._.required&&t.setAttribute("required","required")),delete this.element)}function n(e){var t=e.name,n=e.element,r=e.elementMode,i=e.fire("uiSpace",{space:"top",html:""}).html,s=e.fire("uiSpace",{space:"bottom",html:""}).html,o=new CKEDITOR.template('<{outerEl} id="cke_{name}" class="{id} cke cke_reset cke_chrome cke_editor_{name} cke_{langDir} '+CKEDITOR.env.cssClass+'"  dir="{langDir}" lang="{langCode}" role="application"'+(e.title?' aria-labelledby="cke_{name}_arialbl"':"")+">"+(e.title?'<span id="cke_{name}_arialbl" class="cke_voice_label">{voiceLabel}</span>':"")+'<{outerEl} class="cke_inner cke_reset" role="presentation">{topHtml}<{outerEl} id="{contentId}" class="cke_contents cke_reset" role="presentation"></{outerEl}>{bottomHtml}</{outerEl}></{outerEl}>'),t=CKEDITOR.dom.element.createFromHtml(o.output({id:e.id,name:t,langDir:e.lang.dir,langCode:e.langCode,voiceLabel:e.title,topHtml:i?'<span id="'+e.ui.spaceId("top")+'" class="cke_top cke_reset_all" role="presentation" style="height:auto">'+i+"</span>":"",contentId:e.ui.spaceId("contents"),bottomHtml:s?'<span id="'+e.ui.spaceId("bottom")+'" class="cke_bottom cke_reset_all" role="presentation">'+s+"</span>":"",outerEl:CKEDITOR.env.ie?"span":"div"}));r==CKEDITOR.ELEMENT_MODE_REPLACE?(n.hide(),t.insertAfter(n)):n.append(t),e.container=t,i&&e.ui.space("top").unselectable(),s&&e.ui.space("bottom").unselectable(),n=e.config.width,r=e.config.height,n&&t.setStyle("width",CKEDITOR.tools.cssLength(n)),r&&e.ui.space("contents").setStyle("height",CKEDITOR.tools.cssLength(r)),t.disableContextMenu(),CKEDITOR.env.webkit&&t.on("focus",function(){e.focus()}),e.fireOnce("uiReady")}CKEDITOR.replace=function(t,n){return e(t,n,null,CKEDITOR.ELEMENT_MODE_REPLACE)},CKEDITOR.appendTo=function(t,n,r){return e(t,n,r,CKEDITOR.ELEMENT_MODE_APPENDTO)},CKEDITOR.replaceAll=function(){for(var e=document.getElementsByTagName("textarea"),t=0;t<e.length;t++){var n=null,r=e[t];if(r.name||r.id){if(typeof arguments[0]=="string"){if(!RegExp("(?:^|\\s)"+arguments[0]+"(?:$|\\s)").test(r.className))continue}else if(typeof arguments[0]=="function"){n={};if(arguments[0](r,n)===!1)continue}this.replace(r,n)}}},CKEDITOR.editor.prototype.addMode=function(e,t){(this._.modes||(this._.modes={}))[e]=t},CKEDITOR.editor.prototype.setMode=function(e,t){var n=this,r=this._.modes;if(e!=n.mode&&!!r&&!!r[e]){n.fire("beforeSetMode",e);if(n.mode){var i=n.checkDirty(),r=n._.previousModeData,s,o=0;n.fire("beforeModeUnload"),n.editable(0),n._.previousMode=n.mode,n._.previousModeData=s=n.getData(1),n.mode=="source"&&r==s&&(n.fire("lockSnapshot",{forceUpdate:!0}),o=1),n.ui.space("contents").setHtml(""),n.mode=""}else n._.previousModeData=n.getData(1);this._.modes[e](function(){n.mode=e,i!==void 0&&!i&&n.resetDirty(),o?n.fire("unlockSnapshot"):e=="wysiwyg"&&n.fire("saveSnapshot"),setTimeout(function(){n.fire("mode"),t&&t.call(n)},0)})}},CKEDITOR.editor.prototype.resize=function(e,t,n,r){var i=this.container,s=this.ui.space("contents"),o=CKEDITOR.env.webkit&&this.document&&this.document.getWindow().$.frameElement,r=r?i.getChild(1):i;r.setSize("width",e,!0),o&&(o.style.width="1%"),s.setStyle("height",Math.max(t-(n?0:(r.$.offsetHeight||0)-(s.$.clientHeight||0)),0)+"px"),o&&(o.style.width="100%"),this.fire("resize")},CKEDITOR.editor.prototype.getResizable=function(e){return e?this.ui.space("contents"):this.container},CKEDITOR.domReady(function(){CKEDITOR.replaceClass&&CKEDITOR.replaceAll(CKEDITOR.replaceClass)})}(),CKEDITOR.config.startupMode="wysiwyg",function(){function e(e){var n=e.editor,i=e.data.path,s=i.blockLimit,o=e.data.selection,u=o.getRanges()[0],a;if(CKEDITOR.env.gecko||CKEDITOR.env.ie&&CKEDITOR.env.needsBrFiller)if(o=t(o,i))o.appendBogus(),a=CKEDITOR.env.ie;if(n.config.autoParagraph!==!1&&n.activeEnterMode!=CKEDITOR.ENTER_BR&&n.editable().equals(s)&&!i.block&&u.collapsed&&!u.getCommonAncestor().isReadOnly()){i=u.clone(),i.enlarge(CKEDITOR.ENLARGE_BLOCK_CONTENTS),s=new CKEDITOR.dom.walker(i),s.guard=function(e){return!r(e)||e.type==CKEDITOR.NODE_COMMENT||e.isReadOnly()};if(!s.checkForward()||i.checkStartOfBlock()&&i.checkEndOfBlock())n=u.fixBlock(!0,n.activeEnterMode==CKEDITOR.ENTER_DIV?"div":"p"),CKEDITOR.env.needsBrFiller||(n=n.getFirst(r))&&n.type==CKEDITOR.NODE_TEXT&&CKEDITOR.tools.trim(n.getText()).match(/^(?:&nbsp;|\xa0)$/)&&n.remove(),a=1,e.cancel()}a&&u.select()}function t(e,t){if(e.isFake)return 0;var n=t.block||t.blockLimit,i=n&&n.getLast(r);if(n&&n.isBlockBoundary()&&(!i||i.type!=CKEDITOR.NODE_ELEMENT||!i.isBlockBoundary())&&!n.is("pre")&&!n.getBogus())return n}function n(e){var t=e.data.getTarget();t.is("input")&&(t=t.getAttribute("type"),(t=="submit"||t=="reset")&&e.data.preventDefault())}function r(e){return c(e)&&h(e)}function i(e,t){return function(n){var r=CKEDITOR.dom.element.get(n.data.$.toElement||n.data.$.fromElement||n.data.$.relatedTarget);(!r||!t.equals(r)&&!t.contains(r))&&e.call(this,n)}}function s(e){var t,n=e.getRanges()[0],i=e.root,s={table:1,ul:1,ol:1,dl:1};if(n.startPath().contains(s)){var e=function(e){return function(n,i){i&&n.type==CKEDITOR.NODE_ELEMENT&&n.is(s)&&(t=n);if(!i&&r(n)&&(!e||!f(n)))return!1}},o=n.clone();o.collapse(1),o.setStartAt(i,CKEDITOR.POSITION_AFTER_START),i=new CKEDITOR.dom.walker(o),i.guard=e(),i.checkBackward();if(t)return o=n.clone(),o.collapse(),o.setEndAt(t,CKEDITOR.POSITION_AFTER_END),i=new CKEDITOR.dom.walker(o),i.guard=e(!0),t=!1,i.checkForward(),t}return null}function o(e){e.editor.focus(),e.editor.fire("saveSnapshot")}function u(e){var t=e.editor;t.getSelection().scrollIntoView(),setTimeout(function(){t.fire("saveSnapshot")},0)}function a(e,t,n){for(var r=e.getCommonAncestor(t),t=e=n?t:e;(e=e.getParent())&&!r.equals(e)&&e.getChildCount()==1;)t=e;t.remove()}CKEDITOR.editable=CKEDITOR.tools.createClass({base:CKEDITOR.dom.element,$:function(e,t){this.base(t.$||t),this.editor=e,this.status="unloaded",this.hasFocus=!1,this.setup()},proto:{focus:function(){var e;if(CKEDITOR.env.webkit&&!this.hasFocus){e=this.editor._.previousActive||this.getDocument().getActive();if(this.contains(e)){e.focus();return}}try{this.$[CKEDITOR.env.ie&&this.getDocument().equals(CKEDITOR.document)?"setActive":"focus"]()}catch(t){if(!CKEDITOR.env.ie)throw t}CKEDITOR.env.safari&&!this.isInline()&&(e=CKEDITOR.document.getActive(),e.equals(this.getWindow().getFrame())||this.getWindow().focus())},on:function(e,t){var n=Array.prototype.slice.call(arguments,0);return CKEDITOR.env.ie&&/^focus|blur$/.exec(e)&&(e=e=="focus"?"focusin":"focusout",t=i(t,this),n[0]=e,n[1]=t),CKEDITOR.dom.element.prototype.on.apply(this,n)},attachListener:function(e,t,n,r,i,s){!this._.listeners&&(this._.listeners=[]);var o=Array.prototype.slice.call(arguments,1),o=e.on.apply(e,o);return this._.listeners.push(o),o},clearListeners:function(){var e=this._.listeners;try{for(;e.length;)e.pop().removeListener()}catch(t){}},restoreAttrs:function(){var e=this._.attrChanges,t,n;for(n in e)e.hasOwnProperty(n)&&(t=e[n],t!==null?this.setAttribute(n,t):this.removeAttribute(n))},attachClass:function(e){var t=this.getCustomData("classes");this.hasClass(e)||(!t&&(t=[]),t.push(e),this.setCustomData("classes",t),this.addClass(e))},changeAttr:function(e,t){var n=this.getAttribute(e);t!==n&&(!this._.attrChanges&&(this._.attrChanges={}),e in this._.attrChanges||(this._.attrChanges[e]=n),this.setAttribute(e,t))},insertHtml:function(e,t){o(this),p(this,t||"html",e)},insertText:function(e){o(this);var t=this.editor,n=t.getSelection().getStartElement().hasAscendant("pre",!0)?CKEDITOR.ENTER_BR:t.activeEnterMode,t=n==CKEDITOR.ENTER_BR,r=CKEDITOR.tools,e=r.htmlEncode(e.replace(/\r\n/g,"\n")),e=e.replace(/\t/g,"&nbsp;&nbsp; &nbsp;"),n=n==CKEDITOR.ENTER_P?"p":"div";if(!t){var i=/\n{2}/g;if(i.test(e))var s="<"+n+">",u="</"+n+">",e=s+e.replace(i,function(){return u+s})+u}e=e.replace(/\n/g,"<br>"),t||(e=e.replace(RegExp("<br>(?=</"+n+">)"),function(e){return r.repeat(e,2)})),e=e.replace(/^ | $/g,"&nbsp;"),e=e.replace(/(>|\s) /g,function(e,t){return t+"&nbsp;"}).replace(/ (?=<)/g,"&nbsp;"),p(this,"text",e)},insertElement:function(e,t){t?this.insertElementIntoRange(e,t):this.insertElementIntoSelection(e)},insertElementIntoRange:function(e,t){var n=this.editor,r=n.config.enterMode,i=e.getName(),s=CKEDITOR.dtd.$block[i];if(t.checkReadOnly())return!1;t.deleteContents(1),t.startContainer.type==CKEDITOR.NODE_ELEMENT&&t.startContainer.is({tr:1,table:1,tbody:1,thead:1,tfoot:1})&&d(t);var o,u;if(s)for(;(o=t.getCommonAncestor(0,1))&&(u=CKEDITOR.dtd[o.getName()])&&(!u||!u[i]);)o.getName()in CKEDITOR.dtd.span?t.splitElement(o):t.checkStartOfBlock()&&t.checkEndOfBlock()?(t.setStartBefore(o),t.collapse(!0),o.remove()):t.splitBlock(r==CKEDITOR.ENTER_DIV?"div":"p",n.editable());return t.insertNode(e),!0},insertElementIntoSelection:function(e){o(this);var t=this.editor,n=t.activeEnterMode,t=t.getSelection(),i=t.getRanges()[0],s=e.getName(),s=CKEDITOR.dtd.$block[s];this.insertElementIntoRange(e,i)&&(i.moveToPosition(e,CKEDITOR.POSITION_AFTER_END),s&&((s=e.getNext(function(e){return r(e)&&!f(e)}))&&s.type==CKEDITOR.NODE_ELEMENT&&s.is(CKEDITOR.dtd.$block)?s.getDtd()["#"]?i.moveToElementEditStart(s):i.moveToElementEditEnd(e):!s&&n!=CKEDITOR.ENTER_BR&&(s=i.fixBlock(!0,n==CKEDITOR.ENTER_DIV?"div":"p"),i.moveToElementEditStart(s)))),t.selectRanges([i]),u(this)},setData:function(e,t){t||(e=this.editor.dataProcessor.toHtml(e)),this.setHtml(e),this.status=="unloaded"&&(this.status="ready"),this.editor.fire("dataReady")},getData:function(e){var t=this.getHtml();return e||(t=this.editor.dataProcessor.toDataFormat(t)),t},setReadOnly:function(e){this.setAttribute("contenteditable",!e)},detach:function(){this.removeClass("cke_editable"),this.status="detached";var e=this.editor;this._.detach(),delete e.document,delete e.window},isInline:function(){return this.getDocument().equals(CKEDITOR.document)},setup:function(){var e=this.editor;this.attachListener(e,"beforeGetData",function(){var t=this.getData();this.is("textarea")||e.config.ignoreEmptyParagraph!==!1&&(t=t.replace(l,function(e,t){return t})),e.setData(t,null,1)},this),this.attachListener(e,"getSnapshot",function(e){e.data=this.getData(1)},this),this.attachListener(e,"afterSetData",function(){this.setData(e.getData(1))},this),this.attachListener(e,"loadSnapshot",function(e){this.setData(e.data,1)},this),this.attachListener(e,"beforeFocus",function(){var t=e.getSelection();(t=t&&t.getNative())&&t.type=="Control"||this.focus()},this),this.attachListener(e,"insertHtml",function(e){this.insertHtml(e.data.dataValue,e.data.mode)},this),this.attachListener(e,"insertElement",function(e){this.insertElement(e.data)},this),this.attachListener(e,"insertText",function(e){this.insertText(e.data)},this),this.setReadOnly(e.readOnly),this.attachClass("cke_editable"),this.attachClass(e.elementMode==CKEDITOR.ELEMENT_MODE_INLINE?"cke_editable_inline":e.elementMode==CKEDITOR.ELEMENT_MODE_REPLACE||e.elementMode==CKEDITOR.ELEMENT_MODE_APPENDTO?"cke_editable_themed":""),this.attachClass("cke_contents_"+e.config.contentsLangDirection),e.keystrokeHandler.blockedKeystrokes[8]=+e.readOnly,e.keystrokeHandler.attach(this),this.on("blur",function(){this.hasFocus=!1},null,null,-1),this.on("focus",function(){this.hasFocus=!0},null,null,-1),e.focusManager.add(this),this.equals(CKEDITOR.document.getActive())&&(this.hasFocus=!0,e.once("contentDom",function(){e.focusManager.focus()})),this.isInline()&&this.changeAttr("tabindex",e.tabIndex);if(!this.is("textarea")){e.document=this.getDocument(),e.window=this.getWindow();var t=e.document;this.changeAttr("spellcheck",!e.config.disableNativeSpellChecker);var i=e.config.contentsLangDirection;this.getDirection(1)!=i&&this.changeAttr("dir",i);var o=CKEDITOR.getCss();o&&(i=t.getHead(),i.getCustomData("stylesheet")||(o=t.appendStyleText(o),o=new CKEDITOR.dom.element(o.ownerNode||o.owningElement),i.setCustomData("stylesheet",o),o.data("cke-temp",1))),i=t.getCustomData("stylesheet_ref")||0,t.setCustomData("stylesheet_ref",i+1),this.setCustomData("cke_includeReadonly",!e.config.disableReadonlyStyling),this.attachListener(this,"click",function(e){var e=e.data,t=(new CKEDITOR.dom.elementPath(e.getTarget(),this)).contains("a");t&&e.$.button!=2&&t.isReadOnly()&&e.preventDefault()});var u={8:1,46:1};this.attachListener(e,"key",function(t){if(e.readOnly)return!0;var n=t.data.domEvent.getKey(),r;if(n in u){var t=e.getSelection(),i,o=t.getRanges()[0],a=o.startPath(),f,l,h,n=n==8;CKEDITOR.env.ie&&CKEDITOR.env.version<11&&(i=t.getSelectedElement())||(i=s(t))?(e.fire("saveSnapshot"),o.moveToPosition(i,CKEDITOR.POSITION_BEFORE_START),i.remove(),o.select(),e.fire("saveSnapshot"),r=1):o.collapsed&&((f=a.block)&&(h=f[n?"getPrevious":"getNext"](c))&&h.type==CKEDITOR.NODE_ELEMENT&&h.is("table")&&o[n?"checkStartOfBlock":"checkEndOfBlock"]()?(e.fire("saveSnapshot"),o[n?"checkEndOfBlock":"checkStartOfBlock"]()&&f.remove(),o["moveToElementEdit"+(n?"End":"Start")](h),o.select(),e.fire("saveSnapshot"),r=1):a.blockLimit&&a.blockLimit.is("td")&&(l=a.blockLimit.getAscendant("table"))&&o.checkBoundaryOfElement(l,n?CKEDITOR.START:CKEDITOR.END)&&(h=l[n?"getPrevious":"getNext"](c))?(e.fire("saveSnapshot"),o["moveToElementEdit"+(n?"End":"Start")](h),o.checkStartOfBlock()&&o.checkEndOfBlock()?h.remove():o.select(),e.fire("saveSnapshot"),r=1):(l=a.contains(["td","th","caption"]))&&o.checkBoundaryOfElement(l,n?CKEDITOR.START:CKEDITOR.END)&&(r=1))}return!r}),e.blockless&&CKEDITOR.env.ie&&CKEDITOR.env.needsBrFiller&&this.attachListener(this,"keyup",function(t){t.data.getKeystroke()in u&&!this.getFirst(r)&&(this.appendBogus(),t=e.createRange(),t.moveToPosition(this,CKEDITOR.POSITION_AFTER_START),t.select())}),this.attachListener(this,"dblclick",function(t){if(e.readOnly)return!1;t={element:t.data.getTarget()},e.fire("doubleclick",t)}),CKEDITOR.env.ie&&this.attachListener(this,"click",n),CKEDITOR.env.ie||this.attachListener(this,"mousedown",function(t){var n=t.data.getTarget();n.is("img","hr","input","textarea","select")&&!n.isReadOnly()&&(e.getSelection().selectElement(n),n.is("input","textarea","select")&&t.data.preventDefault())}),CKEDITOR.env.gecko&&this.attachListener(this,"mouseup",function(t){if(t.data.$.button==2){t=t.data.getTarget();if(!t.getOuterHtml().replace(l,"")){var n=e.createRange();n.moveToElementEditStart(t),n.select(!0)}}}),CKEDITOR.env.webkit&&(this.attachListener(this,"click",function(e){e.data.getTarget().is("input","select")&&e.data.preventDefault()}),this.attachListener(this,"mouseup",function(e){e.data.getTarget().is("input","textarea")&&e.data.preventDefault()})),CKEDITOR.env.webkit&&this.attachListener(e,"key",function(t){t=t.data.domEvent.getKey();if(t in u){var n=t==8,r=e.getSelection().getRanges()[0],t=r.startPath();if(r.collapsed){var i;e:{var s=t.block;if(s)if(r[n?"checkStartOfBlock":"checkEndOfBlock"]())if(!r.moveToClosestEditablePosition(s,!n)||!r.collapsed)i=!1;else{if(r.startContainer.type==CKEDITOR.NODE_ELEMENT){var o=r.startContainer.getChild(r.startOffset-(n?1:0));if(o&&o.type==CKEDITOR.NODE_ELEMENT&&o.is("hr")){e.fire("saveSnapshot"),o.remove(),i=!0;break e}}if((r=r.startPath().block)&&(!r||!r.contains(s))){e.fire("saveSnapshot");var f;(f=(n?r:s).getBogus())&&f.remove(),i=e.getSelection(),f=i.createBookmarks(),(n?s:r).moveChildren(n?r:s,!1),t.lastElement.mergeSiblings(),a(s,r,!n),i.selectBookmarks(f),i=!0}}else i=!1;else i=!1}if(!i)return}else{n=r,i=t.block,f=n.endPath().block,!i||!f||i.equals(f)?t=!1:(e.fire("saveSnapshot"),(s=i.getBogus())&&s.remove(),n.deleteContents(),f.getParent()&&(f.moveChildren(i,!1),t.lastElement.mergeSiblings(),a(i,f,!0)),n=e.getSelection().getRanges()[0],n.collapse(1),n.select(),t=!0);if(!t)return}return e.getSelection().scrollIntoView(),e.fire("saveSnapshot"),!1}},this,null,100)}}},_:{detach:function(){this.editor.setData(this.editor.getData(),0,1),this.clearListeners(),this.restoreAttrs();var e;if(e=this.removeCustomData("classes"))for(;e.length;)this.removeClass(e.pop());if(!this.is("textarea")){e=this.getDocument();var t=e.getHead();if(t.getCustomData("stylesheet")){var n=e.getCustomData("stylesheet_ref");--n?e.setCustomData("stylesheet_ref",n):(e.removeCustomData("stylesheet_ref"),t.removeCustomData("stylesheet").remove())}}this.editor.fire("contentDomUnload"),delete this.editor}}}),CKEDITOR.editor.prototype.editable=function(e){var t=this._.editable;return t&&e?0:(arguments.length&&(t=this._.editable=e?e instanceof CKEDITOR.editable?e:new CKEDITOR.editable(this,e):(t&&t.detach(),null)),t)};var f=CKEDITOR.dom.walker.bogus(),l=/(^|<body\b[^>]*>)\s*<(p|div|address|h\d|center|pre)[^>]*>\s*(?:<br[^>]*>|&nbsp;|\u00A0|&#160;)?\s*(:?<\/\2>)?\s*(?=$|<\/body>)/gi,c=CKEDITOR.dom.walker.whitespaces(!0),h=CKEDITOR.dom.walker.bookmark(!1,!0);CKEDITOR.on("instanceLoaded",function(t){var n=t.editor;n.on("insertElement",function(e){e=e.data,e.type==CKEDITOR.NODE_ELEMENT&&(e.is("input")||e.is("textarea"))&&(e.getAttribute("contentEditable")!="false"&&e.data("cke-editable",e.hasAttribute("contenteditable")?"true":"1"),e.setAttribute("contentEditable",!1))}),n.on("selectionChange",function(t){if(!n.readOnly){var r=n.getSelection();r&&!r.isLocked&&(r=n.checkDirty(),n.fire("lockSnapshot"),e(t),n.fire("unlockSnapshot"),!r&&n.resetDirty())}})}),CKEDITOR.on("instanceCreated",function(e){var t=e.editor;t.on("mode",function(){var e=t.editable();if(e&&e.isInline()){var n=t.title;e.changeAttr("role","textbox"),e.changeAttr("aria-label",n),n&&e.changeAttr("title",n);var r=t.fire("ariaEditorHelpLabel",{}).label;if(r)if(n=this.ui.space(this.elementMode==CKEDITOR.ELEMENT_MODE_INLINE?"top":"contents")){var i=CKEDITOR.tools.getNextId(),r=CKEDITOR.dom.element.createFromHtml('<span id="'+i+'" class="cke_voice_label">'+r+"</span>");n.append(r),e.changeAttr("aria-describedby",i)}}})}),CKEDITOR.addCss(".cke_editable{cursor:text}.cke_editable img,.cke_editable input,.cke_editable textarea{cursor:default}");var p=function(){function e(e){return e.type==CKEDITOR.NODE_ELEMENT}function t(n,r){var i,s,o,u,f=[],l=r.range.startContainer;i=r.range.startPath();for(var l=a[l.getName()],c=0,h=n.getChildren(),p=h.count(),d=-1,v=-1,m=0,g=i.contains(a.$list);c<p;++c)i=h.getItem(c),e(i)?(o=i.getName(),g&&o in CKEDITOR.dtd.$list?f=f.concat(t(i,r)):(u=!!l[o],o=="br"&&i.data("cke-eol")&&(!c||c==p-1)&&(m=(s=c?f[c-1].node:h.getItem(c+1))&&(!e(s)||!s.is("br")),s=s&&e(s)&&a.$block[s.getName()]),d==-1&&!u&&(d=c),u||(v=c),f.push({isElement:1,isLineBreak:m,isBlock:i.isBlockBoundary(),hasBlockSibling:s,node:i,name:o,allowed:u}),s=m=0)):f.push({isElement:0,node:i,allowed:1});return d>-1&&(f[d].firstNotAllowed=1),v>-1&&(f[v].lastNotAllowed=1),f}function n(t,r){var i=[],s=t.getChildren(),o=s.count(),u,f=0,l=a[r],c=!t.is(a.$inline)||t.is("br");for(c&&i.push(" ");f<o;f++)u=s.getItem(f),e(u)&&!u.is(l)?i=i.concat(n(u,r)):i.push(u);return c&&i.push(" "),i}function i(t){return t&&e(t)&&(t.is(a.$removeEmpty)||t.is("a")&&!t.isBlockBoundary())}function s(t,n,r,i){var o=t.clone(),u,a;o.setEndAt(n,CKEDITOR.POSITION_BEFORE_END),(u=(new CKEDITOR.dom.walker(o)).next())&&e(u)&&f[u.getName()]&&(a=u.getPrevious())&&e(a)&&!a.getParent().equals(t.startContainer)&&r.contains(a)&&i.contains(u)&&u.isIdentical(a)&&(u.moveChildren(a),u.remove(),s(t,n,r,i))}function o(t,n){function r(t,n){if(n.isBlock&&n.isElement&&!n.node.is("br")&&e(t)&&t.is("br"))return t.remove(),1}var i=n.endContainer.getChild(n.endOffset),s=n.endContainer.getChild(n.endOffset-1);i&&r(i,t[t.length-1]),s&&r(s,t[0])&&(n.setEnd(n.endContainer,n.endOffset-1),n.collapse())}var a=CKEDITOR.dtd,f={p:1,div:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,ul:1,ol:1,li:1,pre:1,dl:1,blockquote:1},l={p:1,div:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1},c=CKEDITOR.tools.extend({},a.$inline);return delete c.br,function(f,h,p){var d=f.editor;f.getDocument();var v=d.getSelection().getRanges()[0],m=!1;h=="unfiltered_html"&&(h="html",m=!0);if(!v.checkReadOnly()){var g=(new CKEDITOR.dom.elementPath(v.startContainer,v.root)).blockLimit||v.root,h={type:h,dontFilter:m,editable:f,editor:d,range:v,blockLimit:g,mergeCandidates:[],zombies:[]},d=h.range,m=h.mergeCandidates,y,w,E,S;h.type=="text"&&d.shrink(CKEDITOR.SHRINK_ELEMENT,!0,!1)&&(y=CKEDITOR.dom.element.createFromHtml("<span>&nbsp;</span>",d.document),d.insertNode(y),d.setStartAfter(y)),w=new CKEDITOR.dom.elementPath(d.startContainer),h.endPath=E=new CKEDITOR.dom.elementPath(d.endContainer);if(!d.collapsed){var g=E.block||E.blockLimit,x=d.getCommonAncestor();g&&!g.equals(x)&&!g.contains(x)&&d.checkEndOfBlock()&&h.zombies.push(g),d.deleteContents()}for(;(S=e(d.startContainer)&&d.startContainer.getChild(d.startOffset-1))&&e(S)&&S.isBlockBoundary()&&w.contains(S);)d.moveToPosition(S,CKEDITOR.POSITION_BEFORE_END);s(d,h.blockLimit,w,E),y&&(d.setEndBefore(y),d.collapse(),y.remove()),y=d.startPath();if(g=y.contains(i,!1,1))d.splitElement(g),h.inlineStylesRoot=g,h.inlineStylesPeak=y.lastElement;y=d.createBookmark(),(g=y.startNode.getPrevious(r))&&e(g)&&i(g)&&m.push(g),(g=y.startNode.getNext(r))&&e(g)&&i(g)&&m.push(g);for(g=y.startNode;(g=g.getParent())&&i(g);)m.push(g);d.moveToBookmark(y);if(y=p){y=h.range;if(h.type=="text"&&h.inlineStylesRoot){S=h.inlineStylesPeak,d=S.getDocument().createText("{cke-peak}");for(m=h.inlineStylesRoot.getParent();!S.equals(m);)d=d.appendTo(S.clone()),S=S.getParent();p=d.getOuterHtml().split("{cke-peak}").join(p)}S=h.blockLimit.getName();if(/^\s+|\s+$/.test(p)&&"span"in CKEDITOR.dtd[S])var T='<span data-cke-marker="1">&nbsp;</span>',p=T+p+T;p=h.editor.dataProcessor.toHtml(p,{context:null,fixForBody:!1,dontFilter:h.dontFilter,filter:h.editor.activeFilter,enterMode:h.editor.activeEnterMode}),S=y.document.createElement("body"),S.setHtml(p),T&&(S.getFirst().remove(),S.getLast().remove());if((T=y.startPath().block)&&(T.getChildCount()!=1||!T.getBogus()))e:{var N;if(S.getChildCount()==1&&e(N=S.getFirst())&&N.is(l)){T=N.getElementsByTag("*"),y=0;for(m=T.count();y<m;y++){d=T.getItem(y);if(!d.is(c))break e}N.moveChildren(N.getParent(1)),N.remove()}}h.dataWrapper=S,y=p}if(y){N=h.range;var T=N.document,C,p=h.blockLimit;y=0;var L;S=[];var A,O,m=d=0,M,_;w=N.startContainer;var g=h.endPath.elements[0],D;E=g.getPosition(w),x=!!g.getCommonAncestor(w)&&E!=CKEDITOR.POSITION_IDENTICAL&&!(E&CKEDITOR.POSITION_CONTAINS+CKEDITOR.POSITION_IS_CONTAINED),w=t(h.dataWrapper,h);for(o(w,N);y<w.length;y++){E=w[y];if(C=E.isLineBreak){C=N,M=p;var P=void 0,H=void 0;E.hasBlockSibling?C=1:(P=C.startContainer.getAscendant(a.$block,1),!P||!P.is({div:1,p:1})?C=0:(H=P.getPosition(M),H==CKEDITOR.POSITION_IDENTICAL||H==CKEDITOR.POSITION_CONTAINS?C=0:(M=C.splitElement(P),C.moveToPosition(M,CKEDITOR.POSITION_AFTER_START),C=1)))}if(C)m=y>0;else{C=N.startPath(),!E.isBlock&&h.editor.config.autoParagraph!==!1&&h.editor.activeEnterMode!=CKEDITOR.ENTER_BR&&h.editor.editable().equals(C.blockLimit)&&!C.block&&(O=h.editor.activeEnterMode!=CKEDITOR.ENTER_BR&&h.editor.config.autoParagraph!==!1?h.editor.activeEnterMode==CKEDITOR.ENTER_DIV?"div":"p":!1)&&(O=T.createElement(O),O.appendBogus(),N.insertNode(O),CKEDITOR.env.needsBrFiller&&(L=O.getBogus())&&L.remove(),N.moveToPosition(O,CKEDITOR.POSITION_BEFORE_END));if((C=N.startPath().block)&&!C.equals(A)){if(L=C.getBogus())L.remove(),S.push(C);A=C}E.firstNotAllowed&&(d=1);if(d&&E.isElement){C=N.startContainer;for(M=null;C&&!a[C.getName()][E.name];){if(C.equals(p)){C=null;break}M=C,C=C.getParent()}if(C)M&&(_=N.splitElement(M),h.zombies.push(_),h.zombies.push(M));else{M=p.getName(),D=!y,C=y==w.length-1,M=n(E.node,M);for(var P=[],H=M.length,B=0,F=void 0,I=0,q=-1;B<H;B++)F=M[B],F==" "?(!I&&(!D||B)&&(P.push(new CKEDITOR.dom.text(" ")),q=P.length),I=1):(P.push(F),I=0);C&&q==P.length&&P.pop(),D=P}}if(D){for(;C=D.pop();)N.insertNode(C);D=0}else N.insertNode(E.node);E.lastNotAllowed&&y<w.length-1&&((_=x?g:_)&&N.setEndAt(_,CKEDITOR.POSITION_AFTER_START),d=0),N.collapse()}}h.dontMoveCaret=m,h.bogusNeededBlocks=S}L=h.range;var R;_=h.bogusNeededBlocks;for(D=L.createBookmark();A=h.zombies.pop();)A.getParent()&&(O=L.clone(),O.moveToElementEditStart(A),O.removeEmptyBlocksAtEnd());if(_)for(;A=_.pop();)CKEDITOR.env.needsBrFiller?A.appendBogus():A.append(L.document.createText(" "));for(;A=h.mergeCandidates.pop();)A.mergeSiblings();L.moveToBookmark(D);if(!h.dontMoveCaret){for(A=e(L.startContainer)&&L.startContainer.getChild(L.startOffset-1);A&&e(A)&&!A.is(a.$empty);){if(A.isBlockBoundary())L.moveToPosition(A,CKEDITOR.POSITION_BEFORE_END);else{if(i(A)&&A.getHtml().match(/(\s|&nbsp;)$/g)){R=null;break}R=L.clone(),R.moveToPosition(A,CKEDITOR.POSITION_BEFORE_END)}A=A.getLast(r)}R&&L.moveToRange(R)}v.select(),u(f)}}}(),d=function(){function e(e){return e=new CKEDITOR.dom.walker(e),e.guard=function(e,t){if(t)return!1;if(e.type==CKEDITOR.NODE_ELEMENT)return e.is(CKEDITOR.dtd.$tableContent)},e.evaluator=function(e){return e.type==CKEDITOR.NODE_ELEMENT},e}function t(e,t,n){return t=e.getDocument().createElement(t),e.append(t,n),t}function n(e){var t=e.count(),n;for(t;t-->0;)n=e.getItem(t),CKEDITOR.tools.trim(n.getHtml())||(n.appendBogus(),CKEDITOR.env.ie&&CKEDITOR.env.version<9&&n.getChildCount()&&n.getFirst().remove())}return function(r){var i=r.startContainer,s=i.getAscendant("table",1),o=!1;n(s.getElementsByTag("td")),n(s.getElementsByTag("th")),s=r.clone(),s.setStart(i,0),s=e(s).lastBackward(),s||(s=r.clone(),s.setEndAt(i,CKEDITOR.POSITION_BEFORE_END),s=e(s).lastForward(),o=!0),s||(s=i),s.is("table")?(r.setStartAt(s,CKEDITOR.POSITION_BEFORE_START),r.collapse(!0),s.remove()):(s.is({tbody:1,thead:1,tfoot:1})&&(s=t(s,"tr",o)),s.is("tr")&&(s=t(s,s.getParent().is("thead")?"th":"td",o)),(i=s.getBogus())&&i.remove(),r.moveToPosition(s,o?CKEDITOR.POSITION_AFTER_START:CKEDITOR.POSITION_BEFORE_END))}}()}(),function(){function e(){var e=this._.fakeSelection,t;if(e){t=this.getSelection(1);if(!t||!t.isHidden())e.reset(),e=0}if(!e){e=t||this.getSelection(1);if(!e||e.getType()==CKEDITOR.SELECTION_NONE)return}this.fire("selectionCheck",e),t=this.elementPath(),t.compare(this._.selectionPreviousPath)||(CKEDITOR.env.webkit&&(this._.previousActive=this.document.getActive()),this._.selectionPreviousPath=t,this.fire("selectionChange",{selection:e,path:t}))}function t(){h=!0,c||(n.call(this),c=CKEDITOR.tools.setTimeout(n,200,this))}function n(){c=null,h&&(CKEDITOR.tools.setTimeout(e,0,this),h=!1)}function r(e){function t(t,n){return!t||t.type==CKEDITOR.NODE_TEXT?!1:e.clone()["moveToElementEdit"+(n?"End":"Start")](t)}if(e.root instanceof CKEDITOR.editable){var n=e.startContainer,r=e.getPreviousNode(p,null,n),i=e.getNextNode(p,null,n);return t(r)||t(i,1)||!r&&!i&&(n.type!=CKEDITOR.NODE_ELEMENT||!n.isBlockBoundary()||!n.getBogus())?!0:!1}return!1}function i(e){return e.getCustomData("cke-fillingChar")}function s(e,t){var n=e&&e.removeCustomData("cke-fillingChar");if(n){if(t!==!1){var r,i=e.getDocument().getSelection().getNative(),s=i&&i.type!="None"&&i.getRangeAt(0);if(n.getLength()>1&&s&&s.intersectsNode(n.$)){r=[i.anchorOffset,i.focusOffset],s=i.focusNode==n.$&&i.focusOffset>0,i.anchorNode==n.$&&i.anchorOffset>0&&r[0]--,s&&r[1]--;var u;s=i,s.isCollapsed||(u=s.getRangeAt(0),u.setStart(s.anchorNode,s.anchorOffset),u.setEnd(s.focusNode,s.focusOffset),u=u.collapsed),u&&r.unshift(r.pop())}}n.setText(o(n.getText())),r&&(n=i.getRangeAt(0),n.setStart(n.startContainer,r[0]),n.setEnd(n.startContainer,r[1]),i.removeAllRanges(),i.addRange(n))}}function o(e){return e.replace(/\u200B( )?/g,function(e){return e[1]?" ":""})}function u(e,t,n){var r=e.on("focus",function(e){e.cancel()},null,null,-100);if(CKEDITOR.env.ie)var i=e.getDocument().on("selectionchange",function(e){e.cancel()},null,null,-100);else{var s=new CKEDITOR.dom.range(e);s.moveToElementEditStart(e);var o=e.getDocument().$.createRange();o.setStart(s.startContainer.$,s.startOffset),o.collapse(1),t.removeAllRanges(),t.addRange(o)}n&&e.focus(),r.removeListener(),i&&i.removeListener()}function a(e){var t=CKEDITOR.dom.element.createFromHtml('<div data-cke-hidden-sel="1" data-cke-temp="1" style="'+(CKEDITOR.env.ie?"display:none":"position:fixed;top:0;left:-1000px")+'">&nbsp;</div>',e.document);e.fire("lockSnapshot"),e.editable().append(t);var n=e.getSelection(1),r=e.createRange(),i=n.root.on("selectionchange",function(e){e.cancel()},null,null,0);r.setStartAt(t,CKEDITOR.POSITION_AFTER_START),r.setEndAt(t,CKEDITOR.POSITION_BEFORE_END),n.selectRanges([r]),i.removeListener(),e.fire("unlockSnapshot"),e._.hiddenSelectionContainer=t}function f(e){var t={37:1,39:1,8:1,46:1};return function(n){var r=n.data.getKeystroke();if(t[r]){var i=e.getSelection().getRanges(),s=i[0];i.length==1&&s.collapsed&&(r=s[r<38?"getPreviousEditableNode":"getNextEditableNode"]())&&r.type==CKEDITOR.NODE_ELEMENT&&r.getAttribute("contenteditable")=="false"&&(e.getSelection().fake(r),n.data.preventDefault(),n.cancel())}}}function l(e){for(var t=0;t<e.length;t++){var n=e[t];n.getCommonAncestor().isReadOnly()&&e.splice(t,1);if(!n.collapsed){if(n.startContainer.isReadOnly())for(var r=n.startContainer,i;r;){if((i=r.type==CKEDITOR.NODE_ELEMENT)&&r.is("body")||!r.isReadOnly())break;i&&r.getAttribute("contentEditable")=="false"&&n.setStartAfter(r),r=r.getParent()}r=n.startContainer,i=n.endContainer;var s=n.startOffset,o=n.endOffset,u=n.clone();r&&r.type==CKEDITOR.NODE_TEXT&&(s>=r.getLength()?u.setStartAfter(r):u.setStartBefore(r)),i&&i.type==CKEDITOR.NODE_TEXT&&(o?u.setEndAfter(i):u.setEndBefore(i)),r=new CKEDITOR.dom.walker(u),r.evaluator=function(r){if(r.type==CKEDITOR.NODE_ELEMENT&&r.isReadOnly()){var i=n.clone();return n.setEndBefore(r),n.collapsed&&e.splice(t--,1),r.getPosition(u.endContainer)&CKEDITOR.POSITION_CONTAINS||(i.setStartAfter(r),i.collapsed||e.splice(t+1,0,i)),!0}return!1},r.next()}}return e}var c,h,p=CKEDITOR.dom.walker.invisible(1),d=function(){function e(e){return function(t){var n=t.editor.createRange();return n.moveToClosestEditablePosition(t.selected,e)&&t.editor.getSelection().selectRanges([n]),!1}}function t(e){return function(t){var n=t.editor,r=n.createRange(),i;return(i=r.moveToClosestEditablePosition(t.selected,e))||(i=r.moveToClosestEditablePosition(t.selected,!e)),i&&n.getSelection().selectRanges([r]),n.fire("saveSnapshot"),t.selected.remove(),i||(r.moveToElementEditablePosition(n.editable()),n.getSelection().selectRanges([r])),n.fire("saveSnapshot"),!1}}var n=e(),r=e(1);return{37:n,38:n,39:r,40:r,8:t(),46:t(1)}}();CKEDITOR.on("instanceCreated",function(n){function r(){var e=i.getSelection();e&&e.removeAllRanges()}var i=n.editor;i.on("contentDom",function(){var n=i.document,r=CKEDITOR.document,o=i.editable(),u=n.getBody(),a=n.getDocumentElement(),l=o.isInline(),c,h;CKEDITOR.env.gecko&&o.attachListener(o,"focus",function(e){e.removeListener(),c!==0&&(e=i.getSelection().getNative())&&e.isCollapsed&&e.anchorNode==o.$&&(e=i.createRange(),e.moveToElementEditStart(o),e.select())},null,null,-2),o.attachListener(o,CKEDITOR.env.webkit?"DOMFocusIn":"focus",function(){c&&CKEDITOR.env.webkit&&(c=i._.previousActive&&i._.previousActive.equals(n.getActive())),i.unlockSelection(c),c=0},null,null,-1),o.attachListener(o,"mousedown",function(){c=0});if(CKEDITOR.env.ie||l){var p=function(){h=new CKEDITOR.dom.selection(i.getSelection()),h.lock()};v?o.attachListener(o,"beforedeactivate",p,null,null,-1):o.attachListener(i,"selectionCheck",p,null,null,-1),o.attachListener(o,CKEDITOR.env.webkit?"DOMFocusOut":"blur",function(){i.lockSelection(h),c=1},null,null,-1),o.attachListener(o,"mousedown",function(){c=0})}if(CKEDITOR.env.ie&&!l){var d;o.attachListener(o,"mousedown",function(e){if(e.data.$.button==2){e=i.document.getSelection();if(!e||e.getType()==CKEDITOR.SELECTION_NONE)d=i.window.getScrollPosition()}}),o.attachListener(o,"mouseup",function(e){e.data.$.button==2&&d&&(i.document.$.documentElement.scrollLeft=d.x,i.document.$.documentElement.scrollTop=d.y),d=null});if(n.$.compatMode!="BackCompat"){(CKEDITOR.env.ie7Compat||CKEDITOR.env.ie6Compat)&&a.on("mousedown",function(e){function t(e){e=e.data.$;if(i){var t=u.$.createTextRange();try{t.moveToPoint(e.clientX,e.clientY)}catch(n){}i.setEndPoint(o.compareEndPoints("StartToStart",t)<0?"EndToEnd":"StartToStart",t),i.select()}}function n(){a.removeListener("mousemove",t),r.removeListener("mouseup",n),a.removeListener("mouseup",n),i.select()}e=e.data;if(e.getTarget().is("html")&&e.$.y<a.$.clientHeight&&e.$.x<a.$.clientWidth){var i=u.$.createTextRange();try{i.moveToPoint(e.$.clientX,e.$.clientY)}catch(s){}var o=i.duplicate();a.on("mousemove",t),r.on("mouseup",n),a.on("mouseup",n)}});if(CKEDITOR.env.version>7&&CKEDITOR.env.version<11){a.on("mousedown",function(e){e.data.getTarget().is("html")&&(r.on("mouseup",m),a.on("mouseup",m))});var m=function(){r.removeListener("mouseup",m),a.removeListener("mouseup",m);var e=CKEDITOR.document.$.selection,t=e.createRange();e.type!="None"&&t.parentElement().ownerDocument==n.$&&t.select()}}}}o.attachListener(o,"selectionchange",e,i),o.attachListener(o,"keyup",t,i),o.attachListener(o,CKEDITOR.env.webkit?"DOMFocusIn":"focus",function(){i.forceNextSelectionCheck(),i.selectionChange(1)});if(l&&(CKEDITOR.env.webkit||CKEDITOR.env.gecko)){var g;o.attachListener(o,"mousedown",function(){g=1}),o.attachListener(n.getDocumentElement(),"mouseup",function(){g&&t.call(i),g=0})}else o.attachListener(CKEDITOR.env.ie?o:n.getDocumentElement(),"mouseup",t,i);CKEDITOR.env.webkit&&o.attachListener(n,"keydown",function(e){switch(e.data.getKey()){case 13:case 33:case 34:case 35:case 36:case 37:case 39:case 8:case 45:case 46:s(o)}},null,null,-1),o.attachListener(o,"keydown",f(i),null,null,-1)}),i.on("setData",function(){i.unlockSelection(),CKEDITOR.env.webkit&&r()}),i.on("contentDomUnload",function(){i.unlockSelection()}),CKEDITOR.env.ie9Compat&&i.on("beforeDestroy",r,null,null,9),i.on("dataReady",function(){delete i._.fakeSelection,delete i._.hiddenSelectionContainer,i.selectionChange(1)}),i.on("loadSnapshot",function(){var e=i.editable().getLast(function(e){return e.type==CKEDITOR.NODE_ELEMENT});e&&e.hasAttribute("data-cke-hidden-sel")&&e.remove()},null,null,100),i.on("key",function(e){if(i.mode=="wysiwyg"){var t=i.getSelection();if(t.isFake){var n=d[e.data.keyCode];if(n)return n({editor:i,selected:t.getSelectedElement(),selection:t,keyEvent:e})}}})}),CKEDITOR.on("instanceReady",function(e){var t=e.editor;if(CKEDITOR.env.webkit){t.on("selectionChange",function(){var e=t.editable(),n=i(e);n&&(n.getCustomData("ready")?s(e):n.setCustomData("ready",1))},null,null,-1),t.on("beforeSetMode",function(){s(t.editable())},null,null,-1);var n,r,e=function(){var e=t.editable();if(e)if(e=i(e)){var s=t.document.$.defaultView.getSelection();s.type=="Caret"&&s.anchorNode==e.$&&(r=1),n=e.getText(),e.setText(o(n))}},u=function(){var e=t.editable();e&&(e=i(e))&&(e.setText(n),r&&(t.document.$.defaultView.getSelection().setPosition(e.$,e.getLength()),r=0))};t.on("beforeUndoImage",e),t.on("afterUndoImage",u),t.on("beforeGetData",e,null,null,0),t.on("getData",u)}}),CKEDITOR.editor.prototype.selectionChange=function(n){(n?e:t).call(this)},CKEDITOR.editor.prototype.getSelection=function(e){return(this._.savedSelection||this._.fakeSelection)&&!e?this._.savedSelection||this._.fakeSelection:(e=this.editable())&&this.mode=="wysiwyg"?new CKEDITOR.dom.selection(e):null},CKEDITOR.editor.prototype.lockSelection=function(e){return e=e||this.getSelection(1),e.getType()!=CKEDITOR.SELECTION_NONE?(!e.isLocked&&e.lock(),this._.savedSelection=e,!0):!1},CKEDITOR.editor.prototype.unlockSelection=function(e){var t=this._.savedSelection;return t?(t.unlock(e),delete this._.savedSelection,!0):!1},CKEDITOR.editor.prototype.forceNextSelectionCheck=function(){delete this._.selectionPreviousPath},CKEDITOR.dom.document.prototype.getSelection=function(){return new CKEDITOR.dom.selection(this)},CKEDITOR.dom.range.prototype.select=function(){var e=this.root instanceof CKEDITOR.editable?this.root.editor.getSelection():new CKEDITOR.dom.selection(this.root);return e.selectRanges([this]),e},CKEDITOR.SELECTION_NONE=1,CKEDITOR.SELECTION_TEXT=2,CKEDITOR.SELECTION_ELEMENT=3;var v=typeof window.getSelection!="function",m=1;CKEDITOR.dom.selection=function(e){if(e instanceof CKEDITOR.dom.selection)var t=e,e=e.root;var n=e instanceof CKEDITOR.dom.element;this.rev=t?t.rev:m++,this.document=e instanceof CKEDITOR.dom.document?e:e.getDocument(),this.root=e=n?e:this.document.getBody(),this.isLocked=0,this._={cache:{}};if(t)return CKEDITOR.tools.extend(this._.cache,t._.cache),this.isFake=t.isFake,this.isLocked=t.isLocked,this;n=v?this.document.$.selection:this.document.getWindow().$.getSelection(),CKEDITOR.env.webkit?(n.type=="None"&&this.document.getActive().equals(e)||n.type=="Caret"&&n.anchorNode.nodeType==CKEDITOR.NODE_DOCUMENT)&&u(e,n):CKEDITOR.env.gecko?n&&this.document.getActive().equals(e)&&n.anchorNode&&n.anchorNode.nodeType==CKEDITOR.NODE_DOCUMENT&&u(e,n,!0):CKEDITOR.env.ie&&(t=this.document.getActive(),v?n.type=="None"&&t&&t.equals(this.document.getDocumentElement())&&u(e,null,!0):((n=n&&n.anchorNode)&&(n=new CKEDITOR.dom.node(n)),t&&t.equals(this.document.getDocumentElement())&&n&&(e.equals(n)||e.contains(n))&&u(e,null,!0)));var e=this.getNative(),r,i;if(e)if(e.getRangeAt)r=(i=e.rangeCount&&e.getRangeAt(0))&&new CKEDITOR.dom.node(i.commonAncestorContainer);else{try{i=e.createRange()}catch(s){}r=i&&CKEDITOR.dom.element.get(i.item&&i.item(0)||i.parentElement())}if(!r||r.type!=CKEDITOR.NODE_ELEMENT&&r.type!=CKEDITOR.NODE_TEXT||!this.root.equals(r)&&!this.root.contains(r))this._.cache.type=CKEDITOR.SELECTION_NONE,this._.cache.startElement=null,this._.cache.selectedElement=null,this._.cache.selectedText="",this._.cache.ranges=new CKEDITOR.dom.rangeList;return this};var g={img:1,hr:1,li:1,table:1,tr:1,td:1,th:1,embed:1,object:1,ol:1,ul:1,a:1,input:1,form:1,select:1,textarea:1,button:1,fieldset:1,thead:1,tfoot:1};CKEDITOR.dom.selection.prototype={getNative:function(){return this._.cache.nativeSel!==void 0?this._.cache.nativeSel:this._.cache.nativeSel=v?this.document.$.selection:this.document.getWindow().$.getSelection()},getType:v?function(){var e=this._.cache;if(e.type)return e.type;var t=CKEDITOR.SELECTION_NONE;try{var n=this.getNative(),r=n.type;r=="Text"&&(t=CKEDITOR.SELECTION_TEXT),r=="Control"&&(t=CKEDITOR.SELECTION_ELEMENT),n.createRange().parentElement()&&(t=CKEDITOR.SELECTION_TEXT)}catch(i){}return e.type=t}:function(){var e=this._.cache;if(e.type)return e.type;var t=CKEDITOR.SELECTION_TEXT,n=this.getNative();if(!n||!n.rangeCount)t=CKEDITOR.SELECTION_NONE;else if(n.rangeCount==1){var n=n.getRangeAt(0),r=n.startContainer;r==n.endContainer&&r.nodeType==1&&n.endOffset-n.startOffset==1&&g[r.childNodes[n.startOffset].nodeName.toLowerCase()]&&(t=CKEDITOR.SELECTION_ELEMENT)}return e.type=t},getRanges:function(){var e=v?function(){function e(e){return(new CKEDITOR.dom.node(e)).getIndex()}var t=function(t,n){t=t.duplicate(),t.collapse(n);var r=t.parentElement();if(!r.hasChildNodes())return{container:r,offset:0};for(var i=r.children,s,o,u=t.duplicate(),a=0,f=i.length-1,l=-1,c,h;a<=f;){l=Math.floor((a+f)/2),s=i[l],u.moveToElementText(s),c=u.compareEndPoints("StartToStart",t);if(c>0)f=l-1;else{if(!(c<0))return{container:r,offset:e(s)};a=l+1}}if(l==-1||l==i.length-1&&c<0){u.moveToElementText(r),u.setEndPoint("StartToStart",t),u=u.text.replace(/(\r\n|\r)/g,"\n").length,i=r.childNodes;if(!u)return s=i[i.length-1],s.nodeType!=CKEDITOR.NODE_TEXT?{container:r,offset:i.length}:{container:s,offset:s.nodeValue.length};for(r=i.length;u>0&&r>0;)o=i[--r],o.nodeType==CKEDITOR.NODE_TEXT&&(h=o,u-=o.nodeValue.length);return{container:h,offset:-u}}u.collapse(c>0?!0:!1),u.setEndPoint(c>0?"StartToStart":"EndToStart",t),u=u.text.replace(/(\r\n|\r)/g,"\n").length;if(!u)return{container:r,offset:e(s)+(c>0?0:1)};for(;u>0;)try{o=s[c>0?"previousSibling":"nextSibling"],o.nodeType==CKEDITOR.NODE_TEXT&&(u-=o.nodeValue.length,h=o),s=o}catch(p){return{container:r,offset:e(s)}}return{container:h,offset:c>0?-u:h.nodeValue.length+u}};return function(){var e=this.getNative(),n=e&&e.createRange(),r=this.getType();if(!e)return[];if(r==CKEDITOR.SELECTION_TEXT)return e=new CKEDITOR.dom.range(this.root),r=t(n,!0),e.setStart(new CKEDITOR.dom.node(r.container),r.offset),r=t(n),e.setEnd(new CKEDITOR.dom.node(r.container),r.offset),e.endContainer.getPosition(e.startContainer)&CKEDITOR.POSITION_PRECEDING&&e.endOffset<=e.startContainer.getIndex()&&e.collapse(),[e];if(r==CKEDITOR.SELECTION_ELEMENT){for(var r=[],i=0;i<n.length;i++){for(var s=n.item(i),o=s.parentNode,u=0,e=new CKEDITOR.dom.range(this.root);u<o.childNodes.length&&o.childNodes[u]!=s;u++);e.setStart(new CKEDITOR.dom.node(o),u),e.setEnd(new CKEDITOR.dom.node(o),u+1),r.push(e)}return r}return[]}}():function(){var e=[],t,n=this.getNative();if(!n)return e;for(var r=0;r<n.rangeCount;r++){var i=n.getRangeAt(r);t=new CKEDITOR.dom.range(this.root),t.setStart(new CKEDITOR.dom.node(i.startContainer),i.startOffset),t.setEnd(new CKEDITOR.dom.node(i.endContainer),i.endOffset),e.push(t)}return e};return function(t){var n=this._.cache,r=n.ranges;return r||(n.ranges=r=new CKEDITOR.dom.rangeList(e.call(this))),t?l(new CKEDITOR.dom.rangeList(r.slice())):r}}(),getStartElement:function(){var e=this._.cache;if(e.startElement!==void 0)return e.startElement;var t;switch(this.getType()){case CKEDITOR.SELECTION_ELEMENT:return this.getSelectedElement();case CKEDITOR.SELECTION_TEXT:var n=this.getRanges()[0];if(n){if(n.collapsed)t=n.startContainer,t.type!=CKEDITOR.NODE_ELEMENT&&(t=t.getParent());else{for(n.optimize();;){t=n.startContainer;if(n.startOffset!=(t.getChildCount?t.getChildCount():t.getLength())||!!t.isBlockBoundary())break;n.setStartAfter(t)}t=n.startContainer;if(t.type!=CKEDITOR.NODE_ELEMENT)return t.getParent();t=t.getChild(n.startOffset);if(!t||t.type!=CKEDITOR.NODE_ELEMENT)t=n.startContainer;else for(n=t.getFirst();n&&n.type==CKEDITOR.NODE_ELEMENT;)t=n,n=n.getFirst()}t=t.$}}return e.startElement=t?new CKEDITOR.dom.element(t):null},getSelectedElement:function(){var e=this._.cache;if(e.selectedElement!==void 0)return e.selectedElement;var t=this,n=CKEDITOR.tools.tryThese(function(){return t.getNative().createRange().item(0)},function(){for(var e=t.getRanges()[0].clone(),n,r,i=2;i&&(!(n=e.getEnclosedNode())||n.type!=CKEDITOR.NODE_ELEMENT||!g[n.getName()]||!(r=n));i--)e.shrink(CKEDITOR.SHRINK_ELEMENT);return r&&r.$});return e.selectedElement=n?new CKEDITOR.dom.element(n):null},getSelectedText:function(){var e=this._.cache;if(e.selectedText!==void 0)return e.selectedText;var t=this.getNative(),t=v?t.type=="Control"?"":t.createRange().text:t.toString();return e.selectedText=t},lock:function(){this.getRanges(),this.getStartElement(),this.getSelectedElement(),this.getSelectedText(),this._.cache.nativeSel=null,this.isLocked=1},unlock:function(e){if(this.isLocked){if(e)var t=this.getSelectedElement(),n=!t&&this.getRanges(),r=this.isFake;this.isLocked=0,this.reset(),e&&(e=t||n[0]&&n[0].getCommonAncestor())&&e.getAscendant("body",1)&&(r?this.fake(t):t?this.selectElement(t):this.selectRanges(n))}},reset:function(){this._.cache={},this.isFake=0;var e=this.root.editor;if(e&&e._.fakeSelection&&this.rev==e._.fakeSelection.rev){delete e._.fakeSelection;var t=e._.hiddenSelectionContainer;if(t){var n=e.checkDirty();e.fire("lockSnapshot"),t.remove(),e.fire("unlockSnapshot"),!n&&e.resetDirty()}delete e._.hiddenSelectionContainer}this.rev=m++},selectElement:function(e){var t=new CKEDITOR.dom.range(this.root);t.setStartBefore(e),t.setEndAfter(e),this.selectRanges([t])},selectRanges:function(e){var t=this.root.editor,t=t&&t._.hiddenSelectionContainer;this.reset();if(t)for(var t=this.root,n,i=0;i<e.length;++i)n=e[i],n.endContainer.equals(t)&&(n.endOffset=Math.min(n.endOffset,t.getChildCount()));if(e.length)if(this.isLocked){var o=CKEDITOR.document.getActive();this.unlock(),this.selectRanges(e),this.lock(),o&&!o.equals(this.root)&&o.focus()}else{var u;e:{var a,f;if(e.length==1&&!(f=e[0]).collapsed&&(u=f.getEnclosedNode())&&u.type==CKEDITOR.NODE_ELEMENT){f=f.clone(),f.shrink(CKEDITOR.SHRINK_ELEMENT,!0),(a=f.getEnclosedNode())&&a.type==CKEDITOR.NODE_ELEMENT&&(u=a);if(u.getAttribute("contenteditable")=="false")break e}u=void 0}if(u)this.fake(u);else{if(v){f=CKEDITOR.dom.walker.whitespaces(!0),a=/\ufeff|\u00a0/,t={table:1,tbody:1,tr:1},e.length>1&&(u=e[e.length-1],e[0].setEnd(u.endContainer,u.endOffset)),u=e[0];var e=u.collapsed,l,c,h;if((n=u.getEnclosedNode())&&n.type==CKEDITOR.NODE_ELEMENT&&n.getName()in g&&(!n.is("a")||!n.getText()))try{h=n.$.createControlRange(),h.addElement(n.$),h.select();return}catch(p){}if(u.startContainer.type==CKEDITOR.NODE_ELEMENT&&u.startContainer.getName()in t||u.endContainer.type==CKEDITOR.NODE_ELEMENT&&u.endContainer.getName()in t)u.shrink(CKEDITOR.NODE_ELEMENT,!0),e=u.collapsed;h=u.createBookmark(),t=h.startNode,e||(o=h.endNode),h=u.document.$.body.createTextRange(),h.moveToElementText(t.$),h.moveStart("character",1),o?(a=u.document.$.body.createTextRange(),a.moveToElementText(o.$),h.setEndPoint("EndToEnd",a),h.moveEnd("character",-1)):(l=t.getNext(f),c=t.hasAscendant("pre"),l=!(l&&l.getText&&l.getText().match(a))&&(c||!t.hasPrevious()||t.getPrevious().is&&t.getPrevious().is("br")),c=u.document.createElement("span"),c.setHtml("&#65279;"),c.insertBefore(t),l&&u.document.createText("﻿").insertBefore(t)),u.setStartBefore(t),t.remove(),e?(l?(h.moveStart("character",-1),h.select(),u.document.$.selection.clear()):h.select(),u.moveToPosition(c,CKEDITOR.POSITION_BEFORE_START),c.remove()):(u.setEndBefore(o),o.remove(),h.select())}else{o=this.getNative();if(!o)return;this.removeAllRanges();for(h=0;h<e.length;h++){if(h<e.length-1){l=e[h],c=e[h+1],a=l.clone(),a.setStart(l.endContainer,l.endOffset),a.setEnd(c.startContainer,c.startOffset);if(!a.collapsed){a.shrink(CKEDITOR.NODE_ELEMENT,!0),u=a.getCommonAncestor(),a=a.getEnclosedNode();if(u.isReadOnly()||a&&a.isReadOnly()){c.setStart(l.startContainer,l.startOffset),e.splice(h--,1);continue}}}u=e[h],c=this.document.$.createRange(),u.collapsed&&CKEDITOR.env.webkit&&r(u)&&(l=this.root,s(l,!1),a=l.getDocument().createText("​"),l.setCustomData("cke-fillingChar",a),u.insertNode(a),(l=a.getNext())&&!a.getPrevious()&&l.type==CKEDITOR.NODE_ELEMENT&&l.getName()=="br"?(s(this.root),u.moveToPosition(l,CKEDITOR.POSITION_BEFORE_START)):u.moveToPosition(a,CKEDITOR.POSITION_AFTER_END)),c.setStart(u.startContainer.$,u.startOffset);try{c.setEnd(u.endContainer.$,u.endOffset)}catch(d){if(!(d.toString().indexOf("NS_ERROR_ILLEGAL_VALUE")>=0))throw d;u.collapse(1),c.setEnd(u.endContainer.$,u.endOffset)}o.addRange(c)}}this.reset(),this.root.fire("selectionchange")}}},fake:function(e){var t=this.root.editor;this.reset(),a(t);var n=this._.cache,r=new CKEDITOR.dom.range(this.root);r.setStartBefore(e),r.setEndAfter(e),n.ranges=new CKEDITOR.dom.rangeList(r),n.selectedElement=n.startElement=e,n.type=CKEDITOR.SELECTION_ELEMENT,n.selectedText=n.nativeSel=null,this.isFake=1,this.rev=m++,t._.fakeSelection=this,this.root.fire("selectionchange")},isHidden:function(){var e=this.getCommonAncestor();return e&&e.type==CKEDITOR.NODE_TEXT&&(e=e.getParent()),!!e&&!!e.data("cke-hidden-sel")},createBookmarks:function(e){return e=this.getRanges().createBookmarks(e),this.isFake&&(e.isFake=1),e},createBookmarks2:function(e){return e=this.getRanges().createBookmarks2(e),this.isFake&&(e.isFake=1),e},selectBookmarks:function(e){for(var t=[],n=0;n<e.length;n++){var r=new CKEDITOR.dom.range(this.root);r.moveToBookmark(e[n]),t.push(r)}return e.isFake?this.fake(t[0].getEnclosedNode()):this.selectRanges(t),this},getCommonAncestor:function(){var e=this.getRanges();return e.length?e[0].startContainer.getCommonAncestor(e[e.length-1].endContainer):null},scrollIntoView:function(){this.type!=CKEDITOR.SELECTION_NONE&&this.getRanges()[0].scrollIntoView()},removeAllRanges:function(){if(this.getType()!=CKEDITOR.SELECTION_NONE){var e=this.getNative();try{e&&e[v?"empty":"removeAllRanges"]()}catch(t){}this.reset()}}}}(),"use strict",CKEDITOR.STYLE_BLOCK=1,CKEDITOR.STYLE_INLINE=2,CKEDITOR.STYLE_OBJECT=3,function(){function e(e,t){for(var n,r;e=e.getParent();){if(e.equals(t))break;if(e.getAttribute("data-nostyle"))n=e;else if(!r){var i=e.getAttribute("contentEditable");i=="false"?n=e:i=="true"&&(r=1)}}return n}function t(n){var i=n.document;if(n.collapsed)i=m(this,i),n.insertNode(i),n.moveToPosition(i,CKEDITOR.POSITION_BEFORE_END);else{var s=this.element,o=this._.definition,u,a=o.ignoreReadonly,f=a||o.includeReadonly;f==void 0&&(f=n.root.getCustomData("cke_includeReadonly"));var l=CKEDITOR.dtd[s];l||(u=!0,l=CKEDITOR.dtd.span),n.enlarge(CKEDITOR.ENLARGE_INLINE,1),n.trim();var c=n.createBookmark(),h=c.startNode,d=c.endNode,v=h,g;if(!a){var y=n.getCommonAncestor(),a=e(h,y),y=e(d,y);a&&(v=a.getNextSourceNode(!0)),y&&(d=y)}for(v.getPosition(d)==CKEDITOR.POSITION_FOLLOWING&&(v=0);v;){a=!1;if(v.equals(d))v=null,a=!0;else{var b=v.type==CKEDITOR.NODE_ELEMENT?v.getName():null,y=b&&v.getAttribute("contentEditable")=="false",w=b&&v.getAttribute("data-nostyle");if(b&&v.data("cke-bookmark")){v=v.getNextSourceNode(!0);continue}if(y&&f&&CKEDITOR.dtd.$block[b])for(var E=v,S=r(E),x=void 0,T=S.length,N=0,E=T&&new CKEDITOR.dom.range(E.getDocument());N<T;++N){var x=S[N],k=CKEDITOR.filter.instances[x.data("cke-filter")];if(k?k.check(this):1)E.selectNodeContents(x),t.call(this,E)}S=b?!l[b]||w?0:y&&!f?0:(v.getPosition(d)|L)==L&&(!o.childRule||o.childRule(v)):1;if(S)if((S=v.getParent())&&((S.getDtd()||CKEDITOR.dtd.span)[s]||u)&&(!o.parentRule||o.parentRule(S))){!g&&(!b||!CKEDITOR.dtd.$removeEmpty[b]||(v.getPosition(d)|L)==L)&&(g=n.clone(),g.setStartBefore(v)),b=v.type;if(b==CKEDITOR.NODE_TEXT||y||b==CKEDITOR.NODE_ELEMENT&&!v.getChildCount()){for(var b=v,O;(a=!b.getNext(C))&&(O=b.getParent(),l[O.getName()])&&(O.getPosition(h)|A)==A&&(!o.childRule||o.childRule(O));)b=O;g.setEndAfter(b)}}else a=!0;else a=!0;v=v.getNextSourceNode(w||y)}if(a&&g&&!g.collapsed){for(var a=m(this,i),y=a.hasAttributes(),w=g.getCommonAncestor(),b={},S={},x={},T={},M,_,D;a&&w;){if(w.getName()==s){for(M in o.attributes)!T[M]&&(D=w.getAttribute(_))&&(a.getAttribute(M)==D?S[M]=1:T[M]=1);for(_ in o.styles)!x[_]&&(D=w.getStyle(_))&&(a.getStyle(_)==D?b[_]=1:x[_]=1)}w=w.getParent()}for(M in S)a.removeAttribute(M);for(_ in b)a.removeStyle(_);y&&!a.hasAttributes()&&(a=null),a?(g.extractContents().appendTo(a),g.insertNode(a),p.call(this,a),a.mergeSiblings(),CKEDITOR.env.ie||a.$.normalize()):(a=new CKEDITOR.dom.element("span"),g.extractContents().appendTo(a),g.insertNode(a),p.call(this,a),a.remove(!0)),g=null}}n.moveToBookmark(c),n.shrink(CKEDITOR.SHRINK_TEXT),n.shrink(CKEDITOR.NODE_ELEMENT,!0)}}function n(e){function t(){for(var e=new CKEDITOR.dom.elementPath(r.getParent()),t=new CKEDITOR.dom.elementPath(f.getParent()),n=null,i=null,s=0;s<e.elements.length;s++){var o=e.elements[s];if(o==e.block||o==e.blockLimit)break;l.checkElementRemovable(o)&&(n=o)}for(s=0;s<t.elements.length;s++){o=t.elements[s];if(o==t.block||o==t.blockLimit)break;l.checkElementRemovable(o)&&(i=o)}i&&f.breakParent(i),n&&r.breakParent(n)}e.enlarge(CKEDITOR.ENLARGE_INLINE,1);var n=e.createBookmark(),r=n.startNode;if(e.collapsed){for(var i=new CKEDITOR.dom.elementPath(r.getParent(),e.root),s,o=0,u;o<i.elements.length&&(u=i.elements[o]);o++){if(u==i.block||u==i.blockLimit)break;if(this.checkElementRemovable(u)){var a;e.collapsed&&(e.checkBoundaryOfElement(u,CKEDITOR.END)||(a=e.checkBoundaryOfElement(u,CKEDITOR.START)))?(s=u,s.match=a?"start":"end"):(u.mergeSiblings(),u.is(this.element)?h.call(this,u):d(u,b(this)[u.getName()]))}}if(s){u=r;for(o=0;;o++){a=i.elements[o];if(a.equals(s))break;if(a.match)continue;a=a.clone(),a.append(u),u=a}u[s.match=="start"?"insertBefore":"insertAfter"](s)}}else{var f=n.endNode,l=this;t();for(i=r;!i.equals(f);)s=i.getNextSourceNode(),i.type==CKEDITOR.NODE_ELEMENT&&this.checkElementRemovable(i)&&(i.getName()==this.element?h.call(this,i):d(i,b(this)[i.getName()]),s.type==CKEDITOR.NODE_ELEMENT&&s.contains(r)&&(t(),s=r.getNext())),i=s}e.moveToBookmark(n),e.shrink(CKEDITOR.NODE_ELEMENT,!0)}function r(e){var t=[];return e.forEach(function(e){if(e.getAttribute("contenteditable")=="true")return t.push(e),!1},CKEDITOR.NODE_ELEMENT,!0),t}function i(e){var t=e.getEnclosedNode()||e.getCommonAncestor(!1,!0);(e=(new CKEDITOR.dom.elementPath(t,e.root)).contains(this.element,1))&&!e.isReadOnly()&&g(e,this)}function s(e){var t=e.getCommonAncestor(!0,!0);if(e=(new CKEDITOR.dom.elementPath(t,e.root)).contains(this.element,1)){var t=this._.definition,n=t.attributes;if(n)for(var r in n)e.removeAttribute(r,n[r]);if(t.styles)for(var i in t.styles)t.styles.hasOwnProperty(i)&&e.removeStyle(i)}}function o(e){var t=e.createBookmark(!0),n=e.createIterator();n.enforceRealBlocks=!0,this._.enterMode&&(n.enlargeBr=this._.enterMode!=CKEDITOR.ENTER_BR);for(var r,i=e.document,s;r=n.getNextParagraph();)!r.isReadOnly()&&(n.activeFilter?n.activeFilter.check(this):1)&&(s=m(this,i,r),a(r,s));e.moveToBookmark(t)}function u(e){var t=e.createBookmark(1),n=e.createIterator();n.enforceRealBlocks=!0,n.enlargeBr=this._.enterMode!=CKEDITOR.ENTER_BR;for(var r,i;r=n.getNextParagraph();)this.checkElementRemovable(r)&&(r.is("pre")?((i=this._.enterMode==CKEDITOR.ENTER_BR?null:e.document.createElement(this._.enterMode==CKEDITOR.ENTER_P?"p":"div"))&&r.copyAttributes(i),a(r,i)):h.call(this,r));e.moveToBookmark(t)}function a(e,t){var n=!t;n&&(t=e.getDocument().createElement("div"),e.copyAttributes(t));var r=t&&t.is("pre"),i=e.is("pre"),s=!r&&i;if(r&&!i){i=t,(s=e.getBogus())&&s.remove(),s=e.getHtml(),s=l(s,/(?:^[ \t\n\r]+)|(?:[ \t\n\r]+$)/g,""),s=s.replace(/[ \t\r\n]*(<br[^>]*>)[ \t\r\n]*/gi,"$1"),s=s.replace(/([ \t\n\r]+|&nbsp;)/g," "),s=s.replace(/<br\b[^>]*>/gi,"\n");if(CKEDITOR.env.ie){var o=e.getDocument().createElement("div");o.append(i),i.$.outerHTML="<pre>"+s+"</pre>",i.copyAttributes(o.getFirst()),i=o.getFirst().remove()}else i.setHtml(s);t=i}else s?t=c(n?[e.getHtml()]:f(e),t):e.moveChildren(t);t.replace(e);if(r){var n=t,u;(u=n.getPrevious(k))&&u.type==CKEDITOR.NODE_ELEMENT&&u.is("pre")&&(r=l(u.getHtml(),/\n$/,"")+"\n\n"+l(n.getHtml(),/^\n/,""),CKEDITOR.env.ie?n.$.outerHTML="<pre>"+r+"</pre>":n.setHtml(r),u.remove())}else n&&v(t)}function f(e){e.getName();var t=[];return l(e.getOuterHtml(),/(\S\s*)\n(?:\s|(<span[^>]+data-cke-bookmark.*?\/span>))*\n(?!$)/gi,function(e,t,n){return t+"</pre>"+n+"<pre>"}).replace(/<pre\b.*?>([\s\S]*?)<\/pre>/gi,function(e,n){t.push(n)}),t}function l(e,t,n){var r="",i="",e=e.replace(/(^<span[^>]+data-cke-bookmark.*?\/span>)|(<span[^>]+data-cke-bookmark.*?\/span>$)/gi,function(e,t,n){return t&&(r=t),n&&(i=n),""});return r+e.replace(t,n)+i}function c(e,t){var n;e.length>1&&(n=new CKEDITOR.dom.documentFragment(t.getDocument()));for(var r=0;r<e.length;r++){var i=e[r],i=i.replace(/(\r\n|\r)/g,"\n"),i=l(i,/^[ \t]*\n/,""),i=l(i,/\n$/,""),i=l(i,/^[ \t]+|[ \t]+$/g,function(e,t){return e.length==1?"&nbsp;":t?" "+CKEDITOR.tools.repeat("&nbsp;",e.length-1):CKEDITOR.tools.repeat("&nbsp;",e.length-1)+" "}),i=i.replace(/\n/g,"<br>"),i=i.replace(/[ \t]{2,}/g,function(e){return CKEDITOR.tools.repeat("&nbsp;",e.length-1)+" "});if(n){var s=t.clone();s.setHtml(i),n.append(s)}else t.setHtml(i)}return n||t}function h(e,t){var n=this._.definition,r=n.attributes,n=n.styles,i=b(this)[e.getName()],s=CKEDITOR.tools.isEmpty(r)&&CKEDITOR.tools.isEmpty(n),o;for(o in r)(o!="class"&&!this._.definition.fullMatch||e.getAttribute(o)==w(o,r[o]))&&(!t||o.slice(0,5)!="data-")&&(s=e.hasAttribute(o),e.removeAttribute(o));for(var u in n)if(!this._.definition.fullMatch||e.getStyle(u)==w(u,n[u],true))s=s||!!e.getStyle(u),e.removeStyle(u);d(e,i,S[e.getName()]),s&&(this._.definition.alwaysRemoveElement?v(e,1):!CKEDITOR.dtd.$block[e.getName()]||this._.enterMode==CKEDITOR.ENTER_BR&&!e.hasAttributes()?v(e):e.renameNode(this._.enterMode==CKEDITOR.ENTER_P?"p":"div"))}function p(e){for(var t=b(this),n=e.getElementsByTag(this.element),r,i=n.count();--i>=0;)r=n.getItem(i),r.isReadOnly()||h.call(this,r,!0);for(var s in t)if(s!=this.element){n=e.getElementsByTag(s);for(i=n.count()-1;i>=0;i--)r=n.getItem(i),r.isReadOnly()||d(r,t[s])}}function d(e,t,n){if(t=t&&t.attributes)for(var r=0;r<t.length;r++){var i=t[r][0],s;if(s=e.getAttribute(i)){var o=t[r][1];(o===null||o.test&&o.test(s)||typeof o=="string"&&s==o)&&e.removeAttribute(i)}}n||v(e)}function v(e,t){if(!e.hasAttributes()||t)if(CKEDITOR.dtd.$block[e.getName()]){var n=e.getPrevious(k),r=e.getNext(k);n&&(n.type==CKEDITOR.NODE_TEXT||!n.isBlockBoundary({br:1}))&&e.append("br",1),r&&(r.type==CKEDITOR.NODE_TEXT||!r.isBlockBoundary({br:1}))&&e.append("br"),e.remove(!0)}else n=e.getFirst(),r=e.getLast(),e.remove(!0),n&&(n.type==CKEDITOR.NODE_ELEMENT&&n.mergeSiblings(),r&&!n.equals(r)&&r.type==CKEDITOR.NODE_ELEMENT&&r.mergeSiblings())}function m(e,t,n){var r;return r=e.element,r=="*"&&(r="span"),r=new CKEDITOR.dom.element(r,t),n&&n.copyAttributes(r),r=g(r,e),t.getCustomData("doc_processing_style")&&r.hasAttribute("id")?r.removeAttribute("id"):t.setCustomData("doc_processing_style",1),r}function g(e,t){var n=t._.definition,r=n.attributes,n=CKEDITOR.style.getStyleText(n);if(r)for(var i in r)e.setAttribute(i,r[i]);return n&&e.setAttribute("style",n),e}function y(e,t){for(var n in e)e[n]=e[n].replace(N,function(e,n){return t[n]})}function b(e){if(e._.overrides)return e._.overrides;var t=e._.overrides={},n=e._.definition.overrides;if(n){CKEDITOR.tools.isArray(n)||(n=[n]);for(var r=0;r<n.length;r++){var i=n[r],s,o;typeof i=="string"?s=i.toLowerCase():(s=i.element?i.element.toLowerCase():e.element,o=i.attributes),i=t[s]||(t[s]={});if(o){var i=i.attributes=i.attributes||[],u;for(u in o)i.push([u.toLowerCase(),o[u]])}}}return t}function w(e,t,n){var r=new CKEDITOR.dom.element("span");return r[n?"setStyle":"setAttribute"](e,t),r[n?"getStyle":"getAttribute"](e)}function E(e,t,n){for(var r=e.document,i=e.getRanges(),t=t?this.removeFromRange:this.applyToRange,s,o=i.createIterator();s=o.getNextRange();)t.call(this,s,n);e.selectRanges(i),r.removeCustomData("doc_processing_style")}var S={address:1,div:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,p:1,pre:1,section:1,header:1,footer:1,nav:1,article:1,aside:1,figure:1,dialog:1,hgroup:1,time:1,meter:1,menu:1,command:1,keygen:1,output:1,progress:1,details:1,datagrid:1,datalist:1},x={a:1,blockquote:1,embed:1,hr:1,img:1,li:1,object:1,ol:1,table:1,td:1,tr:1,th:1,ul:1,dl:1,dt:1,dd:1,form:1,audio:1,video:1},T=/\s*(?:;\s*|$)/,N=/#\((.+?)\)/g,C=CKEDITOR.dom.walker.bookmark(0,1),k=CKEDITOR.dom.walker.whitespaces(1);CKEDITOR.style=function(e,t){if(typeof e.type=="string")return new CKEDITOR.style.customHandlers[e.type](e);var n=e.attributes;n&&n.style&&(e.styles=CKEDITOR.tools.extend({},e.styles,CKEDITOR.tools.parseCssText(n.style)),delete n.style),t&&(e=CKEDITOR.tools.clone(e),y(e.attributes,t),y(e.styles,t)),n=this.element=e.element?typeof e.element=="string"?e.element.toLowerCase():e.element:"*",this.type=e.type||(S[n]?CKEDITOR.STYLE_BLOCK:x[n]?CKEDITOR.STYLE_OBJECT:CKEDITOR.STYLE_INLINE),typeof this.element=="object"&&(this.type=CKEDITOR.STYLE_OBJECT),this._={definition:e}},CKEDITOR.style.prototype={apply:function(e){if(e instanceof CKEDITOR.dom.document)return E.call(this,e.getSelection());if(this.checkApplicable(e.elementPath(),e)){var t=this._.enterMode;t||(this._.enterMode=e.activeEnterMode),E.call(this,e.getSelection(),0,e),this._.enterMode=t}},remove:function(e){if(e instanceof CKEDITOR.dom.document)return E.call(this,e.getSelection(),1);if(this.checkApplicable(e.elementPath(),e)){var t=this._.enterMode;t||(this._.enterMode=e.activeEnterMode),E.call(this,e.getSelection(),1,e),this._.enterMode=t}},applyToRange:function(e){return this.applyToRange=this.type==CKEDITOR.STYLE_INLINE?t:this.type==CKEDITOR.STYLE_BLOCK?o:this.type==CKEDITOR.STYLE_OBJECT?i:null,this.applyToRange(e)},removeFromRange:function(e){return this.removeFromRange=this.type==CKEDITOR.STYLE_INLINE?n:this.type==CKEDITOR.STYLE_BLOCK?u:this.type==CKEDITOR.STYLE_OBJECT?s:null,this.removeFromRange(e)},applyToObject:function(e){g(e,this)},checkActive:function(e,t){switch(this.type){case CKEDITOR.STYLE_BLOCK:return this.checkElementRemovable(e.block||e.blockLimit,!0,t);case CKEDITOR.STYLE_OBJECT:case CKEDITOR.STYLE_INLINE:for(var n=e.elements,r=0,i;r<n.length;r++){i=n[r];if(this.type!=CKEDITOR.STYLE_INLINE||i!=e.block&&i!=e.blockLimit){if(this.type==CKEDITOR.STYLE_OBJECT){var s=i.getName();if(!(typeof this.element=="string"?s==this.element:s in this.element))continue}if(this.checkElementRemovable(i,!0,t))return!0}}}return!1},checkApplicable:function(e,t,n){t&&t instanceof CKEDITOR.filter&&(n=t);if(n&&!n.check(this))return!1;switch(this.type){case CKEDITOR.STYLE_OBJECT:return!!e.contains(this.element);case CKEDITOR.STYLE_BLOCK:return!!e.blockLimit.getDtd()[this.element]}return!0},checkElementMatch:function(e,t){var n=this._.definition;if(!e||!n.ignoreReadonly&&e.isReadOnly())return!1;var r=e.getName();if(typeof this.element=="string"?r==this.element:r in this.element){if(!t&&!e.hasAttributes())return!0;if(r=n._AC)n=r;else{var r={},i=0,s=n.attributes;if(s)for(var o in s)i++,r[o]=s[o];if(o=CKEDITOR.style.getStyleText(n))r.style||i++,r.style=o;r._length=i,n=n._AC=r}if(!n._length)return!0;for(var u in n)if(u!="_length"){i=e.getAttribute(u)||"";if(u=="style")e:{r=n[u],typeof r=="string"&&(r=CKEDITOR.tools.parseCssText(r)),typeof i=="string"&&(i=CKEDITOR.tools.parseCssText(i,!0)),o=void 0;for(o in r)if(!(o in i)||i[o]!=r[o]&&r[o]!="inherit"&&i[o]!="inherit"){r=!1;break e}r=!0}else r=n[u]==i;if(r){if(!t)return!0}else if(t)return!1}if(t)return!0}return!1},checkElementRemovable:function(e,t,n){if(this.checkElementMatch(e,t,n))return!0;if(t=b(this)[e.getName()]){var r;if(!(t=t.attributes))return!0;for(n=0;n<t.length;n++){r=t[n][0];if(r=e.getAttribute(r)){var i=t[n][1];if(i===null||typeof i=="string"&&r==i||i.test(r))return!0}}}return!1},buildPreview:function(e){var t=this._.definition,n=[],r=t.element;r=="bdo"&&(r="span");var n=["<",r],i=t.attributes;if(i)for(var s in i)n.push(" ",s,'="',i[s],'"');return(i=CKEDITOR.style.getStyleText(t))&&n.push(' style="',i,'"'),n.push(">",e||t.name,"</",r,">"),n.join("")},getDefinition:function(){return this._.definition}},CKEDITOR.style.getStyleText=function(e){var t=e._ST;if(t)return t;var t=e.styles,n=e.attributes&&e.attributes.style||"",r="";n.length&&(n=n.replace(T,";"));for(var i in t){var s=t[i],o=(i+":"+s).replace(T,";");s=="inherit"?r+=o:n+=o}return n.length&&(n=CKEDITOR.tools.normalizeCssText(n,!0)),e._ST=n+r},CKEDITOR.style.customHandlers={},CKEDITOR.style.addCustomHandler=function(e){var t=function(e){this._={definition:e},this.setup&&this.setup(e)};return t.prototype=CKEDITOR.tools.extend(CKEDITOR.tools.prototypedCopy(CKEDITOR.style.prototype),{assignedTo:CKEDITOR.STYLE_OBJECT},e,!0),this.customHandlers[e.type]=t};var L=CKEDITOR.POSITION_PRECEDING|CKEDITOR.POSITION_IDENTICAL|CKEDITOR.POSITION_IS_CONTAINED,A=CKEDITOR.POSITION_FOLLOWING|CKEDITOR.POSITION_IDENTICAL|CKEDITOR.POSITION_IS_CONTAINED}(),CKEDITOR.styleCommand=function(e,t){this.requiredContent=this.allowedContent=this.style=e,CKEDITOR.tools.extend(this,t,!0)},CKEDITOR.styleCommand.prototype.exec=function(e){e.focus(),this.state==CKEDITOR.TRISTATE_OFF?e.applyStyle(this.style):this.state==CKEDITOR.TRISTATE_ON&&e.removeStyle(this.style)},CKEDITOR.stylesSet=new CKEDITOR.resourceManager("","stylesSet"),CKEDITOR.addStylesSet=CKEDITOR.tools.bind(CKEDITOR.stylesSet.add,CKEDITOR.stylesSet),CKEDITOR.loadStylesSet=function(e,t,n){CKEDITOR.stylesSet.addExternal(e,t,""),CKEDITOR.stylesSet.load(e,n)},CKEDITOR.tools.extend(CKEDITOR.editor.prototype,{attachStyleStateChange:function(e,t){var n=this._.styleStateChangeCallbacks;n||(n=this._.styleStateChangeCallbacks=[],this.on("selectionChange",function(e){for(var t=0;t<n.length;t++){var r=n[t],i=r.style.checkActive(e.data.path,this)?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF;r.fn.call(this,i)}})),n.push({style:e,fn:t})},applyStyle:function(e){e.apply(this)},removeStyle:function(e){e.remove(this)},getStylesSet:function(e){if(this._.stylesDefinitions)e(this._.stylesDefinitions);else{var t=this,n=t.config.stylesCombo_stylesSet||t.config.stylesSet;if(n===!1)e(null);else if(n instanceof Array)t._.stylesDefinitions=n,e(n);else{n||(n="default");var n=n.split(":"),r=n[0];CKEDITOR.stylesSet.addExternal(r,n[1]?n.slice(1).join(":"):CKEDITOR.getUrl("styles.js"),""),CKEDITOR.stylesSet.load(r,function(n){t._.stylesDefinitions=n[r],e(t._.stylesDefinitions)})}}}}),CKEDITOR.dom.comment=function(e,t){typeof e=="string"&&(e=(t?t.$:document).createComment(e)),CKEDITOR.dom.domObject.call(this,e)},CKEDITOR.dom.comment.prototype=new CKEDITOR.dom.node,CKEDITOR.tools.extend(CKEDITOR.dom.comment.prototype,{type:CKEDITOR.NODE_COMMENT,getOuterHtml:function(){return"<!--"+this.$.nodeValue+"-->"}}),"use strict",function(){var e={},t={},n;for(n in CKEDITOR.dtd.$blockLimit)n in CKEDITOR.dtd.$list||(e[n]=1);for(n in CKEDITOR.dtd.$block)n in CKEDITOR.dtd.$blockLimit||n in CKEDITOR.dtd.$empty||(t[n]=1);CKEDITOR.dom.elementPath=function(n,r){var i=null,s=null,o=[],u=n,f,r=r||n.getDocument().getBody();do if(u.type==CKEDITOR.NODE_ELEMENT){o.push(u);if(!this.lastElement){this.lastElement=u;if(u.is(CKEDITOR.dtd.$object)||u.getAttribute("contenteditable")=="false")continue}if(u.equals(r))break;if(!s){f=u.getName(),u.getAttribute("contenteditable")=="true"?s=u:!i&&t[f]&&(i=u);if(e[f]){var l;if(l=!i){if(f=f=="div"){e:{f=u.getChildren(),l=0;for(var c=f.count();l<c;l++){var h=f.getItem(l);if(h.type==CKEDITOR.NODE_ELEMENT&&CKEDITOR.dtd.$block[h.getName()]){f=!0;break e}}f=!1}f=!f}l=f}l?i=u:s=u}}}while(u=u.getParent());s||(s=r),this.block=i,this.blockLimit=s,this.root=r,this.elements=o}}(),CKEDITOR.dom.elementPath.prototype={compare:function(e){var t=this.elements,e=e&&e.elements;if(!e||t.length!=e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].equals(e[n]))return!1;return!0},contains:function(e,t,n){var r;typeof e=="string"&&(r=function(t){return t.getName()==e}),e instanceof CKEDITOR.dom.element?r=function(t){return t.equals(e)}:CKEDITOR.tools.isArray(e)?r=function(t){return CKEDITOR.tools.indexOf(e,t.getName())>-1}:typeof e=="function"?r=e:typeof e=="object"&&(r=function(t){return t.getName()in e});var i=this.elements,s=i.length;t&&s--,n&&(i=Array.prototype.slice.call(i,0),i.reverse());for(t=0;t<s;t++)if(r(i[t]))return i[t];return null},isContextFor:function(e){var t;return e in CKEDITOR.dtd.$block?(t=this.contains(CKEDITOR.dtd.$intermediate)||this.root.equals(this.block)&&this.block||this.blockLimit,!!t.getDtd()[e]):!0},direction:function(){return(this.block||this.blockLimit||this.root).getDirection(1)}},CKEDITOR.dom.text=function(e,t){typeof e=="string"&&(e=(t?t.$:document).createTextNode(e)),this.$=e},CKEDITOR.dom.text.prototype=new CKEDITOR.dom.node,CKEDITOR.tools.extend(CKEDITOR.dom.text.prototype,{type:CKEDITOR.NODE_TEXT,getLength:function(){return this.$.nodeValue.length},getText:function(){return this.$.nodeValue},setText:function(e){this.$.nodeValue=e},split:function(e){var t=this.$.parentNode,n=t.childNodes.length,r=this.getLength(),i=this.getDocument(),s=new CKEDITOR.dom.text(this.$.splitText(e),i);return t.childNodes.length==n&&(e>=r?(s=i.createText(""),s.insertAfter(this)):(e=i.createText(""),e.insertAfter(s),e.remove())),s},substring:function(e,t){return typeof t!="number"?this.$.nodeValue.substr(e):this.$.nodeValue.substring(e,t)}}),function(){function e(e,t,n){var r=e.serializable,i=t[n?"endContainer":"startContainer"],s=n?"endOffset":"startOffset",o=r?t.document.getById(e.startNode):e.startNode,e=r?t.document.getById(e.endNode):e.endNode;return i.equals(o.getPrevious())?(t.startOffset=t.startOffset-i.getLength()-e.getPrevious().getLength(),i=e.getNext()):i.equals(e.getPrevious())&&(t.startOffset=t.startOffset-i.getLength(),i=e.getNext()),i.equals(o.getParent())&&t[s]++,i.equals(e.getParent())&&t[s]++,t[n?"endContainer":"startContainer"]=i,t}CKEDITOR.dom.rangeList=function(e){return e instanceof CKEDITOR.dom.rangeList?e:(e?e instanceof CKEDITOR.dom.range&&(e=[e]):e=[],CKEDITOR.tools.extend(e,t))};var t={createIterator:function(){var e=this,t=CKEDITOR.dom.walker.bookmark(),n=[],r;return{getNextRange:function(i){r=r==void 0?0:r+1;var s=e[r];if(s&&e.length>1){if(!r)for(var o=e.length-1;o>=0;o--)n.unshift(e[o].createBookmark(!0));if(i)for(var u=0;e[r+u+1];){for(var f=s.document,i=0,o=f.getById(n[u].endNode),f=f.getById(n[u+1].startNode);;){o=o.getNextSourceNode(!1);if(f.equals(o))i=1;else if(t(o)||o.type==CKEDITOR.NODE_ELEMENT&&o.isBlockBoundary())continue;break}if(!i)break;u++}for(s.moveToBookmark(n.shift());u--;)o=e[++r],o.moveToBookmark(n.shift()),s.setEnd(o.endContainer,o.endOffset)}return s}}},createBookmarks:function(t){for(var n=[],r,i=0;i<this.length;i++){n.push(r=this[i].createBookmark(t,!0));for(var s=i+1;s<this.length;s++)this[s]=e(r,this[s]),this[s]=e(r,this[s],!0)}return n},createBookmarks2:function(e){for(var t=[],n=0;n<this.length;n++)t.push(this[n].createBookmark2(e));return t},moveToBookmarks:function(e){for(var t=0;t<this.length;t++)this[t].moveToBookmark(e[t])}}}(),function(){function e(){return CKEDITOR.getUrl(CKEDITOR.skinName.split(",")[1]||"skins/"+CKEDITOR.skinName.split(",")[0]+"/")}function t(t){var n=CKEDITOR.skin["ua_"+t],r=CKEDITOR.env;if(n)for(var n=n.split(",").sort(function(e,t){return e>t?-1:1}),i=0,s;i<n.length;i++){s=n[i],r.ie&&(s.replace(/^ie/,"")==r.version||r.quirks&&s=="iequirks")&&(s="ie");if(r[s]){t+="_"+n[i];break}}return CKEDITOR.getUrl(e()+t+".css")}function n(e,n){s[e]||(CKEDITOR.document.appendStyleSheet(t(e)),s[e]=1),n&&n()}function r(e){var t=e.getById(o);return t||(t=e.getHead().append("style"),t.setAttribute("id",o),t.setAttribute("type","text/css")),t}function i(e,t,n){var r,i,s;if(CKEDITOR.env.webkit){t=t.split("}").slice(0,-1);for(i=0;i<t.length;i++)t[i]=t[i].split("{")}for(var o=0;o<e.length;o++)if(CKEDITOR.env.webkit)for(i=0;i<t.length;i++){s=t[i][1];for(r=0;r<n.length;r++)s=s.replace(n[r][0],n[r][1]);e[o].$.sheet.addRule(t[i][0],s)}else{s=t;for(r=0;r<n.length;r++)s=s.replace(n[r][0],n[r][1]);CKEDITOR.env.ie&&CKEDITOR.env.version<11?e[o].$.styleSheet.cssText=e[o].$.styleSheet.cssText+s:e[o].$.innerHTML=e[o].$.innerHTML+s}}var s={};CKEDITOR.skin={path:e,loadPart:function(t,r){CKEDITOR.skin.name!=CKEDITOR.skinName.split(",")[0]?CKEDITOR.scriptLoader.load(CKEDITOR.getUrl(e()+"skin.js"),function(){n(t,r)}):n(t,r)},getPath:function(e){return CKEDITOR.getUrl(t(e))},icons:{},addIcon:function(e,t,n,r){e=e.toLowerCase(),this.icons[e]||(this.icons[e]={path:t,offset:n||0,bgsize:r||"16px"})},getIconStyle:function(e,t,n,r,i){var s;return e&&(e=e.toLowerCase(),t&&(s=this.icons[e+"-rtl"]),s||(s=this.icons[e])),e=n||s&&s.path||"",r=r||s&&s.offset,i=i||s&&s.bgsize||"16px",e&&"background-image:url("+CKEDITOR.getUrl(e)+");background-position:0 "+r+"px;background-size:"+i+";"}},CKEDITOR.tools.extend(CKEDITOR.editor.prototype,{getUiColor:function(){return this.uiColor},setUiColor:function(e){var t=r(CKEDITOR.document);return(this.setUiColor=function(e){var n=CKEDITOR.skin.chameleon,r=[[a,e]];this.uiColor=e,i([t],n(this,"editor"),r),i(u,n(this,"panel"),r)}).call(this,e)}});var o="cke_ui_color",u=[],a=/\$color/g;CKEDITOR.on("instanceLoaded",function(e){if(!CKEDITOR.env.ie||!CKEDITOR.env.quirks){var t=e.editor,e=function(e){e=(e.data[0]||e.data).element.getElementsByTag("iframe").getItem(0).getFrameDocument();if(!e.getById("cke_ui_color")){e=r(e),u.push(e);var n=t.getUiColor();n&&i([e],CKEDITOR.skin.chameleon(t,"panel"),[[a,n]])}};t.on("panelShow",e),t.on("menuShow",e),t.config.uiColor&&t.setUiColor(t.config.uiColor)}})}(),function(){if(CKEDITOR.env.webkit)CKEDITOR.env.hc=!1;else{var e=CKEDITOR.dom.element.createFromHtml('<div style="width:0;height:0;position:absolute;left:-10000px;border:1px solid;border-color:red blue"></div>',CKEDITOR.document);e.appendTo(CKEDITOR.document.getHead());try{var t=e.getComputedStyle("border-top-color"),n=e.getComputedStyle("border-right-color");CKEDITOR.env.hc=!!t&&t==n}catch(r){CKEDITOR.env.hc=!1}e.remove()}CKEDITOR.env.hc&&(CKEDITOR.env.cssClass=CKEDITOR.env.cssClass+" cke_hc"),CKEDITOR.document.appendStyleText(".cke{visibility:hidden;}"),CKEDITOR.status="loaded",CKEDITOR.fireOnce("loaded");if(e=CKEDITOR._.pending){delete CKEDITOR._.pending;for(t=0;t<e.length;t++)CKEDITOR.editor.prototype.constructor.apply(e[t][0],e[t][1]),CKEDITOR.add(e[t][0])}}(),CKEDITOR.skin.name="moono",CKEDITOR.skin.ua_editor="ie,iequirks,ie7,ie8,gecko",CKEDITOR.skin.ua_dialog="ie,iequirks,ie7,ie8",CKEDITOR.skin.chameleon=function(){var e=function(){return function(e,t){for(var n=e.match(/[^#]./g),r=0;3>r;r++){var i=n,s=r,o;o=parseInt(n[r],16),o=("0"+(0>t?0|o*(1+t):0|o+(255-o)*t).toString(16)).slice(-2),i[s]=o}return"#"+n.join("")}}(),t=function(){var e=new CKEDITOR.template("background:#{to};background-image:-webkit-gradient(linear,lefttop,leftbottom,from({from}),to({to}));background-image:-moz-linear-gradient(top,{from},{to});background-image:-webkit-linear-gradient(top,{from},{to});background-image:-o-linear-gradient(top,{from},{to});background-image:-ms-linear-gradient(top,{from},{to});background-image:linear-gradient(top,{from},{to});filter:progid:DXImageTransform.Microsoft.gradient(gradientType=0,startColorstr='{from}',endColorstr='{to}');");return function(t,n){return e.output({from:t,to:n})}}(),n={editor:new CKEDITOR.template("{id}.cke_chrome [border-color:{defaultBorder};] {id} .cke_top [ {defaultGradient}border-bottom-color:{defaultBorder};] {id} .cke_bottom [{defaultGradient}border-top-color:{defaultBorder};] {id} .cke_resizer [border-right-color:{ckeResizer}] {id} .cke_dialog_title [{defaultGradient}border-bottom-color:{defaultBorder};] {id} .cke_dialog_footer [{defaultGradient}outline-color:{defaultBorder};border-top-color:{defaultBorder};] {id} .cke_dialog_tab [{lightGradient}border-color:{defaultBorder};] {id} .cke_dialog_tab:hover [{mediumGradient}] {id} .cke_dialog_contents [border-top-color:{defaultBorder};] {id} .cke_dialog_tab_selected, {id} .cke_dialog_tab_selected:hover [background:{dialogTabSelected};border-bottom-color:{dialogTabSelectedBorder};] {id} .cke_dialog_body [background:{dialogBody};border-color:{defaultBorder};] {id} .cke_toolgroup [{lightGradient}border-color:{defaultBorder};] {id} a.cke_button_off:hover, {id} a.cke_button_off:focus, {id} a.cke_button_off:active [{mediumGradient}] {id} .cke_button_on [{ckeButtonOn}] {id} .cke_toolbar_separator [background-color: {ckeToolbarSeparator};] {id} .cke_combo_button [border-color:{defaultBorder};{lightGradient}] {id} a.cke_combo_button:hover, {id} a.cke_combo_button:focus, {id} .cke_combo_on a.cke_combo_button [border-color:{defaultBorder};{mediumGradient}] {id} .cke_path_item [color:{elementsPathColor};] {id} a.cke_path_item:hover, {id} a.cke_path_item:focus, {id} a.cke_path_item:active [background-color:{elementsPathBg};] {id}.cke_panel [border-color:{defaultBorder};] "),panel:new CKEDITOR.template(".cke_panel_grouptitle [{lightGradient}border-color:{defaultBorder};] .cke_menubutton_icon [background-color:{menubuttonIcon};] .cke_menubutton:hover .cke_menubutton_icon, .cke_menubutton:focus .cke_menubutton_icon, .cke_menubutton:active .cke_menubutton_icon [background-color:{menubuttonIconHover};] .cke_menuseparator [background-color:{menubuttonIcon};] a:hover.cke_colorbox, a:focus.cke_colorbox, a:active.cke_colorbox [border-color:{defaultBorder};] a:hover.cke_colorauto, a:hover.cke_colormore, a:focus.cke_colorauto, a:focus.cke_colormore, a:active.cke_colorauto, a:active.cke_colormore [background-color:{ckeColorauto};border-color:{defaultBorder};] ")};return function(r,i){var s=r.uiColor,s={id:"."+r.id,defaultBorder:e(s,-0.1),defaultGradient:t(e(s,.9),s),lightGradient:t(e(s,1),e(s,.7)),mediumGradient:t(e(s,.8),e(s,.5)),ckeButtonOn:t(e(s,.6),e(s,.7)),ckeResizer:e(s,-0.4),ckeToolbarSeparator:e(s,.5),ckeColorauto:e(s,.8),dialogBody:e(s,.7),dialogTabSelected:t("#FFFFFF","#FFFFFF"),dialogTabSelectedBorder:"#FFF",elementsPathColor:e(s,-0.6),elementsPathBg:s,menubuttonIcon:e(s,.5),menubuttonIconHover:e(s,.3)};return n[i].output(s).replace(/\[/g,"{").replace(/\]/g,"}")}}(),CKEDITOR.plugins.add("dialogui",{onLoad:function(){var e=function(e){this._||(this._={}),this._["default"]=this._.initValue=e["default"]||"",this._.required=e.required||!1;for(var t=[this._],n=1;n<arguments.length;n++)t.push(arguments[n]);return t.push(!0),CKEDITOR.tools.extend.apply(CKEDITOR.tools,t),this._},t={build:function(e,t,n){return new CKEDITOR.ui.dialog.textInput(e,t,n)}},n={build:function(e,t,n){return new CKEDITOR.ui.dialog[t.type](e,t,n)}},r={isChanged:function(){return this.getValue()!=this.getInitValue()},reset:function(e){this.setValue(this.getInitValue(),e)},setInitValue:function(){this._.initValue=this.getValue()},resetInitValue:function(){this._.initValue=this._["default"]},getInitValue:function(){return this._.initValue}},i=CKEDITOR.tools.extend({},CKEDITOR.ui.dialog.uiElement.prototype.eventProcessors,{onChange:function(e,t){this._.domOnChangeRegistered||(e.on("load",function(){this.getInputElement().on("change",function(){e.parts.dialog.isVisible()&&this.fire("change",{value:this.getValue()})},this)},this),this._.domOnChangeRegistered=!0),this.on("change",t)}},!0),s=/^on([A-Z]\w+)/,o=function(e){for(var t in e)(s.test(t)||"title"==t||"type"==t)&&delete e[t];return e};CKEDITOR.tools.extend(CKEDITOR.ui.dialog,{labeledElement:function(t,n,r,i){if(!(4>arguments.length)){var s=e.call(this,n);s.labelId=CKEDITOR.tools.getNextId()+"_label",this._.children=[];var o={role:n.role||"presentation"};n.includeLabel&&(o["aria-labelledby"]=s.labelId),CKEDITOR.ui.dialog.uiElement.call(this,t,n,r,"div",null,o,function(){var e=[],r=n.required?" cke_required":"";return n.labelLayout!="horizontal"?e.push('<label class="cke_dialog_ui_labeled_label'+r+'" ',' id="'+s.labelId+'"',s.inputId?' for="'+s.inputId+'"':"",(n.labelStyle?' style="'+n.labelStyle+'"':"")+">",n.label,"</label>",'<div class="cke_dialog_ui_labeled_content"',n.controlStyle?' style="'+n.controlStyle+'"':"",' role="presentation">',i.call(this,t,n),"</div>"):(r={type:"hbox",widths:n.widths,padding:0,children:[{type:"html",html:'<label class="cke_dialog_ui_labeled_label'+r+'" id="'+s.labelId+'" for="'+s.inputId+'"'+(n.labelStyle?' style="'+n.labelStyle+'"':"")+">"+CKEDITOR.tools.htmlEncode(n.label)+"</span>"},{type:"html",html:'<span class="cke_dialog_ui_labeled_content"'+(n.controlStyle?' style="'+n.controlStyle+'"':"")+">"+i.call(this,t,n)+"</span>"}]},CKEDITOR.dialog._.uiElementBuilders.hbox.build(t,r,e)),e.join("")})}},textInput:function(t,n,r){if(!(3>arguments.length)){e.call(this,n);var i=this._.inputId=CKEDITOR.tools.getNextId()+"_textInput",s={"class":"cke_dialog_ui_input_"+n.type,id:i,type:n.type};n.validate&&(this.validate=n.validate),n.maxLength&&(s.maxlength=n.maxLength),n.size&&(s.size=n.size),n.inputStyle&&(s.style=n.inputStyle);var o=this,u=!1;t.on("load",function(){o.getInputElement().on("keydown",function(e){e.data.getKeystroke()==13&&(u=!0)}),o.getInputElement().on("keyup",function(e){e.data.getKeystroke()==13&&u&&(t.getButton("ok")&&setTimeout(function(){t.getButton("ok").click()},0),u=!1)},null,null,1e3)}),CKEDITOR.ui.dialog.labeledElement.call(this,t,n,r,function(){var e=['<div class="cke_dialog_ui_input_',n.type,'" role="presentation"'];n.width&&e.push('style="width:'+n.width+'" '),e.push("><input "),s["aria-labelledby"]=this._.labelId,this._.required&&(s["aria-required"]=this._.required);for(var t in s)e.push(t+'="'+s[t]+'" ');return e.push(" /></div>"),e.join("")})}},textarea:function(t,n,r){if(!(3>arguments.length)){e.call(this,n);var i=this,s=this._.inputId=CKEDITOR.tools.getNextId()+"_textarea",o={};n.validate&&(this.validate=n.validate),o.rows=n.rows||5,o.cols=n.cols||20,o["class"]="cke_dialog_ui_input_textarea "+(n["class"]||""),"undefined"!=typeof n.inputStyle&&(o.style=n.inputStyle),n.dir&&(o.dir=n.dir),CKEDITOR.ui.dialog.labeledElement.call(this,t,n,r,function(){o["aria-labelledby"]=this._.labelId,this._.required&&(o["aria-required"]=this._.required);var e=['<div class="cke_dialog_ui_input_textarea" role="presentation"><textarea id="',s,'" '],t;for(t in o)e.push(t+'="'+CKEDITOR.tools.htmlEncode(o[t])+'" ');return e.push(">",CKEDITOR.tools.htmlEncode(i._["default"]),"</textarea></div>"),e.join("")})}},checkbox:function(t,n,r){if(!(3>arguments.length)){var i=e.call(this,n,{"default":!!n["default"]});n.validate&&(this.validate=n.validate),CKEDITOR.ui.dialog.uiElement.call(this,t,n,r,"span",null,null,function(){var e=CKEDITOR.tools.extend({},n,{id:n.id?n.id+"_checkbox":CKEDITOR.tools.getNextId()+"_checkbox"},!0),r=[],s=CKEDITOR.tools.getNextId()+"_label",u={"class":"cke_dialog_ui_checkbox_input",type:"checkbox","aria-labelledby":s};return o(e),n["default"]&&(u.checked="checked"),typeof e.inputStyle!="undefined"&&(e.style=e.inputStyle),i.checkbox=new CKEDITOR.ui.dialog.uiElement(t,e,r,"input",null,u),r.push(' <label id="',s,'" for="',u.id,'"'+(n.labelStyle?' style="'+n.labelStyle+'"':"")+">",CKEDITOR.tools.htmlEncode(n.label),"</label>"),r.join("")})}},radio:function(t,n,r){if(!(3>arguments.length)){e.call(this,n),this._["default"]||(this._["default"]=this._.initValue=n.items[0][1]),n.validate&&(this.validate=n.valdiate);var i=[],s=this;n.role="radiogroup",n.includeLabel=!0,CKEDITOR.ui.dialog.labeledElement.call(this,t,n,r,function(){for(var e=[],r=[],u=(n.id?n.id:CKEDITOR.tools.getNextId())+"_radio",l=0;l<n.items.length;l++){var h=n.items[l],d=h[2]!==void 0?h[2]:h[0],v=h[1]!==void 0?h[1]:h[0],m=CKEDITOR.tools.getNextId()+"_radio_input",g=m+"_label",m=CKEDITOR.tools.extend({},n,{id:m,title:null,type:null},!0),d=CKEDITOR.tools.extend({},m,{title:d},!0),y={type:"radio","class":"cke_dialog_ui_radio_input",name:u,value:v,"aria-labelledby":g},w=[];s._["default"]==v&&(y.checked="checked"),o(m),o(d),typeof m.inputStyle!="undefined"&&(m.style=m.inputStyle),m.keyboardFocusable=!0,i.push(new CKEDITOR.ui.dialog.uiElement(t,m,w,"input",null,y)),w.push(" "),new CKEDITOR.ui.dialog.uiElement(t,d,w,"label",null,{id:g,"for":y.id},h[0]),e.push(w.join(""))}return new CKEDITOR.ui.dialog.hbox(t,i,e,r),r.join("")}),this._.children=i}},button:function(t,n,r){if(arguments.length){"function"==typeof n&&(n=n(t.getParentEditor())),e.call(this,n,{disabled:n.disabled||!1}),CKEDITOR.event.implementOn(this);var i=this;t.on("load",function(){var e=this.getElement();(function(){e.on("click",function(e){i.click(),e.data.preventDefault()}),e.on("keydown",function(e){e.data.getKeystroke()in{32:1}&&(i.click(),e.data.preventDefault())})})(),e.unselectable()},this);var s=CKEDITOR.tools.extend({},n);delete s.style;var o=CKEDITOR.tools.getNextId()+"_label";CKEDITOR.ui.dialog.uiElement.call(this,t,s,r,"a",null,{style:n.style,href:"javascript:void(0)",title:n.label,hidefocus:"true","class":n["class"],role:"button","aria-labelledby":o},'<span id="'+o+'" class="cke_dialog_ui_button">'+CKEDITOR.tools.htmlEncode(n.label)+"</span>")}},select:function(t,n,r){if(!(3>arguments.length)){var i=e.call(this,n);n.validate&&(this.validate=n.validate),i.inputId=CKEDITOR.tools.getNextId()+"_select",CKEDITOR.ui.dialog.labeledElement.call(this,t,n,r,function(){var e=CKEDITOR.tools.extend({},n,{id:n.id?n.id+"_select":CKEDITOR.tools.getNextId()+"_select"},!0),r=[],s=[],u={id:i.inputId,"class":"cke_dialog_ui_input_select","aria-labelledby":this._.labelId};r.push('<div class="cke_dialog_ui_input_',n.type,'" role="presentation"'),n.width&&r.push('style="width:'+n.width+'" '),r.push(">"),n.size!=void 0&&(u.size=n.size),n.multiple!=void 0&&(u.multiple=n.multiple),o(e);for(var l=0,c;l<n.items.length&&(c=n.items[l]);l++)s.push('<option value="',CKEDITOR.tools.htmlEncode(c[1]!==void 0?c[1]:c[0]).replace(/"/g,"&quot;"),'" /> ',CKEDITOR.tools.htmlEncode(c[0]));return typeof e.inputStyle!="undefined"&&(e.style=e.inputStyle),i.select=new CKEDITOR.ui.dialog.uiElement(t,e,r,"select",null,u,s.join("")),r.push("</div>"),r.join("")})}},file:function(t,n,r){if(!(3>arguments.length)){void 0===n["default"]&&(n["default"]="");var i=CKEDITOR.tools.extend(e.call(this,n),{definition:n,buttons:[]});n.validate&&(this.validate=n.validate),t.on("load",function(){CKEDITOR.document.getById(i.frameId).getParent().addClass("cke_dialog_ui_input_file")}),CKEDITOR.ui.dialog.labeledElement.call(this,t,n,r,function(){i.frameId=CKEDITOR.tools.getNextId()+"_fileInput";var e=['<iframe frameborder="0" allowtransparency="0" class="cke_dialog_ui_input_file" role="presentation" id="',i.frameId,'" title="',n.label,'" src="javascript:void('];return e.push(CKEDITOR.env.ie?"(function(){"+encodeURIComponent("document.open();("+CKEDITOR.tools.fixDomain+")();document.close();")+"})()":"0"),e.push(')"></iframe>'),e.join("")})}},fileButton:function(t,n,r){if(!(3>arguments.length)){e.call(this,n);var i=this;n.validate&&(this.validate=n.validate);var s=CKEDITOR.tools.extend({},n),o=s.onClick;s.className=(s.className?s.className+" ":"")+"cke_dialog_ui_button",s.onClick=function(e){var r=n["for"];if(!o||o.call(this,e)!==!1)t.getContentElement(r[0],r[1]).submit(),this.disable()},t.on("load",function(){t.getContentElement(n["for"][0],n["for"][1])._.buttons.push(i)}),CKEDITOR.ui.dialog.button.call(this,t,s,r)}},html:function(){var e=/^\s*<[\w:]+\s+([^>]*)?>/,t=/^(\s*<[\w:]+(?:\s+[^>]*)?)((?:.|\r|\n)+)$/,n=/\/$/;return function(r,i,s){if(!(3>arguments.length)){var o=[],u=i.html;"<"!=u.charAt(0)&&(u="<span>"+u+"</span>");var f=i.focus;if(f){var l=this.focus;this.focus=function(){("function"==typeof f?f:l).call(this),this.fire("focus")},i.isFocusable&&(this.isFocusable=this.isFocusable),this.keyboardFocusable=!0}CKEDITOR.ui.dialog.uiElement.call(this,r,i,o,"span",null,null,""),o=o.join("").match(e),u=u.match(t)||["","",""],n.test(u[1])&&(u[1]=u[1].slice(0,-1),u[2]="/"+u[2]),s.push([u[1]," ",o[1]||"",u[2]].join(""))}}}(),fieldset:function(e,t,n,r,i){var s=i.label;this._={children:t},CKEDITOR.ui.dialog.uiElement.call(this,e,i,r,"fieldset",null,null,function(){var e=[];s&&e.push("<legend"+(i.labelStyle?' style="'+i.labelStyle+'"':"")+">"+s+"</legend>");for(var t=0;t<n.length;t++)e.push(n[t]);return e.join("")})}},!0),CKEDITOR.ui.dialog.html.prototype=new CKEDITOR.ui.dialog.uiElement,CKEDITOR.ui.dialog.labeledElement.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.uiElement,{setLabel:function(e){var t=CKEDITOR.document.getById(this._.labelId);return 1>t.getChildCount()?(new CKEDITOR.dom.text(e,CKEDITOR.document)).appendTo(t):t.getChild(0).$.nodeValue=e,this},getLabel:function(){var e=CKEDITOR.document.getById(this._.labelId);return!e||1>e.getChildCount()?"":e.getChild(0).getText()},eventProcessors:i},!0),CKEDITOR.ui.dialog.button.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.uiElement,{click:function(){return this._.disabled?!1:this.fire("click",{dialog:this._.dialog})},enable:function(){this._.disabled=!1;var e=this.getElement();e&&e.removeClass("cke_disabled")},disable:function(){this._.disabled=!0,this.getElement().addClass("cke_disabled")},isVisible:function(){return this.getElement().getFirst().isVisible()},isEnabled:function(){return!this._.disabled},eventProcessors:CKEDITOR.tools.extend({},CKEDITOR.ui.dialog.uiElement.prototype.eventProcessors,{onClick:function(e,t){this.on("click",function(){t.apply(this,arguments)})}},!0),accessKeyUp:function(){this.click()},accessKeyDown:function(){this.focus()},keyboardFocusable:!0},!0),CKEDITOR.ui.dialog.textInput.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.labeledElement,{getInputElement:function(){return CKEDITOR.document.getById(this._.inputId)},focus:function(){var e=this.selectParentTab();setTimeout(function(){var t=e.getInputElement();t&&t.$.focus()},0)},select:function(){var e=this.selectParentTab();setTimeout(function(){var t=e.getInputElement();t&&(t.$.focus(),t.$.select())},0)},accessKeyUp:function(){this.select()},setValue:function(e){return!e&&(e=""),CKEDITOR.ui.dialog.uiElement.prototype.setValue.apply(this,arguments)},keyboardFocusable:!0},r,!0),CKEDITOR.ui.dialog.textarea.prototype=new CKEDITOR.ui.dialog.textInput,CKEDITOR.ui.dialog.select.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.labeledElement,{getInputElement:function(){return this._.select.getElement()},add:function(e,t,n){var r=new CKEDITOR.dom.element("option",this.getDialog().getParentEditor().document),i=this.getInputElement().$;return r.$.text=e,r.$.value=void 0===t||null===t?e:t,void 0===n||null===n?CKEDITOR.env.ie?i.add(r.$):i.add(r.$,null):i.add(r.$,n),this},remove:function(e){return this.getInputElement().$.remove(e),this},clear:function(){for(var e=this.getInputElement().$;0<e.length;)e.remove(0);return this},keyboardFocusable:!0},r,!0),CKEDITOR.ui.dialog.checkbox.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.uiElement,{getInputElement:function(){return this._.checkbox.getElement()},setValue:function(e,t){this.getInputElement().$.checked=e,!t&&this.fire("change",{value:e})},getValue:function(){return this.getInputElement().$.checked},accessKeyUp:function(){this.setValue(!this.getValue())},eventProcessors:{onChange:function(e,t){return!CKEDITOR.env.ie||8<CKEDITOR.env.version?i.onChange.apply(this,arguments):(e.on("load",function(){var e=this._.checkbox.getElement();e.on("propertychange",function(t){t=t.data.$,"checked"==t.propertyName&&this.fire("change",{value:e.$.checked})},this)},this),this.on("change",t),null)}},keyboardFocusable:!0},r,!0),CKEDITOR.ui.dialog.radio.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.uiElement,{setValue:function(e,t){for(var n=this._.children,r,i=0;i<n.length&&(r=n[i]);i++)r.getElement().$.checked=r.getValue()==e;!t&&this.fire("change",{value:e})},getValue:function(){for(var e=this._.children,t=0;t<e.length;t++)if(e[t].getElement().$.checked)return e[t].getValue();return null},accessKeyUp:function(){var e=this._.children,t;for(t=0;t<e.length;t++)if(e[t].getElement().$.checked){e[t].getElement().focus();return}e[0].getElement().focus()},eventProcessors:{onChange:function(e,t){return CKEDITOR.env.ie?(e.on("load",function(){for(var e=this._.children,t=this,n=0;n<e.length;n++)e[n].getElement().on("propertychange",function(e){e=e.data.$,"checked"==e.propertyName&&this.$.checked&&t.fire("change",{value:this.getAttribute("value")})})},this),this.on("change",t),null):i.onChange.apply(this,arguments)}}},r,!0),CKEDITOR.ui.dialog.file.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.labeledElement,r,{getInputElement:function(){var e=CKEDITOR.document.getById(this._.frameId).getFrameDocument();return 0<e.$.forms.length?new CKEDITOR.dom.element(e.$.forms[0].elements[0]):this.getElement()},submit:function(){return this.getInputElement().getParent().$.submit(),this},getAction:function(){return this.getInputElement().getParent().$.action},registerEvents:function(e){var t=/^on([A-Z]\w+)/,n,r=function(e,t,n,r){e.on("formLoaded",function(){e.getInputElement().on(n,r,e)})},i;for(i in e)if(n=i.match(t))this.eventProcessors[i]?this.eventProcessors[i].call(this,this._.dialog,e[i]):r(this,this._.dialog,n[1].toLowerCase(),e[i]);return this},reset:function(){function e(){n.$.open();var e="";r.size&&(e=r.size-(CKEDITOR.env.ie?7:0));var l=t.frameId+"_input";n.$.write(['<html dir="'+u+'" lang="'+a+'"><head><title></title></head><body style="margin: 0; overflow: hidden; background: transparent;">','<form enctype="multipart/form-data" method="POST" dir="'+u+'" lang="'+a+'" action="',CKEDITOR.tools.htmlEncode(r.action),'"><label id="',t.labelId,'" for="',l,'" style="display:none">',CKEDITOR.tools.htmlEncode(r.label),'</label><input style="width:100%" id="',l,'" aria-labelledby="',t.labelId,'" type="file" name="',CKEDITOR.tools.htmlEncode(r.id||"cke_upload"),'" size="',CKEDITOR.tools.htmlEncode(0<e?e:""),'" /></form></body></html><script>',CKEDITOR.env.ie?"("+CKEDITOR.tools.fixDomain+")();":"","window.parent.CKEDITOR.tools.callFunction("+s+");","window.onbeforeunload = function() {window.parent.CKEDITOR.tools.callFunction("+o+")}","</script>"].join("")),n.$.close();for(e=0;e<i.length;e++)i[e].enable()}var t=this._,n=CKEDITOR.document.getById(t.frameId).getFrameDocument(),r=t.definition,i=t.buttons,s=this.formLoadedNumber,o=this.formUnloadNumber,u=t.dialog._.editor.lang.dir,a=t.dialog._.editor.langCode;s||(s=this.formLoadedNumber=CKEDITOR.tools.addFunction(function(){this.fire("formLoaded")},this),o=this.formUnloadNumber=CKEDITOR.tools.addFunction(function(){this.getInputElement().clearCustomData()},this),this.getDialog()._.editor.on("destroy",function(){CKEDITOR.tools.removeFunction(s),CKEDITOR.tools.removeFunction(o)})),CKEDITOR.env.gecko?setTimeout(e,500):e()},getValue:function(){return this.getInputElement().$.value||""},setInitValue:function(){this._.initValue=""},eventProcessors:{onChange:function(e,t){this._.domOnChangeRegistered||(this.on("formLoaded",function(){this.getInputElement().on("change",function(){this.fire("change",{value:this.getValue()})},this)},this),this._.domOnChangeRegistered=!0),this.on("change",t)}},keyboardFocusable:!0},!0),CKEDITOR.ui.dialog.fileButton.prototype=new CKEDITOR.ui.dialog.button,CKEDITOR.ui.dialog.fieldset.prototype=CKEDITOR.tools.clone(CKEDITOR.ui.dialog.hbox.prototype),CKEDITOR.dialog.addUIElement("text",t),CKEDITOR.dialog.addUIElement("password",t),CKEDITOR.dialog.addUIElement("textarea",n),CKEDITOR.dialog.addUIElement("checkbox",n),CKEDITOR.dialog.addUIElement("radio",n),CKEDITOR.dialog.addUIElement("button",n),CKEDITOR.dialog.addUIElement("select",n),CKEDITOR.dialog.addUIElement("file",n),CKEDITOR.dialog.addUIElement("fileButton",n),CKEDITOR.dialog.addUIElement("html",n),CKEDITOR.dialog.addUIElement("fieldset",{build:function(e,t,n){for(var r=t.children,i,s=[],o=[],u=0;u<r.length&&(i=r[u]);u++){var a=[];s.push(a),o.push(CKEDITOR.dialog._.uiElementBuilders[i.type].build(e,i,a))}return new CKEDITOR.ui.dialog[t.type](e,o,s,n,t)}})}}),CKEDITOR.DIALOG_RESIZE_NONE=0,CKEDITOR.DIALOG_RESIZE_WIDTH=1,CKEDITOR.DIALOG_RESIZE_HEIGHT=2,CKEDITOR.DIALOG_RESIZE_BOTH=3,function(){function e(){for(var e=this._.tabIdList.length,t=CKEDITOR.tools.indexOf(this._.tabIdList,this._.currentTabId)+e,n=t-1;n>t-e;n--)if(this._.tabs[this._.tabIdList[n%e]][0].$.offsetHeight)return this._.tabIdList[n%e];return null}function t(){for(var e=this._.tabIdList.length,t=CKEDITOR.tools.indexOf(this._.tabIdList,this._.currentTabId),n=t+1;n<t+e;n++)if(this._.tabs[this._.tabIdList[n%e]][0].$.offsetHeight)return this._.tabIdList[n%e];return null}function n(e,t){for(var n=e.$.getElementsByTagName("input"),r=0,i=n.length;r<i;r++){var s=new CKEDITOR.dom.element(n[r]);"text"==s.getAttribute("type").toLowerCase()&&(t?(s.setAttribute("value",s.getCustomData("fake_value")||""),s.removeCustomData("fake_value")):(s.setCustomData("fake_value",s.getAttribute("value")),s.setAttribute("value","")))}}function r(e,t){var n=this.getInputElement();n&&(e?n.removeAttribute("aria-invalid"):n.setAttribute("aria-invalid",!0)),e||(this.select?this.select():this.focus()),t&&alert(t),this.fire("validated",{valid:e,msg:t})}function i(){var e=this.getInputElement();e&&e.removeAttribute("aria-invalid")}function s(e){var e=CKEDITOR.dom.element.createFromHtml(CKEDITOR.addTemplate("dialog",v).output({id:CKEDITOR.tools.getNextNumber(),editorId:e.id,langDir:e.lang.dir,langCode:e.langCode,editorDialogClass:"cke_editor_"+e.name.replace(/\./g,"\\.")+"_dialog",closeTitle:e.lang.common.close,hidpi:CKEDITOR.env.hidpi?"cke_hidpi":""})),t=e.getChild([0,0,0,0,0]),n=t.getChild(0),r=t.getChild(1);if(CKEDITOR.env.ie&&!CKEDITOR.env.quirks){var i="javascript:void(function(){"+encodeURIComponent("document.open();("+CKEDITOR.tools.fixDomain+")();document.close();")+"}())";CKEDITOR.dom.element.createFromHtml('<iframe frameBorder="0" class="cke_iframe_shim" src="'+i+'" tabIndex="-1"></iframe>').appendTo(t.getParent())}return n.unselectable(),r.unselectable(),{element:e,parts:{dialog:e.getChild(0),title:n,close:r,tabs:t.getChild(2),contents:t.getChild([3,0,0,0]),footer:t.getChild([3,0,1,0])}}}function o(e,t,n){this.element=t,this.focusIndex=n,this.tabIndex=0,this.isFocusable=function(){return!t.getAttribute("disabled")&&t.isVisible()},this.focus=function(){e._.currentFocusIndex=this.focusIndex,this.element.focus()},t.on("keydown",function(e){e.data.getKeystroke()in{32:1,13:1}&&this.fire("click")}),t.on("focus",function(){this.fire("mouseover")}),t.on("blur",function(){this.fire("mouseout")})}function u(e){function t(){e.layout()}var n=CKEDITOR.document.getWindow();n.on("resize",t),e.on("hide",function(){n.removeListener("resize",t)})}function a(e,t){this._={dialog:e},CKEDITOR.tools.extend(this,t)}function f(e){function t(t){var n=e.getSize(),a=CKEDITOR.document.getWindow().getViewPaneSize(),f=t.data.$.screenX,l=t.data.$.screenY,c=f-r.x,h=l-r.y;r={x:f,y:l},i.x+=c,i.y+=h,e.move(i.x+u[3]<o?-u[3]:i.x-u[1]>a.width-n.width-o?a.width-n.width+("rtl"==s.lang.dir?0:u[1]):i.x,i.y+u[0]<o?-u[0]:i.y-u[2]>a.height-n.height-o?a.height-n.height+u[2]:i.y,1),t.data.preventDefault()}function n(){CKEDITOR.document.removeListener("mousemove",t),CKEDITOR.document.removeListener("mouseup",n);if(CKEDITOR.env.ie6Compat){var e=x.getChild(0).getFrameDocument();e.removeListener("mousemove",t),e.removeListener("mouseup",n)}}var r=null,i=null;e.getElement().getFirst();var s=e.getParentEditor(),o=s.config.dialog_magnetDistance,u=CKEDITOR.skin.margins||[0,0,0,0];"undefined"==typeof o&&(o=20),e.parts.title.on("mousedown",function(s){r={x:s.data.$.screenX,y:s.data.$.screenY},CKEDITOR.document.on("mousemove",t),CKEDITOR.document.on("mouseup",n),i=e.getPosition();if(CKEDITOR.env.ie6Compat){var o=x.getChild(0).getFrameDocument();o.on("mousemove",t),o.on("mouseup",n)}s.data.preventDefault()},e)}function l(e){function r(r){var i="rtl"==u.lang.dir,h=c.width,p=c.height,d=h+(r.data.$.screenX-t)*(i?-1:1)*(e._.moved?1:2),v=p+(r.data.$.screenY-n)*(e._.moved?1:2),m=e._.element.getFirst(),m=i&&m.getComputedStyle("right"),g=e.getPosition();g.y+v>l.height&&(v=l.height-g.y),(i?m:g.x)+d>l.width&&(d=l.width-(i?m:g.x));if(o==CKEDITOR.DIALOG_RESIZE_WIDTH||o==CKEDITOR.DIALOG_RESIZE_BOTH)h=Math.max(s.minWidth||0,d-a);if(o==CKEDITOR.DIALOG_RESIZE_HEIGHT||o==CKEDITOR.DIALOG_RESIZE_BOTH)p=Math.max(s.minHeight||0,v-f);e.resize(h,p),e._.moved||e.layout(),r.data.preventDefault()}function i(){CKEDITOR.document.removeListener("mouseup",i),CKEDITOR.document.removeListener("mousemove",r),h&&(h.remove(),h=null);if(CKEDITOR.env.ie6Compat){var e=x.getChild(0).getFrameDocument();e.removeListener("mouseup",i),e.removeListener("mousemove",r)}}var t,n,s=e.definition,o=s.resizable;if(o!=CKEDITOR.DIALOG_RESIZE_NONE){var u=e.getParentEditor(),a,f,l,c,h,p=CKEDITOR.tools.addFunction(function(s){c=e.getSize();var o=e.parts.contents;o.$.getElementsByTagName("iframe").length&&(h=CKEDITOR.dom.element.createFromHtml('<div class="cke_dialog_resize_cover" style="height: 100%; position: absolute; width: 100%;"></div>'),o.append(h)),f=c.height-e.parts.contents.getSize("height",!(CKEDITOR.env.gecko||CKEDITOR.env.ie&&CKEDITOR.env.quirks)),a=c.width-e.parts.contents.getSize("width",1),t=s.screenX,n=s.screenY,l=CKEDITOR.document.getWindow().getViewPaneSize(),CKEDITOR.document.on("mousemove",r),CKEDITOR.document.on("mouseup",i),CKEDITOR.env.ie6Compat&&(o=x.getChild(0).getFrameDocument(),o.on("mousemove",r),o.on("mouseup",i)),s.preventDefault&&s.preventDefault()});e.on("load",function(){var t="";o==CKEDITOR.DIALOG_RESIZE_WIDTH?t=" cke_resizer_horizontal":o==CKEDITOR.DIALOG_RESIZE_HEIGHT&&(t=" cke_resizer_vertical"),t=CKEDITOR.dom.element.createFromHtml('<div class="cke_resizer'+t+" cke_resizer_"+u.lang.dir+'" title="'+CKEDITOR.tools.htmlEncode(u.lang.common.resize)+'" onmousedown="CKEDITOR.tools.callFunction('+p+', event )">'+("ltr"==u.lang.dir?"◢":"◣")+"</div>"),e.parts.footer.append(t,1)}),u.on("destroy",function(){CKEDITOR.tools.removeFunction(p)})}}function c(e){e.data.preventDefault(1)}function h(e){var t=CKEDITOR.document.getWindow(),n=e.config,r=n.dialog_backgroundCoverColor||"white",i=n.dialog_backgroundCoverOpacity,s=n.baseFloatZIndex,n=CKEDITOR.tools.genKey(r,i,s),o=S[n];o?o.show():(s=['<div tabIndex="-1" style="position: ',CKEDITOR.env.ie6Compat?"absolute":"fixed","; z-index: ",s,"; top: 0px; left: 0px; ",CKEDITOR.env.ie6Compat?"":"background-color: "+r,'" class="cke_dialog_background_cover">'],CKEDITOR.env.ie6Compat&&(r="<html><body style=\\'background-color:"+r+";\\'></body></html>",s.push('<iframe hidefocus="true" frameborder="0" id="cke_dialog_background_iframe" src="javascript:'),s.push("void((function(){"+encodeURIComponent("document.open();("+CKEDITOR.tools.fixDomain+")();document.write( '"+r+"' );document.close();")+"})())"),s.push('" style="position:absolute;left:0;top:0;width:100%;height: 100%;filter: progid:DXImageTransform.Microsoft.Alpha(opacity=0)"></iframe>')),s.push("</div>"),o=CKEDITOR.dom.element.createFromHtml(s.join("")),o.setOpacity(void 0!=i?i:.5),o.on("keydown",c),o.on("keypress",c),o.on("keyup",c),o.appendTo(CKEDITOR.document.getBody()),S[n]=o),e.focusManager.add(o),x=o;var e=function(){var e=t.getViewPaneSize();o.setStyles({width:e.width+"px",height:e.height+"px"})},u=function(){var e=t.getScrollPosition(),n=CKEDITOR.dialog._.currentTop;o.setStyles({left:e.x+"px",top:e.y+"px"});if(n)do e=n.getPosition(),n.move(e.x,e.y);while(n=n._.parentDialog)};E=e,t.on("resize",e),e(),(!CKEDITOR.env.mac||!CKEDITOR.env.webkit)&&o.focus();if(CKEDITOR.env.ie6Compat){var a=function(){u(),arguments.callee.prevScrollHandler.apply(this,arguments)};t.$.setTimeout(function(){a.prevScrollHandler=window.onscroll||function(){},window.onscroll=a},0),u()}}function p(e){x&&(e.focusManager.remove(x),e=CKEDITOR.document.getWindow(),x.hide(),e.removeListener("resize",E),CKEDITOR.env.ie6Compat&&e.$.setTimeout(function(){window.onscroll=window.onscroll&&window.onscroll.prevScrollHandler||null},0),E=null)}var d=CKEDITOR.tools.cssLength,v='<div class="cke_reset_all {editorId} {editorDialogClass} {hidpi}" dir="{langDir}" lang="{langCode}" role="dialog" aria-labelledby="cke_dialog_title_{id}"><table class="cke_dialog '+CKEDITOR.env.cssClass+' cke_{langDir}" style="position:absolute" role="presentation"><tr><td role="presentation"><div class="cke_dialog_body" role="presentation"><div id="cke_dialog_title_{id}" class="cke_dialog_title" role="presentation"></div><a id="cke_dialog_close_button_{id}" class="cke_dialog_close_button" href="javascript:void(0)" title="{closeTitle}" role="button"><span class="cke_label">X</span></a><div id="cke_dialog_tabs_{id}" class="cke_dialog_tabs" role="tablist"></div><table class="cke_dialog_contents" role="presentation"><tr><td id="cke_dialog_contents_{id}" class="cke_dialog_contents_body" role="presentation"></td></tr><tr><td id="cke_dialog_footer_{id}" class="cke_dialog_footer" role="presentation"></td></tr></table></div></td></tr></table></div>';CKEDITOR.dialog=function(n,o){function u(){var e=x._.focusList;e.sort(function(e,t){return e.tabIndex!=t.tabIndex?t.tabIndex-e.tabIndex:e.focusIndex-t.focusIndex});for(var t=e.length,n=0;n<t;n++)e[n].focusIndex=n}function a(e){var t=x._.focusList,e=e||0;if(!(1>t.length)){var n=x._.currentFocusIndex;try{t[n].getInputElement().$.blur()}catch(r){}for(var i=n=(n+e+t.length)%t.length;e&&!t[i].isFocusable()&&(i=(i+e+t.length)%t.length,i!=n););t[i].focus(),"text"==t[i].type&&t[i].select()}}function c(r){if(x==CKEDITOR.dialog._.currentTop){var i=r.data.getKeystroke(),s="rtl"==n.lang.dir;b=E=0;if(9==i||i==CKEDITOR.SHIFT+9)i=i==CKEDITOR.SHIFT+9,x._.tabBarMode?(i=i?e.call(x):t.call(x),x.selectPage(i),x._.tabs[i][0].focus()):a(i?-1:1),b=1;else if(i==CKEDITOR.ALT+121&&!x._.tabBarMode&&1<x.getPageCount())x._.tabBarMode=!0,x._.tabs[x._.currentTabId][0].focus(),b=1;else if(37!=i&&39!=i||!x._.tabBarMode)if(13!=i&&32!=i||!x._.tabBarMode)if(13==i)i=r.data.getTarget(),!i.is("a","button","select","textarea")&&(!i.is("input")||"button"!=i.$.type)&&((i=this.getButton("ok"))&&CKEDITOR.tools.setTimeout(i.click,0,i),b=1),E=1;else{if(27!=i)return;(i=this.getButton("cancel"))?CKEDITOR.tools.setTimeout(i.click,0,i):!1!==this.fire("cancel",{hide:!0}).hide&&this.hide(),E=1}else this.selectPage(this._.currentTabId),this._.tabBarMode=!1,this._.currentFocusIndex=-1,a(1),b=1;else i=i==(s?39:37)?e.call(x):t.call(x),x.selectPage(i),x._.tabs[i][0].focus(),b=1;h(r)}}function h(e){b?e.data.preventDefault(1):E&&e.data.stopPropagation()}var p=CKEDITOR.dialog._.dialogDefinitions[o],d=CKEDITOR.tools.clone(m),v=n.config.dialog_buttonsOrder||"OS",g=n.lang.dir,y={},b,E;("OS"==v&&CKEDITOR.env.mac||"rtl"==v&&"ltr"==g||"ltr"==v&&"rtl"==g)&&d.buttons.reverse(),p=CKEDITOR.tools.extend(p(n),d),p=CKEDITOR.tools.clone(p),p=new w(this,p),d=s(n),this._={editor:n,element:d.element,name:o,contentSize:{width:0,height:0},size:{width:0,height:0},contents:{},buttons:{},accessKeyMap:{},tabs:{},tabIdList:[],currentTabId:null,currentTabIndex:null,pageCount:0,lastTab:null,tabBarMode:!1,focusList:[],currentFocusIndex:0,hasFocus:!1},this.parts=d.parts,CKEDITOR.tools.setTimeout(function(){n.fire("ariaWidget",this.parts.contents)},0,this),d={position:CKEDITOR.env.ie6Compat?"absolute":"fixed",top:0,visibility:"hidden"},d["rtl"==g?"right":"left"]=0,this.parts.dialog.setStyles(d),CKEDITOR.event.call(this),this.definition=p=CKEDITOR.fire("dialogDefinition",{name:o,definition:p},n).definition;if(!("removeDialogTabs"in n._)&&n.config.removeDialogTabs){d=n.config.removeDialogTabs.split(";");for(g=0;g<d.length;g++)if(v=d[g].split(":"),2==v.length){var S=v[0];y[S]||(y[S]=[]),y[S].push(v[1])}n._.removeDialogTabs=y}if(n._.removeDialogTabs&&(y=n._.removeDialogTabs[o]))for(g=0;g<y.length;g++)p.removeContents(y[g]);p.onLoad&&this.on("load",p.onLoad),p.onShow&&this.on("show",p.onShow),p.onHide&&this.on("hide",p.onHide),p.onOk&&this.on("ok",function(e){n.fire("saveSnapshot"),setTimeout(function(){n.fire("saveSnapshot")},0),!1===p.onOk.call(this,e)&&(e.data.hide=!1)}),p.onCancel&&this.on("cancel",function(e){!1===p.onCancel.call(this,e)&&(e.data.hide=!1)});var x=this,T=function(e){var t=x._.contents,n=!1,r;for(r in t)for(var i in t[r])if(n=e.call(this,t[r][i]))return};this.on("ok",function(e){T(function(t){if(t.validate){var n=t.validate(this),i="string"==typeof n||!1===n;return i&&(e.data.hide=!1,e.stop()),r.call(t,!i,"string"==typeof n?n:void 0),i}})},this,null,0),this.on("cancel",function(e){T(function(t){if(t.isChanged())return!n.config.dialog_noConfirmCancel&&!confirm(n.lang.common.confirmCancel)&&(e.data.hide=!1),!0})},this,null,0),this.parts.close.on("click",function(e){!1!==this.fire("cancel",{hide:!0}).hide&&this.hide(),e.data.preventDefault()},this),this.changeFocus=a;var N=this._.element;n.focusManager.add(N,1),this.on("show",function(){N.on("keydown",c,this),CKEDITOR.env.gecko&&N.on("keypress",h,this)}),this.on("hide",function(){N.removeListener("keydown",c),CKEDITOR.env.gecko&&N.removeListener("keypress",h),T(function(e){i.apply(e)})}),this.on("iframeAdded",function(e){(new CKEDITOR.dom.document(e.data.iframe.$.contentWindow.document)).on("keydown",c,this,null,0)}),this.on("show",function(){u();if(n.config.dialog_startupFocusTab&&1<x._.pageCount)x._.tabBarMode=!0,x._.tabs[x._.currentTabId][0].focus();else if(!this._.hasFocus)if(this._.currentFocusIndex=-1,p.onFocus){var e=p.onFocus.call(this);e&&e.focus()}else a(1)},this,null,4294967295),CKEDITOR.env.ie6Compat&&this.on("load",function(){var e=this.getElement(),t=e.getFirst();t.remove(),t.appendTo(e)},this),f(this),l(this),(new CKEDITOR.dom.text(p.title,CKEDITOR.document)).appendTo(this.parts.title);for(g=0;g<p.contents.length;g++)(y=p.contents[g])&&this.addPage(y);this.parts.tabs.on("click",function(e){var t=e.data.getTarget();t.hasClass("cke_dialog_tab")&&(t=t.$.id,this.selectPage(t.substring(4,t.lastIndexOf("_"))),this._.tabBarMode&&(this._.tabBarMode=!1,this._.currentFocusIndex=-1,a(1)),e.data.preventDefault())},this),g=[],y=CKEDITOR.dialog._.uiElementBuilders.hbox.build(this,{type:"hbox",className:"cke_dialog_footer_buttons",widths:[],children:p.buttons},g).getChild(),this.parts.footer.setHtml(g.join(""));for(g=0;g<y.length;g++)this._.buttons[y[g].id]=y[g]},CKEDITOR.dialog.prototype={destroy:function(){this.hide(),this._.element.remove()},resize:function(){return function(e,t){if(!this._.contentSize||this._.contentSize.width!=e||this._.contentSize.height!=t)CKEDITOR.dialog.fire("resize",{dialog:this,width:e,height:t},this._.editor),this.fire("resize",{width:e,height:t},this._.editor),this.parts.contents.setStyles({width:e+"px",height:t+"px"}),"rtl"==this._.editor.lang.dir&&this._.position&&(this._.position.x=CKEDITOR.document.getWindow().getViewPaneSize().width-this._.contentSize.width-parseInt(this._.element.getFirst().getStyle("right"),10)),this._.contentSize={width:e,height:t}}}(),getSize:function(){var e=this._.element.getFirst();return{width:e.$.offsetWidth||0,height:e.$.offsetHeight||0}},move:function(e,t,n){var r=this._.element.getFirst(),i="rtl"==this._.editor.lang.dir,s="fixed"==r.getComputedStyle("position");CKEDITOR.env.ie&&r.setStyle("zoom","100%");if(!s||!this._.position||this._.position.x!=e||this._.position.y!=t)this._.position={x:e,y:t},s||(s=CKEDITOR.document.getWindow().getScrollPosition(),e+=s.x,t+=s.y),i&&(s=this.getSize(),e=CKEDITOR.document.getWindow().getViewPaneSize().width-s.width-e),t={top:(0<t?t:0)+"px"},t[i?"right":"left"]=(0<e?e:0)+"px",r.setStyles(t),n&&(this._.moved=1)},getPosition:function(){return CKEDITOR.tools.extend({},this._.position)},show:function(){var e=this._.element,t=this.definition;!e.getParent()||!e.getParent().equals(CKEDITOR.document.getBody())?e.appendTo(CKEDITOR.document.getBody()):e.setStyle("display","block"),this.resize(this._.contentSize&&this._.contentSize.width||t.width||t.minWidth,this._.contentSize&&this._.contentSize.height||t.height||t.minHeight),this.reset(),this.selectPage(this.definition.contents[0].id),null===CKEDITOR.dialog._.currentZIndex&&(CKEDITOR.dialog._.currentZIndex=this._.editor.config.baseFloatZIndex),this._.element.getFirst().setStyle("z-index",CKEDITOR.dialog._.currentZIndex+=10),null===CKEDITOR.dialog._.currentTop?(CKEDITOR.dialog._.currentTop=this,this._.parentDialog=null,h(this._.editor)):(this._.parentDialog=CKEDITOR.dialog._.currentTop,this._.parentDialog.getElement().getFirst().$.style.zIndex-=Math.floor(this._.editor.config.baseFloatZIndex/2),CKEDITOR.dialog._.currentTop=this),e.on("keydown",N),e.on("keyup",C),this._.hasFocus=!1;for(var n in t.contents)if(t.contents[n]){var e=t.contents[n],r=this._.tabs[e.id],i=e.requiredContent,s=0;if(r){for(var o in this._.contents[e.id]){var a=this._.contents[e.id][o];"hbox"==a.type||"vbox"==a.type||!a.getInputElement()||(a.requiredContent&&!this._.editor.activeFilter.check(a.requiredContent)?a.disable():(a.enable(),s++))}!s||i&&!this._.editor.activeFilter.check(i)?r[0].addClass("cke_dialog_tab_disabled"):r[0].removeClass("cke_dialog_tab_disabled")}}CKEDITOR.tools.setTimeout(function(){this.layout(),u(this),this.parts.dialog.setStyle("visibility",""),this.fireOnce("load",{}),CKEDITOR.ui.fire("ready",this),this.fire("show",{}),this._.editor.fire("dialogShow",this),this._.parentDialog||this._.editor.focusManager.lock(),this.foreach(function(e){e.setInitValue&&e.setInitValue()})},100,this)},layout:function(){var e=this.parts.dialog,t=this.getSize(),n=CKEDITOR.document.getWindow().getViewPaneSize(),r=(n.width-t.width)/2,i=(n.height-t.height)/2;CKEDITOR.env.ie6Compat||(t.height+(0<i?i:0)>n.height||t.width+(0<r?r:0)>n.width?e.setStyle("position","absolute"):e.setStyle("position","fixed")),this.move(this._.moved?this._.position.x:r,this._.moved?this._.position.y:i)},foreach:function(e){for(var t in this._.contents)for(var n in this._.contents[t])e.call(this,this._.contents[t][n]);return this},reset:function(){var e=function(e){e.reset&&e.reset(1)};return function(){return this.foreach(e),this}}(),setupContent:function(){var e=arguments;this.foreach(function(t){t.setup&&t.setup.apply(t,e)})},commitContent:function(){var e=arguments;this.foreach(function(t){CKEDITOR.env.ie&&this._.currentFocusIndex==t.focusIndex&&t.getInputElement().$.blur(),t.commit&&t.commit.apply(t,e)})},hide:function(){if(this.parts.dialog.isVisible()){this.fire("hide",{}),this._.editor.fire("dialogHide",this),this.selectPage(this._.tabIdList[0]);var e=this._.element;e.setStyle("display","none"),this.parts.dialog.setStyle("visibility","hidden");for(L(this);CKEDITOR.dialog._.currentTop!=this;)CKEDITOR.dialog._.currentTop.hide();if(this._.parentDialog){var t=this._.parentDialog.getElement().getFirst();t.setStyle("z-index",parseInt(t.$.style.zIndex,10)+Math.floor(this._.editor.config.baseFloatZIndex/2))}else p(this._.editor);if(CKEDITOR.dialog._.currentTop=this._.parentDialog)CKEDITOR.dialog._.currentZIndex-=10;else{CKEDITOR.dialog._.currentZIndex=null,e.removeListener("keydown",N),e.removeListener("keyup",C);var n=this._.editor;n.focus(),setTimeout(function(){n.focusManager.unlock()},0)}delete this._.parentDialog,this.foreach(function(e){e.resetInitValue&&e.resetInitValue()})}},addPage:function(e){if(!e.requiredContent||this._.editor.filter.check(e.requiredContent)){for(var t=[],n=e.label?' title="'+CKEDITOR.tools.htmlEncode(e.label)+'"':"",r=CKEDITOR.dialog._.uiElementBuilders.vbox.build(this,{type:"vbox",className:"cke_dialog_page_contents",children:e.elements,expand:!!e.expand,padding:e.padding,style:e.style||"width: 100%;"},t),i=this._.contents[e.id]={},s=r.getChild(),o=0;r=s.shift();)!r.notAllowed&&"hbox"!=r.type&&"vbox"!=r.type&&o++,i[r.id]=r,"function"==typeof r.getChild&&s.push.apply(s,r.getChild());o||(e.hidden=!0),t=CKEDITOR.dom.element.createFromHtml(t.join("")),t.setAttribute("role","tabpanel"),r=CKEDITOR.env,i="cke_"+e.id+"_"+CKEDITOR.tools.getNextNumber(),n=CKEDITOR.dom.element.createFromHtml(['<a class="cke_dialog_tab"',0<this._.pageCount?" cke_last":"cke_first",n,e.hidden?' style="display:none"':"",' id="',i,'"',r.gecko&&!r.hc?"":' href="javascript:void(0)"',' tabIndex="-1" hidefocus="true" role="tab">',e.label,"</a>"].join("")),t.setAttribute("aria-labelledby",i),this._.tabs[e.id]=[n,t],this._.tabIdList.push(e.id),!e.hidden&&this._.pageCount++,this._.lastTab=n,this.updateStyle(),t.setAttribute("name",e.id),t.appendTo(this.parts.contents),n.unselectable(),this.parts.tabs.append(n),e.accessKey&&(k(this,this,"CTRL+"+e.accessKey,O,A),this._.accessKeyMap["CTRL+"+e.accessKey]=e.id)}},selectPage:function(e){if(this._.currentTabId!=e&&!this._.tabs[e][0].hasClass("cke_dialog_tab_disabled")&&!1!==this.fire("selectPage",{page:e,currentPage:this._.currentTabId})){for(var t in this._.tabs){var r=this._.tabs[t][0],i=this._.tabs[t][1];t!=e&&(r.removeClass("cke_dialog_tab_selected"),i.hide()),i.setAttribute("aria-hidden",t!=e)}var s=this._.tabs[e];s[0].addClass("cke_dialog_tab_selected"),CKEDITOR.env.ie6Compat||CKEDITOR.env.ie7Compat?(n(s[1]),s[1].show(),setTimeout(function(){n(s[1],1)},0)):s[1].show(),this._.currentTabId=e,this._.currentTabIndex=CKEDITOR.tools.indexOf(this._.tabIdList,e)}},updateStyle:function(){this.parts.dialog[(1===this._.pageCount?"add":"remove")+"Class"]("cke_single_page")},hidePage:function(t){var n=this._.tabs[t]&&this._.tabs[t][0];n&&1!=this._.pageCount&&n.isVisible()&&(t==this._.currentTabId&&this.selectPage(e.call(this)),n.hide(),this._.pageCount--,this.updateStyle())},showPage:function(e){if(e=this._.tabs[e]&&this._.tabs[e][0])e.show(),this._.pageCount++,this.updateStyle()},getElement:function(){return this._.element},getName:function(){return this._.name},getContentElement:function(e,t){var n=this._.contents[e];return n&&n[t]},getValueOf:function(e,t){return this.getContentElement(e,t).getValue()},setValueOf:function(e,t,n){return this.getContentElement(e,t).setValue(n)},getButton:function(e){return this._.buttons[e]},click:function(e){return this._.buttons[e].click()},disableButton:function(e){return this._.buttons[e].disable()},enableButton:function(e){return this._.buttons[e].enable()},getPageCount:function(){return this._.pageCount},getParentEditor:function(){return this._.editor},getSelectedElement:function(){return this.getParentEditor().getSelection().getSelectedElement()},addFocusable:function(e,t){if("undefined"==typeof t)t=this._.focusList.length,this._.focusList.push(new o(this,e,t));else{this._.focusList.splice(t,0,new o(this,e,t));for(var n=t+1;n<this._.focusList.length;n++)this._.focusList[n].focusIndex++}}},CKEDITOR.tools.extend(CKEDITOR.dialog,{add:function(e,t){if(!this._.dialogDefinitions[e]||"function"==typeof t)this._.dialogDefinitions[e]=t},exists:function(e){return!!this._.dialogDefinitions[e]},getCurrent:function(){return CKEDITOR.dialog._.currentTop},isTabEnabled:function(e,t,n){return e=e.config.removeDialogTabs,!e||!e.match(RegExp("(?:^|;)"+t+":"+n+"(?:$|;)","i"))},okButton:function(){var e=function(e,t){return t=t||{},CKEDITOR.tools.extend({id:"ok",type:"button",label:e.lang.common.ok,"class":"cke_dialog_ui_button_ok",onClick:function(e){e=e.data.dialog,!1!==e.fire("ok",{hide:!0}).hide&&e.hide()}},t,!0)};return e.type="button",e.override=function(t){return CKEDITOR.tools.extend(function(n){return e(n,t)},{type:"button"},!0)},e}(),cancelButton:function(){var e=function(e,t){return t=t||{},CKEDITOR.tools.extend({id:"cancel",type:"button",label:e.lang.common.cancel,"class":"cke_dialog_ui_button_cancel",onClick:function(e){e=e.data.dialog,!1!==e.fire("cancel",{hide:!0}).hide&&e.hide()}},t,!0)};return e.type="button",e.override=function(t){return CKEDITOR.tools.extend(function(n){return e(n,t)},{type:"button"},!0)},e}(),addUIElement:function(e,t){this._.uiElementBuilders[e]=t}}),CKEDITOR.dialog._={uiElementBuilders:{},dialogDefinitions:{},currentTop:null,currentZIndex:null},CKEDITOR.event.implementOn(CKEDITOR.dialog),CKEDITOR.event.implementOn(CKEDITOR.dialog.prototype);var m={resizable:CKEDITOR.DIALOG_RESIZE_BOTH,minWidth:600,minHeight:400,buttons:[CKEDITOR.dialog.okButton,CKEDITOR.dialog.cancelButton]},g=function(e,t,n){for(var r=0,i;i=e[r];r++)if(i.id==t||n&&i[n]&&(i=g(i[n],t,n)))return i;return null},y=function(e,t,n,r,i){if(n){for(var s=0,o;o=e[s];s++){if(o.id==n)return e.splice(s,0,t),t;if(r&&o[r]&&(o=y(o[r],t,n,r,!0)))return o}if(i)return null}return e.push(t),t},b=function(e,t,n){for(var r=0,i;i=e[r];r++){if(i.id==t)return e.splice(r,1);if(n&&i[n]&&(i=b(i[n],t,n)))return i}return null},w=function(e,t){this.dialog=e;for(var n=t.contents,r=0,i;i=n[r];r++)n[r]=i&&new a(e,i);CKEDITOR.tools.extend(this,t)};w.prototype={getContents:function(e){return g(this.contents,e)},getButton:function(e){return g(this.buttons,e)},addContents:function(e,t){return y(this.contents,e,t)},addButton:function(e,t){return y(this.buttons,e,t)},removeContents:function(e){b(this.contents,e)},removeButton:function(e){b(this.buttons,e)}},a.prototype={get:function(e){return g(this.elements,e,"children")},add:function(e,t){return y(this.elements,e,t,"children")},remove:function(e){b(this.elements,e,"children")}};var E,S={},x,T={},N=function(e){var t=e.data.$.ctrlKey||e.data.$.metaKey,n=e.data.$.altKey,r=e.data.$.shiftKey,i=String.fromCharCode(e.data.$.keyCode);(t=T[(t?"CTRL+":"")+(n?"ALT+":"")+(r?"SHIFT+":"")+i])&&t.length&&(t=t[t.length-1],t.keydown&&t.keydown.call(t.uiElement,t.dialog,t.key),e.data.preventDefault())},C=function(e){var t=e.data.$.ctrlKey||e.data.$.metaKey,n=e.data.$.altKey,r=e.data.$.shiftKey,i=String.fromCharCode(e.data.$.keyCode);(t=T[(t?"CTRL+":"")+(n?"ALT+":"")+(r?"SHIFT+":"")+i])&&t.length&&(t=t[t.length-1],t.keyup&&(t.keyup.call(t.uiElement,t.dialog,t.key),e.data.preventDefault()))},k=function(e,t,n,r,i){(T[n]||(T[n]=[])).push({uiElement:e,dialog:t,key:n,keyup:i||e.accessKeyUp,keydown:r||e.accessKeyDown})},L=function(e){for(var t in T){for(var n=T[t],r=n.length-1;0<=r;r--)(n[r].dialog==e||n[r].uiElement==e)&&n.splice(r,1);0===n.length&&delete T[t]}},A=function(e,t){e._.accessKeyMap[t]&&e.selectPage(e._.accessKeyMap[t])},O=function(){};(function(){CKEDITOR.ui.dialog={uiElement:function(e,t,n,r,i,s,o){if(!(4>arguments.length)){var u=(r.call?r(t):r)||"div",a=["<",u," "],f=(i&&i.call?i(t):i)||{},l=(s&&s.call?s(t):s)||{},c=(o&&o.call?o.call(this,e,t):o)||"",h=this.domId=l.id||CKEDITOR.tools.getNextId()+"_uiElement";this.id=t.id,t.requiredContent&&!e.getParentEditor().filter.check(t.requiredContent)&&(f.display="none",this.notAllowed=!0),l.id=h;var p={};t.type&&(p["cke_dialog_ui_"+t.type]=1),t.className&&(p[t.className]=1),t.disabled&&(p.cke_disabled=1);for(var d=l["class"]&&l["class"].split?l["class"].split(" "):[],h=0;h<d.length;h++)d[h]&&(p[d[h]]=1);d=[];for(h in p)d.push(h);l["class"]=d.join(" "),t.title&&(l.title=t.title),p=(t.style||"").split(";"),t.align&&(d=t.align,f["margin-left"]="left"==d?0:"auto",f["margin-right"]="right"==d?0:"auto");for(h in f)p.push(h+":"+f[h]);t.hidden&&p.push("display:none");for(h=p.length-1;0<=h;h--)""===p[h]&&p.splice(h,1);0<p.length&&(l.style=(l.style?l.style+"; ":"")+p.join("; "));for(h in l)a.push(h+'="'+CKEDITOR.tools.htmlEncode(l[h])+'" ');a.push(">",c,"</",u,">"),n.push(a.join("")),(this._||(this._={})).dialog=e,"boolean"==typeof t.isChanged&&(this.isChanged=function(){return t.isChanged}),"function"==typeof t.isChanged&&(this.isChanged=t.isChanged),"function"==typeof t.setValue&&(this.setValue=CKEDITOR.tools.override(this.setValue,function(e){return function(n){e.call(this,t.setValue.call(this,n))}})),"function"==typeof t.getValue&&(this.getValue=CKEDITOR.tools.override(this.getValue,function(e){return function(){return t.getValue.call(this,e.call(this))}})),CKEDITOR.event.implementOn(this),this.registerEvents(t),this.accessKeyUp&&this.accessKeyDown&&t.accessKey&&k(this,e,"CTRL+"+t.accessKey);var v=this;e.on("load",function(){var t=v.getInputElement();if(t){var n=v.type in{checkbox:1,ratio:1}&&CKEDITOR.env.ie&&CKEDITOR.env.version<8?"cke_dialog_ui_focused":"";t.on("focus",function(){e._.tabBarMode=!1,e._.hasFocus=!0,v.fire("focus"),n&&this.addClass(n)}),t.on("blur",function(){v.fire("blur"),n&&this.removeClass(n)})}}),CKEDITOR.tools.extend(this,t),this.keyboardFocusable&&(this.tabIndex=t.tabIndex||0,this.focusIndex=e._.focusList.push(this)-1,this.on("focus",function(){e._.currentFocusIndex=v.focusIndex}))}},hbox:function(e,t,n,r,i){if(!(4>arguments.length)){this._||(this._={});var s=this._.children=t,o=i&&i.widths||null,u=i&&i.height||null,a,f={role:"presentation"};i&&i.align&&(f.align=i.align),CKEDITOR.ui.dialog.uiElement.call(this,e,i||{type:"hbox"},r,"table",{},f,function(){var e=['<tbody><tr class="cke_dialog_ui_hbox">'];for(a=0;a<n.length;a++){var t="cke_dialog_ui_hbox_child",r=[];0===a&&(t="cke_dialog_ui_hbox_first"),a==n.length-1&&(t="cke_dialog_ui_hbox_last"),e.push('<td class="',t,'" role="presentation" '),o?o[a]&&r.push("width:"+d(o[a])):r.push("width:"+Math.floor(100/n.length)+"%"),u&&r.push("height:"+d(u)),i&&void 0!=i.padding&&r.push("padding:"+d(i.padding)),CKEDITOR.env.ie&&CKEDITOR.env.quirks&&s[a].align&&r.push("text-align:"+s[a].align),0<r.length&&e.push('style="'+r.join("; ")+'" '),e.push(">",n[a],"</td>")}return e.push("</tr></tbody>"),e.join("")})}},vbox:function(e,t,n,r,i){if(!(3>arguments.length)){this._||(this._={});var s=this._.children=t,o=i&&i.width||null,u=i&&i.heights||null;CKEDITOR.ui.dialog.uiElement.call(this,e,i||{type:"vbox"},r,"div",null,{role:"presentation"},function(){var t=['<table role="presentation" cellspacing="0" border="0" '];t.push('style="'),i&&i.expand&&t.push("height:100%;"),t.push("width:"+d(o||"100%"),";"),CKEDITOR.env.webkit&&t.push("float:none;"),t.push('"'),t.push('align="',CKEDITOR.tools.htmlEncode(i&&i.align||("ltr"==e.getParentEditor().lang.dir?"left":"right")),'" '),t.push("><tbody>");for(var r=0;r<n.length;r++){var a=[];t.push('<tr><td role="presentation" '),o&&a.push("width:"+d(o||"100%")),u?a.push("height:"+d(u[r])):i&&i.expand&&a.push("height:"+Math.floor(100/n.length)+"%"),i&&void 0!=i.padding&&a.push("padding:"+d(i.padding)),CKEDITOR.env.ie&&CKEDITOR.env.quirks&&s[r].align&&a.push("text-align:"+s[r].align),0<a.length&&t.push('style="',a.join("; "),'" '),t.push(' class="cke_dialog_ui_vbox_child">',n[r],"</td></tr>")}return t.push("</tbody></table>"),t.join("")})}}}})(),CKEDITOR.ui.dialog.uiElement.prototype={getElement:function(){return CKEDITOR.document.getById(this.domId)},getInputElement:function(){return this.getElement()},getDialog:function(){return this._.dialog},setValue:function(e,t){return this.getInputElement().setValue(e),!t&&this.fire("change",{value:e}),this},getValue:function(){return this.getInputElement().getValue()},isChanged:function(){return!1},selectParentTab:function(){for(var e=this.getInputElement();(e=e.getParent())&&-1==e.$.className.search("cke_dialog_page_contents"););return e?(e=e.getAttribute("name"),this._.dialog._.currentTabId!=e&&this._.dialog.selectPage(e),this):this},focus:function(){return this.selectParentTab().getInputElement().focus(),this},registerEvents:function(e){var t=/^on([A-Z]\w+)/,n,r=function(e,t,n,r){t.on("load",function(){e.getInputElement().on(n,r,e)})},i;for(i in e)if(n=i.match(t))this.eventProcessors[i]?this.eventProcessors[i].call(this,this._.dialog,e[i]):r(this,this._.dialog,n[1].toLowerCase(),e[i]);return this},eventProcessors:{onLoad:function(e,t){e.on("load",t,this)},onShow:function(e,t){e.on("show",t,this)},onHide:function(e,t){e.on("hide",t,this)}},accessKeyDown:function(){this.focus()},accessKeyUp:function(){},disable:function(){var e=this.getElement();this.getInputElement().setAttribute("disabled","true"),e.addClass("cke_disabled")},enable:function(){var e=this.getElement();this.getInputElement().removeAttribute("disabled"),e.removeClass("cke_disabled")},isEnabled:function(){return!this.getElement().hasClass("cke_disabled")},isVisible:function(){return this.getInputElement().isVisible()},isFocusable:function(){return!this.isEnabled()||!this.isVisible()?!1:!0}},CKEDITOR.ui.dialog.hbox.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.uiElement,{getChild:function(e){return 1>arguments.length?this._.children.concat():(e.splice||(e=[e]),2>e.length?this._.children[e[0]]:this._.children[e[0]]&&this._.children[e[0]].getChild?this._.children[e[0]].getChild(e.slice(1,e.length)):null)}},!0),CKEDITOR.ui.dialog.vbox.prototype=new CKEDITOR.ui.dialog.hbox,function(){var e={build:function(e,t,n){for(var r=t.children,i,s=[],o=[],u=0;u<r.length&&(i=r[u]);u++){var a=[];s.push(a),o.push(CKEDITOR.dialog._.uiElementBuilders[i.type].build(e,i,a))}return new CKEDITOR.ui.dialog[t.type](e,o,s,n,t)}};CKEDITOR.dialog.addUIElement("hbox",e),CKEDITOR.dialog.addUIElement("vbox",e)}(),CKEDITOR.dialogCommand=function(e,t){this.dialogName=e,CKEDITOR.tools.extend(this,t,!0)},CKEDITOR.dialogCommand.prototype={exec:function(e){e.openDialog(this.dialogName)},canUndo:!1,editorFocus:1},function(){var e=/^([a]|[^a])+$/,t=/^\d*$/,n=/^\d*(?:\.\d+)?$/,r=/^(((\d*(\.\d+))|(\d*))(px|\%)?)?$/,i=/^(((\d*(\.\d+))|(\d*))(px|em|ex|in|cm|mm|pt|pc|\%)?)?$/i,s=/^(\s*[\w-]+\s*:\s*[^:;]+(?:;|$))*$/;CKEDITOR.VALIDATE_OR=1,CKEDITOR.VALIDATE_AND=2,CKEDITOR.dialog.validate={functions:function(){var e=arguments;return function(){var t=this&&this.getValue?this.getValue():e[0],n=void 0,r=CKEDITOR.VALIDATE_AND,i=[],s;for(s=0;s<e.length;s++){if("function"!=typeof e[s])break;i.push(e[s])}s<e.length&&"string"==typeof e[s]&&(n=e[s],s++),s<e.length&&"number"==typeof e[s]&&(r=e[s]);var o=r==CKEDITOR.VALIDATE_AND?!0:!1;for(s=0;s<i.length;s++)o=r==CKEDITOR.VALIDATE_AND?o&&i[s](t):o||i[s](t);return o?!0:n}},regex:function(e,t){return function(n){return n=this&&this.getValue?this.getValue():n,e.test(n)?!0:t}},notEmpty:function(t){return this.regex(e,t)},integer:function(e){return this.regex(t,e)},number:function(e){return this.regex(n,e)},cssLength:function(e){return this.functions(function(e){return i.test(CKEDITOR.tools.trim(e))},e)},htmlLength:function(e){return this.functions(function(e){return r.test(CKEDITOR.tools.trim(e))},e)},inlineStyle:function(e){return this.functions(function(e){return s.test(CKEDITOR.tools.trim(e))},e)},equals:function(e,t){return this.functions(function(t){return t==e},t)},notEqual:function(e,t){return this.functions(function(t){return t!=e},t)}},CKEDITOR.on("instanceDestroyed",function(e){if(CKEDITOR.tools.isEmpty(CKEDITOR.instances)){for(var t;t=CKEDITOR.dialog._.currentTop;)t.hide();for(var n in S)S[n].remove();S={}}var e=e.editor._.storedDialogs,r;for(r in e)e[r].destroy()})}(),CKEDITOR.tools.extend(CKEDITOR.editor.prototype,{openDialog:function(e,t){var n=null,r=CKEDITOR.dialog._.dialogDefinitions[e];null===CKEDITOR.dialog._.currentTop&&h(this);if("function"==typeof r)n=this._.storedDialogs||(this._.storedDialogs={}),n=n[e]||(n[e]=new CKEDITOR.dialog(this,e)),t&&t.call(n,n),n.show();else{if("failed"==r)throw p(this),Error('[CKEDITOR.dialog.openDialog] Dialog "'+e+'" failed when loading definition.');"string"==typeof r&&CKEDITOR.scriptLoader.load(CKEDITOR.getUrl(r),function(){"function"!=typeof CKEDITOR.dialog._.dialogDefinitions[e]&&(CKEDITOR.dialog._.dialogDefinitions[e]="failed"),this.openDialog(e,t)},this,0,1)}return CKEDITOR.skin.loadPart("dialog"),n}})}(),CKEDITOR.plugins.add("dialog",{requires:"dialogui",init:function(e){e.on("doubleclick",function(n){n.data.dialog&&e.openDialog(n.data.dialog)},null,null,999)}}),CKEDITOR.plugins.add("about",{requires:"dialog",init:function(e){var t=e.addCommand("about",new CKEDITOR.dialogCommand("about"));t.modes={wysiwyg:1,source:1},t.canUndo=!1,t.readOnly=1,e.ui.addButton&&e.ui.addButton("About",{label:e.lang.about.title,command:"about",toolbar:"about"}),CKEDITOR.dialog.add("about",this.path+"dialogs/about.js")}}),function(){CKEDITOR.plugins.add("a11yhelp",{requires:"dialog",availableLangs:{ar:1,bg:1,ca:1,cs:1,cy:1,da:1,de:1,el:1,en:1,"en-gb":1,eo:1,es:1,et:1,fa:1,fi:1,fr:1,"fr-ca":1,gl:1,gu:1,he:1,hi:1,hr:1,hu:1,id:1,it:1,ja:1,km:1,ko:1,ku:1,lt:1,lv:1,mk:1,mn:1,nb:1,nl:1,no:1,pl:1,pt:1,"pt-br":1,ro:1,ru:1,si:1,sk:1,sl:1,sq:1,sr:1,"sr-latn":1,sv:1,th:1,tr:1,tt:1,ug:1,uk:1,vi:1,zh:1,"zh-cn":1},init:function(e){var t=this;e.addCommand("a11yHelp",{exec:function(){var n=e.langCode,n=t.availableLangs[n]?n:t.availableLangs[n.replace(/-.*/,"")]?n.replace(/-.*/,""):"en";CKEDITOR.scriptLoader.load(CKEDITOR.getUrl(t.path+"dialogs/lang/"+n+".js"),function(){e.lang.a11yhelp=t.langEntries[n],e.openDialog("a11yHelp")})},modes:{wysiwyg:1,source:1},readOnly:1,canUndo:!1}),e.setKeystroke(CKEDITOR.ALT+48,"a11yHelp"),CKEDITOR.dialog.add("a11yHelp",this.path+"dialogs/a11yhelp.js"),e.on("ariaEditorHelpLabel",function(t){t.data.label=e.lang.common.editorHelp})}})}(),function(){function e(e){var t=this.att,e=e&&e.hasAttribute(t)&&e.getAttribute(t)||"";void 0!==e&&this.setValue(e)}function t(){for(var e,t=0;t<arguments.length;t++)if(arguments[t]instanceof CKEDITOR.dom.element){e=arguments[t];break}if(e){var t=this.att,n=this.getValue();n?e.setAttribute(t,n):e.removeAttribute(t,n)}}var n={id:1,dir:1,classes:1,styles:1};CKEDITOR.plugins.add("dialogadvtab",{requires:"dialog",allowedContent:function(e){e||(e=n);var t=[];e.id&&t.push("id"),e.dir&&t.push("dir");var r="";return t.length&&(r+="["+t.join(",")+"]"),e.classes&&(r+="(*)"),e.styles&&(r+="{*}"),r},createAdvancedTab:function(r,s,o){s||(s=n);var u=r.lang.common,a={id:"advanced",label:u.advancedTab,title:u.advancedTab,elements:[{type:"vbox",padding:1,children:[]}]},l=[];if(s.id||s.dir)s.id&&l.push({id:"advId",att:"id",type:"text",requiredContent:o?o+"[id]":null,label:u.id,setup:e,commit:t}),s.dir&&l.push({id:"advLangDir",att:"dir",type:"select",requiredContent:o?o+"[dir]":null,label:u.langDir,"default":"",style:"width:100%",items:[[u.notSet,""],[u.langDirLTR,"ltr"],[u.langDirRTL,"rtl"]],setup:e,commit:t}),a.elements[0].children.push({type:"hbox",widths:["50%","50%"],children:[].concat(l)});if(s.styles||s.classes)l=[],s.styles&&l.push({id:"advStyles",att:"style",type:"text",requiredContent:o?o+"{cke-xyz}":null,label:u.styles,"default":"",validate:CKEDITOR.dialog.validate.inlineStyle(u.invalidInlineStyle),onChange:function(){},getStyle:function(e,t){var n=this.getValue().match(RegExp("(?:^|;)\\s*"+e+"\\s*:\\s*([^;]*)","i"));return n?n[1]:t},updateStyle:function(e,t){var n=this.getValue(),i=r.document.createElement("span");i.setAttribute("style",n),i.setStyle(e,t),n=CKEDITOR.tools.normalizeCssText(i.getAttribute("style")),this.setValue(n,1)},setup:e,commit:t}),s.classes&&l.push({type:"hbox",widths:["45%","55%"],children:[{id:"advCSSClasses",att:"class",type:"text",requiredContent:o?o+"(cke-xyz)":null,label:u.cssClasses,"default":"",setup:e,commit:t}]}),a.elements[0].children.push({type:"hbox",widths:["50%","50%"],children:[].concat(l)});return a}})}(),CKEDITOR.plugins.add("basicstyles",{init:function(e){var t=0,n=function(n,i,s,o){if(o){var o=new CKEDITOR.style(o),u=r[s];u.unshift(o),e.attachStyleStateChange(o,function(t){!e.readOnly&&e.getCommand(s).setState(t)}),e.addCommand(s,new CKEDITOR.styleCommand(o,{contentForms:u})),e.ui.addButton&&e.ui.addButton(n,{label:i,command:s,toolbar:"basicstyles,"+(t+=10)})}},r={bold:["strong","b",["span",function(e){return e=e.styles["font-weight"],"bold"==e||700<=+e}]],italic:["em","i",["span",function(e){return"italic"==e.styles["font-style"]}]],underline:["u",["span",function(e){return"underline"==e.styles["text-decoration"]}]],strike:["s","strike",["span",function(e){return"line-through"==e.styles["text-decoration"]}]],subscript:["sub"],superscript:["sup"]},i=e.config,s=e.lang.basicstyles;n("Bold",s.bold,"bold",i.coreStyles_bold),n("Italic",s.italic,"italic",i.coreStyles_italic),n("Underline",s.underline,"underline",i.coreStyles_underline),n("Strike",s.strike,"strike",i.coreStyles_strike),n("Subscript",s.subscript,"subscript",i.coreStyles_subscript),n("Superscript",s.superscript,"superscript",i.coreStyles_superscript),e.setKeystroke([[CKEDITOR.CTRL+66,"bold"],[CKEDITOR.CTRL+73,"italic"],[CKEDITOR.CTRL+85,"underline"]])}}),CKEDITOR.config.coreStyles_bold={element:"strong",overrides:"b"},CKEDITOR.config.coreStyles_italic={element:"em",overrides:"i"},CKEDITOR.config.coreStyles_underline={element:"u"},CKEDITOR.config.coreStyles_strike={element:"s",overrides:"strike"},CKEDITOR.config.coreStyles_subscript={element:"sub"},CKEDITOR.config.coreStyles_superscript={element:"sup"},function(){function e(e,t,n,r){if(!e.isReadOnly()&&!e.equals(n.editable())){CKEDITOR.dom.element.setMarker(r,e,"bidi_processed",1);for(var r=e,i=n.editable();(r=r.getParent())&&!r.equals(i);)if(r.getCustomData("bidi_processed")){e.removeStyle("direction"),e.removeAttribute("dir");return}r="useComputedState"in n.config?n.config.useComputedState:1,(r?e.getComputedStyle("direction"):e.getStyle("direction")||e.hasAttribute("dir"))!=t&&(e.removeStyle("direction"),r?(e.removeAttribute("dir"),t!=e.getComputedStyle("direction")&&e.setAttribute("dir",t)):e.setAttribute("dir",t),n.forceNextSelectionCheck())}}function t(e,t,n){var r=e.getCommonAncestor(!1,!0),e=e.clone();e.enlarge(n==CKEDITOR.ENTER_BR?CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS:CKEDITOR.ENLARGE_BLOCK_CONTENTS);if(e.checkBoundaryOfElement(r,CKEDITOR.START)&&e.checkBoundaryOfElement(r,CKEDITOR.END)){for(var i;r&&r.type==CKEDITOR.NODE_ELEMENT&&(i=r.getParent())&&1==i.getChildCount()&&!(r.getName()in t);)r=i;return r.type==CKEDITOR.NODE_ELEMENT&&r.getName()in t&&r}}function n(n){return{context:"p",allowedContent:{"h1 h2 h3 h4 h5 h6 table ul ol blockquote div tr p div li td":{propertiesOnly:!0,attributes:"dir"}},requiredContent:"p[dir]",refresh:function(e,t){var n=e.config.useComputedState,r,n=void 0===n||n;if(!n){r=t.lastElement;for(var i=e.editable();r&&!(r.getName()in o||r.equals(i));){var s=r.getParent();if(!s)break;r=s}}r=r||t.block||t.blockLimit,r.equals(e.editable())&&(i=e.getSelection().getRanges()[0].getEnclosedNode())&&i.type==CKEDITOR.NODE_ELEMENT&&(r=i),r&&(n=n?r.getComputedStyle("direction"):r.getStyle("direction")||r.getAttribute("dir"),e.getCommand("bidirtl").setState("rtl"==n?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF),e.getCommand("bidiltr").setState("ltr"==n?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF)),n=(t.block||t.blockLimit||e.editable()).getDirection(1),n!=(e._.selDir||e.lang.dir)&&(e._.selDir=n,e.fire("contentDirChanged",n))},exec:function(r){var o=r.getSelection(),u=r.config.enterMode,a=o.getRanges();if(a&&a.length){for(var f={},l=o.createBookmarks(),a=a.createIterator(),c,h=0;c=a.getNextRange(1);){var d=c.getEnclosedNode();if(!d||d&&!(d.type==CKEDITOR.NODE_ELEMENT&&d.getName()in s))d=t(c,i,u);d&&e(d,n,r,f);var v=new CKEDITOR.dom.walker(c),m=l[h].startNode,g=l[h++].endNode;v.evaluator=function(e){return!!(e.type==CKEDITOR.NODE_ELEMENT&&e.getName()in i&&(e.getName()!=(u==CKEDITOR.ENTER_P?"p":"div")||e.getParent().type!=CKEDITOR.NODE_ELEMENT||"blockquote"!=e.getParent().getName())&&e.getPosition(m)&CKEDITOR.POSITION_FOLLOWING&&(e.getPosition(g)&CKEDITOR.POSITION_PRECEDING+CKEDITOR.POSITION_CONTAINS)==CKEDITOR.POSITION_PRECEDING)};for(;d=v.next();)e(d,n,r,f);c=c.createIterator();for(c.enlargeBr=u!=CKEDITOR.ENTER_BR;d=c.getNextParagraph(u==CKEDITOR.ENTER_P?"p":"div");)e(d,n,r,f)}CKEDITOR.dom.element.clearAllMarkers(f),r.forceNextSelectionCheck(),o.selectBookmarks(l),r.focus()}}}}function r(e){var t=e==u.setAttribute,n=e==u.removeAttribute,r=/\bdirection\s*:\s*(.*?)\s*(:?$|;)/;return function(i,s){if(!this.isReadOnly()){var o;if(o=i==(t||n?"dir":"direction")||"style"==i&&(n||r.test(s))){e:{o=this;for(var u=o.getDocument().getBody().getParent();o;){if(o.equals(u)){o=!1;break e}o=o.getParent()}o=!0}o=!o}if(o&&(o=this.getDirection(1),u=e.apply(this,arguments),o!=this.getDirection(1)))return this.getDocument().fire("dirChanged",this),u}return e.apply(this,arguments)}}var i={table:1,ul:1,ol:1,blockquote:1,div:1},s={},o={};CKEDITOR.tools.extend(s,i,{tr:1,p:1,div:1,li:1}),CKEDITOR.tools.extend(o,s,{td:1}),CKEDITOR.plugins.add("bidi",{init:function(e){function t(t,n,r,i,s){e.addCommand(r,new CKEDITOR.command(e,i)),e.ui.addButton&&e.ui.addButton(t,{label:n,command:r,toolbar:"bidi,"+s})}if(!e.blockless){var r=e.lang.bidi;t("BidiLtr",r.ltr,"bidiltr",n("ltr"),10),t("BidiRtl",r.rtl,"bidirtl",n("rtl"),20),e.on("contentDom",function(){e.document.on("dirChanged",function(t){e.fire("dirChanged",{node:t.data,dir:t.data.getDirection(1)})})}),e.on("contentDirChanged",function(t){var t=(e.lang.dir!=t.data?"add":"remove")+"Class",n=e.ui.space(e.config.toolbarLocation);n&&n[t]("cke_mixed_dir_content")})}}});for(var u=CKEDITOR.dom.element.prototype,a=["setStyle","removeStyle","setAttribute","removeAttribute"],f=0;f<a.length;f++)u[a[f]]=CKEDITOR.tools.override(u[a[f]],r)}(),function(){var e={exec:function(e){var t=e.getCommand("blockquote").state,n=e.getSelection(),r=n&&n.getRanges()[0];if(r){var i=n.createBookmarks();if(CKEDITOR.env.ie){var s=i[0].startNode,o=i[0].endNode,u;if(s&&"blockquote"==s.getParent().getName())for(u=s;u=u.getNext();)if(u.type==CKEDITOR.NODE_ELEMENT&&u.isBlockBoundary()){s.move(u,!0);break}if(o&&"blockquote"==o.getParent().getName())for(u=o;u=u.getPrevious();)if(u.type==CKEDITOR.NODE_ELEMENT&&u.isBlockBoundary()){o.move(u);break}}var a=r.createIterator();a.enlargeBr=e.config.enterMode!=CKEDITOR.ENTER_BR;if(t==CKEDITOR.TRISTATE_OFF){for(s=[];t=a.getNextParagraph();)s.push(t);1>s.length&&(t=e.document.createElement(e.config.enterMode==CKEDITOR.ENTER_P?"p":"div"),o=i.shift(),r.insertNode(t),t.append(new CKEDITOR.dom.text("﻿",e.document)),r.moveToBookmark(o),r.selectNodeContents(t),r.collapse(!0),o=r.createBookmark(),s.push(t),i.unshift(o)),u=s[0].getParent(),r=[];for(o=0;o<s.length;o++)t=s[o],u=u.getCommonAncestor(t.getParent());for(t={table:1,tbody:1,tr:1,ol:1,ul:1};t[u.getName()];)u=u.getParent();for(o=null;0<s.length;){for(t=s.shift();!t.getParent().equals(u);)t=t.getParent();t.equals(o)||r.push(t),o=t}for(;0<r.length;)if(t=r.shift(),"blockquote"==t.getName()){for(o=new CKEDITOR.dom.documentFragment(e.document);t.getFirst();)o.append(t.getFirst().remove()),s.push(o.getLast());o.replace(t)}else s.push(t);r=e.document.createElement("blockquote");for(r.insertBefore(s[0]);0<s.length;)t=s.shift(),r.append(t)}else if(t==CKEDITOR.TRISTATE_ON){o=[];for(u={};t=a.getNextParagraph();){for(s=r=null;t.getParent();){if("blockquote"==t.getParent().getName()){r=t.getParent(),s=t;break}t=t.getParent()}r&&s&&!s.getCustomData("blockquote_moveout")&&(o.push(s),CKEDITOR.dom.element.setMarker(u,s,"blockquote_moveout",!0))}CKEDITOR.dom.element.clearAllMarkers(u),t=[],s=[];for(u={};0<o.length;)a=o.shift(),r=a.getParent(),a.getPrevious()?a.getNext()?(a.breakParent(a.getParent()),s.push(a.getNext())):a.remove().insertAfter(r):a.remove().insertBefore(r),r.getCustomData("blockquote_processed")||(s.push(r),CKEDITOR.dom.element.setMarker(u,r,"blockquote_processed",!0)),t.push(a);CKEDITOR.dom.element.clearAllMarkers(u);for(o=s.length-1;0<=o;o--){r=s[o];e:{u=r;for(var a=0,f=u.getChildCount(),l=void 0;a<f&&(l=u.getChild(a));a++)if(l.type==CKEDITOR.NODE_ELEMENT&&l.isBlockBoundary()){u=!1;break e}u=!0}u&&r.remove()}if(e.config.enterMode==CKEDITOR.ENTER_BR)for(r=!0;t.length;)if(a=t.shift(),"div"==a.getName()){o=new CKEDITOR.dom.documentFragment(e.document),r&&a.getPrevious()&&(a.getPrevious().type!=CKEDITOR.NODE_ELEMENT||!a.getPrevious().isBlockBoundary())&&o.append(e.document.createElement("br"));for(r=a.getNext()&&(a.getNext().type!=CKEDITOR.NODE_ELEMENT||!a.getNext().isBlockBoundary());a.getFirst();)a.getFirst().remove().appendTo(o);r&&o.append(e.document.createElement("br")),o.replace(a),r=!1}}n.selectBookmarks(i),e.focus()}},refresh:function(e,t){this.setState(e.elementPath(t.block||t.blockLimit).contains("blockquote",1)?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF)},context:"blockquote",allowedContent:"blockquote",requiredContent:"blockquote"};CKEDITOR.plugins.add("blockquote",{init:function(t){t.blockless||(t.addCommand("blockquote",e),t.ui.addButton&&t.ui.addButton("Blockquote",{label:t.lang.blockquote.toolbar,command:"blockquote",toolbar:"blocks,10"}))}})}(),function(){function e(e){function t(){var t=e.editable();t.on(y,function(e){(!CKEDITOR.env.ie||!v)&&h(e)}),CKEDITOR.env.ie&&t.on("paste",function(t){m||(i(),t.data.preventDefault(),h(t),o("paste")||e.openDialog("paste"))}),CKEDITOR.env.ie&&(t.on("contextmenu",s,null,null,0),t.on("beforepaste",function(e){e.data&&!e.data.$.ctrlKey&&!e.data.$.shiftKey&&s()},null,null,0)),t.on("beforecut",function(){!v&&a(e)});var n;t.attachListener(CKEDITOR.env.ie?t:e.document.getDocumentElement(),"mouseup",function(){n=setTimeout(function(){p()},0)}),e.on("destroy",function(){clearTimeout(n)}),t.on("keyup",p)}function n(t){return{type:t,canUndo:"cut"==t,startDisabled:!0,exec:function(){"cut"==this.type&&a();var t,n=this.type;if(CKEDITOR.env.ie)t=o(n);else try{t=e.document.$.execCommand(n,!1,null)}catch(r){t=!1}return t||alert(e.lang.clipboard[this.type+"Error"]),t}}}function r(){return{canUndo:!1,async:!0,exec:function(e,t){var n=function(t,n){t&&u(t.type,t.dataValue,!!n),e.fire("afterCommandExec",{name:"paste",command:r,returnValue:!!t})},r=this;"string"==typeof t?n({type:"auto",dataValue:t},1):e.getClipboardData(n)}}}function i(){m=1,setTimeout(function(){m=0},100)}function s(){v=1,setTimeout(function(){v=0},10)}function o(t){var n=e.document,r=n.getBody(),i=!1,s=function(){i=!0};return r.on(t,s),(7<CKEDITOR.env.version?n.$:n.$.selection.createRange()).execCommand(t),r.removeListener(t,s),i}function u(t,n,r){return t={type:t},r&&!1===e.fire("beforePaste",t)||!n?!1:(t.dataValue=n,e.fire("paste",t))}function a(){if(CKEDITOR.env.ie&&!CKEDITOR.env.quirks){var t=e.getSelection(),n,r,i;t.getType()==CKEDITOR.SELECTION_ELEMENT&&(n=t.getSelectedElement())&&(r=t.getRanges()[0],i=e.document.createText(""),i.insertBefore(n),r.setStartBefore(i),r.setEndAfter(n),t.selectRanges([r]),setTimeout(function(){n.getParent()&&(i.remove(),t.selectElement(n))},0))}}function f(t,n){var r=e.document,i=e.editable(),s=function(e){e.cancel()},o;if(!r.getById("cke_pastebin")){var u=e.getSelection(),a=u.createBookmarks();CKEDITOR.env.ie&&u.root.fire("selectionchange");var f=new CKEDITOR.dom.element((CKEDITOR.env.webkit||i.is("body"))&&!CKEDITOR.env.ie?"body":"div",r);f.setAttributes({id:"cke_pastebin","data-cke-temp":"1"});var l=0,r=r.getWindow();CKEDITOR.env.webkit?(i.append(f),f.addClass("cke_editable"),i.is("body")||(l="static"!=i.getComputedStyle("position")?i:CKEDITOR.dom.element.get(i.$.offsetParent),l=l.getDocumentPosition().y)):i.getAscendant(CKEDITOR.env.ie?"body":"html",1).append(f),f.setStyles({position:"absolute",top:r.getScrollPosition().y-l+10+"px",width:"1px",height:Math.max(1,r.getViewPaneSize().height-20)+"px",overflow:"hidden",margin:0,padding:0}),(l=f.getParent().isReadOnly())?(f.setOpacity(0),f.setAttribute("contenteditable",!0)):f.setStyle("ltr"==e.config.contentsLangDirection?"left":"right","-1000px"),e.on("selectionChange",s,null,null,0);if(CKEDITOR.env.webkit||CKEDITOR.env.gecko)o=i.once("blur",s,null,null,-100);l&&f.focus(),l=new CKEDITOR.dom.range(f),l.selectNodeContents(f);var c=l.select();CKEDITOR.env.ie&&(o=i.once("blur",function(){e.lockSelection(c)}));var h=CKEDITOR.document.getWindow().getScrollPosition().y;setTimeout(function(){CKEDITOR.env.webkit&&(CKEDITOR.document.getBody().$.scrollTop=h),o&&o.removeListener(),CKEDITOR.env.ie&&i.focus(),u.selectBookmarks(a),f.remove();var t;CKEDITOR.env.webkit&&(t=f.getFirst())&&t.is&&t.hasClass("Apple-style-span")&&(f=t),e.removeListener("selectionChange",s),n(f.getHtml())},0)}}function l(){if(CKEDITOR.env.ie){e.focus(),i();var t=e.focusManager;t.lock();if(e.editable().fire(y)&&!o("paste"))return t.unlock(),!1;t.unlock()}else try{if(e.editable().fire(y)&&!e.document.$.execCommand("Paste",!1,null))throw 0}catch(n){return!1}return!0}function c(t){if("wysiwyg"==e.mode)switch(t.data.keyCode){case CKEDITOR.CTRL+86:case CKEDITOR.SHIFT+45:t=e.editable(),i(),!CKEDITOR.env.ie&&t.fire("beforepaste");break;case CKEDITOR.CTRL+88:case CKEDITOR.SHIFT+46:e.fire("saveSnapshot"),setTimeout(function(){e.fire("saveSnapshot")},50)}}function h(t){var n={type:"auto"},r=e.fire("beforePaste",n);f(t,function(e){e=e.replace(/<span[^>]+data-cke-bookmark[^<]*?<\/span>/ig,""),r&&u(n.type,e,0,1)})}function p(){if("wysiwyg"==e.mode){var t=d("paste");e.getCommand("cut").setState(d("cut")),e.getCommand("copy").setState(d("copy")),e.getCommand("paste").setState(t),e.fire("pasteState",t)}}function d(t){if(g&&t in{paste:1,cut:1})return CKEDITOR.TRISTATE_DISABLED;if("paste"==t)return CKEDITOR.TRISTATE_OFF;var t=e.getSelection(),n=t.getRanges();return t.getType()==CKEDITOR.SELECTION_NONE||1==n.length&&n[0].collapsed?CKEDITOR.TRISTATE_DISABLED:CKEDITOR.TRISTATE_OFF}var v=0,m=0,g=0,y=CKEDITOR.env.ie?"beforepaste":"paste";(function(){e.on("key",c),e.on("contentDom",t),e.on("selectionChange",function(e){g=e.data.selection.getRanges()[0].checkReadOnly(),p()}),e.contextMenu&&e.contextMenu.addListener(function(e,t){return g=t.getRanges()[0].checkReadOnly(),{cut:d("cut"),copy:d("copy"),paste:d("paste")}})})(),function(){function t(t,n,r,i,s){var o=e.lang.clipboard[n];e.addCommand(n,r),e.ui.addButton&&e.ui.addButton(t,{label:o,command:n,toolbar:"clipboard,"+i}),e.addMenuItems&&e.addMenuItem(n,{label:o,command:n,group:"clipboard",order:s})}t("Cut","cut",n("cut"),10,1),t("Copy","copy",n("copy"),20,4),t("Paste","paste",r(),30,8)}(),e.getClipboardData=function(t,n){function r(e){e.removeListener(),e.cancel(),n(e.data)}function i(e){e.removeListener(),e.cancel(),a=!0,n({type:u,dataValue:e.data})}function s(){this.customTitle=t&&t.title}var o=!1,u="auto",a=!1;n||(n=t,t=null),e.on("paste",r,null,null,0),e.on("beforePaste",function(e){e.removeListener(),o=!0,u=e.data.type},null,null,1e3),!1===l()&&(e.removeListener("paste",r),o&&e.fire("pasteDialog",s)?(e.on("pasteDialogCommit",i),e.on("dialogHide",function(e){e.removeListener(),e.data.removeListener("pasteDialogCommit",i),setTimeout(function(){a||n(null)},10)})):n(null))}}function t(e){if(CKEDITOR.env.webkit){if(!e.match(/^[^<]*$/g)&&!e.match(/^(<div><br( ?\/)?><\/div>|<div>[^<]*<\/div>)*$/gi))return"html"}else if(CKEDITOR.env.ie){if(!e.match(/^([^<]|<br( ?\/)?>)*$/gi)&&!e.match(/^(<p>([^<]|<br( ?\/)?>)*<\/p>|(\r\n))*$/gi))return"html"}else{if(!CKEDITOR.env.gecko)return"html";if(!e.match(/^([^<]|<br( ?\/)?>)*$/gi))return"html"}return"htmlifiedtext"}function n(e,t){function n(e){return CKEDITOR.tools.repeat("</p><p>",~~(e/2))+(1==e%2?"<br>":"")}return t=t.replace(/\s+/g," ").replace(/> +</g,"><").replace(/<br ?\/>/gi,"<br>"),t=t.replace(/<\/?[A-Z]+>/g,function(e){return e.toLowerCase()}),t.match(/^[^<]$/)?t:(CKEDITOR.env.webkit&&-1<t.indexOf("<div>")&&(t=t.replace(/^(<div>(<br>|)<\/div>)(?!$|(<div>(<br>|)<\/div>))/g,"<br>").replace(/^(<div>(<br>|)<\/div>){2}(?!$)/g,"<div></div>"),t.match(/<div>(<br>|)<\/div>/)&&(t="<p>"+t.replace(/(<div>(<br>|)<\/div>)+/g,function(e){return n(e.split("</div><div>").length+1)})+"</p>"),t=t.replace(/<\/div><div>/g,"<br>"),t=t.replace(/<\/?div>/g,"")),CKEDITOR.env.gecko&&e.enterMode!=CKEDITOR.ENTER_BR&&(CKEDITOR.env.gecko&&(t=t.replace(/^<br><br>$/,"<br>")),-1<t.indexOf("<br><br>")&&(t="<p>"+t.replace(/(<br>){2,}/g,function(e){return n(e.length/4)})+"</p>")),s(e,t))}function r(){var e=new CKEDITOR.htmlParser.filter,t={blockquote:1,dl:1,fieldset:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,ol:1,p:1,table:1,ul:1},n=CKEDITOR.tools.extend({br:0},CKEDITOR.dtd.$inline),r={p:1,br:1,"cke:br":1},i=CKEDITOR.dtd,s=CKEDITOR.tools.extend({area:1,basefont:1,embed:1,iframe:1,map:1,object:1,param:1},CKEDITOR.dtd.$nonBodyContent,CKEDITOR.dtd.$cdata),o=function(e){delete e.name,e.add(new CKEDITOR.htmlParser.text(" "))},u=function(e){for(var t=e,n;(t=t.next)&&t.name&&t.name.match(/^h\d$/);){n=new CKEDITOR.htmlParser.element("cke:br"),n.isEmpty=!0;for(e.add(n);n=t.children.shift();)e.add(n)}};return e.addRules({elements:{h1:u,h2:u,h3:u,h4:u,h5:u,h6:u,img:function(e){var e=CKEDITOR.tools.trim(e.attributes.alt||""),t=" ";return e&&!e.match(/(^http|\.(jpe?g|gif|png))/i)&&(t=" ["+e+"] "),new CKEDITOR.htmlParser.text(t)},td:o,th:o,$:function(e){var o=e.name,u;if(s[o])return!1;e.attributes={};if("br"==o)return e;if(t[o])e.name="p";else if(n[o])delete e.name;else if(i[o]){u=new CKEDITOR.htmlParser.element("cke:br"),u.isEmpty=!0;if(CKEDITOR.dtd.$empty[o])return u;e.add(u,0),u=u.clone(),u.isEmpty=!0,e.add(u),delete e.name}return r[e.name]||delete e.name,e}}},{applyToAll:!0}),e}function i(e,t,n){var t=new CKEDITOR.htmlParser.fragment.fromHtml(t),r=new CKEDITOR.htmlParser.basicWriter;t.writeHtml(r,n);var t=r.getHtml(),t=t.replace(/\s*(<\/?[a-z:]+ ?\/?>)\s*/g,"$1").replace(/(<cke:br \/>){2,}/g,"<cke:br />").replace(/(<cke:br \/>)(<\/?p>|<br \/>)/g,"$2").replace(/(<\/?p>|<br \/>)(<cke:br \/>)/g,"$1").replace(/<(cke:)?br( \/)?>/g,"<br>").replace(/<p><\/p>/g,""),i=0,t=t.replace(/<\/?p>/g,function(e){if("<p>"==e){if(1<++i)return"</p><p>"}else if(0<--i)return"</p><p>";return e}).replace(/<p><\/p>/g,"");return s(e,t)}function s(e,t){return e.enterMode==CKEDITOR.ENTER_BR?t=t.replace(/(<\/p><p>)+/g,function(e){return CKEDITOR.tools.repeat("<br>",2*(e.length/7))}).replace(/<\/?p>/g,""):e.enterMode==CKEDITOR.ENTER_DIV&&(t=t.replace(/<(\/)?p>/g,"<$1div>")),t}CKEDITOR.plugins.add("clipboard",{requires:"dialog",init:function(s){var o;e(s),CKEDITOR.dialog.add("paste",CKEDITOR.getUrl(this.path+"dialogs/paste.js")),s.on("paste",function(e){var t=e.data.dataValue,n=CKEDITOR.dtd.$block;-1<t.indexOf("Apple-")&&(t=t.replace(/<span class="Apple-converted-space">&nbsp;<\/span>/gi," "),"html"!=e.data.type&&(t=t.replace(/<span class="Apple-tab-span"[^>]*>([^<]*)<\/span>/gi,function(e,t){return t.replace(/\t/g,"&nbsp;&nbsp; &nbsp;")})),-1<t.indexOf('<br class="Apple-interchange-newline">')&&(e.data.startsWithEOL=1,e.data.preSniffing="html",t=t.replace(/<br class="Apple-interchange-newline">/,"")),t=t.replace(/(<[^>]+) class="Apple-[^"]*"/gi,"$1"));if(t.match(/^<[^<]+cke_(editable|contents)/i)){var r,i,s=new CKEDITOR.dom.element("div");for(s.setHtml(t);1==s.getChildCount()&&(r=s.getFirst())&&r.type==CKEDITOR.NODE_ELEMENT&&(r.hasClass("cke_editable")||r.hasClass("cke_contents"));)s=i=r;i&&(t=i.getHtml().replace(/<br>$/i,""))}CKEDITOR.env.ie?t=t.replace(/^&nbsp;(?: |\r\n)?<(\w+)/g,function(t,r){return r.toLowerCase()in n?(e.data.preSniffing="html","<"+r):t}):CKEDITOR.env.webkit?t=t.replace(/<\/(\w+)><div><br><\/div>$/,function(t,r){return r in n?(e.data.endsWithEOL=1,"</"+r+">"):t}):CKEDITOR.env.gecko&&(t=t.replace(/(\s)<br>$/,"$1")),e.data.dataValue=t},null,null,3),s.on("paste",function(e){var e=e.data,u=e.type,f=e.dataValue,l,c=s.config.clipboard_defaultContentType||"html";l="html"==u||"html"==e.preSniffing?"html":t(f),"htmlifiedtext"==l?f=n(s.config,f):"text"==u&&"html"==l&&(f=i(s.config,f,o||(o=r(s)))),e.startsWithEOL&&(f='<br data-cke-eol="1">'+f),e.endsWithEOL&&(f+='<br data-cke-eol="1">'),"auto"==u&&(u="html"==l||"html"==c?"html":"text"),e.type=u,e.dataValue=f,delete e.preSniffing,delete e.startsWithEOL,delete e.endsWithEOL},null,null,6),s.on("paste",function(e){e=e.data,s.insertHtml(e.dataValue,e.type),setTimeout(function(){s.fire("afterPaste")},0)},null,null,1e3),s.on("pasteDialog",function(e){setTimeout(function(){s.openDialog("paste",e.data)},0)})}})}(),function(){var e='<a id="{id}" class="cke_button cke_button__{name} cke_button_{state} {cls}"'+(CKEDITOR.env.gecko&&!CKEDITOR.env.hc?"":" href=\"javascript:void('{titleJs}')\"")+' title="{title}" tabindex="-1" hidefocus="true" role="button" aria-labelledby="{id}_label" aria-haspopup="{hasArrow}" aria-disabled="{ariaDisabled}"';CKEDITOR.env.gecko&&CKEDITOR.env.mac&&(e+=' onkeypress="return false;"'),CKEDITOR.env.gecko&&(e+=' onblur="this.style.cssText = this.style.cssText;"');var e=e+(' onkeydown="return CKEDITOR.tools.callFunction({keydownFn},event);" onfocus="return CKEDITOR.tools.callFunction({focusFn},event);" '+(CKEDITOR.env.ie?'onclick="return false;" onmouseup':"onclick")+'="CKEDITOR.tools.callFunction({clickFn},this);return false;"><span class="cke_button_icon cke_button__{iconName}_icon" style="{style}"'),e=e+'>&nbsp;</span><span id="{id}_label" class="cke_button_label cke_button__{name}_label" aria-hidden="false">{label}</span>{arrowHtml}</a>',t=CKEDITOR.addTemplate("buttonArrow",'<span class="cke_button_arrow">'+(CKEDITOR.env.hc?"&#9660;":"")+"</span>"),n=CKEDITOR.addTemplate("button",e);CKEDITOR.plugins.add("button",{beforeInit:function(e){e.ui.addHandler(CKEDITOR.UI_BUTTON,CKEDITOR.ui.button.handler)}}),CKEDITOR.UI_BUTTON="button",CKEDITOR.ui.button=function(e){CKEDITOR.tools.extend(this,e,{title:e.label,click:e.click||function(t){t.execCommand(e.command)}}),this._={}},CKEDITOR.ui.button.handler={create:function(e){return new CKEDITOR.ui.button(e)}},CKEDITOR.ui.button.prototype={render:function(e,r){var i=CKEDITOR.env,s=this._.id=CKEDITOR.tools.getNextId(),o="",u=this.command,a;this._.editor=e;var f={id:s,button:this,editor:e,focus:function(){CKEDITOR.document.getById(s).focus()},execute:function(){this.button.click(e)},attach:function(e){this.button.attach(e)}},l=CKEDITOR.tools.addFunction(function(e){if(f.onkey)return e=new CKEDITOR.dom.event(e),!1!==f.onkey(f,e.getKeystroke())}),c=CKEDITOR.tools.addFunction(function(e){var t;return f.onfocus&&(t=!1!==f.onfocus(f,new CKEDITOR.dom.event(e))),t}),h=0;f.clickFn=a=CKEDITOR.tools.addFunction(function(){h&&(e.unlockSelection(1),h=0),f.execute()});if(this.modes){var p={},d=function(){var t=e.mode;t&&(t=this.modes[t]?void 0!=p[t]?p[t]:CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,t=e.readOnly&&!this.readOnly?CKEDITOR.TRISTATE_DISABLED:t,this.setState(t),this.refresh&&this.refresh())};e.on("beforeModeUnload",function(){e.mode&&this._.state!=CKEDITOR.TRISTATE_DISABLED&&(p[e.mode]=this._.state)},this),e.on("activeFilterChange",d,this),e.on("mode",d,this),!this.readOnly&&e.on("readOnly",d,this)}else u&&(u=e.getCommand(u))&&(u.on("state",function(){this.setState(u.state)},this),o+=u.state==CKEDITOR.TRISTATE_ON?"on":u.state==CKEDITOR.TRISTATE_DISABLED?"disabled":"off");this.directional&&e.on("contentDirChanged",function(t){var n=CKEDITOR.document.getById(this._.id),r=n.getFirst(),t=t.data;t!=e.lang.dir?n.addClass("cke_"+t):n.removeClass("cke_ltr").removeClass("cke_rtl"),r.setAttribute("style",CKEDITOR.skin.getIconStyle(v,"rtl"==t,this.icon,this.iconOffset))},this),u||(o+="off");var v=d=this.name||this.command;return this.icon&&!/\./.test(this.icon)&&(v=this.icon,this.icon=null),i={id:s,name:d,iconName:v,label:this.label,cls:this.className||"",state:o,ariaDisabled:"disabled"==o?"true":"false",title:this.title,titleJs:i.gecko&&!i.hc?"":(this.title||"").replace("'",""),hasArrow:this.hasArrow?"true":"false",keydownFn:l,focusFn:c,clickFn:a,style:CKEDITOR.skin.getIconStyle(v,"rtl"==e.lang.dir,this.icon,this.iconOffset),arrowHtml:this.hasArrow?t.output():""},n.output(i,r),this.onRender&&this.onRender(),f},setState:function(e){if(this._.state==e)return!1;this._.state=e;var t=CKEDITOR.document.getById(this._.id);return t?(t.setState(e,"cke_button"),e==CKEDITOR.TRISTATE_DISABLED?t.setAttribute("aria-disabled",!0):t.removeAttribute("aria-disabled"),this.hasArrow?(e=e==CKEDITOR.TRISTATE_ON?this._.editor.lang.button.selectedLabel.replace(/%1/g,this.label):this.label,CKEDITOR.document.getById(this._.id+"_label").setText(e)):e==CKEDITOR.TRISTATE_ON?t.setAttribute("aria-pressed",!0):t.removeAttribute("aria-pressed"),!0):!1},getState:function(){return this._.state},toFeature:function(e){if(this._.feature)return this._.feature;var t=this;return!this.allowedContent&&!this.requiredContent&&this.command&&(t=e.getCommand(this.command)||t),this._.feature=t}},CKEDITOR.ui.prototype.addButton=function(e,t){this.add(e,CKEDITOR.UI_BUTTON,t)}}(),CKEDITOR.plugins.add("panelbutton",{requires:"button",onLoad:function(){function e(e){var t=this._;t.state!=CKEDITOR.TRISTATE_DISABLED&&(this.createPanel(e),t.on?t.panel.hide():t.panel.showBlock(this._.id,this.document.getById(this._.id),4))}CKEDITOR.ui.panelButton=CKEDITOR.tools.createClass({base:CKEDITOR.ui.button,$:function(t){var n=t.panel||{};delete t.panel,this.base(t),this.document=n.parent&&n.parent.getDocument()||CKEDITOR.document,n.block={attributes:n.attributes},this.hasArrow=n.toolbarRelated=!0,this.click=e,this._={panelDefinition:n}},statics:{handler:{create:function(e){return new CKEDITOR.ui.panelButton(e)}}},proto:{createPanel:function(e){var t=this._;if(!t.panel){var n=this._.panelDefinition,r=this._.panelDefinition.block,i=n.parent||CKEDITOR.document.getBody(),s=this._.panel=new CKEDITOR.ui.floatPanel(e,i,n),n=s.addBlock(t.id,r),o=this;s.onShow=function(){o.className&&this.element.addClass(o.className+"_panel"),o.setState(CKEDITOR.TRISTATE_ON),t.on=1,o.editorFocus&&e.focus(),o.onOpen&&o.onOpen()},s.onHide=function(n){o.className&&this.element.getFirst().removeClass(o.className+"_panel"),o.setState(o.modes&&o.modes[e.mode]?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED),t.on=0,!n&&o.onClose&&o.onClose()},s.onEscape=function(){s.hide(1),o.document.getById(t.id).focus()},this.onBlock&&this.onBlock(s,n),n.onHide=function(){t.on=0,o.setState(CKEDITOR.TRISTATE_OFF)}}}}})},beforeInit:function(e){e.ui.addHandler(CKEDITOR.UI_PANELBUTTON,CKEDITOR.ui.panelButton.handler)}}),CKEDITOR.UI_PANELBUTTON="panelbutton",function(){CKEDITOR.plugins.add("panel",{beforeInit:function(e){e.ui.addHandler(CKEDITOR.UI_PANEL,CKEDITOR.ui.panel.handler)}}),CKEDITOR.UI_PANEL="panel",CKEDITOR.ui.panel=function(e,t){t&&CKEDITOR.tools.extend(this,t),CKEDITOR.tools.extend(this,{className:"",css:[]}),this.id=CKEDITOR.tools.getNextId(),this.document=e,this.isFramed=this.forceIFrame||this.css.length,this._={blocks:{}}},CKEDITOR.ui.panel.handler={create:function(e){return new CKEDITOR.ui.panel(e)}};var e=CKEDITOR.addTemplate("panel",'<div lang="{langCode}" id="{id}" dir={dir} class="cke cke_reset_all {editorId} cke_panel cke_panel {cls} cke_{dir}" style="z-index:{z-index}" role="presentation">{frame}</div>'),t=CKEDITOR.addTemplate("panel-frame",'<iframe id="{id}" class="cke_panel_frame" role="presentation" frameborder="0" src="{src}"></iframe>'),n=CKEDITOR.addTemplate("panel-frame-inner",'<!DOCTYPE html><html class="cke_panel_container {env}" dir="{dir}" lang="{langCode}"><head>{css}</head><body class="cke_{dir}" style="margin:0;padding:0" onload="{onload}"></body></html>');CKEDITOR.ui.panel.prototype={render:function(r,i){this.getHolderElement=function(){var e=this._.holder;if(!e){if(this.isFramed){var e=this.document.getById(this.id+"_frame"),t=e.getParent(),e=e.getFrameDocument();CKEDITOR.env.iOS&&t.setStyles({overflow:"scroll","-webkit-overflow-scrolling":"touch"}),t=CKEDITOR.tools.addFunction(CKEDITOR.tools.bind(function(){this.isLoaded=!0,this.onLoad&&this.onLoad()},this)),e.write(n.output(CKEDITOR.tools.extend({css:CKEDITOR.tools.buildStyleHtml(this.css),onload:"window.parent.CKEDITOR.tools.callFunction("+t+");"},s))),e.getWindow().$.CKEDITOR=CKEDITOR,e.on("keydown",function(e){var t=e.data.getKeystroke(),n=this.document.getById(this.id).getAttribute("dir");this._.onKeyDown&&!1===this._.onKeyDown(t)?e.data.preventDefault():(27==t||t==("rtl"==n?39:37))&&this.onEscape&&!1===this.onEscape(t)&&e.data.preventDefault()},this),e=e.getBody(),e.unselectable(),CKEDITOR.env.air&&CKEDITOR.tools.callFunction(t)}else e=this.document.getById(this.id);this._.holder=e}return e};var s={editorId:r.id,id:this.id,langCode:r.langCode,dir:r.lang.dir,cls:this.className,frame:"",env:CKEDITOR.env.cssClass,"z-index":r.config.baseFloatZIndex+1};if(this.isFramed){var o=CKEDITOR.env.air?"javascript:void(0)":CKEDITOR.env.ie?"javascript:void(function(){"+encodeURIComponent("document.open();("+CKEDITOR.tools.fixDomain+")();document.close();")+"}())":"";s.frame=t.output({id:this.id+"_frame",src:o})}return o=e.output(s),i&&i.push(o),o},addBlock:function(e,t){return t=this._.blocks[e]=t instanceof CKEDITOR.ui.panel.block?t:new CKEDITOR.ui.panel.block(this.getHolderElement(),t),this._.currentBlock||this.showBlock(e),t},getBlock:function(e){return this._.blocks[e]},showBlock:function(e){var e=this._.blocks[e],t=this._.currentBlock,n=!this.forceIFrame||CKEDITOR.env.ie?this._.holder:this.document.getById(this.id+"_frame");return t&&t.hide(),this._.currentBlock=e,CKEDITOR.fire("ariaWidget",n),e._.focusIndex=-1,this._.onKeyDown=e.onKeyDown&&CKEDITOR.tools.bind(e.onKeyDown,e),e.show(),e},destroy:function(){this.element&&this.element.remove()}},CKEDITOR.ui.panel.block=CKEDITOR.tools.createClass({$:function(e,t){this.element=e.append(e.getDocument().createElement("div",{attributes:{tabindex:-1,"class":"cke_panel_block"},styles:{display:"none"}})),t&&CKEDITOR.tools.extend(this,t),this.element.setAttributes({role:this.attributes.role||"presentation","aria-label":this.attributes["aria-label"],title:this.attributes.title||this.attributes["aria-label"]}),this.keys={},this._.focusIndex=-1,this.element.disableContextMenu()},_:{markItem:function(e){-1!=e&&(e=this.element.getElementsByTag("a").getItem(this._.focusIndex=e),CKEDITOR.env.webkit&&e.getDocument().getWindow().focus(),e.focus(),this.onMark&&this.onMark(e))}},proto:{show:function(){this.element.setStyle("display","")},hide:function(){(!this.onHide||!0!==this.onHide.call(this))&&this.element.setStyle("display","none")},onKeyDown:function(e,t){var n=this.keys[e];switch(n){case"next":for(var r=this._.focusIndex,n=this.element.getElementsByTag("a"),i;i=n.getItem(++r);)if(i.getAttribute("_cke_focus")&&i.$.offsetWidth){this._.focusIndex=r,i.focus();break}return!i&&!t?(this._.focusIndex=-1,this.onKeyDown(e,1)):!1;case"prev":r=this._.focusIndex;for(n=this.element.getElementsByTag("a");0<r&&(i=n.getItem(--r));){if(i.getAttribute("_cke_focus")&&i.$.offsetWidth){this._.focusIndex=r,i.focus();break}i=null}return!i&&!t?(this._.focusIndex=n.count(),this.onKeyDown(e,1)):!1;case"click":case"mouseup":return r=this._.focusIndex,(i=0<=r&&this.element.getElementsByTag("a").getItem(r))&&(i.$[n]?i.$[n]():i.$["on"+n]()),!1}return!0}}})}(),CKEDITOR.plugins.add("floatpanel",{requires:"panel"}),function(){function e(e,n,r,i,s){var s=CKEDITOR.tools.genKey(n.getUniqueId(),r.getUniqueId(),e.lang.dir,e.uiColor||"",i.css||"",s||""),o=t[s];return o||(o=t[s]=new CKEDITOR.ui.panel(n,i),o.element=r.append(CKEDITOR.dom.element.createFromHtml(o.render(e),n)),o.element.setStyles({display:"none",position:"absolute"})),o}var t={};CKEDITOR.ui.floatPanel=CKEDITOR.tools.createClass({$:function(t,n,i,s){function o(){l.hide()}i.forceIFrame=1,i.toolbarRelated&&t.elementMode==CKEDITOR.ELEMENT_MODE_INLINE&&(n=CKEDITOR.document.getById("cke_"+t.name));var u=n.getDocument(),s=e(t,u,n,i,s||0),a=s.element,f=a.getFirst(),l=this;a.disableContextMenu(),this.element=a,this._={editor:t,panel:s,parentElement:n,definition:i,document:u,iframe:f,children:[],dir:t.lang.dir},t.on("mode",o),t.on("resize",o),CKEDITOR.env.iOS||u.getWindow().on("resize",o)},proto:{addBlock:function(e,t){return this._.panel.addBlock(e,t)},addListBlock:function(e,t){return this._.panel.addListBlock(e,t)},getBlock:function(e){return this._.panel.getBlock(e)},showBlock:function(e,t,n,r,i,s){var o=this._.panel,u=o.showBlock(e);this.allowBlur(!1),e=this._.editor.editable(),this._.returnFocus=e.hasFocus?e:new CKEDITOR.dom.element(CKEDITOR.document.$.activeElement),this._.hideTimeout=0;var a=this.element,e=this._.iframe,e=CKEDITOR.env.ie?e:new CKEDITOR.dom.window(e.$.contentWindow),f=a.getDocument(),l=this._.parentElement.getPositionedAncestor(),c=t.getDocumentPosition(f),f=l?l.getDocumentPosition(f):{x:0,y:0},h="rtl"==this._.dir,p=c.x+(r||0)-f.x,d=c.y+(i||0)-f.y;!h||1!=n&&4!=n?!h&&(2==n||3==n)&&(p+=t.$.offsetWidth-1):p+=t.$.offsetWidth;if(3==n||4==n)d+=t.$.offsetHeight-1;this._.panel._.offsetParentId=t.getId(),a.setStyles({top:d+"px",left:0,display:""}),a.setOpacity(0),a.getFirst().removeStyle("width"),this._.editor.focusManager.add(e),this._.blurSet||(CKEDITOR.event.useCapture=!0,e.on("blur",function(e){function t(){delete this._.returnFocus,this.hide()}this.allowBlur()&&e.data.getPhase()==CKEDITOR.EVENT_PHASE_AT_TARGET&&this.visible&&!this._.activeChild&&(CKEDITOR.env.iOS?this._.hideTimeout||(this._.hideTimeout=CKEDITOR.tools.setTimeout(t,0,this)):t.call(this))},this),e.on("focus",function(){this._.focused=!0,this.hideChild(),this.allowBlur(!0)},this),CKEDITOR.env.iOS&&(e.on("touchstart",function(){clearTimeout(this._.hideTimeout)},this),e.on("touchend",function(){this._.hideTimeout=0,this.focus()},this)),CKEDITOR.event.useCapture=!1,this._.blurSet=1),o.onEscape=CKEDITOR.tools.bind(function(e){if(this.onEscape&&this.onEscape(e)===!1)return!1},this),CKEDITOR.tools.setTimeout(function(){var e=CKEDITOR.tools.bind(function(){a.removeStyle("width");if(u.autoSize){var e=u.element.getDocument(),e=(CKEDITOR.env.webkit?u.element:e.getBody()).$.scrollWidth;CKEDITOR.env.ie&&CKEDITOR.env.quirks&&e>0&&(e+=(a.$.offsetWidth||0)-(a.$.clientWidth||0)+3),a.setStyle("width",e+10+"px"),e=u.element.$.scrollHeight,CKEDITOR.env.ie&&CKEDITOR.env.quirks&&e>0&&(e+=(a.$.offsetHeight||0)-(a.$.clientHeight||0)+3),a.setStyle("height",e+"px"),o._.currentBlock.element.setStyle("display","none").removeStyle("display")}else a.removeStyle("height");h&&(p-=a.$.offsetWidth),a.setStyle("left",p+"px");var t=o.element.getWindow(),e=a.$.getBoundingClientRect(),t=t.getViewPaneSize(),n=e.width||e.right-e.left,r=e.height||e.bottom-e.top,i=h?e.right:t.width-e.left,f=h?t.width-e.right:e.left;h?i<n&&(p=f>n?p+n:t.width>n?p-e.left:p-e.right+t.width):i<n&&(p=f>n?p-n:t.width>n?p-e.right+t.width:p-e.left),n=e.top,t.height-e.top<r&&(d=n>r?d-r:t.height>r?d-e.bottom+t.height:d-e.top),CKEDITOR.env.ie&&(t=e=new CKEDITOR.dom.element(a.$.offsetParent),t.getName()=="html"&&(t=t.getDocument().getBody()),t.getComputedStyle("direction")=="rtl"&&(p=CKEDITOR.env.ie8Compat?p-a.getDocument().getDocumentElement().$.scrollLeft*2:p-(e.$.scrollWidth-e.$.clientWidth)));var e=a.getFirst(),l;(l=e.getCustomData("activePanel"))&&l.onHide&&l.onHide.call(this,1),e.setCustomData("activePanel",this),a.setStyles({top:d+"px",left:p+"px"}),a.setOpacity(1),s&&s()},this);o.isLoaded?e():o.onLoad=e,CKEDITOR.tools.setTimeout(function(){var e=CKEDITOR.env.webkit&&CKEDITOR.document.getWindow().getScrollPosition().y;this.focus(),u.element.focus(),CKEDITOR.env.webkit&&(CKEDITOR.document.getBody().$.scrollTop=e),this.allowBlur(!0),this._.editor.fire("panelShow",this)},0,this)},CKEDITOR.env.air?200:0,this),this.visible=1,this.onShow&&this.onShow.call(this)},focus:function(){if(CKEDITOR.env.webkit){var e=CKEDITOR.document.getActive();e&&!e.equals(this._.iframe)&&e.$.blur()}(this._.lastFocused||this._.iframe.getFrameDocument().getWindow()).focus()},blur:function(){var e=this._.iframe.getFrameDocument().getActive();e&&e.is("a")&&(this._.lastFocused=e)},hide:function(e){if(this.visible&&(!this.onHide||!0!==this.onHide.call(this))){this.hideChild(),CKEDITOR.env.gecko&&this._.iframe.getFrameDocument().$.activeElement.blur(),this.element.setStyle("display","none"),this.visible=0,this.element.getFirst().removeCustomData("activePanel");if(e=e&&this._.returnFocus)CKEDITOR.env.webkit&&e.type&&e.getWindow().$.focus(),e.focus();delete this._.lastFocused,this._.editor.fire("panelHide",this)}},allowBlur:function(e){var t=this._.panel;return void 0!=e&&(t.allowBlur=e),t.allowBlur},showAsChild:function(e,t,n,r,i,s){this._.activeChild==e&&e._.panel._.offsetParentId==n.getId()||(this.hideChild(),e.onHide=CKEDITOR.tools.bind(function(){CKEDITOR.tools.setTimeout(function(){this._.focused||this.hide()},0,this)},this),this._.activeChild=e,this._.focused=!1,e.showBlock(t,n,r,i,s),this.blur(),(CKEDITOR.env.ie7Compat||CKEDITOR.env.ie6Compat)&&setTimeout(function(){e.element.getChild(0).$.style.cssText+=""},100))},hideChild:function(e){var t=this._.activeChild;t&&(delete t.onHide,delete this._.activeChild,t.hide(),e&&this.focus())}}}),CKEDITOR.on("instanceDestroyed",function(){var e=CKEDITOR.tools.isEmpty(CKEDITOR.instances),n;for(n in t){var r=t[n];e?r.destroy():r.element.hide()}e&&(t={})})}(),CKEDITOR.plugins.add("colorbutton",{requires:"panelbutton,floatpanel",init:function(e){function t(t,r,u,a){var l=new CKEDITOR.style(i["colorButton_"+r+"Style"]),h=CKEDITOR.tools.getNextId()+"_colorBox";e.ui.add(t,CKEDITOR.UI_PANELBUTTON,{label:u,title:u,modes:{wysiwyg:1},editorFocus:0,toolbar:"colors,"+a,allowedContent:l,requiredContent:l,panel:{css:CKEDITOR.skin.getPath("editor"),attributes:{role:"listbox","aria-label":s.panelTitle}},onBlock:function(t,i){i.autoSize=!0,i.element.addClass("cke_colorblock"),i.element.setHtml(n(t,r,h)),i.element.getDocument().getBody().setStyle("overflow","hidden"),CKEDITOR.ui.fire("ready",this);var s=i.keys,u="rtl"==e.lang.dir;s[u?37:39]="next",s[40]="next",s[9]="next",s[u?39:37]="prev",s[38]="prev",s[CKEDITOR.SHIFT+9]="prev",s[32]="click"},refresh:function(){e.activeFilter.check(l)||this.setState(CKEDITOR.TRISTATE_DISABLED)},onOpen:function(){var t=e.getSelection(),t=t&&t.getStartElement(),t=e.elementPath(t),n;if(t){t=t.block||t.blockLimit||e.document.getBody();do n=t&&t.getComputedStyle("back"==r?"background-color":"color")||"transparent";while("back"==r&&"transparent"==n&&t&&(t=t.getParent()));if(!n||"transparent"==n)n="#ffffff";return this._.panel._.iframe.getFrameDocument().getById(h).setStyle("background-color",n),n}}})}function n(t,n,o){var u=[],a=i.colorButton_colors.split(","),l=CKEDITOR.tools.addFunction(function(n,s){if("?"==n){var o=arguments.callee,u=function(e){this.removeListener("ok",u),this.removeListener("cancel",u),"ok"==e.name&&o(this.getContentElement("picker","selectedColor").getValue(),s)};e.openDialog("colordialog",function(){this.on("ok",u),this.on("cancel",u)})}else{e.focus(),t.hide(),e.fire("saveSnapshot"),e.removeStyle(new CKEDITOR.style(i["colorButton_"+s+"Style"],{color:"inherit"}));if(n){var a=i["colorButton_"+s+"Style"];a.childRule="back"==s?function(e){return r(e)}:function(e){return!e.is("a")&&!e.getElementsByTag("a").count()||r(e)},e.applyStyle(new CKEDITOR.style(a,{color:n}))}e.fire("saveSnapshot")}});u.push('<a class="cke_colorauto" _cke_focus=1 hidefocus=true title="',s.auto,'" onclick="CKEDITOR.tools.callFunction(',l,",null,'",n,"');return false;\" href=\"javascript:void('",s.auto,'\')" role="option"><table role="presentation" cellspacing=0 cellpadding=0 width="100%"><tr><td><span class="cke_colorbox" id="',o,'"></span></td><td colspan=7 align=center>',s.auto,'</td></tr></table></a><table role="presentation" cellspacing=0 cellpadding=0 width="100%">');for(o=0;o<a.length;o++){0===o%8&&u.push("</tr><tr>");var h=a[o].split("/"),p=h[0],d=h[1]||p;h[1]||(p="#"+p.replace(/^(.)(.)(.)$/,"$1$1$2$2$3$3")),h=e.lang.colorbutton.colors[d]||d,u.push('<td><a class="cke_colorbox" _cke_focus=1 hidefocus=true title="',h,'" onclick="CKEDITOR.tools.callFunction(',l,",'",p,"','",n,"'); return false;\" href=\"javascript:void('",h,'\')" role="option"><span class="cke_colorbox" style="background-color:#',d,'"></span></a></td>')}return(e.plugins.colordialog&&void 0===i.colorButton_enableMore||i.colorButton_enableMore)&&u.push('</tr><tr><td colspan=8 align=center><a class="cke_colormore" _cke_focus=1 hidefocus=true title="',s.more,'" onclick="CKEDITOR.tools.callFunction(',l,",'?','",n,"');return false;\" href=\"javascript:void('",s.more,"')\"",' role="option">',s.more,"</a></td>"),u.push("</tr></table>"),u.join("")}function r(e){return"false"==e.getAttribute("contentEditable")||e.getAttribute("data-nostyle")}var i=e.config,s=e.lang.colorbutton;CKEDITOR.env.hc||(t("TextColor","fore",s.textColorTitle,10),t("BGColor","back",s.bgColorTitle,20))}}),CKEDITOR.config.colorButton_colors="000,800000,8B4513,2F4F4F,008080,000080,4B0082,696969,B22222,A52A2A,DAA520,006400,40E0D0,0000CD,800080,808080,F00,FF8C00,FFD700,008000,0FF,00F,EE82EE,A9A9A9,FFA07A,FFA500,FFFF00,00FF00,AFEEEE,ADD8E6,DDA0DD,D3D3D3,FFF0F5,FAEBD7,FFFFE0,F0FFF0,F0FFFF,F0F8FF,E6E6FA,FFF",CKEDITOR.config.colorButton_foreStyle={element:"span",styles:{color:"#(color)"},overrides:[{element:"font",attributes:{color:null}}]},CKEDITOR.config.colorButton_backStyle={element:"span",styles:{"background-color":"#(color)"}},CKEDITOR.plugins.colordialog={requires:"dialog",init:function(e){var t=new CKEDITOR.dialogCommand("colordialog");t.editorFocus=!1,e.addCommand("colordialog",t),CKEDITOR.dialog.add("colordialog",this.path+"dialogs/colordialog.js"),e.getColorFromDialog=function(t,n){var r=function(e){this.removeListener("ok",r),this.removeListener("cancel",r),e="ok"==e.name?this.getValueOf("picker","selectedColor"):null,t.call(n,e)},i=function(e){e.on("ok",r),e.on("cancel",r)};e.execCommand("colordialog"),e._.storedDialogs&&e._.storedDialogs.colordialog?i(e._.storedDialogs.colordialog):CKEDITOR.on("dialogDefinition",function(e){if("colordialog"==e.data.name){var t=e.data.definition;e.removeListener(),t.onLoad=CKEDITOR.tools.override(t.onLoad,function(e){return function(){i(this),t.onLoad=e,"function"==typeof e&&e.call(this)}})}})}}},CKEDITOR.plugins.add("colordialog",CKEDITOR.plugins.colordialog),function(){CKEDITOR.plugins.add("templates",{requires:"dialog",init:function(e){CKEDITOR.dialog.add("templates",CKEDITOR.getUrl(this.path+"dialogs/templates.js")),e.addCommand("templates",new CKEDITOR.dialogCommand("templates")),e.ui.addButton&&e.ui.addButton("Templates",{label:e.lang.templates.button,command:"templates",toolbar:"doctools,10"})}});var e={},t={};CKEDITOR.addTemplates=function(t,n){e[t]=n},CKEDITOR.getTemplates=function(t){return e[t]},CKEDITOR.loadTemplates=function(e,n){for(var r=[],i=0,s=e.length;i<s;i++)t[e[i]]||(r.push(e[i]),t[e[i]]=1);r.length?CKEDITOR.scriptLoader.load(r,n):setTimeout(n,0)}}(),CKEDITOR.config.templates_files=[CKEDITOR.getUrl("plugins/templates/templates/default.js")],CKEDITOR.config.templates_replaceContent=!0,CKEDITOR.plugins.add("menu",{requires:"floatpanel",beforeInit:function(e){for(var t=e.config.menu_groups.split(","),n=e._.menuGroups={},r=e._.menuItems={},i=0;i<t.length;i++)n[t[i]]=i+1;e.addMenuGroup=function(e,t){n[e]=t||100},e.addMenuItem=function(e,t){n[t.group]&&(r[e]=new CKEDITOR.menuItem(this,e,t))},e.addMenuItems=function(e){for(var t in e)this.addMenuItem(t,e[t])},e.getMenuItem=function(e){return r[e]},e.removeMenuItem=function(e){delete r[e]}}}),function(){function e(e){e.sort(function(e,t){return e.group<t.group?-1:e.group>t.group?1:e.order<t.order?-1:e.order>t.order?1:0})}var t='<span class="cke_menuitem"><a id="{id}" class="cke_menubutton cke_menubutton__{name} cke_menubutton_{state} {cls}" href="{href}" title="{title}" tabindex="-1"_cke_focus=1 hidefocus="true" role="{role}" aria-haspopup="{hasPopup}" aria-disabled="{disabled}" {ariaChecked}';CKEDITOR.env.gecko&&CKEDITOR.env.mac&&(t+=' onkeypress="return false;"'),CKEDITOR.env.gecko&&(t+=' onblur="this.style.cssText = this.style.cssText;"');var t=t+(' onmouseover="CKEDITOR.tools.callFunction({hoverFn},{index});" onmouseout="CKEDITOR.tools.callFunction({moveOutFn},{index});" '+(CKEDITOR.env.ie?'onclick="return false;" onmouseup':"onclick")+'="CKEDITOR.tools.callFunction({clickFn},{index}); return false;">'),n=CKEDITOR.addTemplate("menuItem",t+'<span class="cke_menubutton_inner"><span class="cke_menubutton_icon"><span class="cke_button_icon cke_button__{iconName}_icon" style="{iconStyle}"></span></span><span class="cke_menubutton_label">{label}</span>{arrowHtml}</span></a></span>'),r=CKEDITOR.addTemplate("menuArrow",'<span class="cke_menuarrow"><span>{label}</span></span>');CKEDITOR.menu=CKEDITOR.tools.createClass({$:function(e,t){t=this._.definition=t||{},this.id=CKEDITOR.tools.getNextId(),this.editor=e,this.items=[],this._.listeners=[],this._.level=t.level||1;var n=CKEDITOR.tools.extend({},t.panel,{css:[CKEDITOR.skin.getPath("editor")],level:this._.level-1,block:{}}),r=n.block.attributes=n.attributes||{};!r.role&&(r.role="menu"),this._.panelDefinition=n},_:{onShow:function(){var e=this.editor.getSelection(),t=e&&e.getStartElement(),n=this.editor.elementPath(),r=this._.listeners;this.removeAll();for(var i=0;i<r.length;i++){var s=r[i](t,e,n);if(s)for(var o in s){var u=this.editor.getMenuItem(o);u&&(!u.command||this.editor.getCommand(u.command).state)&&(u.state=s[o],this.add(u))}}},onClick:function(e){this.hide(),e.onClick?e.onClick():e.command&&this.editor.execCommand(e.command)},onEscape:function(e){var t=this.parent;return t?t._.panel.hideChild(1):27==e&&this.hide(1),!1},onHide:function(){this.onHide&&this.onHide()},showSubMenu:function(e){var t=this._.subMenu,n=this.items[e];if(n=n.getItems&&n.getItems()){t?t.removeAll():(t=this._.subMenu=new CKEDITOR.menu(this.editor,CKEDITOR.tools.extend({},this._.definition,{level:this._.level+1},!0)),t.parent=this,t._.onClick=CKEDITOR.tools.bind(this._.onClick,this));for(var r in n){var i=this.editor.getMenuItem(r);i&&(i.state=n[r],t.add(i))}var s=this._.panel.getBlock(this.id).element.getDocument().getById(this.id+(""+e));setTimeout(function(){t.show(s,2)},0)}else this._.panel.hideChild(1)}},proto:{add:function(e){e.order||(e.order=this.items.length),this.items.push(e)},removeAll:function(){this.items=[]},show:function(t,n,r,i){if(!this.parent&&(this._.onShow(),!this.items.length))return;var n=n||("rtl"==this.editor.lang.dir?2:1),s=this.items,o=this.editor,u=this._.panel,a=this._.element;if(!u){u=this._.panel=new CKEDITOR.ui.floatPanel(this.editor,CKEDITOR.document.getBody(),this._.panelDefinition,this._.level),u.onEscape=CKEDITOR.tools.bind(function(e){if(!1===this._.onEscape(e))return!1},this),u.onShow=function(){u._.panel.getHolderElement().getParent().addClass("cke cke_reset_all")},u.onHide=CKEDITOR.tools.bind(function(){this._.onHide&&this._.onHide()},this),a=u.addBlock(this.id,this._.panelDefinition.block),a.autoSize=!0;var f=a.keys;f[40]="next",f[9]="next",f[38]="prev",f[CKEDITOR.SHIFT+9]="prev",f["rtl"==o.lang.dir?37:39]=CKEDITOR.env.ie?"mouseup":"click",f[32]=CKEDITOR.env.ie?"mouseup":"click",CKEDITOR.env.ie&&(f[13]="mouseup"),a=this._.element=a.element,f=a.getDocument(),f.getBody().setStyle("overflow","hidden"),f.getElementsByTag("html").getItem(0).setStyle("overflow","hidden"),this._.itemOverFn=CKEDITOR.tools.addFunction(function(e){clearTimeout(this._.showSubTimeout),this._.showSubTimeout=CKEDITOR.tools.setTimeout(this._.showSubMenu,o.config.menu_subMenuDelay||400,this,[e])},this),this._.itemOutFn=CKEDITOR.tools.addFunction(function(){clearTimeout(this._.showSubTimeout)},this),this._.itemClickFn=CKEDITOR.tools.addFunction(function(e){var t=this.items[e];t.state==CKEDITOR.TRISTATE_DISABLED?this.hide(1):t.getItems?this._.showSubMenu(e):this._.onClick(t)},this)}e(s);for(var f=o.elementPath(),f=['<div class="cke_menu'+(f&&f.direction()!=o.lang.dir?" cke_mixed_dir_content":"")+'" role="presentation">'],l=s.length,c=l&&s[0].group,h=0;h<l;h++){var p=s[h];c!=p.group&&(f.push('<div class="cke_menuseparator" role="separator"></div>'),c=p.group),p.render(this,h,f)}f.push("</div>"),a.setHtml(f.join("")),CKEDITOR.ui.fire("ready",this),this.parent?this.parent._.panel.showAsChild(u,this.id,t,n,r,i):u.showBlock(this.id,t,n,r,i),o.fire("menuShow",[u])},addListener:function(e){this._.listeners.push(e)},hide:function(e){this._.onHide&&this._.onHide(),this._.panel&&this._.panel.hide(e)}}}),CKEDITOR.menuItem=CKEDITOR.tools.createClass({$:function(e,t,n){CKEDITOR.tools.extend(this,n,{order:0,className:"cke_menubutton__"+t}),this.group=e._.menuGroups[this.group],this.editor=e,this.name=t},proto:{render:function(e,t,i){var s=e.id+(""+t),o="undefined"==typeof this.state?CKEDITOR.TRISTATE_OFF:this.state,u="",a=o==CKEDITOR.TRISTATE_ON?"on":o==CKEDITOR.TRISTATE_DISABLED?"disabled":"off";this.role in{menuitemcheckbox:1,menuitemradio:1}&&(u=' aria-checked="'+(o==CKEDITOR.TRISTATE_ON?"true":"false")+'"');var f=this.getItems,c="&#"+("rtl"==this.editor.lang.dir?"9668":"9658")+";",h=this.name;this.icon&&!/\./.test(this.icon)&&(h=this.icon),e={id:s,name:this.name,iconName:h,label:this.label,cls:this.className||"",state:a,hasPopup:f?"true":"false",disabled:o==CKEDITOR.TRISTATE_DISABLED,title:this.label,href:"javascript:void('"+(this.label||"").replace("'")+"')",hoverFn:e._.itemOverFn,moveOutFn:e._.itemOutFn,clickFn:e._.itemClickFn,index:t,iconStyle:CKEDITOR.skin.getIconStyle(h,"rtl"==this.editor.lang.dir,h==this.icon?null:this.icon,this.iconOffset),arrowHtml:f?r.output({label:c}):"",role:this.role?this.role:"menuitem",ariaChecked:u},n.output(e,i)}}})}(),CKEDITOR.config.menu_groups="clipboard,form,tablecell,tablecellproperties,tablerow,tablecolumn,table,anchor,link,image,flash,checkbox,radio,textfield,hiddenfield,imagebutton,button,select,textarea,div",CKEDITOR.plugins.add("contextmenu",{requires:"menu",onLoad:function(){CKEDITOR.plugins.contextMenu=CKEDITOR.tools.createClass({base:CKEDITOR.menu,$:function(e){this.base.call(this,e,{panel:{className:"cke_menu_panel",attributes:{"aria-label":e.lang.contextmenu.options}}})},proto:{addTarget:function(e,t){e.on("contextmenu",function(e){var e=e.data,r=CKEDITOR.env.webkit?n:CKEDITOR.env.mac?e.$.metaKey:e.$.ctrlKey;if(!t||!r){e.preventDefault();if(CKEDITOR.env.mac&&CKEDITOR.env.webkit){var r=this.editor,i=(new CKEDITOR.dom.elementPath(e.getTarget(),r.editable())).contains(function(e){return e.hasAttribute("contenteditable")},!0);i&&"false"==i.getAttribute("contenteditable")&&r.getSelection().fake(i)}var i=e.getTarget().getDocument(),s=e.getTarget().getDocument().getDocumentElement(),r=!i.equals(CKEDITOR.document),i=i.getWindow().getScrollPosition(),o=r?e.$.clientX:e.$.pageX||i.x+e.$.clientX,u=r?e.$.clientY:e.$.pageY||i.y+e.$.clientY;CKEDITOR.tools.setTimeout(function(){this.open(s,null,o,u)},CKEDITOR.env.ie?200:0,this)}},this);if(CKEDITOR.env.webkit){var n,r=function(){n=0};e.on("keydown",function(e){n=CKEDITOR.env.mac?e.data.$.metaKey:e.data.$.ctrlKey}),e.on("keyup",r),e.on("contextmenu",r)}},open:function(e,t,n,r){this.editor.focus(),e=e||CKEDITOR.document.getDocumentElement(),this.editor.selectionChange(1),this.show(e,t,n,r)}}})},beforeInit:function(e){var t=e.contextMenu=new CKEDITOR.plugins.contextMenu(e);e.on("contentDom",function(){t.addTarget(e.editable(),!1!==e.config.browserContextMenuOnCtrl)}),e.addCommand("contextMenu",{exec:function(){e.contextMenu.open(e.document.getBody())}}),e.setKeystroke(CKEDITOR.SHIFT+121,"contextMenu"),e.setKeystroke(CKEDITOR.CTRL+CKEDITOR.SHIFT+121,"contextMenu")}}),function(){CKEDITOR.plugins.add("div",{requires:"dialog",init:function(e){if(!e.blockless){var t=e.lang.div,n="div(*)";CKEDITOR.dialog.isTabEnabled(e,"editdiv","advanced")&&(n+=";div[dir,id,lang,title]{*}"),e.addCommand("creatediv",new CKEDITOR.dialogCommand("creatediv",{allowedContent:n,requiredContent:"div",contextSensitive:!0,refresh:function(e,t){this.setState("div"in(e.config.div_wrapTable?t.root:t.blockLimit).getDtd()?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED)}})),e.addCommand("editdiv",new CKEDITOR.dialogCommand("editdiv",{requiredContent:"div"})),e.addCommand("removediv",{requiredContent:"div",exec:function(e){function t(t){(t=CKEDITOR.plugins.div.getSurroundDiv(e,t))&&!t.data("cke-div-added")&&(o.push(t),t.data("cke-div-added"))}for(var n=e.getSelection(),r=n&&n.getRanges(),i,s=n.createBookmarks(),o=[],u=0;u<r.length;u++)i=r[u],i.collapsed?t(n.getStartElement()):(i=new CKEDITOR.dom.walker(i),i.evaluator=t,i.lastForward());for(u=0;u<o.length;u++)o[u].remove(!0);n.selectBookmarks(s)}}),e.ui.addButton&&e.ui.addButton("CreateDiv",{label:t.toolbar,command:"creatediv",toolbar:"blocks,50"}),e.addMenuItems&&(e.addMenuItems({editdiv:{label:t.edit,command:"editdiv",group:"div",order:1},removediv:{label:t.remove,command:"removediv",group:"div",order:5}}),e.contextMenu&&e.contextMenu.addListener(function(t){return!t||t.isReadOnly()?null:CKEDITOR.plugins.div.getSurroundDiv(e)?{editdiv:CKEDITOR.TRISTATE_OFF,removediv:CKEDITOR.TRISTATE_OFF}:null})),CKEDITOR.dialog.add("creatediv",this.path+"dialogs/div.js"),CKEDITOR.dialog.add("editdiv",this.path+"dialogs/div.js")}}}),CKEDITOR.plugins.div={getSurroundDiv:function(e,t){var n=e.elementPath(t);return e.elementPath(n.blockLimit).contains(function(e){return e.is("div")&&!e.isReadOnly()},1)}}}(),CKEDITOR.plugins.add("resize",{init:function(e){var t,n,r,i,s=e.config,o=e.ui.spaceId("resizer"),u=e.element?e.element.getDirection(1):"ltr";!s.resize_dir&&(s.resize_dir="vertical"),void 0==s.resize_maxWidth&&(s.resize_maxWidth=3e3),void 0==s.resize_maxHeight&&(s.resize_maxHeight=3e3),void 0==s.resize_minWidth&&(s.resize_minWidth=750),void 0==s.resize_minHeight&&(s.resize_minHeight=250);if(!1!==s.resize_enabled){var a=null,f=("both"==s.resize_dir||"horizontal"==s.resize_dir)&&s.resize_minWidth!=s.resize_maxWidth,l=("both"==s.resize_dir||"vertical"==s.resize_dir)&&s.resize_minHeight!=s.resize_maxHeight,c=function(o){var a=t,c=n,h=a+(o.data.$.screenX-r)*("rtl"==u?-1:1),o=c+(o.data.$.screenY-i);f&&(a=Math.max(s.resize_minWidth,Math.min(h,s.resize_maxWidth))),l&&(c=Math.max(s.resize_minHeight,Math.min(o,s.resize_maxHeight))),e.resize(f?a:null,c)},h=function(){CKEDITOR.document.removeListener("mousemove",c),CKEDITOR.document.removeListener("mouseup",h),e.document&&(e.document.removeListener("mousemove",c),e.document.removeListener("mouseup",h))},p=CKEDITOR.tools.addFunction(function(o){a||(a=e.getResizable()),t=a.$.offsetWidth||0,n=a.$.offsetHeight||0,r=o.screenX,i=o.screenY,s.resize_minWidth>t&&(s.resize_minWidth=t),s.resize_minHeight>n&&(s.resize_minHeight=n),CKEDITOR.document.on("mousemove",c),CKEDITOR.document.on("mouseup",h),e.document&&(e.document.on("mousemove",c),e.document.on("mouseup",h)),o.preventDefault&&o.preventDefault()});e.on("destroy",function(){CKEDITOR.tools.removeFunction(p)}),e.on("uiSpace",function(t){if("bottom"==t.data.space){var n="";f&&!l&&(n=" cke_resizer_horizontal"),!f&&l&&(n=" cke_resizer_vertical");var r='<span id="'+o+'" class="cke_resizer'+n+" cke_resizer_"+u+'" title="'+CKEDITOR.tools.htmlEncode(e.lang.common.resize)+'" onmousedown="CKEDITOR.tools.callFunction('+p+', event)">'+("ltr"==u?"◢":"◣")+"</span>";"ltr"==u&&"ltr"==n?t.data.html+=r:t.data.html=r+t.data.html}},e,null,100),e.on("maximize",function(t){e.ui.space("resizer")[t.data==CKEDITOR.TRISTATE_ON?"hide":"show"]()})}}}),function(){function e(e){function n(){for(var n=r(),s=CKEDITOR.tools.clone(e.config.toolbarGroups)||t(e),o=0;o<s.length;o++){var u=s[o];if("/"!=u){"string"==typeof u&&(u=s[o]={name:u});var f,l=u.groups;if(l)for(var h=0;h<l.length;h++)f=l[h],(f=n[f])&&i(u,f);(f=n[u.name])&&i(u,f)}}return s}function r(){var t={},n,r,i;for(n in e.ui.items)r=e.ui.items[n],i=r.toolbar||"others",i=i.split(","),r=i[0],i=parseInt(i[1]||-1,10),t[r]||(t[r]=[]),t[r].push({name:n,order:i});for(r in t)t[r]=t[r].sort(function(e,t){return e.order==t.order?0:0>t.order?-1:0>e.order?1:e.order<t.order?-1:1});return t}function i(t,n){if(n.length){t.items?t.items.push(e.ui.create("-")):t.items=[];for(var r;r=n.shift();)(r="string"==typeof r?r:r.name,!o||-1==CKEDITOR.tools.indexOf(o,r))&&(r=e.ui.create(r))&&e.addFeature(r)&&t.items.push(r)}}function s(e){var t=[],n,r,s;for(n=0;n<e.length;++n)r=e[n],s={},"/"==r?t.push(r):CKEDITOR.tools.isArray(r)?(i(s,CKEDITOR.tools.clone(r)),t.push(s)):r.items&&(i(s,CKEDITOR.tools.clone(r.items)),s.name=r.name,t.push(s));return t}var o=e.config.removeButtons,o=o&&o.split(","),u=e.config.toolbar;return"string"==typeof u&&(u=e.config["toolbar_"+u]),e.toolbar=u?s(u):n()}function t(e){return e._.toolbarGroups||(e._.toolbarGroups=[{name:"document",groups:["mode","document","doctools"]},{name:"clipboard",groups:["clipboard","undo"]},{name:"editing",groups:["find","selection","spellchecker"]},{name:"forms"},"/",{name:"basicstyles",groups:["basicstyles","cleanup"]},{name:"paragraph",groups:["list","indent","blocks","align","bidi"]},{name:"links"},{name:"insert"},"/",{name:"styles"},{name:"colors"},{name:"tools"},{name:"others"},{name:"about"}])}var n=function(){this.toolbars=[],this.focusCommandExecuted=!1};n.prototype.focus=function(){for(var e=0,t;t=this.toolbars[e++];)for(var n=0,r;r=t.items[n++];)if(r.focus){r.focus();return}};var r={modes:{wysiwyg:1,source:1},readOnly:1,exec:function(e){e.toolbox&&(e.toolbox.focusCommandExecuted=!0,CKEDITOR.env.ie||CKEDITOR.env.air?setTimeout(function(){e.toolbox.focus()},100):e.toolbox.focus())}};CKEDITOR.plugins.add("toolbar",{requires:"button",init:function(t){var i,s=function(e,n){var r,o="rtl"==t.lang.dir,u=t.config.toolbarGroupCycling,f=o?37:39,o=o?39:37,u=void 0===u||u;switch(n){case 9:case CKEDITOR.SHIFT+9:for(;!r||!r.items.length;)if(r=9==n?(r?r.next:e.toolbar.next)||t.toolbox.toolbars[0]:(r?r.previous:e.toolbar.previous)||t.toolbox.toolbars[t.toolbox.toolbars.length-1],r.items.length)for(e=r.items[i?r.items.length-1:0];e&&!e.focus;)(e=i?e.previous:e.next)||(r=0);return e&&e.focus(),!1;case f:r=e;do r=r.next,!r&&u&&(r=e.toolbar.items[0]);while(r&&!r.focus);return r?r.focus():s(e,9),!1;case 40:return e.button&&e.button.hasArrow?(t.once("panelShow",function(e){e.data._.panel._.currentBlock.onKeyDown(40)}),e.execute()):s(e,40==n?f:o),!1;case o:case 38:r=e;do r=r.previous,!r&&u&&(r=e.toolbar.items[e.toolbar.items.length-1]);while(r&&!r.focus);return r?r.focus():(i=1,s(e,CKEDITOR.SHIFT+9),i=0),!1;case 27:return t.focus(),!1;case 13:case 32:return e.execute(),!1}return!0};t.on("uiSpace",function(r){if(r.data.space==t.config.toolbarLocation){r.removeListener(),t.toolbox=new n;var i=CKEDITOR.tools.getNextId(),o=['<span id="',i,'" class="cke_voice_label">',t.lang.toolbar.toolbars,"</span>",'<span id="'+t.ui.spaceId("toolbox")+'" class="cke_toolbox" role="group" aria-labelledby="',i,'" onmousedown="return false;">'],i=!1!==t.config.toolbarStartupExpanded,f,l;t.config.toolbarCanCollapse&&t.elementMode!=CKEDITOR.ELEMENT_MODE_INLINE&&o.push('<span class="cke_toolbox_main"'+(i?">":' style="display:none">'));for(var c=t.toolbox.toolbars,h=e(t),p=0;p<h.length;p++){var d,v=0,m,y=h[p],b;if(y)if(f&&(o.push("</span>"),l=f=0),"/"===y)o.push('<span class="cke_toolbar_break"></span>');else{b=y.items||y;for(var E=0;E<b.length;E++){var S=b[E],x;if(S)if(S.type==CKEDITOR.UI_SEPARATOR)l=f&&S;else{x=!1!==S.canGroup;if(!v){d=CKEDITOR.tools.getNextId(),v={id:d,items:[]},m=y.name&&(t.lang.toolbar.toolbarGroups[y.name]||y.name),o.push('<span id="',d,'" class="cke_toolbar"',m?' aria-labelledby="'+d+'_label"':"",' role="toolbar">'),m&&o.push('<span id="',d,'_label" class="cke_voice_label">',m,"</span>"),o.push('<span class="cke_toolbar_start"></span>');var T=c.push(v)-1;0<T&&(v.previous=c[T-1],v.previous.next=v)}x?f||(o.push('<span class="cke_toolgroup" role="presentation">'),f=1):f&&(o.push("</span>"),f=0),d=function(e){e=e.render(t,o),T=v.items.push(e)-1,T>0&&(e.previous=v.items[T-1],e.previous.next=e),e.toolbar=v,e.onkey=s,e.onfocus=function(){t.toolbox.focusCommandExecuted||t.focus()}},l&&(d(l),l=0),d(S)}}f&&(o.push("</span>"),l=f=0),v&&o.push('<span class="cke_toolbar_end"></span></span>')}}t.config.toolbarCanCollapse&&o.push("</span>");if(t.config.toolbarCanCollapse&&t.elementMode!=CKEDITOR.ELEMENT_MODE_INLINE){var N=CKEDITOR.tools.addFunction(function(){t.execCommand("toolbarCollapse")});t.on("destroy",function(){CKEDITOR.tools.removeFunction(N)}),t.addCommand("toolbarCollapse",{readOnly:1,exec:function(e){var t=e.ui.space("toolbar_collapser"),n=t.getPrevious(),r=e.ui.space("contents"),i=n.getParent(),s=parseInt(r.$.style.height,10),o=i.$.offsetHeight,u=t.hasClass("cke_toolbox_collapser_min");u?(n.show(),t.removeClass("cke_toolbox_collapser_min"),t.setAttribute("title",e.lang.toolbar.toolbarCollapse)):(n.hide(),t.addClass("cke_toolbox_collapser_min"),t.setAttribute("title",e.lang.toolbar.toolbarExpand)),t.getFirst().setText(u?"▲":"◀"),r.setStyle("height",s-(i.$.offsetHeight-o)+"px"),e.fire("resize")},modes:{wysiwyg:1,source:1}}),t.setKeystroke(CKEDITOR.ALT+(CKEDITOR.env.ie||CKEDITOR.env.webkit?189:109),"toolbarCollapse"),o.push('<a title="'+(i?t.lang.toolbar.toolbarCollapse:t.lang.toolbar.toolbarExpand)+'" id="'+t.ui.spaceId("toolbar_collapser")+'" tabIndex="-1" class="cke_toolbox_collapser'),i||o.push(" cke_toolbox_collapser_min"),o.push('" onclick="CKEDITOR.tools.callFunction('+N+')">','<span class="cke_arrow">&#9650;</span>',"</a>")}o.push("</span>"),r.data.html+=o.join("")}}),t.on("destroy",function(){if(this.toolbox){var e,t=0,n,r,i;for(e=this.toolbox.toolbars;t<e.length;t++){r=e[t].items;for(n=0;n<r.length;n++)i=r[n],i.clickFn&&CKEDITOR.tools.removeFunction(i.clickFn),i.keyDownFn&&CKEDITOR.tools.removeFunction(i.keyDownFn)}}}),t.on("uiReady",function(){var e=t.ui.space("toolbox");e&&t.focusManager.add(e,1)}),t.addCommand("toolbarFocus",r),t.setKeystroke(CKEDITOR.ALT+121,"toolbarFocus"),t.ui.add("-",CKEDITOR.UI_SEPARATOR,{}),t.ui.addHandler(CKEDITOR.UI_SEPARATOR,{create:function(){return{render:function(e,t){return t.push('<span class="cke_toolbar_separator" role="separator"></span>'),{}}}}})}}),CKEDITOR.ui.prototype.addToolbarGroup=function(e,n,r){var i=t(this.editor),s=0===n,o={name:e};if(r){if(r=CKEDITOR.tools.search(i,function(e){return e.name==r})){!r.groups&&(r.groups=[]);if(n&&(n=CKEDITOR.tools.indexOf(r.groups,n),0<=n)){r.groups.splice(n+1,0,e);return}s?r.groups.splice(0,0,e):r.groups.push(e);return}n=null}n&&(n=CKEDITOR.tools.indexOf(i,function(e){return e.name==n})),s?i.splice(0,0,e):"number"==typeof n?i.splice(n+1,0,o):i.push(e)}}(),CKEDITOR.UI_SEPARATOR="separator",CKEDITOR.config.toolbarLocation="top",function(){function t(t,r){function s(e){e=l.list[e];if(e.equals(t.editable())||"true"==e.getAttribute("contenteditable")){var n=t.createRange();n.selectNodeContents(e),n.select()}else t.getSelection().selectElement(e);t.focus()}function u(){f&&f.setHtml(n),delete l.list}var a=t.ui.spaceId("path"),f,l=t._.elementsPath,c=l.idBase;r.html+='<span id="'+a+'_label" class="cke_voice_label">'+t.lang.elementspath.eleLabel+'</span><span id="'+a+'" class="cke_path" role="group" aria-labelledby="'+a+'_label">'+n+"</span>",t.on("uiReady",function(){var e=t.ui.space("path");e&&t.focusManager.add(e,1)}),l.onClick=s;var h=CKEDITOR.tools.addFunction(s),p=CKEDITOR.tools.addFunction(function(e,n){var r=l.idBase,i,n=new CKEDITOR.dom.event(n);i="rtl"==t.lang.dir;switch(n.getKeystroke()){case i?39:37:case 9:return(i=CKEDITOR.document.getById(r+(e+1)))||(i=CKEDITOR.document.getById(r+"0")),i.focus(),!1;case i?37:39:case CKEDITOR.SHIFT+9:return(i=CKEDITOR.document.getById(r+(e-1)))||(i=CKEDITOR.document.getById(r+(l.list.length-1))),i.focus(),!1;case 27:return t.focus(),!1;case 13:case 32:return s(e),!1}return!0});t.on("selectionChange",function(){t.editable();for(var e=[],r=l.list=[],s=[],u=l.filters,d=!0,g=t.elementPath().elements,y,b=g.length;b--;){var w=g[b],E=0;y=w.data("cke-display-name")?w.data("cke-display-name"):w.data("cke-real-element-type")?w.data("cke-real-element-type"):w.getName(),d=w.hasAttribute("contenteditable")?"true"==w.getAttribute("contenteditable"):d,!d&&!w.hasAttribute("contenteditable")&&(E=1);for(var S=0;S<u.length;S++){var x=u[S](w,y);if(!1===x){E=1;break}y=x||y}E||(r.unshift(w),s.unshift(y))}r=r.length;for(u=0;u<r;u++)y=s[u],d=t.lang.elementspath.eleTitle.replace(/%1/,y),y=i.output({id:c+u,label:d,text:y,jsTitle:"javascript:void('"+y+"')",index:u,keyDownFn:p,clickFn:h}),e.unshift(y);f||(f=CKEDITOR.document.getById(a)),s=f,s.setHtml(e.join("")+n),t.fire("elementsPathUpdate",{space:s})}),t.on("readOnly",u),t.on("contentDomUnload",u),t.addCommand("elementsPathFocus",e),t.setKeystroke(CKEDITOR.ALT+122,"elementsPathFocus")}var e;e={editorFocus:!1,readOnly:1,exec:function(e){(e=CKEDITOR.document.getById(e._.elementsPath.idBase+"0"))&&e.focus(CKEDITOR.env.ie||CKEDITOR.env.air)}};var n='<span class="cke_path_empty">&nbsp;</span>',r="";CKEDITOR.env.gecko&&CKEDITOR.env.mac&&(r+=' onkeypress="return false;"'),CKEDITOR.env.gecko&&(r+=' onblur="this.style.cssText = this.style.cssText;"');var i=CKEDITOR.addTemplate("pathItem",'<a id="{id}" href="{jsTitle}" tabindex="-1" class="cke_path_item" title="{label}"'+r+' hidefocus="true"  onkeydown="return CKEDITOR.tools.callFunction({keyDownFn},{index}, event );" onclick="CKEDITOR.tools.callFunction({clickFn},{index}); return false;" role="button" aria-label="{label}">{text}</a>');CKEDITOR.plugins.add("elementspath",{init:function(e){e._.elementsPath={idBase:"cke_elementspath_"+CKEDITOR.tools.getNextNumber()+"_",filters:[]},e.on("uiSpace",function(n){"bottom"==n.data.space&&t(e,n.data)})}})}(),function(){function e(e,t,n){n=e.config.forceEnterMode||n,"wysiwyg"==e.mode&&(t||(t=e.activeEnterMode),e.elementPath().isContextFor("p")||(t=CKEDITOR.ENTER_BR,n=1),e.fire("saveSnapshot"),t==CKEDITOR.ENTER_BR?s(e,t,null,n):o(e,t,null,n),e.fire("saveSnapshot"))}function t(e){for(var e=e.getSelection().getRanges(!0),t=e.length-1;0<t;t--)e[t].deleteContents();return e[0]}CKEDITOR.plugins.add("enterkey",{init:function(t){t.addCommand("enter",{modes:{wysiwyg:1},editorFocus:!1,exec:function(t){e(t)}}),t.addCommand("shiftEnter",{modes:{wysiwyg:1},editorFocus:!1,exec:function(t){e(t,t.activeShiftEnterMode,1)}}),t.setKeystroke([[13,"enter"],[CKEDITOR.SHIFT+13,"shiftEnter"]])}});var n=CKEDITOR.dom.walker.whitespaces(),r=CKEDITOR.dom.walker.bookmark();CKEDITOR.plugins.enterkey={enterBlock:function(e,i,o,a){if(o=o||t(e)){var f=o.document,l=o.checkStartOfBlock(),c=o.checkEndOfBlock(),h=e.elementPath(o.startContainer),d=h.block,m=i==CKEDITOR.ENTER_DIV?"div":"p",g;if(l&&c){if(d&&(d.is("li")||d.getParent().is("li"))){d.is("li")||(d=d.getParent()),o=d.getParent(),g=o.getParent();var a=!d.hasPrevious(),y=!d.hasNext(),m=e.getSelection(),b=m.createBookmarks(),l=d.getDirection(1),c=d.getAttribute("class"),w=d.getAttribute("style"),E=g.getDirection(1)!=l,e=e.enterMode!=CKEDITOR.ENTER_BR||E||w||c;if(g.is("li"))a||y?d[a?"insertBefore":"insertAfter"](g):d.breakParent(g);else{if(e)(h.block.is("li")?(g=f.createElement(i==CKEDITOR.ENTER_P?"p":"div"),E&&g.setAttribute("dir",l),w&&g.setAttribute("style",w),c&&g.setAttribute("class",c),d.moveChildren(g)):g=h.block,a||y)?g[a?"insertBefore":"insertAfter"](o):(d.breakParent(o),g.insertAfter(o));else if(d.appendBogus(!0),a||y)for(;f=d[a?"getFirst":"getLast"]();)f[a?"insertBefore":"insertAfter"](o);else for(d.breakParent(o);f=d.getLast();)f.insertAfter(o);d.remove()}m.selectBookmarks(b);return}if(d&&d.getParent().is("blockquote")){d.breakParent(d.getParent()),d.getPrevious().getFirst(CKEDITOR.dom.walker.invisible(1))||d.getPrevious().remove(),d.getNext().getFirst(CKEDITOR.dom.walker.invisible(1))||d.getNext().remove(),o.moveToElementEditStart(d),o.select();return}}else if(d&&d.is("pre")&&!c){s(e,i,o,a);return}if(l=o.splitBlock(m)){i=l.previousBlock,d=l.nextBlock,h=l.wasStartOfBlock,e=l.wasEndOfBlock,d?(b=d.getParent(),b.is("li")&&(d.breakParent(b),d.move(d.getNext(),1))):i&&(b=i.getParent())&&b.is("li")&&(i.breakParent(b),b=i.getNext(),o.moveToElementEditStart(b),i.move(i.getPrevious()));if(!h&&!e)d.is("li")&&(g=o.clone(),g.selectNodeContents(d),g=new CKEDITOR.dom.walker(g),g.evaluator=function(e){return!(r(e)||n(e)||e.type==CKEDITOR.NODE_ELEMENT&&e.getName()in CKEDITOR.dtd.$inline&&!(e.getName()in CKEDITOR.dtd.$empty))},(b=g.next())&&b.type==CKEDITOR.NODE_ELEMENT&&b.is("ul","ol")&&(CKEDITOR.env.needsBrFiller?f.createElement("br"):f.createText(" ")).insertBefore(b)),d&&o.moveToElementEditStart(d);else{if(i){if(i.is("li")||!u.test(i.getName())&&!i.is("pre"))g=i.clone()}else d&&(g=d.clone());g?a&&!g.is("li")&&g.renameNode(m):b&&b.is("li")?g=b:(g=f.createElement(m),i&&(y=i.getDirection())&&g.setAttribute("dir",y));if(f=l.elementPath){a=0;for(m=f.elements.length;a<m;a++){b=f.elements[a];if(b.equals(f.block)||b.equals(f.blockLimit))break;CKEDITOR.dtd.$removeEmpty[b.getName()]&&(b=b.clone(),g.moveChildren(b),g.append(b))}}g.appendBogus(),g.getParent()||o.insertNode(g),g.is("li")&&g.removeAttribute("value"),CKEDITOR.env.ie&&h&&(!e||!i.getChildCount())&&(o.moveToElementEditStart(e?i:g),o.select()),o.moveToElementEditStart(h&&!e?d:g)}o.select(),o.scrollIntoView()}}},enterBr:function(e,n,r,i){if(r=r||t(e)){var s=r.document,a=r.checkEndOfBlock(),f=new CKEDITOR.dom.elementPath(e.getSelection().getStartElement()),l=f.block,c=l&&f.block.getName();!i&&"li"==c?o(e,n,r,i):(!i&&a&&u.test(c)?(a=l.getDirection())?(s=s.createElement("div"),s.setAttribute("dir",a),s.insertAfter(l),r.setStart(s,0)):(s.createElement("br").insertAfter(l),CKEDITOR.env.gecko&&s.createText("").insertAfter(l),r.setStartAt(l.getNext(),CKEDITOR.env.ie?CKEDITOR.POSITION_BEFORE_START:CKEDITOR.POSITION_AFTER_START)):(e="pre"==c&&CKEDITOR.env.ie&&8>CKEDITOR.env.version?s.createText("\r"):s.createElement("br"),r.deleteContents(),r.insertNode(e),CKEDITOR.env.needsBrFiller?(s.createText("﻿").insertAfter(e),a&&(l||f.blockLimit).appendBogus(),e.getNext().$.nodeValue="",r.setStartAt(e.getNext(),CKEDITOR.POSITION_AFTER_START)):r.setStartAt(e,CKEDITOR.POSITION_AFTER_END)),r.collapse(!0),r.select(),r.scrollIntoView())}}};var i=CKEDITOR.plugins.enterkey,s=i.enterBr,o=i.enterBlock,u=/^h[1-6]$/}(),function(){function e(e,t){var n={},r=[],i={nbsp:" ",shy:"­",gt:">",lt:"<",amp:"&",apos:"'",quot:'"'},e=e.replace(/\b(nbsp|shy|gt|lt|amp|apos|quot)(?:,|$)/g,function(e,s){var o=t?"&"+s+";":i[s];return n[o]=t?i[s]:"&"+s+";",r.push(o),""});if(!t&&e){var e=e.split(","),s=document.createElement("div"),o;s.innerHTML="&"+e.join(";&")+";",o=s.innerHTML,s=null;for(s=0;s<o.length;s++){var u=o.charAt(s);n[u]="&"+e[s]+";",r.push(u)}}return n.regex=r.join(t?"|":""),n}CKEDITOR.plugins.add("entities",{afterInit:function(t){var n=t.config;if(t=(t=t.dataProcessor)&&t.htmlFilter){var r=[];!1!==n.basicEntities&&r.push("nbsp,gt,lt,amp"),n.entities&&(r.length&&r.push("quot,iexcl,cent,pound,curren,yen,brvbar,sect,uml,copy,ordf,laquo,not,shy,reg,macr,deg,plusmn,sup2,sup3,acute,micro,para,middot,cedil,sup1,ordm,raquo,frac14,frac12,frac34,iquest,times,divide,fnof,bull,hellip,prime,Prime,oline,frasl,weierp,image,real,trade,alefsym,larr,uarr,rarr,darr,harr,crarr,lArr,uArr,rArr,dArr,hArr,forall,part,exist,empty,nabla,isin,notin,ni,prod,sum,minus,lowast,radic,prop,infin,ang,and,or,cap,cup,int,there4,sim,cong,asymp,ne,equiv,le,ge,sub,sup,nsub,sube,supe,oplus,otimes,perp,sdot,lceil,rceil,lfloor,rfloor,lang,rang,loz,spades,clubs,hearts,diams,circ,tilde,ensp,emsp,thinsp,zwnj,zwj,lrm,rlm,ndash,mdash,lsquo,rsquo,sbquo,ldquo,rdquo,bdquo,dagger,Dagger,permil,lsaquo,rsaquo,euro"),n.entities_latin&&r.push("Agrave,Aacute,Acirc,Atilde,Auml,Aring,AElig,Ccedil,Egrave,Eacute,Ecirc,Euml,Igrave,Iacute,Icirc,Iuml,ETH,Ntilde,Ograve,Oacute,Ocirc,Otilde,Ouml,Oslash,Ugrave,Uacute,Ucirc,Uuml,Yacute,THORN,szlig,agrave,aacute,acirc,atilde,auml,aring,aelig,ccedil,egrave,eacute,ecirc,euml,igrave,iacute,icirc,iuml,eth,ntilde,ograve,oacute,ocirc,otilde,ouml,oslash,ugrave,uacute,ucirc,uuml,yacute,thorn,yuml,OElig,oelig,Scaron,scaron,Yuml"),n.entities_greek&&r.push("Alpha,Beta,Gamma,Delta,Epsilon,Zeta,Eta,Theta,Iota,Kappa,Lambda,Mu,Nu,Xi,Omicron,Pi,Rho,Sigma,Tau,Upsilon,Phi,Chi,Psi,Omega,alpha,beta,gamma,delta,epsilon,zeta,eta,theta,iota,kappa,lambda,mu,nu,xi,omicron,pi,rho,sigmaf,sigma,tau,upsilon,phi,chi,psi,omega,thetasym,upsih,piv"),n.entities_additional&&r.push(n.entities_additional));var i=e(r.join(",")),s=i.regex?"["+i.regex+"]":"a^";delete i.regex,n.entities&&n.entities_processNumerical&&(s="[^ -~]|"+s);var s=RegExp(s,"g"),o=function(e){return n.entities_processNumerical=="force"||!i[e]?"&#"+e.charCodeAt(0)+";":i[e]},u=e("nbsp,gt,lt,amp,shy",!0),a=RegExp(u.regex,"g"),f=function(e){return u[e]};t.addRules({text:function(e){return e.replace(a,f).replace(s,o)}},{applyToAll:!0,excludeNestedEditable:!0})}}})}(),CKEDITOR.config.basicEntities=!0,CKEDITOR.config.entities=!0,CKEDITOR.config.entities_latin=!0,CKEDITOR.config.entities_greek=!0,CKEDITOR.config.entities_additional="#39",CKEDITOR.plugins.add("popup"),CKEDITOR.tools.extend(CKEDITOR.editor.prototype,{popup:function(e,t,n,r){t=t||"80%",n=n||"70%","string"==typeof t&&1<t.length&&"%"==t.substr(t.length-1,1)&&(t=parseInt(window.screen.width*parseInt(t,10)/100,10)),"string"==typeof n&&1<n.length&&"%"==n.substr(n.length-1,1)&&(n=parseInt(window.screen.height*parseInt(n,10)/100,10)),640>t&&(t=640),420>n&&(n=420);var i=parseInt((window.screen.height-n)/2,10),s=parseInt((window.screen.width-t)/2,10),r=(r||"location=no,menubar=no,toolbar=no,dependent=yes,minimizable=no,modal=yes,alwaysRaised=yes,resizable=yes,scrollbars=yes")+",width="+t+",height="+n+",top="+i+",left="+s,o=window.open("",null,r,!0);if(!o)return!1;try{-1==navigator.userAgent.toLowerCase().indexOf(" chrome/")&&(o.moveTo(s,i),o.resizeTo(t,n)),o.focus(),o.location.href=e}catch(u){window.open(e,null,r,!0)}return!0}}),function(){function e(e,t){var n=[];if(!t)return e;for(var r in t)n.push(r+"="+encodeURIComponent(t[r]));return e+(-1!=e.indexOf("?")?"&":"?")+n.join("&")}function t(e){return e+="",e.charAt(0).toUpperCase()+e.substr(1)}function n(){var n=this.getDialog(),r=n.getParentEditor();r._.filebrowserSe=this;var i=r.config["filebrowser"+t(n.getName())+"WindowWidth"]||r.config.filebrowserWindowWidth||"80%",n=r.config["filebrowser"+t(n.getName())+"WindowHeight"]||r.config.filebrowserWindowHeight||"70%",s=this.filebrowser.params||{};s.CKEditor=r.name,s.CKEditorFuncNum=r._.filebrowserFn,s.langCode||(s.langCode=r.langCode),s=e(this.filebrowser.url,s),r.popup(s,i,n,r.config.filebrowserWindowFeatures||r.config.fileBrowserWindowFeatures)}function r(){var e=this.getDialog();return e.getParentEditor()._.filebrowserSe=this,!e.getContentElement(this["for"][0],this["for"][1]).getInputElement().$.value||!e.getContentElement(this["for"][0],this["for"][1]).getAction()?!1:!0}function i(t,n,r){var i=r.params||{};i.CKEditor=t.name,i.CKEditorFuncNum=t._.filebrowserFn,i.langCode||(i.langCode=t.langCode),n.action=e(r.url,i),n.filebrowser=r}function s(e,o,u,a){if(a&&a.length)for(var f,c=a.length;c--;)if(f=a[c],("hbox"==f.type||"vbox"==f.type||"fieldset"==f.type)&&s(e,o,u,f.children),f.filebrowser)if("string"==typeof f.filebrowser&&(f.filebrowser={action:"fileButton"==f.type?"QuickUpload":"Browse",target:f.filebrowser}),"Browse"==f.filebrowser.action){var h=f.filebrowser.url;void 0===h&&(h=e.config["filebrowser"+t(o)+"BrowseUrl"],void 0===h&&(h=e.config.filebrowserBrowseUrl)),h&&(f.onClick=n,f.filebrowser.url=h,f.hidden=!1)}else if("QuickUpload"==f.filebrowser.action&&f["for"]&&(h=f.filebrowser.url,void 0===h&&(h=e.config["filebrowser"+t(o)+"UploadUrl"],void 0===h&&(h=e.config.filebrowserUploadUrl)),h)){var p=f.onClick;f.onClick=function(e){var t=e.sender;return p&&p.call(t,e)===!1?!1:r.call(t,e)},f.filebrowser.url=h,f.hidden=!1,i(e,u.getContents(f["for"][0]).get(f["for"][1]),f.filebrowser)}}function o(e,t,n){if(-1!==n.indexOf(";")){for(var n=n.split(";"),r=0;r<n.length;r++)if(o(e,t,n[r]))return!0;return!1}return(e=e.getContents(t).get(n).filebrowser)&&e.url}function u(e,t){var n=this._.filebrowserSe.getDialog(),r=this._.filebrowserSe["for"],i=this._.filebrowserSe.filebrowser.onSelect;r&&n.getContentElement(r[0],r[1]).reset(),("function"!=typeof t||!1!==t.call(this._.filebrowserSe))&&(!i||!1!==i.call(this._.filebrowserSe,e,t))&&("string"==typeof t&&t&&alert(t),e&&(r=this._.filebrowserSe,n=r.getDialog(),r=r.filebrowser.target||null))&&(r=r.split(":"),i=n.getContentElement(r[0],r[1]))&&(i.setValue(e),n.selectPage(r[0]))}CKEDITOR.plugins.add("filebrowser",{requires:"popup",init:function(e){e._.filebrowserFn=CKEDITOR.tools.addFunction(u,e),e.on("destroy",function(){CKEDITOR.tools.removeFunction(this._.filebrowserFn)})}}),CKEDITOR.on("dialogDefinition",function(e){if(e.editor.plugins.filebrowser)for(var t=e.data.definition,n,r=0;r<t.contents.length;++r)if(n=t.contents[r])s(e.editor,e.data.name,t,n.elements),n.hidden&&n.filebrowser&&(n.hidden=!o(t,n.id,n.filebrowser))})}(),CKEDITOR.plugins.add("find",{requires:"dialog",init:function(e){var t=e.addCommand("find",new CKEDITOR.dialogCommand("find"));t.canUndo=!1,t.readOnly=1,e.addCommand("replace",new CKEDITOR.dialogCommand("replace")).canUndo=!1,e.ui.addButton&&(e.ui.addButton("Find",{label:e.lang.find.find,command:"find",toolbar:"find,10"}),e.ui.addButton("Replace",{label:e.lang.find.replace,command:"replace",toolbar:"find,20"})),CKEDITOR.dialog.add("find",this.path+"dialogs/find.js"),CKEDITOR.dialog.add("replace",this.path+"dialogs/find.js")}}),CKEDITOR.config.find_highlight={element:"span",styles:{"background-color":"#004",color:"#fff"}},function(){function e(e,t){var n=r.exec(e),i=r.exec(t);if(n){if(!n[2]&&"px"==i[2])return i[1];if("px"==n[2]&&!i[2])return i[1]+"px"}return t}var t=CKEDITOR.htmlParser.cssStyle,n=CKEDITOR.tools.cssLength,r=/^((?:\d*(?:\.\d+))|(?:\d+))(.*)?$/i,i={elements:{$:function(n){var r=n.attributes;if((r=(r=(r=r&&r["data-cke-realelement"])&&new CKEDITOR.htmlParser.fragment.fromHtml(decodeURIComponent(r)))&&r.children[0])&&n.attributes["data-cke-resizable"]){var i=(new t(n)).rules,n=r.attributes,s=i.width,i=i.height;s&&(n.width=e(n.width,s)),i&&(n.height=e(n.height,i))}return r}}};CKEDITOR.plugins.add("fakeobjects",{init:function(e){e.filter.allow("img[!data-cke-realelement,src,alt,title](*){*}","fakeobjects")},afterInit:function(e){(e=(e=e.dataProcessor)&&e.htmlFilter)&&e.addRules(i,{applyToAll:!0})}}),CKEDITOR.editor.prototype.createFakeElement=function(e,r,i,s){var o=this.lang.fakeobjects,o=o[i]||o.unknown,r={"class":r,"data-cke-realelement":encodeURIComponent(e.getOuterHtml()),"data-cke-real-node-type":e.type,alt:o,title:o,align:e.getAttribute("align")||""};return CKEDITOR.env.hc||(r.src=CKEDITOR.tools.transparentImageData),i&&(r["data-cke-real-element-type"]=i),s&&(r["data-cke-resizable"]=s,i=new t,s=e.getAttribute("width"),e=e.getAttribute("height"),s&&(i.rules.width=n(s)),e&&(i.rules.height=n(e)),i.populate(r)),this.document.createElement("img",{attributes:r})},CKEDITOR.editor.prototype.createFakeParserElement=function(e,r,i,s){var o=this.lang.fakeobjects,o=o[i]||o.unknown,u;return u=new CKEDITOR.htmlParser.basicWriter,e.writeHtml(u),u=u.getHtml(),r={"class":r,"data-cke-realelement":encodeURIComponent(u),"data-cke-real-node-type":e.type,alt:o,title:o,align:e.attributes.align||""},CKEDITOR.env.hc||(r.src=CKEDITOR.tools.transparentImageData),i&&(r["data-cke-real-element-type"]=i),s&&(r["data-cke-resizable"]=s,s=e.attributes,e=new t,i=s.width,s=s.height,void 0!=i&&(e.rules.width=n(i)),void 0!=s&&(e.rules.height=n(s)),e.populate(r)),new CKEDITOR.htmlParser.element("img",r)},CKEDITOR.editor.prototype.restoreRealElement=function(t){if(t.data("cke-real-node-type")!=CKEDITOR.NODE_ELEMENT)return null;var n=CKEDITOR.dom.element.createFromHtml(decodeURIComponent(t.data("cke-realelement")),this.document);if(t.data("cke-resizable")){var r=t.getStyle("width"),t=t.getStyle("height");r&&n.setAttribute("width",e(n.getAttribute("width"),r)),t&&n.setAttribute("height",e(n.getAttribute("height"),t))}return n}}(),function(){function e(e){return e=e.attributes,"application/x-shockwave-flash"==e.type||n.test(e.src||"")}function t(e,t){return e.createFakeParserElement(t,"cke_flash","flash",!0)}var n=/\.swf(?:$|\?)/i;CKEDITOR.plugins.add("flash",{requires:"dialog,fakeobjects",onLoad:function(){CKEDITOR.addCss("img.cke_flash{background-image: url("+CKEDITOR.getUrl(this.path+"images/placeholder.png")+");background-position: center center;background-repeat: no-repeat;border: 1px solid #a9a9a9;width: 80px;height: 80px;}")},init:function(e){var t="object[classid,codebase,height,hspace,vspace,width];param[name,value];embed[height,hspace,pluginspage,src,type,vspace,width]";CKEDITOR.dialog.isTabEnabled(e,"flash","properties")&&(t+=";object[align]; embed[allowscriptaccess,quality,scale,wmode]"),CKEDITOR.dialog.isTabEnabled(e,"flash","advanced")&&(t+=";object[id]{*}; embed[bgcolor]{*}(*)"),e.addCommand("flash",new CKEDITOR.dialogCommand("flash",{allowedContent:t,requiredContent:"embed"})),e.ui.addButton&&e.ui.addButton("Flash",{label:e.lang.common.flash,command:"flash",toolbar:"insert,20"}),CKEDITOR.dialog.add("flash",this.path+"dialogs/flash.js"),e.addMenuItems&&e.addMenuItems({flash:{label:e.lang.flash.properties,command:"flash",group:"flash"}}),e.on("doubleclick",function(e){var t=e.data.element;t.is("img")&&"flash"==t.data("cke-real-element-type")&&(e.data.dialog="flash")}),e.contextMenu&&e.contextMenu.addListener(function(e){if(e&&e.is("img")&&!e.isReadOnly()&&"flash"==e.data("cke-real-element-type"))return{flash:CKEDITOR.TRISTATE_OFF}})},afterInit:function(n){var r=n.dataProcessor;(r=r&&r.dataFilter)&&r.addRules({elements:{"cke:object":function(r){var i=r.attributes;if((!i.classid||!(""+i.classid).toLowerCase())&&!e(r)){for(i=0;i<r.children.length;i++)if("cke:embed"==r.children[i].name){if(!e(r.children[i]))break;return t(n,r)}return null}return t(n,r)},"cke:embed":function(r){return e(r)?t(n,r):null}}},5)}})}(),CKEDITOR.tools.extend(CKEDITOR.config,{flashEmbedTagOnly:!1,flashAddEmbedTag:!0,flashConvertOnEdit:!1}),function(){function e(e){var r=e.config,i=e.fire("uiSpace",{space:"top",html:""}).html,o=function(){function i(e,t,r){a.setStyle(t,n(r)),a.setStyle("position",e)}function u(e){var t=l.getDocumentPosition();switch(e){case"top":i("absolute","top",t.y-v-w);break;case"pin":i("fixed","top",S);break;case"bottom":i("absolute","top",t.y+(h.height||h.bottom-h.top)+w)}f=e}var f,l,c,h,d,v,m,y=r.floatSpaceDockedOffsetX||0,w=r.floatSpaceDockedOffsetY||0,E=r.floatSpacePinnedOffsetX||0,S=r.floatSpacePinnedOffsetY||0;return function(r){if(l=e.editable())if(r&&"focus"==r.name&&a.show(),a.removeStyle("left"),a.removeStyle("right"),c=a.getClientRect(),h=l.getClientRect(),d=t.getViewPaneSize(),v=c.height,m="pageXOffset"in t.$?t.$.pageXOffset:CKEDITOR.document.$.documentElement.scrollLeft,f){v+w<=h.top?u("top"):v+w>d.height-h.bottom?u("pin"):u("bottom");var r=d.width/2,r=0<h.left&&h.right<d.width&&h.width>c.width?"rtl"==e.config.contentsLangDirection?"right":"left":r-h.left>h.right-r?"left":"right",i;c.width>d.width?(r="left",i=0):(i="left"==r?0<h.left?h.left:0:h.right<d.width?d.width-h.right:0,i+c.width>d.width&&(r="left"==r?"right":"left",i=0)),a.setStyle(r,n(("pin"==f?E:y)+i+("pin"==f?0:"left"==r?m:-m)))}else f="pin",u("pin"),o(r)}}();if(i){var u=new CKEDITOR.template('<div id="cke_{name}" class="cke {id} cke_reset_all cke_chrome cke_editor_{name} cke_float cke_{langDir} '+CKEDITOR.env.cssClass+'" dir="{langDir}" title="'+(CKEDITOR.env.gecko?" ":"")+'" lang="{langCode}" role="application" style="{style}"'+(e.title?' aria-labelledby="cke_{name}_arialbl"':" ")+">"+(e.title?'<span id="cke_{name}_arialbl" class="cke_voice_label">{voiceLabel}</span>':" ")+'<div class="cke_inner"><div id="{topId}" class="cke_top" role="presentation">{content}</div></div></div>'),a=CKEDITOR.document.getBody().append(CKEDITOR.dom.element.createFromHtml(u.output({content:i,id:e.id,langDir:e.lang.dir,langCode:e.langCode,name:e.name,style:"display:none;z-index:"+(r.baseFloatZIndex-1),topId:e.ui.spaceId("top"),voiceLabel:e.title}))),f=CKEDITOR.tools.eventsBuffer(500,o),l=CKEDITOR.tools.eventsBuffer(100,o);a.unselectable(),a.on("mousedown",function(e){e=e.data,e.getTarget().hasAscendant("a",1)||e.preventDefault()}),e.on("focus",function(n){o(n),e.on("change",f.input),t.on("scroll",l.input),t.on("resize",l.input)}),e.on("blur",function(){a.hide(),e.removeListener("change",f.input),t.removeListener("scroll",l.input),t.removeListener("resize",l.input)}),e.on("destroy",function(){t.removeListener("scroll",l.input),t.removeListener("resize",l.input),a.clearCustomData(),a.remove()}),e.focusManager.hasFocus&&a.show(),e.focusManager.add(a,1)}}var t=CKEDITOR.document.getWindow(),n=CKEDITOR.tools.cssLength;CKEDITOR.plugins.add("floatingspace",{init:function(t){t.on("loaded",function(){e(this)},null,null,20)}})}(),CKEDITOR.plugins.add("listblock",{requires:"panel",onLoad:function(){var e=CKEDITOR.addTemplate("panel-list",'<ul role="presentation" class="cke_panel_list">{items}</ul>'),t=CKEDITOR.addTemplate("panel-list-item",'<li id="{id}" class="cke_panel_listItem" role=presentation><a id="{id}_option" _cke_focus=1 hidefocus=true title="{title}" href="javascript:void(\'{val}\')"  {onclick}="CKEDITOR.tools.callFunction({clickFn},\'{val}\'); return false;" role="option">{text}</a></li>'),n=CKEDITOR.addTemplate("panel-list-group",'<h1 id="{id}" class="cke_panel_grouptitle" role="presentation" >{label}</h1>'),r=/\'/g;CKEDITOR.ui.panel.prototype.addListBlock=function(e,t){return this.addBlock(e,new CKEDITOR.ui.listBlock(this.getHolderElement(),t))},CKEDITOR.ui.listBlock=CKEDITOR.tools.createClass({base:CKEDITOR.ui.panel.block,$:function(e,t){var t=t||{},n=t.attributes||(t.attributes={});(this.multiSelect=!!t.multiSelect)&&(n["aria-multiselectable"]=!0),!n.role&&(n.role="listbox"),this.base.apply(this,arguments),this.element.setAttribute("role",n.role),n=this.keys,n[40]="next",n[9]="next",n[38]="prev",n[CKEDITOR.SHIFT+9]="prev",n[32]=CKEDITOR.env.ie?"mouseup":"click",CKEDITOR.env.ie&&(n[13]="mouseup"),this._.pendingHtml=[],this._.pendingList=[],this._.items={},this._.groups={}},_:{close:function(){if(this._.started){var t=e.output({items:this._.pendingList.join("")});this._.pendingList=[],this._.pendingHtml.push(t),delete this._.started}},getClick:function(){return this._.click||(this._.click=CKEDITOR.tools.addFunction(function(e){var t=this.toggle(e);this.onClick&&this.onClick(e,t)},this)),this._.click}},proto:{add:function(e,n,s){var o=CKEDITOR.tools.getNextId();this._.started||(this._.started=1,this._.size=this._.size||0),this._.items[e]=o;var u;u=CKEDITOR.tools.htmlEncodeAttr(e).replace(r,"\\'"),e={id:o,val:u,onclick:CKEDITOR.env.ie?'onclick="return false;" onmouseup':"onclick",clickFn:this._.getClick(),title:CKEDITOR.tools.htmlEncodeAttr(s||e),text:n||e},this._.pendingList.push(t.output(e))},startGroup:function(e){this._.close();var t=CKEDITOR.tools.getNextId();this._.groups[e]=t,this._.pendingHtml.push(n.output({id:t,label:e}))},commit:function(){this._.close(),this.element.appendHtml(this._.pendingHtml.join("")),delete this._.size,this._.pendingHtml=[]},toggle:function(e){var t=this.isMarked(e);return t?this.unmark(e):this.mark(e),!t},hideGroup:function(e){var t=(e=this.element.getDocument().getById(this._.groups[e]))&&e.getNext();e&&(e.setStyle("display","none"),t&&"ul"==t.getName()&&t.setStyle("display","none"))},hideItem:function(e){this.element.getDocument().getById(this._.items[e]).setStyle("display","none")},showAll:function(){var e=this._.items,t=this._.groups,n=this.element.getDocument(),r;for(r in e)n.getById(e[r]).setStyle("display","");for(var i in t)e=n.getById(t[i]),r=e.getNext(),e.setStyle("display",""),r&&"ul"==r.getName()&&r.setStyle("display","")},mark:function(e){this.multiSelect||this.unmarkAll();var e=this._.items[e],t=this.element.getDocument().getById(e);t.addClass("cke_selected"),this.element.getDocument().getById(e+"_option").setAttribute("aria-selected",!0),this.onMark&&this.onMark(t)},unmark:function(e){var t=this.element.getDocument(),e=this._.items[e],n=t.getById(e);n.removeClass("cke_selected"),t.getById(e+"_option").removeAttribute("aria-selected"),this.onUnmark&&this.onUnmark(n)},unmarkAll:function(){var e=this._.items,t=this.element.getDocument(),n;for(n in e){var r=e[n];t.getById(r).removeClass("cke_selected"),t.getById(r+"_option").removeAttribute("aria-selected")}this.onUnmark&&this.onUnmark()},isMarked:function(e){return this.element.getDocument().getById(this._.items[e]).hasClass("cke_selected")},focus:function(e){this._.focusIndex=-1;var t=this.element.getElementsByTag("a"),n,r=-1;if(e){for(n=this.element.getDocument().getById(this._.items[e]).getFirst();e=t.getItem(++r);)if(e.equals(n)){this._.focusIndex=r;break}}else this.element.focus();n&&setTimeout(function(){n.focus()},0)}}})}}),CKEDITOR.plugins.add("richcombo",{requires:"floatpanel,listblock,button",beforeInit:function(e){e.ui.addHandler(CKEDITOR.UI_RICHCOMBO,CKEDITOR.ui.richCombo.handler)}}),function(){var e='<span id="{id}" class="cke_combo cke_combo__{name} {cls}" role="presentation"><span id="{id}_label" class="cke_combo_label">{label}</span><a class="cke_combo_button" hidefocus=true title="{title}" tabindex="-1"'+(CKEDITOR.env.gecko&&!CKEDITOR.env.hc?"":'" href="javascript:void(\'{titleJs}\')"')+' hidefocus="true" role="button" aria-labelledby="{id}_label" aria-haspopup="true"';CKEDITOR.env.gecko&&CKEDITOR.env.mac&&(e+=' onkeypress="return false;"'),CKEDITOR.env.gecko&&(e+=' onblur="this.style.cssText = this.style.cssText;"');var e=e+(' onkeydown="return CKEDITOR.tools.callFunction({keydownFn},event,this);" onfocus="return CKEDITOR.tools.callFunction({focusFn},event);" '+(CKEDITOR.env.ie?'onclick="return false;" onmouseup':"onclick")+'="CKEDITOR.tools.callFunction({clickFn},this);return false;"><span id="{id}_text" class="cke_combo_text cke_combo_inlinelabel">{label}</span><span class="cke_combo_open"><span class="cke_combo_arrow">'+(CKEDITOR.env.hc?"&#9660;":CKEDITOR.env.air?"&nbsp;":"")+"</span></span></a></span>"),t=CKEDITOR.addTemplate("combo",e);CKEDITOR.UI_RICHCOMBO="richcombo",CKEDITOR.ui.richCombo=CKEDITOR.tools.createClass({$:function(e){CKEDITOR.tools.extend(this,e,{canGroup:!1,title:e.label,modes:{wysiwyg:1},editorFocus:1}),e=this.panel||{},delete this.panel,this.id=CKEDITOR.tools.getNextNumber(),this.document=e.parent&&e.parent.getDocument()||CKEDITOR.document,e.className="cke_combopanel",e.block={multiSelect:e.multiSelect,attributes:e.attributes},e.toolbarRelated=!0,this._={panelDefinition:e,items:{}}},proto:{renderHtml:function(e){var t=[];return this.render(e,t),t.join("")},render:function(e,n){function r(){if(this.getState()!=CKEDITOR.TRISTATE_ON){var t=this.modes[e.mode]?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED;e.readOnly&&!this.readOnly&&(t=CKEDITOR.TRISTATE_DISABLED),this.setState(t),this.setValue(""),t!=CKEDITOR.TRISTATE_DISABLED&&this.refresh&&this.refresh()}}var s=CKEDITOR.env,o="cke_"+this.id,u=CKEDITOR.tools.addFunction(function(t){h&&(e.unlockSelection(1),h=0),f.execute(t)},this),a=this,f={id:o,combo:this,focus:function(){CKEDITOR.document.getById(o).getChild(1).focus()},execute:function(t){var n=a._;if(n.state!=CKEDITOR.TRISTATE_DISABLED)if(a.createPanel(e),n.on)n.panel.hide();else{a.commit();var r=a.getValue();r?n.list.mark(r):n.list.unmarkAll(),n.panel.showBlock(a.id,new CKEDITOR.dom.element(t),4)}},clickFn:u};e.on("activeFilterChange",r,this),e.on("mode",r,this),e.on("selectionChange",r,this),!this.readOnly&&e.on("readOnly",r,this);var l=CKEDITOR.tools.addFunction(function(t,n){var t=new CKEDITOR.dom.event(t),r=t.getKeystroke();40==r&&e.once("panelShow",function(e){e.data._.panel._.currentBlock.onKeyDown(40)});switch(r){case 13:case 32:case 40:CKEDITOR.tools.callFunction(u,n);break;default:f.onkey(f,r)}t.preventDefault()}),c=CKEDITOR.tools.addFunction(function(){f.onfocus&&f.onfocus()}),h=0;return f.keyDownFn=l,s={id:o,name:this.name||this.command,label:this.label,title:this.title,cls:this.className||"",titleJs:s.gecko&&!s.hc?"":(this.title||"").replace("'",""),keydownFn:l,focusFn:c,clickFn:u},t.output(s,n),this.onRender&&this.onRender(),f},createPanel:function(e){if(!this._.panel){var t=this._.panelDefinition,n=this._.panelDefinition.block,r=t.parent||CKEDITOR.document.getBody(),i="cke_combopanel__"+this.name,s=new CKEDITOR.ui.floatPanel(e,r,t),o=s.addListBlock(this.id,n),u=this;s.onShow=function(){this.element.addClass(i),u.setState(CKEDITOR.TRISTATE_ON),u._.on=1,u.editorFocus&&!e.focusManager.hasFocus&&e.focus(),u.onOpen&&u.onOpen(),e.once("panelShow",function(){o.focus(!o.multiSelect&&u.getValue())})},s.onHide=function(t){this.element.removeClass(i),u.setState(u.modes&&u.modes[e.mode]?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED),u._.on=0,!t&&u.onClose&&u.onClose()},s.onEscape=function(){s.hide(1)},o.onClick=function(e,t){u.onClick&&u.onClick.call(u,e,t),s.hide()},this._.panel=s,this._.list=o,s.getBlock(this.id).onHide=function(){u._.on=0,u.setState(CKEDITOR.TRISTATE_OFF)},this.init&&this.init()}},setValue:function(e,t){this._.value=e;var n=this.document.getById("cke_"+this.id+"_text");n&&(!e&&!t?(t=this.label,n.addClass("cke_combo_inlinelabel")):n.removeClass("cke_combo_inlinelabel"),n.setText("undefined"!=typeof t?t:e))},getValue:function(){return this._.value||""},unmarkAll:function(){this._.list.unmarkAll()},mark:function(e){this._.list.mark(e)},hideItem:function(e){this._.list.hideItem(e)},hideGroup:function(e){this._.list.hideGroup(e)},showAll:function(){this._.list.showAll()},add:function(e,t,n){this._.items[e]=n||e,this._.list.add(e,t,n)},startGroup:function(e){this._.list.startGroup(e)},commit:function(){this._.committed||(this._.list.commit(),this._.committed=1,CKEDITOR.ui.fire("ready",this)),this._.committed=1},setState:function(e){if(this._.state!=e){var t=this.document.getById("cke_"+this.id);t.setState(e,"cke_combo"),e==CKEDITOR.TRISTATE_DISABLED?t.setAttribute("aria-disabled",!0):t.removeAttribute("aria-disabled"),this._.state=e}},getState:function(){return this._.state},enable:function(){this._.state==CKEDITOR.TRISTATE_DISABLED&&this.setState(this._.lastState)},disable:function(){this._.state!=CKEDITOR.TRISTATE_DISABLED&&(this._.lastState=this._.state,this.setState(CKEDITOR.TRISTATE_DISABLED))}},statics:{handler:{create:function(e){return new CKEDITOR.ui.richCombo(e)}}}}),CKEDITOR.ui.prototype.addRichCombo=function(e,t){this.add(e,CKEDITOR.UI_RICHCOMBO,t)}}(),function(){function e(e,t,n,r,i,s,o,u){for(var a=e.config,f=new CKEDITOR.style(o),l=i.split(";"),i=[],c={},h=0;h<l.length;h++){var p=l[h];if(p){var p=p.split("/"),d={},v=l[h]=p[0];d[n]=i[h]=p[1]||v,c[v]=new CKEDITOR.style(o,d),c[v]._.definition.name=v}else l.splice(h--,1)}e.ui.addRichCombo(t,{label:r.label,title:r.panelTitle,toolbar:"styles,"+u,allowedContent:f,requiredContent:f,panel:{css:[CKEDITOR.skin.getPath("editor")].concat(a.contentsCss),multiSelect:!1,attributes:{"aria-label":r.panelTitle}},init:function(){this.startGroup(r.panelTitle);for(var e=0;e<l.length;e++){var t=l[e];this.add(t,c[t].buildPreview(),t)}},onClick:function(t){e.focus(),e.fire("saveSnapshot");var n=c[t];e[this.getValue()==t?"removeStyle":"applyStyle"](n),e.fire("saveSnapshot")},onRender:function(){e.on("selectionChange",function(t){for(var n=this.getValue(),t=t.data.path.elements,r=0,i;r<t.length;r++){i=t[r];for(var o in c)if(c[o].checkElementMatch(i,!0,e)){o!=n&&this.setValue(o);return}}this.setValue("",s)},this)},refresh:function(){e.activeFilter.check(f)||this.setState(CKEDITOR.TRISTATE_DISABLED)}})}CKEDITOR.plugins.add("font",{requires:"richcombo",init:function(t){var n=t.config;e(t,"Font","family",t.lang.font,n.font_names,n.font_defaultLabel,n.font_style,30),e(t,"FontSize","size",t.lang.font.fontSize,n.fontSize_sizes,n.fontSize_defaultLabel,n.fontSize_style,40)}})}(),CKEDITOR.config.font_names="Arial/Arial, Helvetica, sans-serif;Comic Sans MS/Comic Sans MS, cursive;Courier New/Courier New, Courier, monospace;Georgia/Georgia, serif;Lucida Sans Unicode/Lucida Sans Unicode, Lucida Grande, sans-serif;Tahoma/Tahoma, Geneva, sans-serif;Times New Roman/Times New Roman, Times, serif;Trebuchet MS/Trebuchet MS, Helvetica, sans-serif;Verdana/Verdana, Geneva, sans-serif",CKEDITOR.config.font_defaultLabel="",CKEDITOR.config.font_style={element:"span",styles:{"font-family":"#(family)"},overrides:[{element:"font",attributes:{face:null}}]},CKEDITOR.config.fontSize_sizes="8/8px;9/9px;10/10px;11/11px;12/12px;14/14px;16/16px;18/18px;20/20px;22/22px;24/24px;26/26px;28/28px;36/36px;48/48px;72/72px",CKEDITOR.config.fontSize_defaultLabel="",CKEDITOR.config.fontSize_style={element:"span",styles:{"font-size":"#(size)"},overrides:[{element:"font",attributes:{size:null}}]},CKEDITOR.plugins.add("forms",{requires:"dialog,fakeobjects",onLoad:function(){CKEDITOR.addCss(".cke_editable form{border: 1px dotted #FF0000;padding: 2px;}\n"),CKEDITOR.addCss("img.cke_hidden{background-image: url("+CKEDITOR.getUrl(this.path+"images/hiddenfield.gif")+");background-position: center center;background-repeat: no-repeat;border: 1px solid #a9a9a9;width: 16px !important;height: 16px !important;}")},init:function(e){var t=e.lang,n=0,r={email:1,password:1,search:1,tel:1,text:1,url:1},i={checkbox:"input[type,name,checked]",radio:"input[type,name,checked]",textfield:"input[type,name,value,size,maxlength]",textarea:"textarea[cols,rows,name]",select:"select[name,size,multiple]; option[value,selected]",button:"input[type,name,value]",form:"form[action,name,id,enctype,target,method]",hiddenfield:"input[type,name,value]",imagebutton:"input[type,alt,src]{width,height,border,border-width,border-style,margin,float}"},s={checkbox:"input",radio:"input",textfield:"input",textarea:"textarea",select:"select",button:"input",form:"form",hiddenfield:"input",imagebutton:"input"},o=function(r,o,u){var a={allowedContent:i[o],requiredContent:s[o]};"form"==o&&(a.context="form"),e.addCommand(o,new CKEDITOR.dialogCommand(o,a)),e.ui.addButton&&e.ui.addButton(r,{label:t.common[r.charAt(0).toLowerCase()+r.slice(1)],command:o,toolbar:"forms,"+(n+=10)}),CKEDITOR.dialog.add(o,u)},u=this.path+"dialogs/";!e.blockless&&o("Form","form",u+"form.js"),o("Checkbox","checkbox",u+"checkbox.js"),o("Radio","radio",u+"radio.js"),o("TextField","textfield",u+"textfield.js"),o("Textarea","textarea",u+"textarea.js"),o("Select","select",u+"select.js"),o("Button","button",u+"button.js");var a=e.plugins.image;a&&!e.plugins.image2&&o("ImageButton","imagebutton",CKEDITOR.plugins.getPath("image")+"dialogs/image.js"),o("HiddenField","hiddenfield",u+"hiddenfield.js"),e.addMenuItems&&(o={checkbox:{label:t.forms.checkboxAndRadio.checkboxTitle,command:"checkbox",group:"checkbox"},radio:{label:t.forms.checkboxAndRadio.radioTitle,command:"radio",group:"radio"},textfield:{label:t.forms.textfield.title,command:"textfield",group:"textfield"},hiddenfield:{label:t.forms.hidden.title,command:"hiddenfield",group:"hiddenfield"},button:{label:t.forms.button.title,command:"button",group:"button"},select:{label:t.forms.select.title,command:"select",group:"select"},textarea:{label:t.forms.textarea.title,command:"textarea",group:"textarea"}},a&&(o.imagebutton={label:t.image.titleButton,command:"imagebutton",group:"imagebutton"}),!e.blockless&&(o.form={label:t.forms.form.menu,command:"form",group:"form"}),e.addMenuItems(o)),e.contextMenu&&(!e.blockless&&e.contextMenu.addListener(function(e,t,n){if((e=n.contains("form",1))&&!e.isReadOnly())return{form:CKEDITOR.TRISTATE_OFF}}),e.contextMenu.addListener(function(e){if(e&&!e.isReadOnly()){var t=e.getName();if(t=="select")return{select:CKEDITOR.TRISTATE_OFF};if(t=="textarea")return{textarea:CKEDITOR.TRISTATE_OFF};if(t=="input"){var n=e.getAttribute("type")||"text";switch(n){case"button":case"submit":case"reset":return{button:CKEDITOR.TRISTATE_OFF};case"checkbox":return{checkbox:CKEDITOR.TRISTATE_OFF};case"radio":return{radio:CKEDITOR.TRISTATE_OFF};case"image":return a?{imagebutton:CKEDITOR.TRISTATE_OFF}:null}if(r[n])return{textfield:CKEDITOR.TRISTATE_OFF}}if(t=="img"&&e.data("cke-real-element-type")=="hiddenfield")return{hiddenfield:CKEDITOR.TRISTATE_OFF}}})),e.on("doubleclick",function(t){var n=t.data.element;if(!e.blockless&&n.is("form"))t.data.dialog="form";else if(n.is("select"))t.data.dialog="select";else if(n.is("textarea"))t.data.dialog="textarea";else if(n.is("img")&&n.data("cke-real-element-type")=="hiddenfield")t.data.dialog="hiddenfield";else if(n.is("input")){n=n.getAttribute("type")||"text";switch(n){case"button":case"submit":case"reset":t.data.dialog="button";break;case"checkbox":t.data.dialog="checkbox";break;case"radio":t.data.dialog="radio";break;case"image":t.data.dialog="imagebutton"}r[n]&&(t.data.dialog="textfield")}})},afterInit:function(e){var t=e.dataProcessor,n=t&&t.htmlFilter,t=t&&t.dataFilter;CKEDITOR.env.ie&&n&&n.addRules({elements:{input:function(e){var e=e.attributes,t=e.type;t||(e.type="text"),("checkbox"==t||"radio"==t)&&"on"==e.value&&delete e.value}}},{applyToAll:!0}),t&&t.addRules({elements:{input:function(t){if("hidden"==t.attributes.type)return e.createFakeParserElement(t,"cke_hidden","hiddenfield")}}},{applyToAll:!0})}}),CKEDITOR.plugins.add("format",{requires:"richcombo",init:function(e){if(!e.blockless){for(var t=e.config,n=e.lang.format,r=t.format_tags.split(";"),i={},s=0,o=[],u=0;u<r.length;u++){var a=r[u],f=new CKEDITOR.style(t["format_"+a]);if(!e.filter.customConfig||e.filter.check(f))s++,i[a]=f,i[a]._.enterMode=e.config.enterMode,o.push(f)}0!==s&&e.ui.addRichCombo("Format",{label:n.label,title:n.panelTitle,toolbar:"styles,20",allowedContent:o,panel:{css:[CKEDITOR.skin.getPath("editor")].concat(t.contentsCss),multiSelect:!1,attributes:{"aria-label":n.panelTitle}},init:function(){this.startGroup(n.panelTitle);for(var e in i){var t=n["tag_"+e];this.add(e,i[e].buildPreview(t),t)}},onClick:function(t){e.focus(),e.fire("saveSnapshot");var t=i[t],n=e.elementPath();e[t.checkActive(n,e)?"removeStyle":"applyStyle"](t),setTimeout(function(){e.fire("saveSnapshot")},0)},onRender:function(){e.on("selectionChange",function(t){var n=this.getValue(),t=t.data.path;this.refresh();for(var r in i)if(i[r].checkActive(t,e)){r!=n&&this.setValue(r,e.lang.format["tag_"+r]);return}this.setValue("")},this)},onOpen:function(){this.showAll();for(var t in i)e.activeFilter.check(i[t])||this.hideItem(t)},refresh:function(){var t=e.elementPath();if(t){if(t.isContextFor("p"))for(var n in i)if(e.activeFilter.check(i[n]))return;this.setState(CKEDITOR.TRISTATE_DISABLED)}}})}}}),CKEDITOR.config.format_tags="p;h1;h2;h3;h4;h5;h6;pre;address;div",CKEDITOR.config.format_p={element:"p"},CKEDITOR.config.format_div={element:"div"},CKEDITOR.config.format_pre={element:"pre"},CKEDITOR.config.format_address={element:"address"},CKEDITOR.config.format_h1={element:"h1"},CKEDITOR.config.format_h2={element:"h2"},CKEDITOR.config.format_h3={element:"h3"},CKEDITOR.config.format_h4={element:"h4"},CKEDITOR.config.format_h5={element:"h5"},CKEDITOR.config.format_h6={element:"h6"},function(){var e={canUndo:!1,exec:function(e){var t=e.document.createElement("hr");e.insertElement(t)},allowedContent:"hr",requiredContent:"hr"};CKEDITOR.plugins.add("horizontalrule",{init:function(t){t.blockless||(t.addCommand("horizontalrule",e),t.ui.addButton&&t.ui.addButton("HorizontalRule",{label:t.lang.horizontalrule.toolbar,command:"horizontalrule",toolbar:"insert,40"}))}})}(),CKEDITOR.plugins.add("htmlwriter",{init:function(e){var t=new CKEDITOR.htmlWriter;t.forceSimpleAmpersand=e.config.forceSimpleAmpersand,t.indentationChars=e.config.dataIndentationChars||"	",e.dataProcessor.writer=t}}),CKEDITOR.htmlWriter=CKEDITOR.tools.createClass({base:CKEDITOR.htmlParser.basicWriter,$:function(){this.base(),this.indentationChars="	",this.selfClosingEnd=" />",this.lineBreakChars="\n",this.sortAttributes=1,this._.indent=0,this._.indentation="",this._.inPre=0,this._.rules={};var e=CKEDITOR.dtd,t;for(t in CKEDITOR.tools.extend({},e.$nonBodyContent,e.$block,e.$listItem,e.$tableContent))this.setRules(t,{indent:!e[t]["#"],breakBeforeOpen:1,breakBeforeClose:!e[t]["#"],breakAfterClose:1,needsSpace:t in e.$block&&!(t in{li:1,dt:1,dd:1})});this.setRules("br",{breakAfterOpen:1}),this.setRules("title",{indent:0,breakAfterOpen:0}),this.setRules("style",{indent:0,breakBeforeClose:1}),this.setRules("pre",{breakAfterOpen:1,indent:0})},proto:{openTag:function(e){var t=this._.rules[e];this._.afterCloser&&t&&t.needsSpace&&this._.needsSpace&&this._.output.push("\n"),this._.indent?this.indentation():t&&t.breakBeforeOpen&&(this.lineBreak(),this.indentation()),this._.output.push("<",e),this._.afterCloser=0},openTagClose:function(e,t){var n=this._.rules[e];t?(this._.output.push(this.selfClosingEnd),n&&n.breakAfterClose&&(this._.needsSpace=n.needsSpace)):(this._.output.push(">"),n&&n.indent&&(this._.indentation+=this.indentationChars)),n&&n.breakAfterOpen&&this.lineBreak(),"pre"==e&&(this._.inPre=1)},attribute:function(e,t){"string"==typeof t&&(this.forceSimpleAmpersand&&(t=t.replace(/&amp;/g,"&")),t=CKEDITOR.tools.htmlEncodeAttr(t)),this._.output.push(" ",e,'="',t,'"')},closeTag:function(e){var t=this._.rules[e];t&&t.indent&&(this._.indentation=this._.indentation.substr(this.indentationChars.length)),this._.indent?this.indentation():t&&t.breakBeforeClose&&(this.lineBreak(),this.indentation()),this._.output.push("</",e,">"),"pre"==e&&(this._.inPre=0),t&&t.breakAfterClose&&(this.lineBreak(),this._.needsSpace=t.needsSpace),this._.afterCloser=1},text:function(e){this._.indent&&(this.indentation(),!this._.inPre&&(e=CKEDITOR.tools.ltrim(e))),this._.output.push(e)},comment:function(e){this._.indent&&this.indentation(),this._.output.push("<!--",e,"-->")},lineBreak:function(){!this._.inPre&&0<this._.output.length&&this._.output.push(this.lineBreakChars),this._.indent=1},indentation:function(){!this._.inPre&&this._.indentation&&this._.output.push(this._.indentation),this._.indent=0},reset:function(){this._.output=[],this._.indent=0,this._.indentation="",this._.afterCloser=0,this._.inPre=0},setRules:function(e,t){var n=this._.rules[e];n?CKEDITOR.tools.extend(n,t,!0):this._.rules[e]=t}}}),function(){CKEDITOR.plugins.add("iframe",{requires:"dialog,fakeobjects",onLoad:function(){CKEDITOR.addCss("img.cke_iframe{background-image: url("+CKEDITOR.getUrl(this.path+"images/placeholder.png")+");background-position: center center;background-repeat: no-repeat;border: 1px solid #a9a9a9;width: 80px;height: 80px;}")},init:function(e){var t=e.lang.iframe,n="iframe[align,longdesc,frameborder,height,name,scrolling,src,title,width]";e.plugins.dialogadvtab&&(n+=";iframe"+e.plugins.dialogadvtab.allowedContent({id:1,classes:1,styles:1})),CKEDITOR.dialog.add("iframe",this.path+"dialogs/iframe.js"),e.addCommand("iframe",new CKEDITOR.dialogCommand("iframe",{allowedContent:n,requiredContent:"iframe"})),e.ui.addButton&&e.ui.addButton("Iframe",{label:t.toolbar,command:"iframe",toolbar:"insert,80"}),e.on("doubleclick",function(e){var t=e.data.element;t.is("img")&&"iframe"==t.data("cke-real-element-type")&&(e.data.dialog="iframe")}),e.addMenuItems&&e.addMenuItems({iframe:{label:t.title,command:"iframe",group:"image"}}),e.contextMenu&&e.contextMenu.addListener(function(e){if(e&&e.is("img")&&"iframe"==e.data("cke-real-element-type"))return{iframe:CKEDITOR.TRISTATE_OFF}})},afterInit:function(e){var t=e.dataProcessor;(t=t&&t.dataFilter)&&t.addRules({elements:{iframe:function(t){return e.createFakeParserElement(t,"cke_iframe","iframe",!0)}}})}})}(),function(){function e(e){var n=this.editor,r=e.document,i=r.body,s=r.getElementById("cke_actscrpt");s&&s.parentNode.removeChild(s),(s=r.getElementById("cke_shimscrpt"))&&s.parentNode.removeChild(s),(s=r.getElementById("cke_basetagscrpt"))&&s.parentNode.removeChild(s),CKEDITOR.env.gecko&&(i.contentEditable=!1,2e4>CKEDITOR.env.version&&(i.innerHTML=i.innerHTML.replace(/^.*<\!-- cke-content-start --\>/,""),setTimeout(function(){var e=new CKEDITOR.dom.range(new CKEDITOR.dom.document(r));e.setStart(new CKEDITOR.dom.node(i),0),n.getSelection().selectRanges([e])},0))),i.contentEditable=!0,CKEDITOR.env.ie&&(i.hideFocus=!0,i.disabled=!0,i.removeAttribute("disabled")),delete this._.isLoadingData,this.$=i,r=new CKEDITOR.dom.document(r),this.setup(),CKEDITOR.env.ie&&(r.getDocumentElement().addClass(r.$.compatMode),n.config.enterMode!=CKEDITOR.ENTER_P&&this.attachListener(r,"selectionchange",function(){var e=r.getBody(),t=n.getSelection(),i=t&&t.getRanges()[0];i&&e.getHtml().match(/^<p>(?:&nbsp;|<br>)<\/p>$/i)&&i.startContainer.equals(e)&&setTimeout(function(){i=n.getSelection().getRanges()[0],i.startContainer.equals("body")||(e.getFirst().remove(1),i.moveToElementEditEnd(e),i.select())},0)})),(CKEDITOR.env.webkit||CKEDITOR.env.ie&&10<CKEDITOR.env.version)&&r.getDocumentElement().on("mousedown",function(e){e.data.getTarget().is("html")&&setTimeout(function(){n.editable().focus()})}),t(n);try{n.document.$.execCommand("2D-position",!1,!0)}catch(o){}(CKEDITOR.env.gecko||CKEDITOR.env.ie&&"CSS1Compat"==n.document.$.compatMode)&&this.attachListener(this,"keydown",function(e){var t=e.data.getKeystroke();if(t==33||t==34)if(CKEDITOR.env.ie)setTimeout(function(){n.getSelection().scrollIntoView()},0);else if(n.window.$.innerHeight>this.$.offsetHeight){var r=n.createRange();r[t==33?"moveToElementEditStart":"moveToElementEditEnd"](this),r.select(),e.data.preventDefault()}}),CKEDITOR.env.ie&&this.attachListener(r,"blur",function(){try{r.$.selection.empty()}catch(e){}}),CKEDITOR.env.iOS&&this.attachListener(r,"touchend",function(){e.focus()}),n.document.getElementsByTag("title").getItem(0).data("cke-title",n.document.$.title),CKEDITOR.env.ie&&(n.document.$.title=this._.docTitle),CKEDITOR.tools.setTimeout(function(){this.status=="unloaded"&&(this.status="ready"),n.fire("contentDom"),this._.isPendingFocus&&(n.focus(),this._.isPendingFocus=!1),setTimeout(function(){n.fire("dataReady")},0),CKEDITOR.env.ie&&setTimeout(function(){if(n.document){var e=n.document.$.body;e.runtimeStyle.marginBottom="0px",e.runtimeStyle.marginBottom=""}},1e3)},0,this)}function t(e){function t(){var t;e.editable().attachListener(e,"selectionChange",function(){var r=e.getSelection().getSelectedElement();r&&(t&&(t.detachEvent("onresizestart",n),t=null),r.$.attachEvent("onresizestart",n),t=r.$)})}function n(e){e.returnValue=!1}if(CKEDITOR.env.gecko)try{var r=e.document.$;r.execCommand("enableObjectResizing",!1,!e.config.disableObjectResizing),r.execCommand("enableInlineTableEditing",!1,!e.config.disableNativeTableHandles)}catch(i){}else CKEDITOR.env.ie&&11>CKEDITOR.env.version&&e.config.disableObjectResizing&&t(e)}function n(){var e=[];if(8<=CKEDITOR.document.$.documentMode){e.push("html.CSS1Compat [contenteditable=false]{min-height:0 !important}");var t=[],n;for(n in CKEDITOR.dtd.$removeEmpty)t.push("html.CSS1Compat "+n+"[contenteditable=false]");e.push(t.join(",")+"{display:inline-block}")}else CKEDITOR.env.gecko&&(e.push("html{height:100% !important}"),e.push("img:-moz-broken{-moz-force-broken-image-icon:1;min-width:24px;min-height:24px}"));return e.push("html{cursor:text;*cursor:auto}"),e.push("img,input,textarea{cursor:default}"),e.join("\n")}CKEDITOR.plugins.add("wysiwygarea",{init:function(e){e.config.fullPage&&e.addFeature({allowedContent:"html head title; style [media,type]; body (*)[id]; meta link [*]",requiredContent:"body"}),e.addMode("wysiwyg",function(t){function n(n){n&&n.removeListener(),e.editable(new r(e,s.$.contentWindow.document.body)),e.setData(e.getData(1),t)}var i="document.open();"+(CKEDITOR.env.ie?"("+CKEDITOR.tools.fixDomain+")();":"")+"document.close();",i=CKEDITOR.env.air?"javascript:void(0)":CKEDITOR.env.ie?"javascript:void(function(){"+encodeURIComponent(i)+"}())":"",s=CKEDITOR.dom.element.createFromHtml('<iframe src="'+i+'" frameBorder="0"></iframe>');s.setStyles({width:"100%",height:"100%"}),s.addClass("cke_wysiwyg_frame cke_reset");var o=e.ui.space("contents");o.append(s),(i=CKEDITOR.env.ie||CKEDITOR.env.gecko)&&s.on("load",n);var u=e.title,f=e.fire("ariaEditorHelpLabel",{}).label;u&&(CKEDITOR.env.ie&&f&&(u+=", "+f),s.setAttribute("title",u));if(f){var u=CKEDITOR.tools.getNextId(),l=CKEDITOR.dom.element.createFromHtml('<span id="'+u+'" class="cke_voice_label">'+f+"</span>");o.append(l,1),s.setAttribute("aria-describedby",u)}e.on("beforeModeUnload",function(e){e.removeListener(),l&&l.remove()}),s.setAttributes({tabIndex:e.tabIndex,allowTransparency:"true"}),!i&&n(),CKEDITOR.env.webkit&&(i=function(){o.setStyle("width","100%"),s.hide(),s.setSize("width",o.getSize("width")),o.removeStyle("width"),s.show()},s.setCustomData("onResize",i),CKEDITOR.document.getWindow().on("resize",i)),e.fire("ariaWidget",s)})}}),CKEDITOR.editor.prototype.addContentsCss=function(e){var t=this.config,n=t.contentsCss;CKEDITOR.tools.isArray(n)||(t.contentsCss=n?[n]:[]),t.contentsCss.push(e)};var r=CKEDITOR.tools.createClass({$:function(t){this.base.apply(this,arguments),this._.frameLoadedHandler=CKEDITOR.tools.addFunction(function(t){CKEDITOR.tools.setTimeout(e,0,this,t)},this),this._.docTitle=this.getWindow().getFrame().getAttribute("title")},base:CKEDITOR.editable,proto:{setData:function(e,t){var r=this.editor;if(t)this.setHtml(e),r.fire("dataReady");else{this._.isLoadingData=!0,r._.dataStore={id:1};var i=r.config,s=i.fullPage,o=i.docType,u=CKEDITOR.tools.buildStyleHtml(n()).replace(/<style>/,'<style data-cke-temp="1">');s||(u+=CKEDITOR.tools.buildStyleHtml(r.config.contentsCss));var a=i.baseHref?'<base href="'+i.baseHref+'" data-cke-temp="1" />':"";s&&(e=e.replace(/<!DOCTYPE[^>]*>/i,function(e){return r.docType=o=e,""}).replace(/<\?xml\s[^\?]*\?>/i,function(e){return r.xmlDeclaration=e,""})),e=r.dataProcessor.toHtml(e),s?(/<body[\s|>]/.test(e)||(e="<body>"+e),/<html[\s|>]/.test(e)||(e="<html>"+e+"</html>"),/<head[\s|>]/.test(e)?/<title[\s|>]/.test(e)||(e=e.replace(/<head[^>]*>/,"$&<title></title>")):e=e.replace(/<html[^>]*>/,"$&<head><title></title></head>"),a&&(e=e.replace(/<head>/,"$&"+a)),e=e.replace(/<\/head\s*>/,u+"$&"),e=o+e):e=i.docType+'<html dir="'+i.contentsLangDirection+'" lang="'+(i.contentsLanguage||r.langCode)+'"><head><title>'+this._.docTitle+"</title>"+a+u+"</head><body"+(i.bodyId?' id="'+i.bodyId+'"':"")+(i.bodyClass?' class="'+i.bodyClass+'"':"")+">"+e+"</body></html>",CKEDITOR.env.gecko&&(e=e.replace(/<body/,'<body contenteditable="true" '),2e4>CKEDITOR.env.version&&(e=e.replace(/<body[^>]*>/,"$&<!-- cke-content-start -->"))),i='<script id="cke_actscrpt" type="text/javascript"'+(CKEDITOR.env.ie?' defer="defer" ':"")+">var wasLoaded=0;function onload(){if(!wasLoaded)window.parent.CKEDITOR.tools.callFunction("+this._.frameLoadedHandler+",window);wasLoaded=1;}"+(CKEDITOR.env.ie?"onload();":'document.addEventListener("DOMContentLoaded", onload, false );')+"</script>",CKEDITOR.env.ie&&9>CKEDITOR.env.version&&(i+='<script id="cke_shimscrpt">window.parent.CKEDITOR.tools.enableHtml5Elements(document)</script>'),a&&CKEDITOR.env.ie&&10>CKEDITOR.env.version&&(i+='<script id="cke_basetagscrpt">var baseTag = document.querySelector( "base" );baseTag.href = baseTag.href;</script>'),e=e.replace(/(?=\s*<\/(:?head)>)/,i),this.clearCustomData(),this.clearListeners(),r.fire("contentDomUnload");var f=this.getDocument();try{f.write(e)}catch(l){setTimeout(function(){f.write(e)},0)}}},getData:function(e){if(e)return this.getHtml();var e=this.editor,t=e.config,n=t.fullPage,r=n&&e.docType,i=n&&e.xmlDeclaration,s=this.getDocument(),n=n?s.getDocumentElement().getOuterHtml():s.getBody().getHtml();return CKEDITOR.env.gecko&&t.enterMode!=CKEDITOR.ENTER_BR&&(n=n.replace(/<br>(?=\s*(:?$|<\/body>))/,"")),n=e.dataProcessor.toDataFormat(n),i&&(n=i+"\n"+n),r&&(n=r+"\n"+n),n},focus:function(){this._.isLoadingData?this._.isPendingFocus=!0:r.baseProto.focus.call(this)},detach:function(){var e=this.editor,t=e.document,e=e.window.getFrame();r.baseProto.detach.call(this),this.clearCustomData(),t.getDocumentElement().clearCustomData(),e.clearCustomData(),CKEDITOR.tools.removeFunction(this._.frameLoadedHandler),(t=e.removeCustomData("onResize"))&&t.removeListener(),e.remove()}}})}(),CKEDITOR.config.disableObjectResizing=!1,CKEDITOR.config.disableNativeTableHandles=!0,CKEDITOR.config.disableNativeSpellChecker=!0,CKEDITOR.config.contentsCss=CKEDITOR.getUrl("contents.css"),function(){function e(e,t){t||(t=e.getSelection().getSelectedElement());if(t&&t.is("img")&&!t.data("cke-realelement")&&!t.isReadOnly())return t}function t(e){var t=e.getStyle("float");if("inherit"==t||"none"==t)t=0;return t||(t=e.getAttribute("align")),t}CKEDITOR.plugins.add("image",{requires:"dialog",init:function(t){if(!t.plugins.image2){CKEDITOR.dialog.add("image",this.path+"dialogs/image.js");var n="img[alt,!src]{border-style,border-width,float,height,margin,margin-bottom,margin-left,margin-right,margin-top,width}";CKEDITOR.dialog.isTabEnabled(t,"image","advanced")&&(n="img[alt,dir,id,lang,longdesc,!src,title]{*}(*)"),t.addCommand("image",new CKEDITOR.dialogCommand("image",{allowedContent:n,requiredContent:"img[alt,src]",contentTransformations:[["img{width}: sizeToStyle","img[width]: sizeToAttribute"],["img{float}: alignmentToStyle","img[align]: alignmentToAttribute"]]})),t.ui.addButton&&t.ui.addButton("Image",{label:t.lang.common.image,command:"image",toolbar:"insert,10"}),t.on("doubleclick",function(e){var t=e.data.element;t.is("img")&&!t.data("cke-realelement")&&!t.isReadOnly()&&(e.data.dialog="image")}),t.addMenuItems&&t.addMenuItems({image:{label:t.lang.image.menu,command:"image",group:"image"}}),t.contextMenu&&t.contextMenu.addListener(function(n){if(e(t,n))return{image:CKEDITOR.TRISTATE_OFF}})}},afterInit:function(n){function r(r){var i=n.getCommand("justify"+r);i&&(("left"==r||"right"==r)&&i.on("exec",function(i){var s=e(n),o;s&&(o=t(s),o==r?(s.removeStyle("float"),r==t(s)&&s.removeAttribute("align")):s.setStyle("float",r),i.cancel())}),i.on("refresh",function(i){var s=e(n);s&&(s=t(s),this.setState(s==r?CKEDITOR.TRISTATE_ON:"right"==r||"left"==r?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED),i.cancel())}))}n.plugins.image2||(r("left"),r("right"),r("center"),r("block"))}})}(),CKEDITOR.config.image_removeLinkByEmptyURL=!0,function(){function e(e,r){var s,o;r.on("refresh",function(e){var r=[t],s;for(s in e.data.states)r.push(e.data.states[s]);this.setState(CKEDITOR.tools.search(r,n)?n:t)},r,null,100),r.on("exec",function(t){s=e.getSelection(),o=s.createBookmarks(1),t.data||(t.data={}),t.data.done=!1},r,null,0),r.on("exec",function(){e.forceNextSelectionCheck(),s.selectBookmarks(o)},r,null,100)}var t=CKEDITOR.TRISTATE_DISABLED,n=CKEDITOR.TRISTATE_OFF;CKEDITOR.plugins.add("indent",{init:function(t){var n=CKEDITOR.plugins.indent.genericDefinition;e(t,t.addCommand("indent",new n(!0))),e(t,t.addCommand("outdent",new n)),t.ui.addButton&&(t.ui.addButton("Indent",{label:t.lang.indent.indent,command:"indent",directional:!0,toolbar:"indent,20"}),t.ui.addButton("Outdent",{label:t.lang.indent.outdent,command:"outdent",directional:!0,toolbar:"indent,10"})),t.on("dirChanged",function(e){var n=t.createRange(),r=e.data.node;n.setStartBefore(r),n.setEndAfter(r);for(var i=new CKEDITOR.dom.walker(n),s;s=i.next();)if(s.type==CKEDITOR.NODE_ELEMENT)if(!s.equals(r)&&s.getDirection())n.setStartAfter(s),i=new CKEDITOR.dom.walker(n);else{var o=t.config.indentClasses;if(o)for(var u=e.data.dir=="ltr"?["_rtl",""]:["","_rtl"],f=0;f<o.length;f++)s.hasClass(o[f]+u[0])&&(s.removeClass(o[f]+u[0]),s.addClass(o[f]+u[1]));o=s.getStyle("margin-right"),u=s.getStyle("margin-left"),o?s.setStyle("margin-left",o):s.removeStyle("margin-left"),u?s.setStyle("margin-right",u):s.removeStyle("margin-right")}})}}),CKEDITOR.plugins.indent={genericDefinition:function(e){this.isIndent=!!e,this.startDisabled=!this.isIndent},specificDefinition:function(e,t,n){this.name=t,this.editor=e,this.jobs={},this.enterBr=e.config.enterMode==CKEDITOR.ENTER_BR,this.isIndent=!!n,this.relatedGlobal=n?"indent":"outdent",this.indentKey=n?9:CKEDITOR.SHIFT+9,this.database={}},registerCommands:function(e,t){e.on("pluginsLoaded",function(){for(var e in t)(function(e,t){var n=e.getCommand(t.relatedGlobal),r;for(r in t.jobs)n.on("exec",function(n){n.data.done||(e.fire("lockSnapshot"),t.execJob(e,r)&&(n.data.done=!0),e.fire("unlockSnapshot"),CKEDITOR.dom.element.clearAllMarkers(t.database))},this,null,r),n.on("refresh",function(n){n.data.states||(n.data.states={}),n.data.states[t.name+"@"+r]=t.refreshJob(e,r,n.data.path)},this,null,r);e.addFeature(t)})(this,t[e])})}},CKEDITOR.plugins.indent.genericDefinition.prototype={context:"p",exec:function(){}},CKEDITOR.plugins.indent.specificDefinition.prototype={execJob:function(e,n){var r=this.jobs[n];if(r.state!=t)return r.exec.call(this,e)},refreshJob:function(e,n,r){return n=this.jobs[n],n.state=e.activeFilter.checkFeature(this)?n.refresh.call(this,e,r):t,n.state},getContext:function(e){return e.contains(this.context)}}}(),function(){function e(e,n,r){if(!e.getCustomData("indent_processed")){var i=this.editor,s=this.isIndent;if(n){i=e.$.className.match(this.classNameRegex),r=0,i&&(i=i[1],r=CKEDITOR.tools.indexOf(n,i)+1);if(0>(r+=s?1:-1))return;r=Math.min(r,n.length),r=Math.max(r,0),e.$.className=CKEDITOR.tools.ltrim(e.$.className.replace(this.classNameRegex,"")),0<r&&e.addClass(n[r-1])}else{var n=t(e,r),r=parseInt(e.getStyle(n),10),o=i.config.indentOffset||40;isNaN(r)&&(r=0),r+=(s?1:-1)*o;if(0>r)return;r=Math.max(r,0),r=Math.ceil(r/o)*o,e.setStyle(n,r?r+(i.config.indentUnit||"px"):""),""===e.getAttribute("style")&&e.removeAttribute("style")}CKEDITOR.dom.element.setMarker(this.database,e,"indent_processed",1)}}function t(e,t){return"ltr"==(t||e.getComputedStyle("direction"))?"margin-left":"margin-right"}var n=CKEDITOR.dtd.$listItem,r=CKEDITOR.dtd.$list,i=CKEDITOR.TRISTATE_DISABLED,s=CKEDITOR.TRISTATE_OFF;CKEDITOR.plugins.add("indentblock",{requires:"indent",init:function(o){function u(o,u){a.specificDefinition.apply(this,arguments),this.allowedContent={"div h1 h2 h3 h4 h5 h6 ol p pre ul":{propertiesOnly:!0,styles:c?null:"margin-left,margin-right",classes:c||null}},this.enterBr&&(this.allowedContent.div=!0),this.requiredContent=(this.enterBr?"div":"p")+(c?"("+c.join(",")+")":"{margin-left}"),this.jobs={20:{refresh:function(e,r){var o=r.block||r.blockLimit;if(o.is(n))o=o.getParent();else if(o.getAscendant(n))return i;if(!this.enterBr&&!this.getContext(r))return i;if(c){var u;u=c;var o=o.$.className.match(this.classNameRegex),a=this.isIndent;return u=o?a?o[1]!=u.slice(-1):!0:a,u?s:i}return this.isIndent?s:o?CKEDITOR[(parseInt(o.getStyle(t(o)),10)||0)<=0?"TRISTATE_DISABLED":"TRISTATE_OFF"]:i},exec:function(t){var n=t.getSelection(),n=n&&n.getRanges()[0],i;if(i=t.elementPath().contains(r))e.call(this,i,c);else{n=n.createIterator(),t=t.config.enterMode,n.enforceRealBlocks=!0;for(n.enlargeBr=t!=CKEDITOR.ENTER_BR;i=n.getNextParagraph(t==CKEDITOR.ENTER_P?"p":"div");)i.isReadOnly()||e.call(this,i,c)}return!0}}}}var a=CKEDITOR.plugins.indent,c=o.config.indentClasses;a.registerCommands(o,{indentblock:new u(o,"indentblock",!0),outdentblock:new u(o,"outdentblock")}),CKEDITOR.tools.extend(u.prototype,a.specificDefinition.prototype,{context:{div:1,dl:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,ul:1,ol:1,p:1,pre:1,table:1},classNameRegex:c?RegExp("(?:^|\\s+)("+c.join("|")+")(?=$|\\s)"):null})}})}(),function(){function e(e){function t(t){for(var n=a.startContainer,u=a.endContainer;n&&!n.getParent().equals(t);)n=n.getParent();for(;u&&!u.getParent().equals(t);)u=u.getParent();if(!n||!u)return!1;for(var f=n,n=[],l=!1;!l;)f.equals(u)&&(l=!0),n.push(f),f=f.getNext();if(1>n.length)return!1;f=t.getParents(!0);for(u=0;u<f.length;u++)if(f[u].getName&&o[f[u].getName()]){t=f[u];break}for(var f=i.isIndent?1:-1,u=n[0],n=n[n.length-1],l=CKEDITOR.plugins.list.listToArray(t,s),c=l[n.getCustomData("listarray_index")].indent,u=u.getCustomData("listarray_index");u<=n.getCustomData("listarray_index");u++)if(l[u].indent+=f,0<f){var h=l[u].parent;l[u].parent=new CKEDITOR.dom.element(h.getName(),h.getDocument())}for(u=n.getCustomData("listarray_index")+1;u<l.length&&l[u].indent>c;u++)l[u].indent+=f;n=CKEDITOR.plugins.list.arrayToList(l,s,null,e.config.enterMode,t.getDirection());if(!i.isIndent){var p;if((p=t.getParent())&&p.is("li"))for(var f=n.listNode.getChildren(),v=[],m,u=f.count()-1;0<=u;u--)(m=f.getItem(u))&&m.is&&m.is("li")&&v.push(m)}n&&n.listNode.replace(t);if(v&&v.length)for(u=0;u<v.length;u++){for(m=t=v[u];(m=m.getNext())&&m.is&&m.getName()in o;)CKEDITOR.env.needsNbspFiller&&!t.getFirst(r)&&t.append(a.document.createText(" ")),t.append(m);t.insertAfter(p)}return n&&e.fire("contentDomInvalidated"),!0}for(var i=this,s=this.database,o=this.context,u=e.getSelection(),u=(u&&u.getRanges()).createIterator(),a;a=u.getNextRange();){for(var f=a.getCommonAncestor();f&&(f.type!=CKEDITOR.NODE_ELEMENT||!o[f.getName()]);)f=f.getParent();f||(f=a.startPath().contains(o))&&a.setEndAt(f,CKEDITOR.POSITION_BEFORE_END);if(!f){var l=a.getEnclosedNode();l&&l.type==CKEDITOR.NODE_ELEMENT&&l.getName()in o&&(a.setStartAt(l,CKEDITOR.POSITION_AFTER_START),a.setEndAt(l,CKEDITOR.POSITION_BEFORE_END),f=l)}f&&a.startContainer.type==CKEDITOR.NODE_ELEMENT&&a.startContainer.getName()in o&&(l=new CKEDITOR.dom.walker(a),l.evaluator=n,a.startContainer=l.next()),f&&a.endContainer.type==CKEDITOR.NODE_ELEMENT&&a.endContainer.getName()in o&&(l=new CKEDITOR.dom.walker(a),l.evaluator=n,a.endContainer=l.previous());if(f)return t(f)}return 0}function t(e,t){return t||(t=e.contains(this.context)),t&&e.block&&e.block.equals(t.getFirst(n))}function n(e){return e.type==CKEDITOR.NODE_ELEMENT&&e.is("li")}function r(e){return i(e)&&s(e)}var i=CKEDITOR.dom.walker.whitespaces(!0),s=CKEDITOR.dom.walker.bookmark(!1,!0),o=CKEDITOR.TRISTATE_DISABLED,u=CKEDITOR.TRISTATE_OFF;CKEDITOR.plugins.add("indentlist",{requires:"indent",init:function(n){function r(n,r){i.specificDefinition.apply(this,arguments),this.requiredContent=["ul","ol"],n.on("key",function(e){if("wysiwyg"==n.mode&&e.data.keyCode==this.indentKey){var r=this.getContext(n.elementPath());r&&(!this.isIndent||!t.call(this,n.elementPath(),r))&&(n.execCommand(this.relatedGlobal),e.cancel())}},this),this.jobs[this.isIndent?10:30]={refresh:this.isIndent?function(e,n){var r=this.getContext(n),i=t.call(this,n,r);return!r||!this.isIndent||i?o:u}:function(e,t){return!this.getContext(t)||this.isIndent?o:u},exec:CKEDITOR.tools.bind(e,this)}}var i=CKEDITOR.plugins.indent;i.registerCommands(n,{indentlist:new r(n,"indentlist",!0),outdentlist:new r(n,"outdentlist")}),CKEDITOR.tools.extend(r.prototype,i.specificDefinition.prototype,{context:{ol:1,ul:1}})}})}(),CKEDITOR.plugins.add("smiley",{requires:"dialog",init:function(e){e.config.smiley_path=e.config.smiley_path||this.path+"images/",e.addCommand("smiley",new CKEDITOR.dialogCommand("smiley",{allowedContent:"img[alt,height,!src,title,width]",requiredContent:"img"})),e.ui.addButton&&e.ui.addButton("Smiley",{label:e.lang.smiley.toolbar,command:"smiley",toolbar:"insert,50"}),CKEDITOR.dialog.add("smiley",this.path+"dialogs/smiley.js")}}),CKEDITOR.config.smiley_images="regular_smile.png sad_smile.png wink_smile.png teeth_smile.png confused_smile.png tongue_smile.png embarrassed_smile.png omg_smile.png whatchutalkingabout_smile.png angry_smile.png angel_smile.png shades_smile.png devil_smile.png cry_smile.png lightbulb.png thumbs_down.png thumbs_up.png heart.png broken_heart.png kiss.png envelope.png".split(" "),CKEDITOR.config.smiley_descriptions="smiley;sad;wink;laugh;frown;cheeky;blush;surprise;indecision;angry;angel;cool;devil;crying;enlightened;no;yes;heart;broken heart;kiss;mail".split(";"),function(){function e(e,t){var t=void 0===t||t,n;if(t)n=e.getComputedStyle("text-align");else{for(;!e.hasAttribute||!e.hasAttribute("align")&&!e.getStyle("text-align");){n=e.getParent();if(!n)break;e=n}n=e.getStyle("text-align")||e.getAttribute("align")||""}return n&&(n=n.replace(/(?:-(?:moz|webkit)-)?(?:start|auto)/i,"")),!n&&t&&(n="rtl"==e.getComputedStyle("direction")?"right":"left"),n}function t(e,t,n){this.editor=e,this.name=t,this.value=n,this.context="p";var t=e.config.justifyClasses,r=e.config.enterMode==CKEDITOR.ENTER_P?"p":"div";if(t){switch(n){case"left":this.cssClassName=t[0];break;case"center":this.cssClassName=t[1];break;case"right":this.cssClassName=t[2];break;case"justify":this.cssClassName=t[3]}this.cssClassRegex=RegExp("(?:^|\\s+)(?:"+t.join("|")+")(?=$|\\s)"),this.requiredContent=r+"("+this.cssClassName+")"}else this.requiredContent=r+"{text-align}";this.allowedContent={"caption div h1 h2 h3 h4 h5 h6 p pre td th li":{propertiesOnly:!0,styles:this.cssClassName?null:"text-align",classes:this.cssClassName||null}},e.config.enterMode==CKEDITOR.ENTER_BR&&(this.allowedContent.div=!0)}function n(e){var t=e.editor,n=t.createRange();n.setStartBefore(e.data.node),n.setEndAfter(e.data.node);for(var r=new CKEDITOR.dom.walker(n),i;i=r.next();)if(i.type==CKEDITOR.NODE_ELEMENT)if(!i.equals(e.data.node)&&i.getDirection())n.setStartAfter(i),r=new CKEDITOR.dom.walker(n);else{var s=t.config.justifyClasses;s&&(i.hasClass(s[0])?(i.removeClass(s[0]),i.addClass(s[2])):i.hasClass(s[2])&&(i.removeClass(s[2]),i.addClass(s[0]))),s=i.getStyle("text-align"),"left"==s?i.setStyle("text-align","right"):"right"==s&&i.setStyle("text-align","left")}}t.prototype={exec:function(t){var n=t.getSelection(),r=t.config.enterMode;if(n){for(var i=n.createBookmarks(),s=n.getRanges(),o=this.cssClassName,u,a,f=t.config.useComputedState,f=void 0===f||f,c=s.length-1;0<=c;c--){u=s[c].createIterator();for(u.enlargeBr=r!=CKEDITOR.ENTER_BR;a=u.getNextParagraph(r==CKEDITOR.ENTER_P?"p":"div");)if(!a.isReadOnly()){a.removeAttribute("align"),a.removeStyle("text-align");var h=o&&(a.$.className=CKEDITOR.tools.ltrim(a.$.className.replace(this.cssClassRegex,""))),p=this.state==CKEDITOR.TRISTATE_OFF&&(!f||e(a,!0)!=this.value);o?p?a.addClass(o):h||a.removeAttribute("class"):p&&a.setStyle("text-align",this.value)}}t.focus(),t.forceNextSelectionCheck(),n.selectBookmarks(i)}},refresh:function(t,n){var r=n.block||n.blockLimit;this.setState("body"!=r.getName()&&e(r,this.editor.config.useComputedState)==this.value?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF)}},CKEDITOR.plugins.add("justify",{init:function(e){if(!e.blockless){var r=new t(e,"justifyleft","left"),i=new t(e,"justifycenter","center"),s=new t(e,"justifyright","right"),o=new t(e,"justifyblock","justify");e.addCommand("justifyleft",r),e.addCommand("justifycenter",i),e.addCommand("justifyright",s),e.addCommand("justifyblock",o),e.ui.addButton&&(e.ui.addButton("JustifyLeft",{label:e.lang.justify.left,command:"justifyleft",toolbar:"align,10"}),e.ui.addButton("JustifyCenter",{label:e.lang.justify.center,command:"justifycenter",toolbar:"align,20"}),e.ui.addButton("JustifyRight",{label:e.lang.justify.right,command:"justifyright",toolbar:"align,30"}),e.ui.addButton("JustifyBlock",{label:e.lang.justify.block,command:"justifyblock",toolbar:"align,40"})),e.on("dirChanged",n)}}})}(),CKEDITOR.plugins.add("menubutton",{requires:"button,menu",onLoad:function(){var e=function(e){var t=this._,n=t.menu;t.state!==CKEDITOR.TRISTATE_DISABLED&&(t.on&&n?n.hide():(t.previousState=t.state,n||(n=t.menu=new CKEDITOR.menu(e,{panel:{className:"cke_menu_panel",attributes:{"aria-label":e.lang.common.options}}}),n.onHide=CKEDITOR.tools.bind(function(){var n=this.command?e.getCommand(this.command).modes:this.modes;this.setState(!n||n[e.mode]?t.previousState:CKEDITOR.TRISTATE_DISABLED),t.on=0},this),this.onMenu&&n.addListener(this.onMenu)),this.setState(CKEDITOR.TRISTATE_ON),t.on=1,setTimeout(function(){n.show(CKEDITOR.document.getById(t.id),4)},0)))};CKEDITOR.ui.menuButton=CKEDITOR.tools.createClass({base:CKEDITOR.ui.button,$:function(t){delete t.panel,this.base(t),this.hasArrow=!0,this.click=e},statics:{handler:{create:function(e){return new CKEDITOR.ui.menuButton(e)}}}})},beforeInit:function(e){e.ui.addHandler(CKEDITOR.UI_MENUBUTTON,CKEDITOR.ui.menuButton.handler)}}),CKEDITOR.UI_MENUBUTTON="menubutton",function(){CKEDITOR.plugins.add("language",{requires:"menubutton",init:function(e){var t=e.config.language_list||["ar:Arabic:rtl","fr:French","es:Spanish"],n=this,r=e.lang.language,i={},s,o,u,a;e.addCommand("language",{allowedContent:"span[!lang,!dir]",requiredContent:"span[lang,dir]",contextSensitive:!0,exec:function(e,t){var n=i["language_"+t];n&&e[n.style.checkActive(e.elementPath(),e)?"removeStyle":"applyStyle"](n.style)},refresh:function(e){this.setState(n.getCurrentLangElement(e)?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF)}});for(a=0;a<t.length;a++)s=t[a].split(":"),o=s[0],u="language_"+o,i[u]={label:s[1],langId:o,group:"language",order:a,ltr:"rtl"!=(""+s[2]).toLowerCase(),onClick:function(){e.execCommand("language",this.langId)},role:"menuitemcheckbox"},i[u].style=new CKEDITOR.style({element:"span",attributes:{lang:o,dir:i[u].ltr?"ltr":"rtl"}});i.language_remove={label:r.remove,group:"language_remove",state:CKEDITOR.TRISTATE_DISABLED,order:i.length,onClick:function(){var t=n.getCurrentLangElement(e);t&&e.execCommand("language",t.getAttribute("lang"))}},e.addMenuGroup("language",1),e.addMenuGroup("language_remove"),e.addMenuItems(i),e.ui.add("Language",CKEDITOR.UI_MENUBUTTON,{label:r.button,allowedContent:"span[!lang,!dir]",requiredContent:"span[lang,dir]",toolbar:"bidi,30",command:"language",onMenu:function(){var t={},r=n.getCurrentLangElement(e),s;for(s in i)t[s]=CKEDITOR.TRISTATE_OFF;return t.language_remove=r?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,r&&(t["language_"+r.getAttribute("lang")]=CKEDITOR.TRISTATE_ON),t}})},getCurrentLangElement:function(e){var t=e.elementPath(),e=t&&t.elements,n;if(t)for(var r=0;r<e.length;r++)t=e[r],!n&&"span"==t.getName()&&t.hasAttribute("dir")&&t.hasAttribute("lang")&&(n=t);return n}})}(),function(){function e(e){return e.replace(/'/g,"\\$&")}function t(e){for(var t,n=e.length,r=[],i=0;i<n;i++)t=e.charCodeAt(i),r.push(t);return"String.fromCharCode("+r.join(",")+")"}function n(t,n){var r=t.plugins.link,i=r.compiledProtectionFunction.params,s,o;o=[r.compiledProtectionFunction.name,"("];for(var u=0;u<i.length;u++)r=i[u].toLowerCase(),s=n[r],0<u&&o.push(","),o.push("'",s?e(encodeURIComponent(n[r])):"","'");return o.push(")"),o.join("")}function r(e){var e=e.config.emailProtection||"",t;return e&&"encode"!=e&&(t={},e.replace(/^([^(]+)\(([^)]+)\)$/,function(e,n,r){t.name=n,t.params=[],r.replace(/[^,\s]+/g,function(e){t.params.push(e)})})),t}CKEDITOR.plugins.add("link",{requires:"dialog,fakeobjects",onLoad:function(){function e(e){return n.replace(/%1/g,"rtl"==e?"right":"left").replace(/%2/g,"cke_contents_"+e)}var t="background:url("+CKEDITOR.getUrl(this.path+"images"+(CKEDITOR.env.hidpi?"/hidpi":"")+"/anchor.png")+") no-repeat %1 center;border:1px dotted #00f;background-size:16px;",n=".%2 a.cke_anchor,.%2 a.cke_anchor_empty,.cke_editable.%2 a[name],.cke_editable.%2 a[data-cke-saved-name]{"+t+"padding-%1:18px;cursor:auto;}.%2 img.cke_anchor{"+t+"width:16px;min-height:15px;height:1.15em;vertical-align:text-bottom;}";CKEDITOR.addCss(e("ltr")+e("rtl"))},init:function(e){var t="a[!href]";CKEDITOR.dialog.isTabEnabled(e,"link","advanced")&&(t=t.replace("]",",accesskey,charset,dir,id,lang,name,rel,tabindex,title,type]{*}(*)")),CKEDITOR.dialog.isTabEnabled(e,"link","target")&&(t=t.replace("]",",target,onclick]")),e.addCommand("link",new CKEDITOR.dialogCommand("link",{allowedContent:t,requiredContent:"a[href]"})),e.addCommand("anchor",new CKEDITOR.dialogCommand("anchor",{allowedContent:"a[!name,id]",requiredContent:"a[name]"})),e.addCommand("unlink",new CKEDITOR.unlinkCommand),e.addCommand("removeAnchor",new CKEDITOR.removeAnchorCommand),e.setKeystroke(CKEDITOR.CTRL+76,"link"),e.ui.addButton&&(e.ui.addButton("Link",{label:e.lang.link.toolbar,command:"link",toolbar:"links,10"}),e.ui.addButton("Unlink",{label:e.lang.link.unlink,command:"unlink",toolbar:"links,20"}),e.ui.addButton("Anchor",{label:e.lang.link.anchor.toolbar,command:"anchor",toolbar:"links,30"})),CKEDITOR.dialog.add("link",this.path+"dialogs/link.js"),CKEDITOR.dialog.add("anchor",this.path+"dialogs/anchor.js"),e.on("doubleclick",function(t){var n=CKEDITOR.plugins.link.getSelectedLink(e)||t.data.element;n.isReadOnly()||(n.is("a")?(t.data.dialog=n.getAttribute("name")&&(!n.getAttribute("href")||!n.getChildCount())?"anchor":"link",t.data.link=n):CKEDITOR.plugins.link.tryRestoreFakeAnchor(e,n)&&(t.data.dialog="anchor"))},null,null,0),e.on("doubleclick",function(t){t.data.dialog in{link:1,anchor:1}&&t.data.link&&e.getSelection().selectElement(t.data.link)},null,null,20),e.addMenuItems&&e.addMenuItems({anchor:{label:e.lang.link.anchor.menu,command:"anchor",group:"anchor",order:1},removeAnchor:{label:e.lang.link.anchor.remove,command:"removeAnchor",group:"anchor",order:5},link:{label:e.lang.link.menu,command:"link",group:"link",order:1},unlink:{label:e.lang.link.unlink,command:"unlink",group:"link",order:5}}),e.contextMenu&&e.contextMenu.addListener(function(t){if(!t||t.isReadOnly())return null;t=CKEDITOR.plugins.link.tryRestoreFakeAnchor(e,t);if(!t&&!(t=CKEDITOR.plugins.link.getSelectedLink(e)))return null;var n={};return t.getAttribute("href")&&t.getChildCount()&&(n={link:CKEDITOR.TRISTATE_OFF,unlink:CKEDITOR.TRISTATE_OFF}),t&&t.hasAttribute("name")&&(n.anchor=n.removeAnchor=CKEDITOR.TRISTATE_OFF),n}),this.compiledProtectionFunction=r(e)},afterInit:function(e){e.dataProcessor.dataFilter.addRules({elements:{a:function(t){return t.attributes.name?t.children.length?null:e.createFakeParserElement(t,"cke_anchor","anchor"):null}}});var t=e._.elementsPath&&e._.elementsPath.filters;t&&t.push(function(t,n){if("a"==n&&(CKEDITOR.plugins.link.tryRestoreFakeAnchor(e,t)||t.getAttribute("name")&&(!t.getAttribute("href")||!t.getChildCount())))return"anchor"})}});var i=/^javascript:/,s=/^mailto:([^?]+)(?:\?(.+))?$/,o=/subject=([^;?:@&=$,\/]*)/,u=/body=([^;?:@&=$,\/]*)/,a=/^#(.*)$/,f=/^((?:http|https|ftp|news):\/\/)?(.*)$/,l=/^(_(?:self|top|parent|blank))$/,c=/^javascript:void\(location\.href='mailto:'\+String\.fromCharCode\(([^)]+)\)(?:\+'(.*)')?\)$/,h=/^javascript:([^(]+)\(([^)]+)\)$/,p=/\s*window.open\(\s*this\.href\s*,\s*(?:'([^']*)'|null)\s*,\s*'([^']*)'\s*\)\s*;\s*return\s*false;*\s*/,d=/(?:^|,)([^=]+)=(\d+|yes|no)/gi,v={id:"advId",dir:"advLangDir",accessKey:"advAccessKey",name:"advName",lang:"advLangCode",tabindex:"advTabIndex",title:"advTitle",type:"advContentType","class":"advCSSClasses",charset:"advCharset",style:"advStyles",rel:"advRel"};CKEDITOR.plugins.link={getSelectedLink:function(e){var t=e.getSelection(),n=t.getSelectedElement();return n&&n.is("a")?n:(t=t.getRanges()[0])?(t.shrink(CKEDITOR.SHRINK_TEXT),e.elementPath(t.getCommonAncestor()).contains("a",1)):null},getEditorAnchors:function(e){for(var t=e.editable(),n=t.isInline()&&!e.plugins.divarea?e.document:t,t=n.getElementsByTag("a"),n=n.getElementsByTag("img"),r=[],i=0,s;s=t.getItem(i++);)(s.data("cke-saved-name")||s.hasAttribute("name"))&&r.push({name:s.data("cke-saved-name")||s.getAttribute("name"),id:s.getAttribute("id")});for(i=0;s=n.getItem(i++);)(s=this.tryRestoreFakeAnchor(e,s))&&r.push({name:s.getAttribute("name"),id:s.getAttribute("id")});return r},fakeAnchor:!0,tryRestoreFakeAnchor:function(e,t){if(t&&t.data("cke-real-element-type")&&"anchor"==t.data("cke-real-element-type")){var n=e.restoreRealElement(t);if(n.data("cke-saved-name"))return n}},parseLinkAttributes:function(e,t){var n=t&&(t.data("cke-saved-href")||t.getAttribute("href"))||"",r=e.plugins.link.compiledProtectionFunction,m=e.config.emailProtection,g,b={};n.match(i)&&("encode"==m?n=n.replace(c,function(e,t,n){return"mailto:"+String.fromCharCode.apply(String,t.split(","))+(n&&n.replace(/\\'/g,"'"))}):m&&n.replace(h,function(e,t,n){if(t==r.name){b.type="email";for(var e=b.email={},t=/(^')|('$)/g,n=n.match(/[^,\s]+/g),i=n.length,s,o,u=0;u<i;u++)s=decodeURIComponent,o=n[u].replace(t,"").replace(/\\'/g,"'"),o=s(o),s=r.params[u].toLowerCase(),e[s]=o;e.address=[e.name,e.domain].join("@")}}));if(!b.type)if(m=n.match(a))b.type="anchor",b.anchor={},b.anchor.name=b.anchor.id=m[1];else if(m=n.match(s)){g=n.match(o),n=n.match(u),b.type="email";var E=b.email={};E.address=m[1],g&&(E.subject=decodeURIComponent(g[1])),n&&(E.body=decodeURIComponent(n[1]))}else n&&(g=n.match(f))&&(b.type="url",b.url={},b.url.protocol=g[1],b.url.url=g[2]);if(t){if(n=t.getAttribute("target"))b.target={type:n.match(l)?n:"frame",name:n};else if(n=(n=t.data("cke-pa-onclick")||t.getAttribute("onclick"))&&n.match(p))for(b.target={type:"popup",name:n[1]};m=d.exec(n[2]);)"yes"!=m[2]&&"1"!=m[2]||m[1]in{height:1,width:1,top:1,left:1}?isFinite(m[2])&&(b.target[m[1]]=m[2]):b.target[m[1]]=!0;var n={},S;for(S in v)(m=t.getAttribute(S))&&(n[v[S]]=m);if(S=t.data("cke-saved-name")||n.advName)n.advName=S;CKEDITOR.tools.isEmpty(n)||(b.advanced=n)}return b},getLinkAttributes:function(r,i){var s=r.config.emailProtection||"",o={};switch(i.type){case"url":var s=i.url&&void 0!=i.url.protocol?i.url.protocol:"http://",u=i.url&&CKEDITOR.tools.trim(i.url.url)||"";o["data-cke-saved-href"]=0===u.indexOf("/")?u:s+u;break;case"anchor":s=i.anchor&&i.anchor.id,o["data-cke-saved-href"]="#"+(i.anchor&&i.anchor.name||s||"");break;case"email":var a=i.email,u=a.address;switch(s){case"":case"encode":var f=encodeURIComponent(a.subject||""),l=encodeURIComponent(a.body||""),a=[];f&&a.push("subject="+f),l&&a.push("body="+l),a=a.length?"?"+a.join("&"):"","encode"==s?(s=["javascript:void(location.href='mailto:'+",t(u)],a&&s.push("+'",e(a),"'"),s.push(")")):s=["mailto:",u,a];break;default:s=u.split("@",2),a.name=s[0],a.domain=s[1],s=["javascript:",n(r,a)]}o["data-cke-saved-href"]=s.join("")}if(i.target)if("popup"==i.target.type){for(var s=["window.open(this.href, '",i.target.name||"","', '"],c="resizable status location toolbar menubar fullscreen scrollbars dependent".split(" "),u=c.length,f=function(e){i.target[e]&&c.push(e+"="+i.target[e])},a=0;a<u;a++)c[a]+=i.target[c[a]]?"=yes":"=no";f("width"),f("left"),f("height"),f("top"),s.push(c.join(","),"'); return false;"),o["data-cke-pa-onclick"]=s.join("")}else"notSet"!=i.target.type&&i.target.name&&(o.target=i.target.name);if(i.advanced){for(var h in v)(s=i.advanced[v[h]])&&(o[h]=s);o.name&&(o["data-cke-saved-name"]=o.name)}o["data-cke-saved-href"]&&(o.href=o["data-cke-saved-href"]),h=CKEDITOR.tools.extend({target:1,onclick:1,"data-cke-pa-onclick":1,"data-cke-saved-name":1},v);for(var p in o)delete h[p];return{set:o,removed:CKEDITOR.tools.objectKeys(h)}}},CKEDITOR.unlinkCommand=function(){},CKEDITOR.unlinkCommand.prototype={exec:function(e){var t=new CKEDITOR.style({element:"a",type:CKEDITOR.STYLE_INLINE,alwaysRemoveElement:1});e.removeStyle(t)},refresh:function(e,t){var n=t.lastElement&&t.lastElement.getAscendant("a",!0);n&&"a"==n.getName()&&n.getAttribute("href")&&n.getChildCount()?this.setState(CKEDITOR.TRISTATE_OFF):this.setState(CKEDITOR.TRISTATE_DISABLED)},contextSensitive:1,startDisabled:1,requiredContent:"a[href]"},CKEDITOR.removeAnchorCommand=function(){},CKEDITOR.removeAnchorCommand.prototype={exec:function(e){var t=e.getSelection(),n=t.createBookmarks(),r;if(t&&(r=t.getSelectedElement())&&(r.getChildCount()?r.is("a"):CKEDITOR.plugins.link.tryRestoreFakeAnchor(e,r)))r.remove(1);else if(r=CKEDITOR.plugins.link.getSelectedLink(e))r.hasAttribute("href")?(r.removeAttributes({name:1,"data-cke-saved-name":1}),r.removeClass("cke_anchor")):r.remove(1);t.selectBookmarks(n)},requiredContent:"a[name]"},CKEDITOR.tools.extend(CKEDITOR.config,{linkShowAdvancedTab:!0,linkShowTargetTab:!0})}(),function(){function e(e,t,n){function r(n){(f=a[n?"getFirst":"getLast"]())&&(!f.is||!f.isBlockBoundary())&&(l=t.root[n?"getPrevious":"getNext"](CKEDITOR.dom.walker.invisible(!0)))&&(!l.is||!l.isBlockBoundary({br:1}))&&e.document.createElement("br")[n?"insertBefore":"insertAfter"](f)}for(var i=CKEDITOR.plugins.list.listToArray(t.root,n),s=[],o=0;o<t.contents.length;o++){var u=t.contents[o];(u=u.getAscendant("li",!0))&&!u.getCustomData("list_item_processed")&&(s.push(u),CKEDITOR.dom.element.setMarker(n,u,"list_item_processed",!0))}u=null;for(o=0;o<s.length;o++)u=s[o].getCustomData("listarray_index"),i[u].indent=-1;for(o=u+1;o<i.length;o++)if(i[o].indent>i[o-1].indent+1){s=i[o-1].indent+1-i[o].indent;for(u=i[o].indent;i[o]&&i[o].indent>=u;)i[o].indent+=s,o++;o--}var a=CKEDITOR.plugins.list.arrayToList(i,n,null,e.config.enterMode,t.root.getAttribute("dir")).listNode,f,l;r(!0),r(),a.replace(t.root),e.fire("contentDomInvalidated")}function t(e,t){this.name=e,this.context=this.type=t,this.allowedContent=t+" li",this.requiredContent=t}function n(e,t,n,r){for(var i,s;i=e[r?"getLast":"getFirst"](p);)(s=i.getDirection(1))!==t.getDirection(1)&&i.setAttribute("dir",s),i.remove(),n?i[r?"insertBefore":"insertAfter"](n):t.append(i,r)}function r(e){var t;(t=function(t){var r=e[t?"getPrevious":"getNext"](l);r&&r.type==CKEDITOR.NODE_ELEMENT&&r.is(e.getName())&&(n(e,r,null,!t),e.remove(),e=r)})(),t(1)}function i(e){return e.type==CKEDITOR.NODE_ELEMENT&&(e.getName()in CKEDITOR.dtd.$block||e.getName()in CKEDITOR.dtd.$listItem)&&CKEDITOR.dtd[e.getName()]["#"]}function s(e,t,i){e.fire("saveSnapshot"),i.enlarge(CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS);var s=i.extractContents();t.trim(!1,!0);var u=t.createBookmark(),a=new CKEDITOR.dom.elementPath(t.startContainer),f=a.block,a=a.lastElement.getAscendant("li",1)||f,h=new CKEDITOR.dom.elementPath(i.startContainer),p=h.contains(CKEDITOR.dtd.$listItem),h=h.contains(CKEDITOR.dtd.$list);f?(f=f.getBogus())&&f.remove():h&&(f=h.getPrevious(l))&&c(f)&&f.remove(),(f=s.getLast())&&f.type==CKEDITOR.NODE_ELEMENT&&f.is("br")&&f.remove(),(f=t.startContainer.getChild(t.startOffset))?s.insertBefore(f):t.startContainer.append(s),p&&(s=o(p))&&(a.contains(p)?(n(s,p.getParent(),p),s.remove()):a.append(s));for(;i.checkStartOfBlock()&&i.checkEndOfBlock();){h=i.startPath(),s=h.block;if(!s)break;s.is("li")&&(a=s.getParent(),s.equals(a.getLast(l))&&s.equals(a.getFirst(l))&&(s=a)),i.moveToPosition(s,CKEDITOR.POSITION_BEFORE_START),s.remove()}i=i.clone(),s=e.editable(),i.setEndAt(s,CKEDITOR.POSITION_BEFORE_END),i=new CKEDITOR.dom.walker(i),i.evaluator=function(e){return l(e)&&!c(e)},(i=i.next())&&i.type==CKEDITOR.NODE_ELEMENT&&i.getName()in CKEDITOR.dtd.$list&&r(i),t.moveToBookmark(u),t.select(),e.fire("saveSnapshot")}function o(e){return(e=e.getLast(l))&&e.type==CKEDITOR.NODE_ELEMENT&&e.getName()in u?e:null}var u={ol:1,ul:1},a=CKEDITOR.dom.walker.whitespaces(),f=CKEDITOR.dom.walker.bookmark(),l=function(e){return!a(e)&&!f(e)},c=CKEDITOR.dom.walker.bogus();CKEDITOR.plugins.list={listToArray:function(e,t,n,r,i){if(!u[e.getName()])return[];r||(r=0),n||(n=[]);for(var s=0,o=e.getChildCount();s<o;s++){var a=e.getChild(s);a.type==CKEDITOR.NODE_ELEMENT&&a.getName()in CKEDITOR.dtd.$list&&CKEDITOR.plugins.list.listToArray(a,t,n,r+1);if("li"==a.$.nodeName.toLowerCase()){var f={parent:e,indent:r,element:a,contents:[]};i?f.grandparent=i:(f.grandparent=e.getParent(),f.grandparent&&"li"==f.grandparent.$.nodeName.toLowerCase()&&(f.grandparent=f.grandparent.getParent())),t&&CKEDITOR.dom.element.setMarker(t,a,"listarray_index",n.length),n.push(f);for(var l=0,c=a.getChildCount(),h;l<c;l++)h=a.getChild(l),h.type==CKEDITOR.NODE_ELEMENT&&u[h.getName()]?CKEDITOR.plugins.list.listToArray(h,t,n,r+1,f.grandparent):f.contents.push(h)}}return n},arrayToList:function(e,t,n,r,i){n||(n=0);if(!e||e.length<n+1)return null;for(var s,o=e[n].parent.getDocument(),a=new CKEDITOR.dom.documentFragment(o),c=null,h=n,p=Math.max(e[n].indent,0),d=null,v,m,g=r==CKEDITOR.ENTER_P?"p":"div";;){var y=e[h];s=y.grandparent,v=y.element.getDirection(1);if(y.indent==p){if(!c||e[h].parent.getName()!=c.getName())c=e[h].parent.clone(!1,1),i&&c.setAttribute("dir",i),a.append(c);d=c.append(y.element.clone(0,1)),v!=c.getDirection(1)&&d.setAttribute("dir",v);for(s=0;s<y.contents.length;s++)d.append(y.contents[s].clone(1,1));h++}else if(y.indent==Math.max(p,0)+1)y=e[h-1].element.getDirection(1),h=CKEDITOR.plugins.list.arrayToList(e,null,h,r,y!=v?v:null),!d.getChildCount()&&CKEDITOR.env.needsNbspFiller&&!(7<o.$.documentMode)&&d.append(o.createText(" ")),d.append(h.listNode),h=h.nextIndex;else{if(-1!=y.indent||!!n||!s)return null;u[s.getName()]?(d=y.element.clone(!1,!0),v!=s.getDirection(1)&&d.setAttribute("dir",v)):d=new CKEDITOR.dom.documentFragment(o);var c=s.getDirection(1)!=v,b=y.element,w=b.getAttribute("class"),E=b.getAttribute("style"),S=d.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT&&(r!=CKEDITOR.ENTER_BR||c||E||w),x,T=y.contents.length,N;for(s=0;s<T;s++)if(x=y.contents[s],f(x)&&1<T)S?N=x.clone(1,1):d.append(x.clone(1,1));else if(x.type==CKEDITOR.NODE_ELEMENT&&x.isBlockBoundary()){c&&!x.getDirection()&&x.setAttribute("dir",v),m=x;var C=b.getAttribute("style");C&&m.setAttribute("style",C.replace(/([^;])$/,"$1;")+(m.getAttribute("style")||"")),w&&x.addClass(w),m=null,N&&(d.append(N),N=null),d.append(x.clone(1,1))}else S?(m||(m=o.createElement(g),d.append(m),c&&m.setAttribute("dir",v)),E&&m.setAttribute("style",E),w&&m.setAttribute("class",w),N&&(m.append(N),N=null),m.append(x.clone(1,1))):d.append(x.clone(1,1));N&&((m||d).append(N),N=null),d.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT&&h!=e.length-1&&(CKEDITOR.env.needsBrFiller&&(v=d.getLast())&&v.type==CKEDITOR.NODE_ELEMENT&&v.is("br")&&v.remove(),v=d.getLast(l),(!v||v.type!=CKEDITOR.NODE_ELEMENT||!v.is(CKEDITOR.dtd.$block))&&d.append(o.createElement("br"))),v=d.$.nodeName.toLowerCase(),("div"==v||"p"==v)&&d.appendBogus(),a.append(d),c=null,h++}m=null;if(e.length<=h||Math.max(e[h].indent,0)<p)break}if(t)for(e=a.getFirst();e;){if(e.type==CKEDITOR.NODE_ELEMENT&&(CKEDITOR.dom.element.clearMarkers(t,e),e.getName()in CKEDITOR.dtd.$listItem&&(n=e,o=i=r=void 0,r=n.getDirection()))){for(i=n.getParent();i&&!(o=i.getDirection());)i=i.getParent();r==o&&n.removeAttribute("dir")}e=e.getNextSourceNode()}return{listNode:a,nextIndex:h}}};var h=/^h[1-6]$/,p=CKEDITOR.dom.walker.nodeType(CKEDITOR.NODE_ELEMENT);t.prototype={exec:function(t){this.refresh(t,t.elementPath());var n=t.config,i=t.getSelection(),s=i&&i.getRanges();if(this.state==CKEDITOR.TRISTATE_OFF){var o=t.editable();if(o.getFirst(l)){var a=1==s.length&&s[0];(n=a&&a.getEnclosedNode())&&n.is&&this.type==n.getName()&&this.setState(CKEDITOR.TRISTATE_ON)}else n.enterMode==CKEDITOR.ENTER_BR?o.appendBogus():s[0].fixBlock(1,n.enterMode==CKEDITOR.ENTER_P?"p":"div"),i.selectRanges(s)}for(var n=i.createBookmarks(!0),o=[],f={},s=s.createIterator(),c=0;(a=s.getNextRange())&&++c;){var p=a.getBoundaryNodes(),d=p.startNode,v=p.endNode;d.type==CKEDITOR.NODE_ELEMENT&&"td"==d.getName()&&a.setStartAt(p.startNode,CKEDITOR.POSITION_AFTER_START),v.type==CKEDITOR.NODE_ELEMENT&&"td"==v.getName()&&a.setEndAt(p.endNode,CKEDITOR.POSITION_BEFORE_END),a=a.createIterator();for(a.forceBrBreak=this.state==CKEDITOR.TRISTATE_OFF;p=a.getNextParagraph();)if(!p.getCustomData("list_block")){CKEDITOR.dom.element.setMarker(f,p,"list_block",1);for(var m=t.elementPath(p),d=m.elements,v=0,m=m.blockLimit,g,y=d.length-1;0<=y&&(g=d[y]);y--)if(u[g.getName()]&&m.contains(g)){m.removeCustomData("list_group_object_"+c),(d=g.getCustomData("list_group_object"))?d.contents.push(p):(d={root:g,contents:[p]},o.push(d),CKEDITOR.dom.element.setMarker(f,g,"list_group_object",d)),v=1;break}v||(v=m,v.getCustomData("list_group_object_"+c)?v.getCustomData("list_group_object_"+c).contents.push(p):(d={root:v,contents:[p]},CKEDITOR.dom.element.setMarker(f,v,"list_group_object_"+c,d),o.push(d)))}}for(g=[];0<o.length;)if(d=o.shift(),this.state==CKEDITOR.TRISTATE_OFF)if(u[d.root.getName()]){s=t,c=d,d=f,a=g,v=CKEDITOR.plugins.list.listToArray(c.root,d),m=[];for(p=0;p<c.contents.length;p++)if(y=c.contents[p],(y=y.getAscendant("li",!0))&&!y.getCustomData("list_item_processed"))m.push(y),CKEDITOR.dom.element.setMarker(d,y,"list_item_processed",!0);for(var y=c.root.getDocument(),b=void 0,w=void 0,p=0;p<m.length;p++){var S=m[p].getCustomData("listarray_index"),b=v[S].parent;b.is(this.type)||(w=y.createElement(this.type),b.copyAttributes(w,{start:1,type:1}),w.removeStyle("list-style-type"),v[S].parent=w)}d=CKEDITOR.plugins.list.arrayToList(v,d,null,s.config.enterMode),v=void 0,m=d.listNode.getChildCount();for(p=0;p<m&&(v=d.listNode.getChild(p));p++)v.getName()==this.type&&a.push(v);d.listNode.replace(c.root),s.fire("contentDomInvalidated")}else{v=t,p=d,a=g,m=p.contents,s=p.root.getDocument(),c=[],1==m.length&&m[0].equals(p.root)&&(d=s.createElement("div"),m[0].moveChildren&&m[0].moveChildren(d),m[0].append(d),m[0]=d),p=p.contents[0].getParent();for(y=0;y<m.length;y++)p=p.getCommonAncestor(m[y].getParent());b=v.config.useComputedState,v=d=void 0,b=void 0===b||b;for(y=0;y<m.length;y++)for(w=m[y];S=w.getParent();){if(S.equals(p)){c.push(w),!v&&w.getDirection()&&(v=1),w=w.getDirection(b),null!==d&&(d=d&&d!=w?null:w);break}w=S}if(!(1>c.length)){m=c[c.length-1].getNext(),y=s.createElement(this.type),a.push(y);for(b=a=void 0;c.length;)a=c.shift(),b=s.createElement("li"),a.is("pre")||h.test(a.getName())||"false"==a.getAttribute("contenteditable")?a.appendTo(b):(a.copyAttributes(b),d&&a.getDirection()&&(b.removeStyle("direction"),b.removeAttribute("dir")),a.moveChildren(b),a.remove()),b.appendTo(y);d&&v&&y.setAttribute("dir",d),m?y.insertBefore(m):y.appendTo(p)}}else this.state==CKEDITOR.TRISTATE_ON&&u[d.root.getName()]&&e.call(this,t,d,f);for(y=0;y<g.length;y++)r(g[y]);CKEDITOR.dom.element.clearAllMarkers(f),i.selectBookmarks(n),t.focus()},refresh:function(e,t){var n=t.contains(u,1),r=t.blockLimit||t.root;n&&r.contains(n)?this.setState(n.is(this.type)?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF):this.setState(CKEDITOR.TRISTATE_OFF)}},CKEDITOR.plugins.add("list",{requires:"indentlist",init:function(e){e.blockless||(e.addCommand("numberedlist",new t("numberedlist","ol")),e.addCommand("bulletedlist",new t("bulletedlist","ul")),e.ui.addButton&&(e.ui.addButton("NumberedList",{label:e.lang.list.numberedlist,command:"numberedlist",directional:!0,toolbar:"list,10"}),e.ui.addButton("BulletedList",{label:e.lang.list.bulletedlist,command:"bulletedlist",directional:!0,toolbar:"list,20"})),e.on("key",function(t){var n=t.data.domEvent.getKey();if(e.mode=="wysiwyg"&&n in{8:1,46:1}){var r=e.getSelection().getRanges()[0],a=r&&r.startPath();if(r&&r.collapsed){var f=n==8,h=e.editable(),p=new CKEDITOR.dom.walker(r.clone());p.evaluator=function(e){return l(e)&&!c(e)},p.guard=function(e,t){return!t||e.type!=CKEDITOR.NODE_ELEMENT||!e.is("table")},n=r.clone();if(f){var d,m;(d=a.contains(u))&&r.checkBoundaryOfElement(d,CKEDITOR.START)&&(d=d.getParent())&&d.is("li")&&(d=o(d))?(m=d,d=d.getPrevious(l),n.moveToPosition(d&&c(d)?d:m,CKEDITOR.POSITION_BEFORE_START)):(p.range.setStartAt(h,CKEDITOR.POSITION_AFTER_START),p.range.setEnd(r.startContainer,r.startOffset),(d=p.previous())&&d.type==CKEDITOR.NODE_ELEMENT&&(d.getName()in u||d.is("li"))&&(d.is("li")||(p.range.selectNodeContents(d),p.reset(),p.evaluator=i,d=p.previous()),m=d,n.moveToElementEditEnd(m))),m?(s(e,n,r),t.cancel()):(n=a.contains(u))&&r.checkBoundaryOfElement(n,CKEDITOR.START)&&(m=n.getFirst(l),r.checkBoundaryOfElement(m,CKEDITOR.START)&&(d=n.getPrevious(l),o(m)?d&&(r.moveToElementEditEnd(d),r.select()):e.execCommand("outdent"),t.cancel()))}else(m=a.contains("li"))?(p.range.setEndAt(h,CKEDITOR.POSITION_BEFORE_END),h=(a=m.getLast(l))&&i(a)?a:m,m=0,(d=p.next())&&d.type==CKEDITOR.NODE_ELEMENT&&d.getName()in u&&d.equals(a)?(m=1,d=p.next()):r.checkBoundaryOfElement(h,CKEDITOR.END)&&(m=1),m&&d&&(r=r.clone(),r.moveToElementEditStart(d),s(e,n,r),t.cancel())):(p.range.setEndAt(h,CKEDITOR.POSITION_BEFORE_END),(d=p.next())&&d.type==CKEDITOR.NODE_ELEMENT&&d.is(u)&&(d=d.getFirst(l),a.block&&r.checkStartOfBlock()&&r.checkEndOfBlock()?(a.block.remove(),r.moveToElementEditStart(d),r.select()):o(d)?(r.moveToElementEditStart(d),r.select()):(r=r.clone(),r.moveToElementEditStart(d),s(e,n,r)),t.cancel()));setTimeout(function(){e.selectionChange(1)})}}}))}})}(),function(){CKEDITOR.plugins.liststyle={requires:"dialog,contextmenu",init:function(e){if(!e.blockless){var t;t=new CKEDITOR.dialogCommand("numberedListStyle",{requiredContent:"ol",allowedContent:"ol{list-style-type}[start]"}),t=e.addCommand("numberedListStyle",t),e.addFeature(t),CKEDITOR.dialog.add("numberedListStyle",this.path+"dialogs/liststyle.js"),t=new CKEDITOR.dialogCommand("bulletedListStyle",{requiredContent:"ul",allowedContent:"ul{list-style-type}"}),t=e.addCommand("bulletedListStyle",t),e.addFeature(t),CKEDITOR.dialog.add("bulletedListStyle",this.path+"dialogs/liststyle.js"),e.addMenuGroup("list",108),e.addMenuItems({numberedlist:{label:e.lang.liststyle.numberedTitle,group:"list",command:"numberedListStyle"},bulletedlist:{label:e.lang.liststyle.bulletedTitle,group:"list",command:"bulletedListStyle"}}),e.contextMenu.addListener(function(e){if(!e||e.isReadOnly())return null;for(;e;){var t=e.getName();if("ol"==t)return{numberedlist:CKEDITOR.TRISTATE_OFF};if("ul"==t)return{bulletedlist:CKEDITOR.TRISTATE_OFF};e=e.getParent()}return null})}}},CKEDITOR.plugins.add("liststyle",CKEDITOR.plugins.liststyle)}(),function(){function e(e,t,n){return l(t)&&l(n)&&n.equals(t.getNext(function(e){return!(J(e)||K(e)||c(e))}))}function t(e){this.upper=e[0],this.lower=e[1],this.set.apply(this,e.slice(2))}function n(e){var t=e.element;if(t&&l(t)&&(t=t.getAscendant(e.triggers,!0))&&e.editable.contains(t)){var n=s(t);if("true"==n.getAttribute("contenteditable"))return t;if(n.is(e.triggers))return n}return null}function r(e,t,n){return b(e,t),b(e,n),e=t.size.bottom,n=n.size.top,e&&n?0|(e+n)/2:e||n}function i(e,t,n){return t=t[n?"getPrevious":"getNext"](function(t){return t&&t.type==CKEDITOR.NODE_TEXT&&!J(t)||l(t)&&!c(t)&&!f(e,t)})}function s(e,t){if(e.data("cke-editable"))return null;for(t||(e=e.getParent());e&&!e.data("cke-editable");){if(e.hasAttribute("contenteditable"))return e;e=e.getParent()}return null}function o(e){var t=e.doc,n=N('<span contenteditable="false" style="'+W+"position:absolute;border-top:1px dashed "+e.boxColor+'"></span>',t),r=this.path+"images/"+(C.hidpi?"hidpi/":"")+"icon"+(e.rtl?"-rtl":"")+".png";x(n,{attach:function(){return this.wrap.getParent()||this.wrap.appendTo(e.editable,!0),this},lineChildren:[x(N('<span title="'+e.editor.lang.magicline.title+'" contenteditable="false">&#8629;</span>',t),{base:W+"height:17px;width:17px;"+(e.rtl?"left":"right")+":17px;background:url("+r+") center no-repeat "+e.boxColor+";cursor:pointer;"+(C.hc?"font-size: 15px;line-height:14px;border:1px solid #fff;text-align:center;":"")+(C.hidpi?"background-size: 9px 10px;":""),looks:["top:-8px;"+CKEDITOR.tools.cssVendorPrefix("border-radius","2px",1),"top:-17px;"+CKEDITOR.tools.cssVendorPrefix("border-radius","2px 2px 0px 0px",1),"top:-1px;"+CKEDITOR.tools.cssVendorPrefix("border-radius","0px 0px 2px 2px",1)]}),x(N(V,t),{base:X+"left:0px;border-left-color:"+e.boxColor+";",looks:["border-width:8px 0 8px 8px;top:-8px","border-width:8px 0 0 8px;top:-8px","border-width:0 0 8px 8px;top:0px"]}),x(N(V,t),{base:X+"right:0px;border-right-color:"+e.boxColor+";",looks:["border-width:8px 8px 8px 0;top:-8px","border-width:8px 8px 0 0;top:-8px","border-width:0 8px 8px 0;top:0px"]})],detach:function(){return this.wrap.getParent()&&this.wrap.remove(),this},mouseNear:function(){b(e,this);var t=e.holdDistance,n=this.size;return n&&e.mouse.y>n.top-t&&e.mouse.y<n.bottom+t&&e.mouse.x>n.left-t&&e.mouse.x<n.right+t?!0:!1},place:function(){var t=e.view,n=e.editable,r=e.trigger,i=r.upper,s=r.lower,o=i||s,u=o.getParent(),a={};this.trigger=r,i&&b(e,i,!0),s&&b(e,s,!0),b(e,u,!0),e.inInlineMode&&w(e,!0),u.equals(n)?(a.left=t.scroll.x,a.right=-t.scroll.x,a.width=""):(a.left=o.size.left-o.size.margin.left+t.scroll.x-(e.inInlineMode?t.editable.left+t.editable.border.left:0),a.width=o.size.outerWidth+o.size.margin.left+o.size.margin.right+t.scroll.x,a.right=""),i&&s?a.top=i.size.margin.bottom===s.size.margin.top?0|i.size.bottom+i.size.margin.bottom/2:i.size.margin.bottom<s.size.margin.top?i.size.bottom+i.size.margin.bottom:i.size.bottom+i.size.margin.bottom-s.size.margin.top:i?s||(a.top=i.size.bottom+i.size.margin.bottom):a.top=s.size.top-s.size.margin.top,r.is(H)||a.top>t.scroll.y-15&&a.top<t.scroll.y+5?(a.top=e.inInlineMode?0:t.scroll.y,this.look(H)):r.is(B)||a.top>t.pane.bottom-5&&a.top<t.pane.bottom+15?(a.top=e.inInlineMode?t.editable.height+t.editable.padding.top+t.editable.padding.bottom:t.pane.bottom-1,this.look(B)):(e.inInlineMode&&(a.top-=t.editable.top+t.editable.border.top),this.look(j)),e.inInlineMode&&(a.top--,a.top+=t.editable.scroll.top,a.left+=t.editable.scroll.left);for(var f in a)a[f]=CKEDITOR.tools.cssLength(a[f]);this.setStyles(a)},look:function(e){if(this.oldLook!=e){for(var t=this.lineChildren.length,n;t--;)(n=this.lineChildren[t]).setAttribute("style",n.base+n.looks[0|e/2]);this.oldLook=e}},wrap:new T("span",e.doc)});for(t=n.lineChildren.length;t--;)n.lineChildren[t].appendTo(n);n.look(j),n.appendTo(n.wrap),n.unselectable(),n.lineChildren[0].on("mouseup",function(t){n.detach(),u(e,function(t){var n=e.line.trigger;t[n.is(O)?"insertBefore":"insertAfter"](n.is(O)?n.lower:n.upper)},!0),e.editor.focus(),!C.ie&&e.enterMode!=CKEDITOR.ENTER_BR&&e.hotNode.scrollIntoView(),t.data.preventDefault(!0)}),n.on("mousedown",function(e){e.data.preventDefault(!0)}),e.line=n}function u(e,t,n){var r=new CKEDITOR.dom.range(e.doc),i=e.editor,o;C.ie&&e.enterMode==CKEDITOR.ENTER_BR?o=e.doc.createText(F):(o=(o=s(e.element,!0))&&o.data("cke-enter-mode")||e.enterMode,o=new T(A[o],e.doc),o.is("br")||e.doc.createText(F).appendTo(o)),n&&i.fire("saveSnapshot"),t(o),r.moveToPosition(o,CKEDITOR.POSITION_AFTER_START),i.getSelection().selectRanges([r]),e.hotNode=o,n&&i.fire("saveSnapshot")}function a(e,t){return{canUndo:!0,modes:{wysiwyg:1},exec:function(){function r(n){var r=C.ie&&9>C.version?" ":F,i=e.hotNode&&e.hotNode.getText()==r&&e.element.equals(e.hotNode)&&e.lastCmdDirection===!!t;u(e,function(r){i&&e.hotNode&&e.hotNode.remove(),r[t?"insertAfter":"insertBefore"](n),r.setAttributes({"data-cke-magicline-hot":1,"data-cke-magicline-dir":!!t}),e.lastCmdDirection=!!t}),!C.ie&&e.enterMode!=CKEDITOR.ENTER_BR&&e.hotNode.scrollIntoView(),e.line.detach()}return function(o){var o=o.getSelection().getStartElement(),u,o=o.getAscendant(U,1);if(!d(e,o)&&o&&!o.equals(e.editable)&&!o.contains(e.editable)){(u=s(o))&&"false"==u.getAttribute("contenteditable")&&(o=u),e.element=o,u=i(e,o,!t);var a;l(u)&&u.is(e.triggers)&&u.is(R)&&(!i(e,u,!t)||(a=i(e,u,!t))&&l(a)&&a.is(e.triggers))?r(u):(a=n(e,o),l(a)&&(i(e,a,!t)?(o=i(e,a,!t))&&l(o)&&o.is(e.triggers)&&r(a):r(a)))}}}()}}function f(e,t){if(!t||t.type!=CKEDITOR.NODE_ELEMENT||!t.$)return!1;var n=e.line;return n.wrap.equals(t)||n.wrap.contains(t)}function l(e){return e&&e.type==CKEDITOR.NODE_ELEMENT&&e.$}function c(e){if(!l(e))return!1;var t;return(t=h(e))||(l(e)?(t={left:1,right:1,center:1},t=!!t[e.getComputedStyle("float")]||!!t[e.getAttribute("align")]):t=!1),t}function h(e){return!!{absolute:1,fixed:1}[e.getComputedStyle("position")]}function p(e,t){return l(t)?t.is(e.triggers):null}function d(e,t){if(!t)return!1;for(var n=t.getParents(1),r=n.length;r--;)for(var i=e.tabuList.length;i--;)if(n[r].hasAttribute(e.tabuList[i]))return!0;return!1}function v(e,t,n){return t=t[n?"getLast":"getFirst"](function(t){return e.isRelevant(t)&&!t.is(q)}),t?(b(e,t),n?t.size.top>e.mouse.y:t.size.bottom<e.mouse.y):!1}function m(e){var n=e.editable,r=e.mouse,i=e.view,s=e.triggerOffset;w(e);var o=r.y>(e.inInlineMode?i.editable.top+i.editable.height/2:Math.min(i.editable.height,i.pane.height)/2),n=n[o?"getLast":"getFirst"](function(e){return!J(e)&&!K(e)});return n?(f(e,n)&&(n=e.line.wrap[o?"getPrevious":"getNext"](function(e){return!J(e)&&!K(e)})),!l(n)||c(n)||!p(e,n)?null:(b(e,n),!o&&0<=n.size.top&&0<r.y&&r.y<n.size.top+s?(e=e.inInlineMode||0===i.scroll.y?H:j,new t([null,n,O,D,e])):o&&n.size.bottom<=i.pane.height&&r.y>n.size.bottom-s&&r.y<i.pane.height?(e=e.inInlineMode||n.size.bottom>i.pane.height-s&&n.size.bottom<i.pane.height?B:j,new t([n,null,M,D,e])):null)):null}function g(e){var r=e.mouse,s=e.view,o=e.triggerOffset,u=n(e);if(!u)return null;b(e,u);var o=Math.min(o,0|u.size.outerHeight/2),a=[],f,h;if(r.y>u.size.top-1&&r.y<u.size.top+o)h=!1;else{if(!(r.y>u.size.bottom-o&&r.y<u.size.bottom+1))return null;h=!0}if(c(u)||v(e,u,h)||u.getParent().is(I))return null;var d=i(e,u,!h);if(d){if(d&&d.type==CKEDITOR.NODE_TEXT)return null;if(l(d)){if(c(d)||!p(e,d)||d.getParent().is(I))return null;a=[d,u][h?"reverse":"concat"]().concat([_,D])}}else u.equals(e.editable[h?"getLast":"getFirst"](e.isRelevant))?(w(e),h&&r.y>u.size.bottom-o&&r.y<s.pane.height&&u.size.bottom>s.pane.height-o&&u.size.bottom<s.pane.height?f=B:0<r.y&&r.y<u.size.top+o&&(f=H)):f=j,a=[null,u][h?"reverse":"concat"]().concat([h?M:O,D,f,u.equals(e.editable[h?"getLast":"getFirst"](e.isRelevant))?h?B:H:j]);return 0 in a?new t(a):null}function y(e,t,n,r){for(var i=function(){var n=C.ie?t.$.currentStyle:e.win.$.getComputedStyle(t.$,"");return C.ie?function(e){return n[CKEDITOR.tools.cssStyleToDomStyle(e)]}:function(e){return n.getPropertyValue(e)}}(),s=t.getDocumentPosition(),o={},u={},a={},f={},l=G.length;l--;)o[G[l]]=parseInt(i("border-"+G[l]+"-width"),10)||0,a[G[l]]=parseInt(i("padding-"+G[l]),10)||0,u[G[l]]=parseInt(i("margin-"+G[l]),10)||0;return(!n||r)&&E(e,r),f.top=s.y-(n?0:e.view.scroll.y),f.left=s.x-(n?0:e.view.scroll.x),f.outerWidth=t.$.offsetWidth,f.outerHeight=t.$.offsetHeight,f.height=f.outerHeight-(a.top+a.bottom+o.top+o.bottom),f.width=f.outerWidth-(a.left+a.right+o.left+o.right),f.bottom=f.top+f.outerHeight,f.right=f.left+f.outerWidth,e.inInlineMode&&(f.scroll={top:t.$.scrollTop,left:t.$.scrollLeft}),x({border:o,padding:a,margin:u,ignoreScroll:n},f,!0)}function b(e,t,n){if(!l(t))return t.size=null;if(t.size){if(t.size.ignoreScroll==n&&t.size.date>new Date-z)return null}else t.size={};return x(t.size,y(e,t,n),{date:+(new Date)},!0)}function w(e,t){e.view.editable=y(e,e.editable,t,!0)}function E(e,t){e.view||(e.view={});var n=e.view;if(t||!(n&&n.date>new Date-z)){var r=e.win,n=r.getScrollPosition(),r=r.getViewPaneSize();x(e.view,{scroll:{x:n.x,y:n.y,width:e.doc.$.documentElement.scrollWidth-r.width,height:e.doc.$.documentElement.scrollHeight-r.height},pane:{width:r.width,height:r.height,bottom:r.height+n.y},date:+(new Date)},!0)}}function S(e,n,r,i){for(var s=i,o=i,u=0,a=!1,f=!1,l=e.view.pane.height,c=e.mouse;c.y+u<l&&0<c.y-u;){a||(a=n(s,i)),f||(f=n(o,i)),!a&&0<c.y-u&&(s=r(e,{x:c.x,y:c.y-u})),!f&&c.y+u<l&&(o=r(e,{x:c.x,y:c.y+u}));if(a&&f)break;u+=2}return new t([s,o,null,null])}CKEDITOR.plugins.add("magicline",{init:function(e){var r=e.config,s=r.magicline_triggerOffset||30,p={editor:e,enterMode:r.enterMode,triggerOffset:s,holdDistance:0|s*(r.magicline_holdDistance||.5),boxColor:r.magicline_color||"#ff0000",rtl:"rtl"==r.contentsLangDirection,tabuList:["data-cke-hidden-sel"].concat(r.magicline_tabuList||[]),triggers:r.magicline_everywhere?U:{table:1,hr:1,div:1,ul:1,ol:1,dl:1,form:1,blockquote:1}},v,b,S;p.isRelevant=function(e){return l(e)&&!f(p,e)&&!c(e)},e.on("contentDom",function(){var s=e.editable(),l=e.document,c=e.window;x(p,{editable:s,inInlineMode:s.isInline(),doc:l,win:c,hotNode:null},!0),p.boundary=p.inInlineMode?p.editable:p.doc.getDocumentElement(),s.is(L.$inline)||(p.inInlineMode&&!h(s)&&s.setStyles({position:"relative",top:null,left:null}),o.call(this,p),E(p),s.attachListener(e,"beforeUndoImage",function(){p.line.detach()}),s.attachListener(e,"beforeGetData",function(){p.line.wrap.getParent()&&(p.line.detach(),e.once("getData",function(){p.line.attach()},null,null,1e3))},null,null,0),s.attachListener(p.inInlineMode?l:l.getWindow().getFrame(),"mouseout",function(t){if("wysiwyg"==e.mode)if(p.inInlineMode){var n=t.data.$.clientX,t=t.data.$.clientY;E(p),w(p,!0);var r=p.view.editable,i=p.view.scroll;if(!(n>r.left-i.x&&n<r.right-i.x)||!(t>r.top-i.y&&t<r.bottom-i.y))clearTimeout(S),S=null,p.line.detach()}else clearTimeout(S),S=null,p.line.detach()}),s.attachListener(s,"keyup",function(){p.hiddenMode=0}),s.attachListener(s,"keydown",function(t){if("wysiwyg"==e.mode)switch(t=t.data.getKeystroke(),e.getSelection().getStartElement(),t){case 2228240:case 16:p.hiddenMode=1,p.line.detach()}}),s.attachListener(p.inInlineMode?s:l,"mousemove",function(t){b=!0;if("wysiwyg"==e.mode&&!e.readOnly&&!S){var n={x:t.data.$.clientX,y:t.data.$.clientY};S=setTimeout(function(){p.mouse=n,S=p.trigger=null,E(p),b&&!p.hiddenMode&&e.focusManager.hasFocus&&!p.line.mouseNear()&&(p.element=$(p,!0))&&((p.trigger=m(p)||g(p)||Q(p))&&!d(p,p.trigger.upper||p.trigger.lower)?p.line.attach().place():(p.trigger=null,p.line.detach()),b=!1)},30)}}),s.attachListener(c,"scroll",function(){"wysiwyg"==e.mode&&(p.line.detach(),C.webkit&&(p.hiddenMode=1,clearTimeout(v),v=setTimeout(function(){p.mouseDown||(p.hiddenMode=0)},50)))}),s.attachListener(k?l:c,"mousedown",function(){"wysiwyg"==e.mode&&(p.line.detach(),p.hiddenMode=1,p.mouseDown=1)}),s.attachListener(k?l:c,"mouseup",function(){p.hiddenMode=0,p.mouseDown=0}),e.addCommand("accessPreviousSpace",a(p)),e.addCommand("accessNextSpace",a(p,!0)),e.setKeystroke([[r.magicline_keystrokePrevious,"accessPreviousSpace"],[r.magicline_keystrokeNext,"accessNextSpace"]]),e.on("loadSnapshot",function(){var t,n,r,i;for(i in{p:1,br:1,div:1}){t=e.document.getElementsByTag(i);for(r=t.count();r--;)if((n=t.getItem(r)).data("cke-magicline-hot")){p.hotNode=n,p.lastCmdDirection="true"===n.data("cke-magicline-dir")?!0:!1;return}}}),this.backdoor={accessFocusSpace:u,boxTrigger:t,isLine:f,getAscendantTrigger:n,getNonEmptyNeighbour:i,getSize:y,that:p,triggerEdge:g,triggerEditable:m,triggerExpand:Q})},this)}});var x=CKEDITOR.tools.extend,T=CKEDITOR.dom.element,N=T.createFromHtml,C=CKEDITOR.env,k=CKEDITOR.env.ie&&9>CKEDITOR.env.version,L=CKEDITOR.dtd,A={},O=128,M=64,_=32,D=16,P=8,H=4,B=2,j=1,F=" ",I=L.$listItem,q=L.$tableContent,R=x({},L.$nonEditable,L.$empty),U=L.$block,z=100,W="width:0px;height:0px;padding:0px;margin:0px;display:block;z-index:9999;color:#fff;position:absolute;font-size: 0px;line-height:0px;",X=W+"border-color:transparent;display:block;border-style:solid;",V="<span>"+F+"</span>";A[CKEDITOR.ENTER_BR]="br",A[CKEDITOR.ENTER_P]="p",A[CKEDITOR.ENTER_DIV]="div",t.prototype={set:function(e,t,n){return this.properties=e+t+(n||j),this},is:function(e){return(this.properties&e)==e}};var $=function(){function e(e,t){var n=e.$.elementFromPoint(t.x,t.y);return n&&n.nodeType?new CKEDITOR.dom.element(n):null}return function(t,n,r){if(!t.mouse)return null;var i=t.doc,s=t.line.wrap,r=r||t.mouse,o=e(i,r);return n&&f(t,o)&&(s.hide(),o=e(i,r),s.show()),!o||o.type!=CKEDITOR.NODE_ELEMENT||!o.$||C.ie&&9>C.version&&!t.boundary.equals(o)&&!t.boundary.contains(o)?null:o}}(),J=CKEDITOR.dom.walker.whitespaces(),K=CKEDITOR.dom.walker.nodeType(CKEDITOR.NODE_COMMENT),Q=function(){function t(t){var i=t.element,s,o,u;if(!l(i)||i.contains(t.editable)||i.isReadOnly())return null;u=S(t,function(e,t){return!t.equals(e)},function(e,t){return $(e,!0,t)},i),s=u.upper,o=u.lower;if(e(t,s,o))return u.set(_,P);if(s&&i.contains(s))for(;!s.getParent().equals(i);)s=s.getParent();else s=i.getFirst(function(e){return n(t,e)});if(o&&i.contains(o))for(;!o.getParent().equals(i);)o=o.getParent();else o=i.getLast(function(e){return n(t,e)});if(!s||!o)return null;b(t,s),b(t,o);if(t.mouse.y>s.size.top&&t.mouse.y<o.size.bottom){for(var i=Number.MAX_VALUE,a,f,c,h;o&&!o.equals(s)&&(f=s.getNext(t.isRelevant));)a=Math.abs(r(t,s,f)-t.mouse.y),a<i&&(i=a,c=s,h=f),s=f,b(t,s);return!!c&&!!h&&t.mouse.y>c.size.top&&t.mouse.y<h.size.bottom?(u.upper=c,u.lower=h,u.set(_,P)):null}return null}function n(e,t){return!(t&&t.type==CKEDITOR.NODE_TEXT||K(t)||c(t)||f(e,t)||t.type==CKEDITOR.NODE_ELEMENT&&t.$&&t.is("br"))}return function(n){var r=t(n),i;if(i=r){i=r.upper;var s=r.lower;i=!i||!s||c(s)||c(i)||s.equals(i)||i.equals(s)||s.contains(i)||i.contains(s)?!1:p(n,i)&&p(n,s)&&e(n,i,s)?!0:!1}return i?r:null}}(),G=["top","left","right","bottom"]}(),CKEDITOR.config.magicline_keystrokePrevious=CKEDITOR.CTRL+CKEDITOR.SHIFT+51,CKEDITOR.config.magicline_keystrokeNext=CKEDITOR.CTRL+CKEDITOR.SHIFT+52,function(){function e(e){if(!e||e.type!=CKEDITOR.NODE_ELEMENT||"form"!=e.getName())return[];for(var t=[],n=["style","className"],r=0;r<n.length;r++){var i=e.$.elements.namedItem(n[r]);i&&(i=new CKEDITOR.dom.element(i),t.push([i,i.nextSibling]),i.remove())}return t}function t(e,t){if(e&&e.type==CKEDITOR.NODE_ELEMENT&&"form"==e.getName()&&0<t.length)for(var n=t.length-1;0<=n;n--){var r=t[n][0],i=t[n][1];i?r.insertBefore(i):r.appendTo(e)}}function n(n,r){var i=e(n),s={},u=n.$;return r||(s["class"]=u.className||"",u.className=""),s.inline=u.style.cssText||"",r||(u.style.cssText="position: static; overflow: visible"),t(i),s}function r(n,r){var i=e(n),s=n.$;"class"in r&&(s.className=r["class"]),"inline"in r&&(s.style.cssText=r.inline),t(i)}function i(e){if(!e.editable().isInline()){var t=CKEDITOR.instances,n;for(n in t){var r=t[n];"wysiwyg"==r.mode&&!r.readOnly&&(r=r.document.getBody(),r.setAttribute("contentEditable",!1),r.setAttribute("contentEditable",!0))}e.editable().hasFocus&&(e.toolbox.focus(),e.focus())}}CKEDITOR.plugins.add("maximize",{init:function(e){function t(){var t=u.getViewPaneSize();e.resize(t.width,t.height,null,!0)}if(e.elementMode!=CKEDITOR.ELEMENT_MODE_INLINE){var s=e.lang,o=CKEDITOR.document,u=o.getWindow(),a,f,l,c=CKEDITOR.TRISTATE_OFF;e.addCommand("maximize",{modes:{wysiwyg:!CKEDITOR.env.iOS,source:!CKEDITOR.env.iOS},readOnly:1,editorFocus:!1,exec:function(){var h=e.container.getChild(1),v=e.ui.space("contents");if("wysiwyg"==e.mode){var g=e.getSelection();a=g&&g.getRanges(),f=u.getScrollPosition()}else{var y=e.editable().$;a=!CKEDITOR.env.ie&&[y.selectionStart,y.selectionEnd],f=[y.scrollLeft,y.scrollTop]}if(this.state==CKEDITOR.TRISTATE_OFF){u.on("resize",t),l=u.getScrollPosition();for(g=e.container;g=g.getParent();)g.setCustomData("maximize_saved_styles",n(g)),g.setStyle("z-index",e.config.baseFloatZIndex-5);v.setCustomData("maximize_saved_styles",n(v,!0)),h.setCustomData("maximize_saved_styles",n(h,!0)),v={overflow:CKEDITOR.env.webkit?"":"hidden",width:0,height:0},o.getDocumentElement().setStyles(v),!CKEDITOR.env.gecko&&o.getDocumentElement().setStyle("position","fixed"),(!CKEDITOR.env.gecko||!CKEDITOR.env.quirks)&&o.getBody().setStyles(v),CKEDITOR.env.ie?setTimeout(function(){u.$.scrollTo(0,0)},0):u.$.scrollTo(0,0),h.setStyle("position",CKEDITOR.env.gecko&&CKEDITOR.env.quirks?"fixed":"absolute"),h.$.offsetLeft,h.setStyles({"z-index":e.config.baseFloatZIndex-5,left:"0px",top:"0px"}),h.addClass("cke_maximized"),t(),v=h.getDocumentPosition(),h.setStyles({left:-1*v.x+"px",top:-1*v.y+"px"}),CKEDITOR.env.gecko&&i(e)}else if(this.state==CKEDITOR.TRISTATE_ON){u.removeListener("resize",t),v=[v,h];for(g=0;g<v.length;g++)r(v[g],v[g].getCustomData("maximize_saved_styles")),v[g].removeCustomData("maximize_saved_styles");for(g=e.container;g=g.getParent();)r(g,g.getCustomData("maximize_saved_styles")),g.removeCustomData("maximize_saved_styles");CKEDITOR.env.ie?setTimeout(function(){u.$.scrollTo(l.x,l.y)},0):u.$.scrollTo(l.x,l.y),h.removeClass("cke_maximized"),CKEDITOR.env.webkit&&(h.setStyle("display","inline"),setTimeout(function(){h.setStyle("display","block")},0)),e.fire("resize")}this.toggleState();if(g=this.uiItems[0])v=this.state==CKEDITOR.TRISTATE_OFF?s.maximize.maximize:s.maximize.minimize,g=CKEDITOR.document.getById(g._.id),g.getChild(1).setHtml(v),g.setAttribute("title",v),g.setAttribute("href",'javascript:void("'+v+'");');"wysiwyg"==e.mode?a?(CKEDITOR.env.gecko&&i(e),e.getSelection().selectRanges(a),(y=e.getSelection().getStartElement())&&y.scrollIntoView(!0)):u.$.scrollTo(f.x,f.y):(a&&(y.selectionStart=a[0],y.selectionEnd=a[1]),y.scrollLeft=f[0],y.scrollTop=f[1]),a=f=null,c=this.state,e.fire("maximize",this.state)},canUndo:!1}),e.ui.addButton&&e.ui.addButton("Maximize",{label:s.maximize.maximize,command:"maximize",toolbar:"tools,10"}),e.on("mode",function(){var t=e.getCommand("maximize");t.setState(t.state==CKEDITOR.TRISTATE_DISABLED?CKEDITOR.TRISTATE_DISABLED:c)},null,null,100)}}})}(),CKEDITOR.plugins.add("newpage",{init:function(e){e.addCommand("newpage",{modes:{wysiwyg:1,source:1},exec:function(e){var t=this;e.setData(e.config.newpage_html||"",function(){e.focus(),setTimeout(function(){e.fire("afterCommandExec",{name:"newpage",command:t}),e.selectionChange()},200)})},async:!0}),e.ui.addButton&&e.ui.addButton("NewPage",{label:e.lang.newpage.toolbar,command:"newpage",toolbar:"document,20"})}}),function(){function e(e){return{"aria-label":e,"class":"cke_pagebreak",contenteditable:"false","data-cke-display-name":"pagebreak","data-cke-pagebreak":1,style:"page-break-after: always",title:e}}CKEDITOR.plugins.add("pagebreak",{requires:"fakeobjects",onLoad:function(){var e=("background:url("+CKEDITOR.getUrl(this.path+"images/pagebreak.gif")+") no-repeat center center;clear:both;width:100%;border-top:#999 1px dotted;border-bottom:#999 1px dotted;padding:0;height:5px;cursor:default;").replace(/;/g," !important;");CKEDITOR.addCss("div.cke_pagebreak{"+e+"}")},init:function(e){e.blockless||(e.addCommand("pagebreak",CKEDITOR.plugins.pagebreakCmd),e.ui.addButton&&e.ui.addButton("PageBreak",{label:e.lang.pagebreak.toolbar,command:"pagebreak",toolbar:"insert,70"}),CKEDITOR.env.webkit&&e.on("contentDom",function(){e.document.on("click",function(t){t=t.data.getTarget(),t.is("div")&&t.hasClass("cke_pagebreak")&&e.getSelection().selectElement(t)})}))},afterInit:function(t){function n(n){CKEDITOR.tools.extend(n.attributes,e(t.lang.pagebreak.alt),!0),n.children.length=0}var r=t.dataProcessor,i=r&&r.dataFilter,r=r&&r.htmlFilter,s=/page-break-after\s*:\s*always/i,o=/display\s*:\s*none/i;r&&r.addRules({attributes:{"class":function(e,t){var n=e.replace("cke_pagebreak","");if(n!=e){var r=CKEDITOR.htmlParser.fragment.fromHtml('<span style="display: none;">&nbsp;</span>').children[0];t.children.length=0,t.add(r),r=t.attributes,delete r["aria-label"],delete r.contenteditable,delete r.title}return n}}},{applyToAll:!0,priority:5}),i&&i.addRules({elements:{div:function(e){if(e.attributes["data-cke-pagebreak"])n(e);else if(s.test(e.attributes.style)){var t=e.children[0];t&&"span"==t.name&&o.test(t.attributes.style)&&n(e)}}}})}}),CKEDITOR.plugins.pagebreakCmd={exec:function(t){var n=t.document.createElement("div",{attributes:e(t.lang.pagebreak.alt)});t.insertElement(n)},context:"div",allowedContent:{div:{styles:"!page-break-after"},span:{match:function(e){return(e=e.parent)&&"div"==e.name&&e.styles["page-break-after"]},styles:"display"}},requiredContent:"div{page-break-after}"}}(),function(){var e={canUndo:!1,async:!0,exec:function(t){t.getClipboardData({title:t.lang.pastetext.title},function(n){n&&t.fire("paste",{type:"text",dataValue:n.dataValue}),t.fire("afterCommandExec",{name:"pastetext",command:e,returnValue:!!n})})}};CKEDITOR.plugins.add("pastetext",{requires:"clipboard",init:function(t){t.addCommand("pastetext",e),t.ui.addButton&&t.ui.addButton("PasteText",{label:t.lang.pastetext.button,command:"pastetext",toolbar:"clipboard,40"}),t.config.forcePasteAsPlainText&&t.on("beforePaste",function(e){"html"!=e.data.type&&(e.data.type="text")}),t.on("pasteState",function(e){t.getCommand("pastetext").setState(e.data)})}})}(),function(){function e(e,t,n){var r=CKEDITOR.cleanWord;return r?n():(e=CKEDITOR.getUrl(e.config.pasteFromWordCleanupFile||t+"filter/default.js"),CKEDITOR.scriptLoader.load(e,n,null,!0)),!r}function t(e){e.data.type="html"}CKEDITOR.plugins.add("pastefromword",{requires:"clipboard",init:function(n){var r=0,s=this.path;n.addCommand("pastefromword",{canUndo:!1,async:!0,exec:function(e){var n=this;r=1,e.once("beforePaste",t),e.getClipboardData({title:e.lang.pastefromword.title},function(t){t&&e.fire("paste",{type:"html",dataValue:t.dataValue}),e.fire("afterCommandExec",{name:"pastefromword",command:n,returnValue:!!t})})}}),n.ui.addButton&&n.ui.addButton("PasteFromWord",{label:n.lang.pastefromword.toolbar,command:"pastefromword",toolbar:"clipboard,50"}),n.on("pasteState",function(e){n.getCommand("pastefromword").setState(e.data)}),n.on("paste",function(t){var i=t.data,o=i.dataValue;if(o&&(r||/(class=\"?Mso|style=\"[^\"]*\bmso\-|w:WordDocument)/.test(o))){var u=e(n,s,function(){if(u)n.fire("paste",i);else if(!n.config.pasteFromWordPromptCleanup||r||confirm(n.lang.pastefromword.confirmCleanup))i.dataValue=CKEDITOR.cleanWord(o,n)});u&&t.cancel()}},null,null,3)}})}(),function(){var e,t={modes:{wysiwyg:1,source:1},canUndo:!1,readOnly:1,exec:function(t){var n,r=t.config,i=r.baseHref?'<base href="'+r.baseHref+'"/>':"";if(r.fullPage)n=t.getData().replace(/<head>/,"$&"+i).replace(/[^>]*(?=<\/title>)/,"$& &mdash; "+t.lang.preview.preview);else{var r="<body ",s=t.document&&t.document.getBody();s&&(s.getAttribute("id")&&(r+='id="'+s.getAttribute("id")+'" '),s.getAttribute("class")&&(r+='class="'+s.getAttribute("class")+'" ')),n=t.config.docType+'<html dir="'+t.config.contentsLangDirection+'"><head>'+i+"<title>"+t.lang.preview.preview+"</title>"+CKEDITOR.tools.buildStyleHtml(t.config.contentsCss)+"</head>"+(r+">")+t.getData()+"</body></html>"}i=640,r=420,s=80;try{var o=window.screen,i=Math.round(.8*o.width),r=Math.round(.7*o.height),s=Math.round(.1*o.width)}catch(u){}if(!1===t.fire("contentPreview",t={dataValue:n}))return!1;var o="",a;return CKEDITOR.env.ie&&(window._cke_htmlToLoad=t.dataValue,a="javascript:void( (function(){document.open();"+("("+CKEDITOR.tools.fixDomain+")();").replace(/\/\/.*?\n/g,"").replace(/parent\./g,"window.opener.")+"document.write( window.opener._cke_htmlToLoad );document.close();window.opener._cke_htmlToLoad = null;})() )",o=""),CKEDITOR.env.gecko&&(window._cke_htmlToLoad=t.dataValue,o=e+"preview.html"),o=window.open(o,null,"toolbar=yes,location=no,status=yes,menubar=yes,scrollbars=yes,resizable=yes,width="+i+",height="+r+",left="+s),CKEDITOR.env.ie&&o&&(o.location=a),!CKEDITOR.env.ie&&!CKEDITOR.env.gecko&&(a=o.document,a.open(),a.write(t.dataValue),a.close()),!0}};CKEDITOR.plugins.add("preview",{init:function(n){n.elementMode!=CKEDITOR.ELEMENT_MODE_INLINE&&(e=this.path,n.addCommand("preview",t),n.ui.addButton&&n.ui.addButton("Preview",{label:n.lang.preview.preview,command:"preview",toolbar:"document,40"}))}})}(),CKEDITOR.plugins.add("print",{init:function(e){e.elementMode!=CKEDITOR.ELEMENT_MODE_INLINE&&(e.addCommand("print",CKEDITOR.plugins.print),e.ui.addButton&&e.ui.addButton("Print",{label:e.lang.print.toolbar,command:"print",toolbar:"document,50"}))}}),CKEDITOR.plugins.print={exec:function(e){CKEDITOR.env.gecko?e.window.$.print():e.document.$.execCommand("Print")},canUndo:!1,readOnly:1,modes:{wysiwyg:1}},CKEDITOR.plugins.add("removeformat",{init:function(e){e.addCommand("removeFormat",CKEDITOR.plugins.removeformat.commands.removeformat),e.ui.addButton&&e.ui.addButton("RemoveFormat",{label:e.lang.removeformat.toolbar,command:"removeFormat",toolbar:"cleanup,10"})}}),CKEDITOR.plugins.removeformat={commands:{removeformat:{exec:function(e){for(var t=e._.removeFormatRegex||(e._.removeFormatRegex=RegExp("^(?:"+e.config.removeFormatTags.replace(/,/g,"|")+")$","i")),n=e._.removeAttributes||(e._.removeAttributes=e.config.removeFormatAttributes.split(",")),r=CKEDITOR.plugins.removeformat.filter,i=e.getSelection().getRanges(),s=i.createIterator(),o=function(e){return e.type==CKEDITOR.NODE_ELEMENT},u;u=s.getNextRange();){u.collapsed||u.enlarge(CKEDITOR.ENLARGE_ELEMENT);var a=u.createBookmark(),f=a.startNode,l=a.endNode,c=function(n){for(var i=e.elementPath(n),s=i.elements,o=1,u;(u=s[o])&&!u.equals(i.block)&&!u.equals(i.blockLimit);o++)t.test(u.getName())&&r(e,u)&&n.breakParent(u)};c(f);if(l){c(l);for(f=f.getNextSourceNode(!0,CKEDITOR.NODE_ELEMENT);f&&!f.equals(l);)if(f.isReadOnly()){if(f.getPosition(l)&CKEDITOR.POSITION_CONTAINS)break;f=f.getNext(o)}else c=f.getNextSourceNode(!1,CKEDITOR.NODE_ELEMENT),("img"!=f.getName()||!f.data("cke-realelement"))&&r(e,f)&&(t.test(f.getName())?f.remove(1):(f.removeAttributes(n),e.fire("removeFormatCleanup",f))),f=c}u.moveToBookmark(a)}e.forceNextSelectionCheck(),e.getSelection().selectRanges(i)}}},filter:function(e,t){for(var n=e._.removeFormatFilters||[],r=0;r<n.length;r++)if(!1===n[r](t))return!1;return!0}},CKEDITOR.editor.prototype.addRemoveFormatFilter=function(e){this._.removeFormatFilters||(this._.removeFormatFilters=[]),this._.removeFormatFilters.push(e)},CKEDITOR.config.removeFormatTags="b,big,code,del,dfn,em,font,i,ins,kbd,q,s,samp,small,span,strike,strong,sub,sup,tt,u,var",CKEDITOR.config.removeFormatAttributes="class,style,lang,width,height,align,hspace,valign",function(){var e={readOnly:1,exec:function(e){if(e.fire("save")&&(e=e.element.$.form))try{e.submit()}catch(t){e.submit.click&&e.submit.click()}}};CKEDITOR.plugins.add("save",{init:function(t){t.elementMode==CKEDITOR.ELEMENT_MODE_REPLACE&&(t.addCommand("save",e).modes={wysiwyg:!!t.element.$.form},t.ui.addButton&&t.ui.addButton("Save",{label:t.lang.save.toolbar,command:"save",toolbar:"document,10"}))}})}(),function(){CKEDITOR.plugins.add("selectall",{init:function(e){e.addCommand("selectAll",{modes:{wysiwyg:1,source:1},exec:function(e){var t=e.editable();if(t.is("textarea"))e=t.$,CKEDITOR.env.ie?e.createTextRange().execCommand("SelectAll"):(e.selectionStart=0,e.selectionEnd=e.value.length),e.focus();else{if(t.is("body"))e.document.$.execCommand("SelectAll",!1,null);else{var n=e.createRange();n.selectNodeContents(t),n.select()}e.forceNextSelectionCheck(),e.selectionChange()}},canUndo:!1}),e.ui.addButton&&e.ui.addButton("SelectAll",{label:e.lang.selectall.toolbar,command:"selectAll",toolbar:"selection,10"})}})}(),function(){var e={readOnly:1,preserveState:!0,editorFocus:!1,exec:function(e){this.toggleState(),this.refresh(e)},refresh:function(e){if(e.document){var t=this.state!=CKEDITOR.TRISTATE_ON||e.elementMode==CKEDITOR.ELEMENT_MODE_INLINE&&!e.focusManager.hasFocus?"removeClass":"attachClass";e.editable()[t]("cke_show_blocks")}}};CKEDITOR.plugins.add("showblocks",{onLoad:function(){var e="p div pre address blockquote h1 h2 h3 h4 h5 h6".split(" "),t,n,r,i,s=CKEDITOR.getUrl(this.path),o=!(CKEDITOR.env.ie&&9>CKEDITOR.env.version),u=o?":not([contenteditable=false]):not(.cke_show_blocks_off)":"",a,f;for(t=n=r=i="";a=e.pop();)f=e.length?",":"",t+=".cke_show_blocks "+a+u+f,r+=".cke_show_blocks.cke_contents_ltr "+a+u+f,i+=".cke_show_blocks.cke_contents_rtl "+a+u+f,n+=".cke_show_blocks "+a+u+"{background-image:url("+s+"images/block_"+a+".png)}";CKEDITOR.addCss((t+"{background-repeat:no-repeat;border:1px dotted gray;padding-top:8px}").concat(n,r+"{background-position:top left;padding-left:8px}",i+"{background-position:top right;padding-right:8px}")),o||CKEDITOR.addCss(".cke_show_blocks [contenteditable=false],.cke_show_blocks .cke_show_blocks_off{border:none;padding-top:0;background-image:none}.cke_show_blocks.cke_contents_rtl [contenteditable=false],.cke_show_blocks.cke_contents_rtl .cke_show_blocks_off{padding-right:0}.cke_show_blocks.cke_contents_ltr [contenteditable=false],.cke_show_blocks.cke_contents_ltr .cke_show_blocks_off{padding-left:0}")},init:function(t){function n(){r.refresh(t)}if(!t.blockless){var r=t.addCommand("showblocks",e);r.canUndo=!1,t.config.startupOutlineBlocks&&r.setState(CKEDITOR.TRISTATE_ON),t.ui.addButton&&t.ui.addButton("ShowBlocks",{label:t.lang.showblocks.toolbar,command:"showblocks",toolbar:"tools,20"}),t.on("mode",function(){r.state!=CKEDITOR.TRISTATE_DISABLED&&r.refresh(t)}),t.elementMode==CKEDITOR.ELEMENT_MODE_INLINE&&(t.on("focus",n),t.on("blur",n)),t.on("contentDom",function(){r.state!=CKEDITOR.TRISTATE_DISABLED&&r.refresh(t)})}}})}(),function(){var e={preserveState:!0,editorFocus:!1,readOnly:1,exec:function(e){this.toggleState(),this.refresh(e)},refresh:function(e){if(e.document){var t=this.state==CKEDITOR.TRISTATE_ON?"attachClass":"removeClass";e.editable()[t]("cke_show_borders")}}};CKEDITOR.plugins.add("showborders",{modes:{wysiwyg:1},onLoad:function(){var e;e=(CKEDITOR.env.ie6Compat?[".%1 table.%2,",".%1 table.%2 td, .%1 table.%2 th","{","border : #d3d3d3 1px dotted","}"]:".%1 table.%2,;.%1 table.%2 > tr > td, .%1 table.%2 > tr > th,;.%1 table.%2 > tbody > tr > td, .%1 table.%2 > tbody > tr > th,;.%1 table.%2 > thead > tr > td, .%1 table.%2 > thead > tr > th,;.%1 table.%2 > tfoot > tr > td, .%1 table.%2 > tfoot > tr > th;{;border : #d3d3d3 1px dotted;}".split(";")).join("").replace(/%2/g,"cke_show_border").replace(/%1/g,"cke_show_borders "),CKEDITOR.addCss(e)},init:function(t){var n=t.addCommand("showborders",e);n.canUndo=!1,!1!==t.config.startupShowBorders&&n.setState(CKEDITOR.TRISTATE_ON),t.on("mode",function(){n.state!=CKEDITOR.TRISTATE_DISABLED&&n.refresh(t)},null,null,100),t.on("contentDom",function(){n.state!=CKEDITOR.TRISTATE_DISABLED&&n.refresh(t)}),t.on("removeFormatCleanup",function(e){e=e.data,t.getCommand("showborders").state==CKEDITOR.TRISTATE_ON&&e.is("table")&&(!e.hasAttribute("border")||0>=parseInt(e.getAttribute("border"),10))&&e.addClass("cke_show_border")})},afterInit:function(e){var t=e.dataProcessor,e=t&&t.dataFilter,t=t&&t.htmlFilter;e&&e.addRules({elements:{table:function(e){var e=e.attributes,t=e["class"],n=parseInt(e.border,10);(!n||0>=n)&&(!t||-1==t.indexOf("cke_show_border"))&&(e["class"]=(t||"")+" cke_show_border")}}}),t&&t.addRules({elements:{table:function(e){var e=e.attributes,t=e["class"];t&&(e["class"]=t.replace("cke_show_border","").replace(/\s{2}/," ").replace(/^\s+|\s+$/,""))}}})}}),CKEDITOR.on("dialogDefinition",function(e){var t=e.data.name;if("table"==t||"tableProperties"==t)if(e=e.data.definition,t=e.getContents("info").get("txtBorder"),t.commit=CKEDITOR.tools.override(t.commit,function(e){return function(t,n){e.apply(this,arguments);var r=parseInt(this.getValue(),10);n[!r||0>=r?"addClass":"removeClass"]("cke_show_border")}}),e=(e=e.getContents("advanced"))&&e.get("advCSSClasses"))e.setup=CKEDITOR.tools.override(e.setup,function(e){return function(){e.apply(this,arguments),this.setValue(this.getValue().replace(/cke_show_border/,""))}}),e.commit=CKEDITOR.tools.override(e.commit,function(e){return function(t,n){e.apply(this,arguments),parseInt(n.getAttribute("border"),10)||n.addClass("cke_show_border")}})})}(),function(){CKEDITOR.plugins.add("sourcearea",{init:function(t){function n(){var e=i&&this.equals(CKEDITOR.document.getActive());this.hide(),this.setStyle("height",this.getParent().$.clientHeight+"px"),this.setStyle("width",this.getParent().$.clientWidth+"px"),this.show(),e&&this.focus()}if(t.elementMode!=CKEDITOR.ELEMENT_MODE_INLINE){var r=CKEDITOR.plugins.sourcearea;t.addMode("source",function(r){var i=t.ui.space("contents").getDocument().createElement("textarea");i.setStyles(CKEDITOR.tools.extend({width:CKEDITOR.env.ie7Compat?"99%":"100%",height:"100%",resize:"none",outline:"none","text-align":"left"},CKEDITOR.tools.cssVendorPrefix("tab-size",t.config.sourceAreaTabSize||4))),i.setAttribute("dir","ltr"),i.addClass("cke_source cke_reset cke_enable_context_menu"),t.ui.space("contents").append(i),i=t.editable(new e(t,i)),i.setData(t.getData(1)),CKEDITOR.env.ie&&(i.attachListener(t,"resize",n,i),i.attachListener(CKEDITOR.document.getWindow(),"resize",n,i),CKEDITOR.tools.setTimeout(n,0,i)),t.fire("ariaWidget",this),r()}),t.addCommand("source",r.commands.source),t.ui.addButton&&t.ui.addButton("Source",{label:t.lang.sourcearea.toolbar,command:"source",toolbar:"mode,10"}),t.on("mode",function(){t.getCommand("source").setState("source"==t.mode?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF)});var i=CKEDITOR.env.ie&&9==CKEDITOR.env.version}}});var e=CKEDITOR.tools.createClass({base:CKEDITOR.editable,proto:{setData:function(e){this.setValue(e),this.status="ready",this.editor.fire("dataReady")},getData:function(){return this.getValue()},insertHtml:function(){},insertElement:function(){},insertText:function(){},setReadOnly:function(e){this[(e?"set":"remove")+"Attribute"]("readOnly","readonly")},detach:function(){e.baseProto.detach.call(this),this.clearCustomData(),this.remove()}}})}(),CKEDITOR.plugins.sourcearea={commands:{source:{modes:{wysiwyg:1,source:1},editorFocus:!1,readOnly:1,exec:function(e){"wysiwyg"==e.mode&&e.fire("saveSnapshot"),e.getCommand("source").setState(CKEDITOR.TRISTATE_DISABLED),e.setMode("source"==e.mode?"wysiwyg":"source")},canUndo:!1}}},CKEDITOR.plugins.add("specialchar",{availableLangs:{ar:1,bg:1,ca:1,cs:1,cy:1,de:1,el:1,en:1,"en-gb":1,eo:1,es:1,et:1,fa:1,fi:1,fr:1,"fr-ca":1,gl:1,he:1,hr:1,hu:1,id:1,it:1,ja:1,km:1,ku:1,lv:1,nb:1,nl:1,no:1,pl:1,pt:1,"pt-br":1,ru:1,si:1,sk:1,sl:1,sq:1,sv:1,th:1,tr:1,tt:1,ug:1,uk:1,vi:1,zh:1,"zh-cn":1},requires:"dialog",init:function(e){var t=this;CKEDITOR.dialog.add("specialchar",this.path+"dialogs/specialchar.js"),e.addCommand("specialchar",{exec:function(){var n=e.langCode,n=t.availableLangs[n]?n:t.availableLangs[n.replace(/-.*/,"")]?n.replace(/-.*/,""):"en";CKEDITOR.scriptLoader.load(CKEDITOR.getUrl(t.path+"dialogs/lang/"+n+".js"),function(){CKEDITOR.tools.extend(e.lang.specialchar,t.langEntries[n]),e.openDialog("specialchar")})},modes:{wysiwyg:1},canUndo:!1}),e.ui.addButton&&e.ui.addButton("SpecialChar",{label:e.lang.specialchar.toolbar,command:"specialchar",toolbar:"insert,50"})}}),CKEDITOR.config.specialChars="! &quot; # $ % &amp; ' ( ) * + - . / 0 1 2 3 4 5 6 7 8 9 : ; &lt; = &gt; ? @ A B C D E F G H I J K L M N O P Q R S T U V W X Y Z [ ] ^ _ ` a b c d e f g h i j k l m n o p q r s t u v w x y z { | } ~ &euro; &lsquo; &rsquo; &ldquo; &rdquo; &ndash; &mdash; &iexcl; &cent; &pound; &curren; &yen; &brvbar; &sect; &uml; &copy; &ordf; &laquo; &not; &reg; &macr; &deg; &sup2; &sup3; &acute; &micro; &para; &middot; &cedil; &sup1; &ordm; &raquo; &frac14; &frac12; &frac34; &iquest; &Agrave; &Aacute; &Acirc; &Atilde; &Auml; &Aring; &AElig; &Ccedil; &Egrave; &Eacute; &Ecirc; &Euml; &Igrave; &Iacute; &Icirc; &Iuml; &ETH; &Ntilde; &Ograve; &Oacute; &Ocirc; &Otilde; &Ouml; &times; &Oslash; &Ugrave; &Uacute; &Ucirc; &Uuml; &Yacute; &THORN; &szlig; &agrave; &aacute; &acirc; &atilde; &auml; &aring; &aelig; &ccedil; &egrave; &eacute; &ecirc; &euml; &igrave; &iacute; &icirc; &iuml; &eth; &ntilde; &ograve; &oacute; &ocirc; &otilde; &ouml; &divide; &oslash; &ugrave; &uacute; &ucirc; &uuml; &yacute; &thorn; &yuml; &OElig; &oelig; &#372; &#374 &#373 &#375; &sbquo; &#8219; &bdquo; &hellip; &trade; &#9658; &bull; &rarr; &rArr; &hArr; &diams; &asymp;".split(" "),CKEDITOR.plugins.add("scayt",{requires:"menubutton,dialog",tabToOpen:null,dialogName:"scaytDialog",init:function(e){var t=this,n=CKEDITOR.plugins.scayt;this.bindEvents(e),this.parseConfig(e),this.addRule(e),CKEDITOR.dialog.add(this.dialogName,CKEDITOR.getUrl(this.path+"dialogs/options.js")),this.addMenuItems(e);var r=e.lang.scayt,i=CKEDITOR.env;e.ui.add("Scayt",CKEDITOR.UI_MENUBUTTON,{label:r.text_title,title:r.text_title,modes:{wysiwyg:!i.ie||!(8>i.version||i.quirks)},toolbar:"spellchecker,20",refresh:function(){var t=e.ui.instances.Scayt.getState();e.scayt&&(t=n.state[e.name]?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF),e.fire("scaytButtonState",t)},onRender:function(){var t=this;e.on("scaytButtonState",function(e){void 0!==typeof e.data&&t.setState(e.data)})},onMenu:function(){var t=e.scayt;return e.getMenuItem("scaytToggle").label=e.lang.scayt[t&&n.state[e.name]?"btn_disable":"btn_enable"],t={scaytToggle:CKEDITOR.TRISTATE_OFF,scaytOptions:t?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,scaytLangs:t?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,scaytDict:t?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,scaytAbout:t?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,WSC:e.plugins.wsc?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED},e.config.scayt_uiTabs[0]||delete t.scaytOptions,e.config.scayt_uiTabs[1]||delete t.scaytLangs,e.config.scayt_uiTabs[2]||delete t.scaytDict,t}}),e.contextMenu&&e.addMenuItems&&(e.contextMenu.addListener(function(){var n=e.scayt,r;if(n){var i=n.getSelectionNode();if(i=i?i.getAttribute(n.getNodeAttribute()):i)r=t.menuGenerator(e,i,t),n.showBanner("."+e.contextMenu._.definition.panel.className.split(" ").join(" ."))}return r}),e.contextMenu._.onHide=CKEDITOR.tools.override(e.contextMenu._.onHide,function(t){return function(){var n=e.scayt;return n&&n.hideBanner(),t.apply(this)}}))},addMenuItems:function(e){var t=this,n=CKEDITOR.plugins.scayt;e.addMenuGroup("scaytButton");var r=e.config.scayt_contextMenuItemsOrder.split("|");if(r&&r.length)for(var i=0;i<r.length;i++)e.addMenuGroup("scayt_"+r[i],i-10);r={scaytToggle:{label:e.lang.scayt.btn_enable,group:"scaytButton",onClick:function(){var t=e.scayt;n.state[e.name]=!n.state[e.name],!0===n.state[e.name]?t||n.createScayt(e):t&&n.destroy(e)}},scaytAbout:{label:e.lang.scayt.btn_about,group:"scaytButton",onClick:function(){e.scayt.tabToOpen="about",e.lockSelection(),e.openDialog(t.dialogName)}},scaytOptions:{label:e.lang.scayt.btn_options,group:"scaytButton",onClick:function(){e.scayt.tabToOpen="options",e.lockSelection(),e.openDialog(t.dialogName)}},scaytLangs:{label:e.lang.scayt.btn_langs,group:"scaytButton",onClick:function(){e.scayt.tabToOpen="langs",e.lockSelection(),e.openDialog(t.dialogName)}},scaytDict:{label:e.lang.scayt.btn_dictionaries,group:"scaytButton",onClick:function(){e.scayt.tabToOpen="dictionaries",e.lockSelection(),e.openDialog(t.dialogName)}}},e.plugins.wsc&&(r.WSC={label:e.lang.wsc.toolbar,group:"scaytButton",onClick:function(){var t=CKEDITOR.plugins.scayt,n=e.scayt,r=e.elementMode==CKEDITOR.ELEMENT_MODE_INLINE?e.container.getText():e.document.getBody().getText();(r=r.replace(/\s/g,""))?(n&&t.state[e.name]&&n.setMarkupPaused&&n.setMarkupPaused(!0),e.lockSelection(),e.execCommand("checkspell")):alert("Nothing to check!")}}),e.addMenuItems(r)},bindEvents:function(e){var t=CKEDITOR.plugins.scayt,n=e.elementMode==CKEDITOR.ELEMENT_MODE_INLINE;CKEDITOR.on("dialogDefinition",function(e){"scaytDialog"===e.data.name&&e.data.definition.dialog.on("cancel",function(){return!1},this,null,-1)});var r=function(){e.scayt&&t.destroy(e)},i=function(){t.state[e.name]&&!e.readOnly&&t.createScayt(e)},s=function(){n?(e.on("blur",r),e.on("focus",i),e.focusManager.hasFocus&&i()):i()};e.on("contentDom",s),e.on("beforeCommandExec",function(n){if(n.data.name in t.options.disablingCommandExec&&"wysiwyg"==e.mode){if(n=e.scayt)t.destroy(e),e.fire("scaytButtonState",CKEDITOR.TRISTATE_DISABLED)}else if("bold"===n.data.name||"italic"===n.data.name||"underline"===n.data.name||"strike"===n.data.name||"subscript"===n.data.name||"superscript"===n.data.name)if(n=e.scayt)n.removeMarkupInSelectionNode(),n.fire("startSpellCheck")}),e.on("beforeSetMode",function(n){"source"==n.data&&(n=e.scayt)&&(t.destroy(e),e.fire("scaytButtonState",CKEDITOR.TRISTATE_DISABLED))}),e.on("afterCommandExec",function(t){var n;"wysiwyg"==e.mode&&("undo"==t.data.name||"redo"==t.data.name)&&(n=e.scayt)&&setTimeout(function(){n.fire("startSpellCheck")},250)}),e.on("readOnly",function(n){var r;n&&(r=e.scayt,!0===n.editor.readOnly?r&&r.fire("removeMarkupInDocument",{}):r?r.fire("startSpellCheck"):"wysiwyg"==n.editor.mode&&!0===t.state[n.editor.name]&&(t.createScayt(e),n.editor.fire("scaytButtonState",CKEDITOR.TRISTATE_ON)))}),e.on("beforeDestroy",r),e.on("setData",function(){r(),e.elementMode==CKEDITOR.ELEMENT_MODE_INLINE&&s()},this,null,50),e.on("insertElement",function(){var t=e.scayt;t&&(t.removeMarkupInSelectionNode(),t.fire("startSpellCheck"))},this,null,50),e.on("insertHtml",function(){var t=e.scayt;t&&(t.removeMarkupInSelectionNode(),t.fire("startSpellCheck"))},this,null,50),e.on("scaytDialogShown",function(t){t.data.selectPage(e.scayt.tabToOpen)})},parseConfig:function(e){var t=CKEDITOR.plugins.scayt;t.replaceOldOptionsNames(e.config),"boolean"!=typeof e.config.scayt_autoStartup&&(e.config.scayt_autoStartup=!1),t.state[e.name]=e.config.scayt_autoStartup,e.config.scayt_contextCommands||(e.config.scayt_contextCommands="ignore|ignoreall|add"),e.config.scayt_contextMenuItemsOrder||(e.config.scayt_contextMenuItemsOrder="suggest|moresuggest|control"),e.config.scayt_sLang||(e.config.scayt_sLang="en_US");if(void 0===e.config.scayt_maxSuggestions||"number"!=typeof e.config.scayt_maxSuggestions||0>e.config.scayt_maxSuggestions)e.config.scayt_maxSuggestions=5;if(void 0===e.config.scayt_customDictionaryIds||"string"!=typeof e.config.scayt_customDictionaryIds)e.config.scayt_customDictionaryIds="";if(void 0===e.config.scayt_userDictionaryName||"string"!=typeof e.config.scayt_userDictionaryName)e.config.scayt_userDictionaryName=null;if("string"==typeof e.config.scayt_uiTabs&&3===e.config.scayt_uiTabs.split(",").length){var n=[],r=[];e.config.scayt_uiTabs=e.config.scayt_uiTabs.split(","),CKEDITOR.tools.search(e.config.scayt_uiTabs,function(e){Number(e)===1||Number(e)===0?(r.push(!0),n.push(Number(e))):r.push(!1)}),e.config.scayt_uiTabs=null===CKEDITOR.tools.search(r,!1)?n:[1,1,1]}else e.config.scayt_uiTabs=[1,1,1];"string"!=typeof e.config.scayt_serviceProtocol&&(e.config.scayt_serviceProtocol=null),"string"!=typeof e.config.scayt_serviceHost&&(e.config.scayt_serviceHost=null),"string"!=typeof e.config.scayt_servicePort&&(e.config.scayt_servicePort=null),"string"!=typeof e.config.scayt_servicePath&&(e.config.scayt_servicePath=null),e.config.scayt_moreSuggestions||(e.config.scayt_moreSuggestions="on"),"string"!=typeof e.config.scayt_customerId&&(e.config.scayt_customerId="1:WvF0D4-UtPqN1-43nkD4-NKvUm2-daQqk3-LmNiI-z7Ysb4-mwry24-T8YrS3-Q2tpq2"),"string"!=typeof e.config.scayt_srcUrl&&(t=document.location.protocol,t=-1!=t.search(/https?:/)?t:"http:",e.config.scayt_srcUrl=t+"//svc.webspellchecker.net/spellcheck31/lf/scayt3/ckscayt/ckscayt.js"),"boolean"!=typeof CKEDITOR.config.scayt_handleCheckDirty&&(CKEDITOR.config.scayt_handleCheckDirty=!0),"boolean"!=typeof CKEDITOR.config.scayt_handleUndoRedo&&(CKEDITOR.config.scayt_handleUndoRedo=!0)},addRule:function(e){var t=e.dataProcessor,n=t&&t.htmlFilter,r=e._.elementsPath&&e._.elementsPath.filters,t=t&&t.dataFilter,i=e.addRemoveFormatFilter,s=function(t){var n=CKEDITOR.plugins.scayt;if(e.scayt&&t.hasAttribute(n.options.data_attribute_name))return!1},o=function(t){var n=CKEDITOR.plugins.scayt,r=!0;return e.scayt&&t.hasAttribute(n.options.data_attribute_name)&&(r=!1),r};r&&r.push(s),t&&t.addRules({elements:{span:function(t){var n=CKEDITOR.plugins.scayt;return n&&n.state[e.name]&&t.classes&&CKEDITOR.tools.search(t.classes,n.options.misspelled_word_class)&&(t.classes&&t.parent.type===CKEDITOR.NODE_DOCUMENT_FRAGMENT?(delete t.attributes.style,delete t.name):delete t.classes[CKEDITOR.tools.indexOf(t.classes,n.options.misspelled_word_class)]),t}}}),n&&n.addRules({elements:{span:function(t){var n=CKEDITOR.plugins.scayt;return n&&n.state[e.name]&&t.hasClass(n.options.misspelled_word_class)&&t.attributes[n.options.data_attribute_name]&&(t.removeClass(n.options.misspelled_word_class),delete t.attributes[n.options.data_attribute_name],delete t.name),t}}}),i&&i.call(e,o)},scaytMenuDefinition:function(e){var t=this,e=e.scayt;return{scayt_ignore:{label:e.getLocal("btn_ignore"),group:"scayt_control",order:1,exec:function(e){e.scayt.ignoreWord()}},scayt_ignoreall:{label:e.getLocal("btn_ignoreAll"),group:"scayt_control",order:2,exec:function(e){e.scayt.ignoreAllWords()}},scayt_add:{label:e.getLocal("btn_addWord"),group:"scayt_control",order:3,exec:function(e){var t=e.scayt;setTimeout(function(){t.addWordToUserDictionary()},10)}},option:{label:e.getLocal("btn_options"),group:"scayt_control",order:4,exec:function(e){e.scayt.tabToOpen="options",e.lockSelection(),e.openDialog(t.dialogName)},verification:function(e){return 1==e.config.scayt_uiTabs[0]?!0:!1}},language:{label:e.getLocal("btn_langs"),group:"scayt_control",order:5,exec:function(e){e.scayt.tabToOpen="langs",e.lockSelection(),e.openDialog(t.dialogName)},verification:function(e){return 1==e.config.scayt_uiTabs[1]?!0:!1}},dictionary:{label:e.getLocal("btn_dictionaries"),group:"scayt_control",order:6,exec:function(e){e.scayt.tabToOpen="dictionaries",e.lockSelection(),e.openDialog(t.dialogName)},verification:function(e){return 1==e.config.scayt_uiTabs[2]?!0:!1}},about:{label:e.getLocal("btn_about"),group:"scayt_control",order:7,exec:function(e){e.scayt.tabToOpen="about",e.lockSelection(),e.openDialog(t.dialogName)}}}},buildSuggestionMenuItems:function(e,t){var n={},r={},i=e.scayt;if(0<t.length&&"no_any_suggestions"!==t[0])for(var s=0;s<t.length;s++){var o="scayt_suggest_"+CKEDITOR.plugins.scayt.suggestions[s].replace(" ","_");e.addCommand(o,this.createCommand(CKEDITOR.plugins.scayt.suggestions[s])),s<e.config.scayt_maxSuggestions?(e.addMenuItem(o,{label:t[s],command:o,group:"scayt_suggest",order:s+1}),n[o]=CKEDITOR.TRISTATE_OFF):(e.addMenuItem(o,{label:t[s],command:o,group:"scayt_moresuggest",order:s+1}),r[o]=CKEDITOR.TRISTATE_OFF,"on"===e.config.scayt_moreSuggestions&&(e.addMenuItem("scayt_moresuggest",{label:i.getLocal("btn_moreSuggestions"),group:"scayt_moresuggest",order:10,getItems:function(){return r}}),n.scayt_moresuggest=CKEDITOR.TRISTATE_OFF))}else n.no_scayt_suggest=CKEDITOR.TRISTATE_DISABLED,e.addCommand("no_scayt_suggest",{exec:function(){}}),e.addMenuItem("no_scayt_suggest",{label:i.getLocal("btn_noSuggestions")||"no_scayt_suggest",command:"no_scayt_suggest",group:"scayt_suggest",order:0});return n},menuGenerator:function(e,t){var n=e.scayt,r=this.scaytMenuDefinition(e),i={},s=e.config.scayt_contextCommands.split("|");n.fire("getSuggestionsList",{lang:n.getLang(),word:t}),i=this.buildSuggestionMenuItems(e,CKEDITOR.plugins.scayt.suggestions);if("off"==e.config.scayt_contextCommands)return i;for(var o in r)-1==CKEDITOR.tools.indexOf(s,o.replace("scayt_",""))&&"all"!=e.config.scayt_contextCommands||(i[o]=CKEDITOR.TRISTATE_OFF,"function"==typeof r[o].verification&&!r[o].verification(e)&&delete i[o],e.addCommand(o,{exec:r[o].exec}),e.addMenuItem(o,{label:e.lang.scayt[r[o].label]||r[o].label,command:o,group:r[o].group,order:r[o].order}));return i},createCommand:function(e){return{exec:function(t){t.scayt.replaceSelectionNode({word:e})}}}}),CKEDITOR.plugins.scayt={state:{},suggestions:[],loadingHelper:{loadOrder:[]},isLoading:!1,options:{disablingCommandExec:{source:!0,newpage:!0,templates:!0},data_attribute_name:"data-scayt-word",misspelled_word_class:"scayt-misspell-word"},backCompatibilityMap:{scayt_service_protocol:"scayt_serviceProtocol",scayt_service_host:"scayt_serviceHost",scayt_service_port:"scayt_servicePort",scayt_service_path:"scayt_servicePath",scayt_customerid:"scayt_customerId"},replaceOldOptionsNames:function(e){for(var t in e)t in this.backCompatibilityMap&&(e[this.backCompatibilityMap[t]]=e[t],delete e[t])},createScayt:function(e){var t=this;this.loadScaytLibrary(e,function(e){var n={lang:e.config.scayt_sLang,container:"BODY"==e.editable().$.nodeName?e.document.getWindow().$.frameElement:e.editable().$,customDictionary:e.config.scayt_customDictionaryIds,userDictionaryName:e.config.scayt_userDictionaryName,localization:e.langCode,customer_id:e.config.scayt_customerId,data_attribute_name:t.options.data_attribute_name,misspelled_word_class:t.options.misspelled_word_class};e.config.scayt_serviceProtocol&&(n.service_protocol=e.config.scayt_serviceProtocol),e.config.scayt_serviceHost&&(n.service_host=e.config.scayt_serviceHost),e.config.scayt_servicePort&&(n.service_port=e.config.scayt_servicePort),e.config.scayt_servicePath&&(n.service_path=e.config.scayt_servicePath),n=new SCAYT.CKSCAYT(n,function(){},function(){}),n.subscribe("suggestionListSend",function(e){for(var t={},n=[],r=0;r<e.suggestionList.length;r++)t[e.suggestionList[r]]||(t[e.suggestionList[r]]=e.suggestionList[r],n.push(e.suggestionList[r]));CKEDITOR.plugins.scayt.suggestions=n}),e.scayt=n,e.fire("scaytButtonState",e.readOnly?CKEDITOR.TRISTATE_DISABLED:CKEDITOR.TRISTATE_ON)})},destroy:function(e){e.scayt&&e.scayt.destroy(),delete e.scayt,e.fire("scaytButtonState",CKEDITOR.TRISTATE_OFF)},loadScaytLibrary:function(e,t){var n=this;"undefined"==typeof window.SCAYT||"function"!=typeof window.SCAYT.CKSCAYT?(this.loadingHelper[e.name]=t,this.loadingHelper.loadOrder.push(e.name),CKEDITOR.scriptLoader.load(e.config.scayt_srcUrl,function(){var e;CKEDITOR.fireOnce("scaytReady");for(var t=0;t<n.loadingHelper.loadOrder.length;t++)e=n.loadingHelper.loadOrder[t],"function"==typeof n.loadingHelper[e]&&n.loadingHelper[e](CKEDITOR.instances[e]),delete n.loadingHelper[e];n.loadingHelper.loadOrder=[]})):window.SCAYT&&"function"==typeof window.SCAYT.CKSCAYT&&(CKEDITOR.fireOnce("scaytReady"),e.scayt||"function"==typeof t&&t(e))}},CKEDITOR.on("scaytReady",function(){if(!0===CKEDITOR.config.scayt_handleCheckDirty){var e=CKEDITOR.editor.prototype;e.checkDirty=CKEDITOR.tools.override(e.checkDirty,function(e){return function(){var t=null,n=this.scayt;if(!CKEDITOR.plugins.scayt||!CKEDITOR.plugins.scayt.state[this.name]||!this.scayt)t=e.call(this);else if(t="ready"==this.status)var r=n.removeMarkupFromString(this.getSnapshot()),n=n.removeMarkupFromString(this._.previousValue),t=t&&n!==r;return t}}),e.resetDirty=CKEDITOR.tools.override(e.resetDirty,function(e){return function(){var t=this.scayt;!CKEDITOR.plugins.scayt||!CKEDITOR.plugins.scayt.state[this.name]||!this.scayt?e.call(this):this._.previousValue=t.removeMarkupFromString(this.getSnapshot())}})}if(!0===CKEDITOR.config.scayt_handleUndoRedo){var e=CKEDITOR.plugins.undo.Image.prototype,t="function"==typeof e.equalsContent?"equalsContent":"equals";e[t]=CKEDITOR.tools.override(e[t],function(e){return function(t){var n=t.editor.scayt,r=this.contents,i=t.contents,s=null;return CKEDITOR.plugins.scayt&&CKEDITOR.plugins.scayt.state[t.editor.name]&&t.editor.scayt&&(this.contents=n.removeMarkupFromString(r)||"",t.contents=n.removeMarkupFromString(i)||""),s=e.apply(this,arguments),this.contents=r,t.contents=i,s}})}}),function(){CKEDITOR.plugins.add("stylescombo",{requires:"richcombo",init:function(e){var t=e.config,n=e.lang.stylescombo,r={},i=[],s=[];e.on("stylesSet",function(n){if(n=n.data.styles){for(var o,u,a,l=0,h=n.length;l<h;l++)if(o=n[l],!(e.blockless&&o.element in CKEDITOR.dtd.$block)&&(u=o.name,o=new CKEDITOR.style(o),!e.filter.customConfig||e.filter.check(o)))o._name=u,o._.enterMode=t.enterMode,o._.type=a=o.assignedTo||o.type,o._.weight=l+1e3*(a==CKEDITOR.STYLE_OBJECT?1:a==CKEDITOR.STYLE_BLOCK?2:3),r[u]=o,i.push(o),s.push(o);i.sort(function(e,t){return e._.weight-t._.weight})}}),e.ui.addRichCombo("Styles",{label:n.label,title:n.panelTitle,toolbar:"styles,10",allowedContent:s,panel:{css:[CKEDITOR.skin.getPath("editor")].concat(t.contentsCss),multiSelect:!0,attributes:{"aria-label":n.panelTitle}},init:function(){var e,t,r,s,o,u;o=0;for(u=i.length;o<u;o++)e=i[o],t=e._name,s=e._.type,s!=r&&(this.startGroup(n["panelTitle"+s]),r=s),this.add(t,e.type==CKEDITOR.STYLE_OBJECT?t:e.buildPreview(),t);this.commit()},onClick:function(t){e.focus(),e.fire("saveSnapshot");var t=r[t],n=e.elementPath();e[t.checkActive(n,e)?"removeStyle":"applyStyle"](t),e.fire("saveSnapshot")},onRender:function(){e.on("selectionChange",function(t){for(var n=this.getValue(),t=t.data.path.elements,i=0,s=t.length,o;i<s;i++){o=t[i];for(var u in r)if(r[u].checkElementRemovable(o,!0,e)){u!=n&&this.setValue(u);return}}this.setValue("")},this)},onOpen:function(){var t=e.getSelection().getSelectedElement(),t=e.elementPath(t),i=[0,0,0,0];this.showAll(),this.unmarkAll();for(var s in r){var o=r[s],u=o._.type;o.checkApplicable(t,e,e.activeFilter)?i[u]++:this.hideItem(s),o.checkActive(t,e)&&this.mark(s)}i[CKEDITOR.STYLE_BLOCK]||this.hideGroup(n["panelTitle"+CKEDITOR.STYLE_BLOCK]),i[CKEDITOR.STYLE_INLINE]||this.hideGroup(n["panelTitle"+CKEDITOR.STYLE_INLINE]),i[CKEDITOR.STYLE_OBJECT]||this.hideGroup(n["panelTitle"+CKEDITOR.STYLE_OBJECT])},refresh:function(){var t=e.elementPath();if(t){for(var n in r)if(r[n].checkApplicable(t,e,e.activeFilter))return;this.setState(CKEDITOR.TRISTATE_DISABLED)}},reset:function(){r={},i=[]}})}})}(),function(){function e(e){return{editorFocus:!1,canUndo:!1,modes:{wysiwyg:1},exec:function(t){if(t.editable().hasFocus){var n=t.getSelection(),r;if(r=(new CKEDITOR.dom.elementPath(n.getCommonAncestor(),n.root)).contains({td:1,th:1},1)){var n=t.createRange(),i=CKEDITOR.tools.tryThese(function(){var t=r.getParent().$.cells[r.$.cellIndex+(e?-1:1)];return t.parentNode.parentNode,t},function(){var t=r.getParent(),t=t.getAscendant("table").$.rows[t.$.rowIndex+(e?-1:1)];return t.cells[e?t.cells.length-1:0]});if(!i&&!e){for(var s=r.getAscendant("table").$,i=r.getParent().$.cells,s=new CKEDITOR.dom.element(s.insertRow(-1),t.document),o=0,u=i.length;o<u;o++)s.append((new CKEDITOR.dom.element(i[o],t.document)).clone(!1,!1)).appendBogus();n.moveToElementEditStart(s)}else{if(!i)return!0;i=new CKEDITOR.dom.element(i),n.moveToElementEditStart(i),(!n.checkStartOfBlock()||!n.checkEndOfBlock())&&n.selectNodeContents(i)}return n.select(!0),!0}}return!1}}}var t={editorFocus:!1,modes:{wysiwyg:1,source:1}},n={exec:function(e){e.container.focusNext(!0,e.tabIndex)}},r={exec:function(e){e.container.focusPrevious(!0,e.tabIndex)}};CKEDITOR.plugins.add("tab",{init:function(s){for(var o=!1!==s.config.enableTabKeyTools,u=s.config.tabSpaces||0,a="";u--;)a+=" ";a&&s.on("key",function(e){9==e.data.keyCode&&(s.insertHtml(a),e.cancel())}),o&&s.on("key",function(e){(9==e.data.keyCode&&s.execCommand("selectNextCell")||e.data.keyCode==CKEDITOR.SHIFT+9&&s.execCommand("selectPreviousCell"))&&e.cancel()}),s.addCommand("blur",CKEDITOR.tools.extend(n,t)),s.addCommand("blurBack",CKEDITOR.tools.extend(r,t)),s.addCommand("selectNextCell",e()),s.addCommand("selectPreviousCell",e(!0))}})}(),CKEDITOR.dom.element.prototype.focusNext=function(e,t){var n=void 0===t?this.getTabIndex():t,r,i,s,o,u,a;if(0>=n)for(u=this.getNextSourceNode(e,CKEDITOR.NODE_ELEMENT);u;){if(u.isVisible()&&0===u.getTabIndex()){s=u;break}u=u.getNextSourceNode(!1,CKEDITOR.NODE_ELEMENT)}else for(u=this.getDocument().getBody().getFirst();u=u.getNextSourceNode(!1,CKEDITOR.NODE_ELEMENT);){if(!r)if(!i&&u.equals(this)){if(i=!0,e){if(!(u=u.getNextSourceNode(!0,CKEDITOR.NODE_ELEMENT)))break;r=1}}else i&&!this.contains(u)&&(r=1);if(u.isVisible()&&!(0>(a=u.getTabIndex()))){if(r&&a==n){s=u;break}a>n&&(!s||!o||a<o)?(s=u,o=a):!s&&0===a&&(s=u,o=a)}}s&&s.focus()},CKEDITOR.dom.element.prototype.focusPrevious=function(e,t){for(var n=void 0===t?this.getTabIndex():t,r,i,s,o=0,u,a=this.getDocument().getBody().getLast();a=a.getPreviousSourceNode(!1,CKEDITOR.NODE_ELEMENT);){if(!r)if(!i&&a.equals(this)){if(i=!0,e){if(!(a=a.getPreviousSourceNode(!0,CKEDITOR.NODE_ELEMENT)))break;r=1}}else i&&!this.contains(a)&&(r=1);if(a.isVisible()&&!(0>(u=a.getTabIndex())))if(0>=n){if(r&&0===u){s=a;break}u>o&&(s=a,o=u)}else{if(r&&u==n){s=a;break}u<n&&(!s||u>o)&&(s=a,o=u)}}s&&s.focus()},CKEDITOR.plugins.add("table",{requires:"dialog",init:function(e){function t(e){return CKEDITOR.tools.extend(e||{},{contextSensitive:1,refresh:function(e,t){this.setState(t.contains("table",1)?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED)}})}if(!e.blockless){var n=e.lang.table;e.addCommand("table",new CKEDITOR.dialogCommand("table",{context:"table",allowedContent:"table{width,height}[align,border,cellpadding,cellspacing,summary];caption tbody thead tfoot;th td tr[scope];"+(e.plugins.dialogadvtab?"table"+e.plugins.dialogadvtab.allowedContent():""),requiredContent:"table",contentTransformations:[["table{width}: sizeToStyle","table[width]: sizeToAttribute"]]})),e.addCommand("tableProperties",new CKEDITOR.dialogCommand("tableProperties",t())),e.addCommand("tableDelete",t({exec:function(e){var t=e.elementPath().contains("table",1);if(t){var n=t.getParent(),r=e.editable();1==n.getChildCount()&&!n.is("td","th")&&!n.equals(r)&&(t=n),e=e.createRange(),e.moveToPosition(t,CKEDITOR.POSITION_BEFORE_START),t.remove(),e.select()}}})),e.ui.addButton&&e.ui.addButton("Table",{label:n.toolbar,command:"table",toolbar:"insert,30"}),CKEDITOR.dialog.add("table",this.path+"dialogs/table.js"),CKEDITOR.dialog.add("tableProperties",this.path+"dialogs/table.js"),e.addMenuItems&&e.addMenuItems({table:{label:n.menu,command:"tableProperties",group:"table",order:5},tabledelete:{label:n.deleteTable,command:"tableDelete",group:"table",order:1}}),e.on("doubleclick",function(e){e.data.element.is("table")&&(e.data.dialog="tableProperties")}),e.contextMenu&&e.contextMenu.addListener(function(){return{tabledelete:CKEDITOR.TRISTATE_OFF,table:CKEDITOR.TRISTATE_OFF}})}}}),function(){function e(e){function t(e){!(0<n.length)&&e.type==CKEDITOR.NODE_ELEMENT&&h.test(e.getName())&&!e.getCustomData("selected_cell")&&(CKEDITOR.dom.element.setMarker(r,e,"selected_cell",!0),n.push(e))}for(var e=e.getRanges(),n=[],r={},i=0;i<e.length;i++){var s=e[i];if(s.collapsed)s=s.getCommonAncestor(),(s=s.getAscendant("td",!0)||s.getAscendant("th",!0))&&n.push(s);else{var s=new CKEDITOR.dom.walker(s),o;for(s.guard=t;o=s.next();)(o.type!=CKEDITOR.NODE_ELEMENT||!o.is(CKEDITOR.dtd.table))&&(o=o.getAscendant("td",!0)||o.getAscendant("th",!0))&&!o.getCustomData("selected_cell")&&(CKEDITOR.dom.element.setMarker(r,o,"selected_cell",!0),n.push(o))}}return CKEDITOR.dom.element.clearAllMarkers(r),n}function t(t,n){for(var r=e(t),i=r[0],s=i.getAscendant("table"),i=i.getDocument(),o=r[0].getParent(),u=o.$.rowIndex,r=r[r.length-1],a=r.getParent().$.rowIndex+r.$.rowSpan-1,r=new CKEDITOR.dom.element(s.$.rows[a]),u=n?u:a,o=n?o:r,r=CKEDITOR.tools.buildTableMap(s),s=r[u],u=n?r[u-1]:r[u+1],r=r[0].length,i=i.createElement("tr"),a=0;s[a]&&a<r;a++){var f;1<s[a].rowSpan&&u&&s[a]==u[a]?(f=s[a],f.rowSpan+=1):(f=(new CKEDITOR.dom.element(s[a])).clone(),f.removeAttribute("rowSpan"),f.appendBogus(),i.append(f),f=f.$),a+=f.colSpan-1}n?i.insertBefore(o):i.insertAfter(o)}function n(t){if(t instanceof CKEDITOR.dom.selection){for(var r=e(t),i=r[0].getAscendant("table"),s=CKEDITOR.tools.buildTableMap(i),t=r[0].getParent().$.rowIndex,r=r[r.length-1],o=r.getParent().$.rowIndex+r.$.rowSpan-1,r=[],u=t;u<=o;u++){for(var a=s[u],f=new CKEDITOR.dom.element(i.$.rows[u]),l=0;l<a.length;l++){var c=new CKEDITOR.dom.element(a[l]),h=c.getParent().$.rowIndex;1==c.$.rowSpan?c.remove():(c.$.rowSpan-=1,h==u&&(h=s[u+1],h[l-1]?c.insertAfter(new CKEDITOR.dom.element(h[l-1])):(new CKEDITOR.dom.element(i.$.rows[u+1])).append(c,1))),l+=c.$.colSpan-1}r.push(f)}s=i.$.rows,i=new CKEDITOR.dom.element(s[o+1]||(0<t?s[t-1]:null)||i.$.parentNode);for(u=r.length;0<=u;u--)n(r[u]);return i}return t instanceof CKEDITOR.dom.element&&(i=t.getAscendant("table"),1==i.$.rows.length?i.remove():t.remove()),null}function r(e,t){for(var n=t?Infinity:0,r=0;r<e.length;r++){var i;i=e[r];for(var s=t,o=i.getParent().$.cells,u=0,a=0;a<o.length;a++){var f=o[a],u=u+(s?1:f.colSpan);if(f==i.$)break}i=u-1;if(t?i<n:i>n)n=i}return n}function i(t,n){for(var i=e(t),s=i[0].getAscendant("table"),o=r(i,1),i=r(i),o=n?o:i,u=CKEDITOR.tools.buildTableMap(s),s=[],i=[],a=u.length,f=0;f<a;f++)s.push(u[f][o]),i.push(n?u[f][o-1]:u[f][o+1]);for(f=0;f<a;f++)s[f]&&(1<s[f].colSpan&&i[f]==s[f]?(o=s[f],o.colSpan+=1):(o=(new CKEDITOR.dom.element(s[f])).clone(),o.removeAttribute("colSpan"),o.appendBogus(),o[n?"insertBefore":"insertAfter"].call(o,new CKEDITOR.dom.element(s[f])),o=o.$),f+=o.rowSpan-1)}function s(e,t){var n=e.getStartElement();if(n=n.getAscendant("td",1)||n.getAscendant("th",1)){var r=n.clone();r.appendBogus(),t?r.insertBefore(n):r.insertAfter(n)}}function o(t){if(t instanceof CKEDITOR.dom.selection){var t=e(t),n=t[0]&&t[0].getAscendant("table"),r;e:{var i=0;r=t.length-1;for(var s={},a,f;a=t[i++];)CKEDITOR.dom.element.setMarker(s,a,"delete_cell",!0);for(i=0;a=t[i++];)if((f=a.getPrevious())&&!f.getCustomData("delete_cell")||(f=a.getNext())&&!f.getCustomData("delete_cell")){CKEDITOR.dom.element.clearAllMarkers(s),r=f;break e}CKEDITOR.dom.element.clearAllMarkers(s),f=t[0].getParent(),(f=f.getPrevious())?r=f.getLast():(f=t[r].getParent(),r=(f=f.getNext())?f.getChild(0):null)}for(f=t.length-1;0<=f;f--)o(t[f]);r?u(r,!0):n&&n.remove()}else t instanceof CKEDITOR.dom.element&&(n=t.getParent(),1==n.getChildCount()?n.remove():t.remove())}function u(e,t){var n=e.getDocument(),r=CKEDITOR.document;CKEDITOR.env.ie&&10==CKEDITOR.env.version&&(r.focus(),n.focus()),n=new CKEDITOR.dom.range(n),n["moveToElementEdit"+(t?"End":"Start")](e)||(n.selectNodeContents(e),n.collapse(t?!1:!0)),n.select(!0)}function a(e,t,n){e=e[t];if("undefined"==typeof n)return e;for(t=0;e&&t<e.length;t++){if(n.is&&e[t]==n.$)return t;if(t==n)return new CKEDITOR.dom.element(e[t])}return n.is?-1:null}function f(t,n,r){var i=e(t),s;if((n?1!=i.length:2>i.length)||(s=t.getCommonAncestor())&&s.type==CKEDITOR.NODE_ELEMENT&&s.is("table"))return!1;var o,t=i[0];s=t.getAscendant("table");var u=CKEDITOR.tools.buildTableMap(s),f=u.length,l=u[0].length,c=t.getParent().$.rowIndex,h=a(u,c,t);if(n){var d;try{var m=parseInt(t.getAttribute("rowspan"),10)||1;o=parseInt(t.getAttribute("colspan"),10)||1,d=u["up"==n?c-m:"down"==n?c+m:c]["left"==n?h-o:"right"==n?h+o:h]}catch(g){return!1}if(!d||t.$==d)return!1;i["up"==n||"left"==n?"unshift":"push"](new CKEDITOR.dom.element(d))}for(var n=t.getDocument(),y=c,m=d=0,b=!r&&new CKEDITOR.dom.documentFragment(n),w=0,n=0;n<i.length;n++){o=i[n];var E=o.getParent(),S=o.getFirst(),x=o.$.colSpan,T=o.$.rowSpan,E=E.$.rowIndex,N=a(u,E,o),w=w+x*T,m=Math.max(m,N-h+x);d=Math.max(d,E-c+T),r||(x=o,(T=x.getBogus())&&T.remove(),x.trim(),o.getChildren().count()&&(E!=y&&S&&(!S.isBlockBoundary||!S.isBlockBoundary({br:1}))&&(y=b.getLast(CKEDITOR.dom.walker.whitespaces(!0)))&&(!y.is||!y.is("br"))&&b.append("br"),o.moveChildren(b)),n?o.remove():o.setHtml("")),y=E}if(r)return d*m==w;b.moveChildren(t),t.appendBogus(),m>=l?t.removeAttribute("rowSpan"):t.$.rowSpan=d,d>=f?t.removeAttribute("colSpan"):t.$.colSpan=m,r=new CKEDITOR.dom.nodeList(s.$.rows),i=r.count();for(n=i-1;0<=n;n--)s=r.getItem(n),s.$.cells.length||(s.remove(),i++);return t}function l(t,n){var r=e(t);if(1<r.length)return!1;if(n)return!0;var r=r[0],i=r.getParent(),s=i.getAscendant("table"),o=CKEDITOR.tools.buildTableMap(s),u=i.$.rowIndex,f=a(o,u,r),l=r.$.rowSpan,c;if(1<l){c=Math.ceil(l/2);for(var l=Math.floor(l/2),i=u+c,s=new CKEDITOR.dom.element(s.$.rows[i]),o=a(o,i),h,i=r.clone(),u=0;u<o.length;u++){if(h=o[u],h.parentNode==s.$&&u>f){i.insertBefore(new CKEDITOR.dom.element(h));break}h=null}h||s.append(i)}else{l=c=1,s=i.clone(),s.insertAfter(i),s.append(i=r.clone()),h=a(o,u);for(f=0;f<h.length;f++)h[f].rowSpan++}return i.appendBogus(),r.$.rowSpan=c,i.$.rowSpan=l,1==c&&r.removeAttribute("rowSpan"),1==l&&i.removeAttribute("rowSpan"),i}function c(t,n){var r=e(t);if(1<r.length)return!1;if(n)return!0;var r=r[0],i=r.getParent(),s=i.getAscendant("table"),s=CKEDITOR.tools.buildTableMap(s),o=a(s,i.$.rowIndex,r),u=r.$.colSpan;if(1<u)i=Math.ceil(u/2),u=Math.floor(u/2);else{for(var u=i=1,f=[],l=0;l<s.length;l++){var c=s[l];f.push(c[o]),1<c[o].rowSpan&&(l+=c[o].rowSpan-1)}for(s=0;s<f.length;s++)f[s].colSpan++}return s=r.clone(),s.insertAfter(r),s.appendBogus(),r.$.colSpan=i,s.$.colSpan=u,1==i&&r.removeAttribute("colSpan"),1==u&&s.removeAttribute("colSpan"),s}var h=/^(?:td|th)$/;CKEDITOR.plugins.tabletools={requires:"table,dialog,contextmenu",init:function(r){function a(e){return CKEDITOR.tools.extend(e||{},{contextSensitive:1,refresh:function(e,t){this.setState(t.contains({td:1,th:1},1)?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED)}})}function h(e,t){var n=r.addCommand(e,t);r.addFeature(n)}var d=r.lang.table;h("cellProperties",new CKEDITOR.dialogCommand("cellProperties",a({allowedContent:"td th{width,height,border-color,background-color,white-space,vertical-align,text-align}[colspan,rowspan]",requiredContent:"table"}))),CKEDITOR.dialog.add("cellProperties",this.path+"dialogs/tableCell.js"),h("rowDelete",a({requiredContent:"table",exec:function(e){e=e.getSelection(),u(n(e))}})),h("rowInsertBefore",a({requiredContent:"table",exec:function(e){e=e.getSelection(),t(e,!0)}})),h("rowInsertAfter",a({requiredContent:"table",exec:function(e){e=e.getSelection(),t(e)}})),h("columnDelete",a({requiredContent:"table",exec:function(t){for(var t=t.getSelection(),t=e(t),n=t[0],r=t[t.length-1],t=n.getAscendant("table"),i=CKEDITOR.tools.buildTableMap(t),s,o,a=[],f=0,l=i.length;f<l;f++)for(var c=0,h=i[f].length;c<h;c++)i[f][c]==n.$&&(s=c),i[f][c]==r.$&&(o=c);for(f=s;f<=o;f++)for(c=0;c<i.length;c++)r=i[c],n=new CKEDITOR.dom.element(t.$.rows[c]),r=new CKEDITOR.dom.element(r[f]),r.$&&(1==r.$.colSpan?r.remove():r.$.colSpan-=1,c+=r.$.rowSpan-1,n.$.cells.length||a.push(n));o=t.$.rows[0]&&t.$.rows[0].cells,s=new CKEDITOR.dom.element(o[s]||(s?o[s-1]:t.$.parentNode)),a.length==l&&t.remove(),s&&u(s,!0)}})),h("columnInsertBefore",a({requiredContent:"table",exec:function(e){e=e.getSelection(),i(e,!0)}})),h("columnInsertAfter",a({requiredContent:"table",exec:function(e){e=e.getSelection(),i(e)}})),h("cellDelete",a({requiredContent:"table",exec:function(e){e=e.getSelection(),o(e)}})),h("cellMerge",a({allowedContent:"td[colspan,rowspan]",requiredContent:"td[colspan,rowspan]",exec:function(e){u(f(e.getSelection()),!0)}})),h("cellMergeRight",a({allowedContent:"td[colspan]",requiredContent:"td[colspan]",exec:function(e){u(f(e.getSelection(),"right"),!0)}})),h("cellMergeDown",a({allowedContent:"td[rowspan]",requiredContent:"td[rowspan]",exec:function(e){u(f(e.getSelection(),"down"),!0)}})),h("cellVerticalSplit",a({allowedContent:"td[rowspan]",requiredContent:"td[rowspan]",exec:function(e){u(l(e.getSelection()))}})),h("cellHorizontalSplit",a({allowedContent:"td[colspan]",requiredContent:"td[colspan]",exec:function(e){u(c(e.getSelection()))}})),h("cellInsertBefore",a({requiredContent:"table",exec:function(e){e=e.getSelection(),s(e,!0)}})),h("cellInsertAfter",a({requiredContent:"table",exec:function(e){e=e.getSelection(),s(e)}})),r.addMenuItems&&r.addMenuItems({tablecell:{label:d.cell.menu,group:"tablecell",order:1,getItems:function(){var t=r.getSelection(),n=e(t);return{tablecell_insertBefore:CKEDITOR.TRISTATE_OFF,tablecell_insertAfter:CKEDITOR.TRISTATE_OFF,tablecell_delete:CKEDITOR.TRISTATE_OFF,tablecell_merge:f(t,null,!0)?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,tablecell_merge_right:f(t,"right",!0)?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,tablecell_merge_down:f(t,"down",!0)?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,tablecell_split_vertical:l(t,!0)?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,tablecell_split_horizontal:c(t,!0)?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,tablecell_properties:0<n.length?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED}}},tablecell_insertBefore:{label:d.cell.insertBefore,group:"tablecell",command:"cellInsertBefore",order:5},tablecell_insertAfter:{label:d.cell.insertAfter,group:"tablecell",command:"cellInsertAfter",order:10},tablecell_delete:{label:d.cell.deleteCell,group:"tablecell",command:"cellDelete",order:15},tablecell_merge:{label:d.cell.merge,group:"tablecell",command:"cellMerge",order:16},tablecell_merge_right:{label:d.cell.mergeRight,group:"tablecell",command:"cellMergeRight",order:17},tablecell_merge_down:{label:d.cell.mergeDown,group:"tablecell",command:"cellMergeDown",order:18},tablecell_split_horizontal:{label:d.cell.splitHorizontal,group:"tablecell",command:"cellHorizontalSplit",order:19},tablecell_split_vertical:{label:d.cell.splitVertical,group:"tablecell",command:"cellVerticalSplit",order:20},tablecell_properties:{label:d.cell.title,group:"tablecellproperties",command:"cellProperties",order:21},tablerow:{label:d.row.menu,group:"tablerow",order:1,getItems:function(){return{tablerow_insertBefore:CKEDITOR.TRISTATE_OFF,tablerow_insertAfter:CKEDITOR.TRISTATE_OFF,tablerow_delete:CKEDITOR.TRISTATE_OFF}}},tablerow_insertBefore:{label:d.row.insertBefore,group:"tablerow",command:"rowInsertBefore",order:5},tablerow_insertAfter:{label:d.row.insertAfter,group:"tablerow",command:"rowInsertAfter",order:10},tablerow_delete:{label:d.row.deleteRow,group:"tablerow",command:"rowDelete",order:15},tablecolumn:{label:d.column.menu,group:"tablecolumn",order:1,getItems:function(){return{tablecolumn_insertBefore:CKEDITOR.TRISTATE_OFF,tablecolumn_insertAfter:CKEDITOR.TRISTATE_OFF,tablecolumn_delete:CKEDITOR.TRISTATE_OFF}}},tablecolumn_insertBefore:{label:d.column.insertBefore,group:"tablecolumn",command:"columnInsertBefore",order:5},tablecolumn_insertAfter:{label:d.column.insertAfter,group:"tablecolumn",command:"columnInsertAfter",order:10},tablecolumn_delete:{label:d.column.deleteColumn,group:"tablecolumn",command:"columnDelete",order:15}}),r.contextMenu&&r.contextMenu.addListener(function(e,t,n){return(e=n.contains({td:1,th:1},1))&&!e.isReadOnly()?{tablecell:CKEDITOR.TRISTATE_OFF,tablerow:CKEDITOR.TRISTATE_OFF,tablecolumn:CKEDITOR.TRISTATE_OFF}:null})},getSelectedCells:e},CKEDITOR.plugins.add("tabletools",CKEDITOR.plugins.tabletools)}(),CKEDITOR.tools.buildTableMap=function(e){for(var e=e.$.rows,t=-1,n=[],r=0;r<e.length;r++){t++,!n[t]&&(n[t]=[]);for(var i=-1,s=0;s<e[r].cells.length;s++){var o=e[r].cells[s];for(i++;n[t][i];)i++;for(var u=isNaN(o.colSpan)?1:o.colSpan,o=isNaN(o.rowSpan)?1:o.rowSpan,a=0;a<o;a++){n[t+a]||(n[t+a]=[]);for(var f=0;f<u;f++)n[t+a][i+f]=e[r].cells[s]}i+=u-1}}return n},function(){var e=[CKEDITOR.CTRL+90,CKEDITOR.CTRL+89,CKEDITOR.CTRL+CKEDITOR.SHIFT+90],t={8:1,46:1};CKEDITOR.plugins.add("undo",{init:function(t){function r(e){s.enabled&&!1!==e.data.command.canUndo&&s.save()}function i(){s.enabled=t.readOnly?!1:"wysiwyg"==t.mode,s.onChange()}var s=t.undoManager=new n(t),o=s.editingHandler=new a(s),u=t.addCommand("undo",{exec:function(){s.undo()&&(t.selectionChange(),this.fire("afterUndo"))},startDisabled:!0,canUndo:!1}),f=t.addCommand("redo",{exec:function(){s.redo()&&(t.selectionChange(),this.fire("afterRedo"))},startDisabled:!0,canUndo:!1});t.setKeystroke([[e[0],"undo"],[e[1],"redo"],[e[2],"redo"]]),s.onChange=function(){u.setState(s.undoable()?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED),f.setState(s.redoable()?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED)},t.on("beforeCommandExec",r),t.on("afterCommandExec",r),t.on("saveSnapshot",function(e){s.save(e.data&&e.data.contentOnly)}),t.on("contentDom",o.attachListeners,o),t.on("instanceReady",function(){t.fire("saveSnapshot")}),t.on("beforeModeUnload",function(){"wysiwyg"==t.mode&&s.save(!0)}),t.on("mode",i),t.on("readOnly",i),t.ui.addButton&&(t.ui.addButton("Undo",{label:t.lang.undo.undo,command:"undo",toolbar:"undo,10"}),t.ui.addButton("Redo",{label:t.lang.undo.redo,command:"redo",toolbar:"undo,20"})),t.resetUndo=function(){s.reset(),t.fire("saveSnapshot")},t.on("updateSnapshot",function(){s.currentImage&&s.update()}),t.on("lockSnapshot",function(e){e=e.data,s.lock(e&&e.dontUpdate,e&&e.forceUpdate)}),t.on("unlockSnapshot",s.unlock,s)}}),CKEDITOR.plugins.undo={};var n=CKEDITOR.plugins.undo.UndoManager=function(e){this.editor=e,this.reset()};n.prototype={keyGroupsEnum:{PRINTABLE:0,FUNCTIONAL:1},strokesRecorded:[0,0],navigationKeyCodes:{37:1,38:1,39:1,40:1,36:1,35:1,33:1,34:1},previousKeyGroup:-1,type:function(e){var n=this.keyGroupsEnum,e=t[e]?n.FUNCTIONAL:n.PRINTABLE,r=this.strokesRecorded[e]+1,i=e!==this.previousKeyGroup,s=25<=r,n=e==n.FUNCTIONAL?n.PRINTABLE:n.FUNCTIONAL;this.typing||(this.hasUndo=this.typing=!0,this.hasRedo=!1,this.onChange());if(i&&-1!==this.previousKeyGroup||s)i?(this.strokesRecorded[n]=0,this.save(!1,this.editingHandler.lastKeydownImage,!1)||this.snapshots.splice(this.index+1,this.snapshots.length-this.index-1)):(r=0,this.editor.fire("saveSnapshot"),this.typing=!0);this.strokesRecorded[e]=r,this.previousKeyGroup=e,this.editor.fire("change")},reset:function(){this.snapshots=[],this.index=-1,this.limit=this.editor.config.undoStackSize||20,this.currentImage=null,this.hasRedo=this.hasUndo=!1,this.locked=null,this.resetType()},resetType:function(){this.strokesRecorded=[0,0],this.typing=!1,this.previousKeyGroup=-1},refreshState:function(){this.hasUndo=!!this.getNextImage(!0),this.hasRedo=!!this.getNextImage(!1),this.resetType(),this.onChange()},save:function(e,t,n){var i=this.editor;if(this.locked||"ready"!=i.status||"wysiwyg"!=i.mode)return!1;var s=i.editable();if(!s||"ready"!=s.status)return!1;s=this.snapshots,t||(t=new r(i));if(!1===t.contents)return!1;if(this.currentImage)if(t.equalsContent(this.currentImage)){if(e||t.equalsSelection(this.currentImage))return!1}else!1!==n&&i.fire("change");return s.splice(this.index+1,s.length-this.index-1),s.length==this.limit&&s.shift(),this.index=s.push(t)-1,this.currentImage=t,!1!==n&&this.refreshState(),!0},restoreImage:function(e){var t=this.editor,n;e.bookmarks&&(t.focus(),n=t.getSelection()),this.locked={level:999},this.editor.loadSnapshot(e.contents),e.bookmarks?n.selectBookmarks(e.bookmarks):CKEDITOR.env.ie&&(n=this.editor.document.getBody().$.createTextRange(),n.collapse(!0),n.select()),this.locked=null,this.index=e.index,this.currentImage=this.snapshots[this.index],this.update(),this.refreshState(),t.fire("change")},getNextImage:function(e){var t=this.snapshots,n=this.currentImage,r;if(n)if(e){for(r=this.index-1;0<=r;r--)if(e=t[r],!n.equalsContent(e))return e.index=r,e}else for(r=this.index+1;r<t.length;r++)if(e=t[r],!n.equalsContent(e))return e.index=r,e;return null},redoable:function(){return this.enabled&&this.hasRedo},undoable:function(){return this.enabled&&this.hasUndo},undo:function(){if(this.undoable()){this.save(!0);var e=this.getNextImage(!0);if(e)return this.restoreImage(e),!0}return!1},redo:function(){if(this.redoable()&&(this.save(!0),this.redoable())){var e=this.getNextImage(!1);if(e)return this.restoreImage(e),!0}return!1},update:function(e){if(!this.locked){e||(e=new r(this.editor));for(var t=this.index,n=this.snapshots;0<t&&this.currentImage.equalsContent(n[t-1]);)t-=1;n.splice(t,this.index-t+1,e),this.index=t,this.currentImage=e}},updateSelection:function(e){if(!this.snapshots.length)return!1;var t=this.snapshots,n=t[t.length-1];return n.equalsContent(e)&&!n.equalsSelection(e)?(this.currentImage=t[t.length-1]=e,!0):!1},lock:function(e,t){if(this.locked)this.locked.level++;else if(e)this.locked={level:1};else{var n=null;if(t)n=!0;else{var i=new r(this.editor,!0);this.currentImage&&this.currentImage.equalsContent(i)&&(n=i)}this.locked={update:n,level:1}}},unlock:function(){if(this.locked&&!--this.locked.level){var e=this.locked.update;this.locked=null;if(!0===e)this.update();else if(e){var t=new r(this.editor,!0);e.equalsContent(t)||this.update()}}},isNavigationKey:function(e){return!!this.navigationKeyCodes[e]}};var r=CKEDITOR.plugins.undo.Image=function(e,t){this.editor=e,e.fire("beforeUndoImage");var n=e.getSnapshot();CKEDITOR.env.ie&&n&&(n=n.replace(/\s+data-cke-expando=".*?"/g,"")),this.contents=n,t||(this.bookmarks=(n=n&&e.getSelection())&&n.createBookmarks2(!0)),e.fire("afterUndoImage")},i=/\b(?:href|src|name)="[^"]*?"/gi;r.prototype={equalsContent:function(e){var t=this.contents,e=e.contents;return CKEDITOR.env.ie&&(CKEDITOR.env.ie7Compat||CKEDITOR.env.quirks)&&(t=t.replace(i,""),e=e.replace(i,"")),t!=e?!1:!0},equalsSelection:function(e){var t=this.bookmarks,e=e.bookmarks;if(t||e){if(!t||!e||t.length!=e.length)return!1;for(var n=0;n<t.length;n++){var r=t[n],i=e[n];if(r.startOffset!=i.startOffset||r.endOffset!=i.endOffset||!CKEDITOR.tools.arrayCompare(r.start,i.start)||!CKEDITOR.tools.arrayCompare(r.end,i.end))return!1}}return!0}};var s=0,o=!1,u=function(){o=!0},a=CKEDITOR.plugins.undo.NativeEditingHandler=function(e){this.undoManager=e};a.prototype={onKeydown:function(t){if(-1<CKEDITOR.tools.indexOf(e,t.data.getKeystroke()))t.data.preventDefault();else{var t=t.data.getKey(),n=this.undoManager;this.lastKeydownImage=new r(n.editor),n.isNavigationKey(t)&&(n.strokesRecorded[0]||n.strokesRecorded[1])&&(n.save(!1,this.lastKeydownImage),n.resetType())}},onInput:function(){s+=1,o&&(s-=1,o=!1)},onKeyup:function(e){var n=this.undoManager,e=e.data.getKey(),i=n.editor;if(CKEDITOR.env.ie&&e in t&&this.lastKeydownImage){if(this.lastKeydownImage.equalsContent(new r(i,!0)))return;s+=1}0<s?(s-=1,n.type(e)):n.isNavigationKey(e)&&this.onNavigationKey(!0)},onNavigationKey:function(e){var t=this.undoManager;(e||!t.save(!0,null,!1))&&t.updateSelection(new r(t.editor)),t.resetType()},resetCounter:function(){s=0},attachListeners:function(){var e=this.undoManager.editor.editable(),t=this;e.attachListener(e,"keydown",t.onKeydown,t),e.attachListener(e,CKEDITOR.env.ie?"keypress":"input",t.onInput,t),e.attachListener(e,"keyup",t.onKeyup,t),e.attachListener(e,"paste",u),e.attachListener(e,"drop",u),e.attachListener(e,"click",function(){t.onNavigationKey()})}}}(),CKEDITOR.config.wsc_removeGlobalVariable=!0,CKEDITOR.plugins.add("wsc",{requires:"dialog",parseApi:function(e){e.config.wsc_onFinish="function"==typeof e.config.wsc_onFinish?e.config.wsc_onFinish:function(){},e.config.wsc_onClose="function"==typeof e.config.wsc_onClose?e.config.wsc_onClose:function(){}},parseConfig:function(e){e.config.wsc_customerId=e.config.wsc_customerId||CKEDITOR.config.wsc_customerId||"1:ua3xw1-2XyGJ3-GWruD3-6OFNT1-oXcuB1-nR6Bp4-hgQHc-EcYng3-sdRXG3-NOfFk",e.config.wsc_customDictionaryIds=e.config.wsc_customDictionaryIds||CKEDITOR.config.wsc_customDictionaryIds||"",e.config.wsc_userDictionaryName=e.config.wsc_userDictionaryName||CKEDITOR.config.wsc_userDictionaryName||"",e.config.wsc_customLoaderScript=e.config.wsc_customLoaderScript||CKEDITOR.config.wsc_customLoaderScript,CKEDITOR.config.wsc_cmd=e.config.wsc_cmd||CKEDITOR.config.wsc_cmd||"spell",CKEDITOR.config.wsc_version=CKEDITOR.version+" | %Rev%"},init:function(e){var t=CKEDITOR.env;this.parseConfig(e),this.parseApi(e),e.addCommand("checkspell",new CKEDITOR.dialogCommand("checkspell")).modes={wysiwyg:!CKEDITOR.env.opera&&!CKEDITOR.env.air&&document.domain==window.location.hostname&&(!t.ie||!(8>t.version||t.quirks))},"undefined"==typeof e.plugins.scayt&&e.ui.addButton&&e.ui.addButton("SpellChecker",{label:e.lang.wsc.toolbar,click:function(e){var t=e.elementMode==CKEDITOR.ELEMENT_MODE_INLINE?e.container.getText():e.document.getBody().getText();(t=t.replace(/\s/g,""))?e.execCommand("checkspell"):alert("Nothing to check!")},toolbar:"spellchecker,10"}),CKEDITOR.dialog.add("checkspell",this.path+(CKEDITOR.env.ie&&7>=CKEDITOR.env.version?"dialogs/wsc_ie.js":window.postMessage?"dialogs/wsc.js":"dialogs/wsc_ie.js"))}}),CKEDITOR.config.plugins="dialogui,dialog,about,a11yhelp,dialogadvtab,basicstyles,bidi,blockquote,clipboard,button,panelbutton,panel,floatpanel,colorbutton,colordialog,templates,menu,contextmenu,div,resize,toolbar,elementspath,enterkey,entities,popup,filebrowser,find,fakeobjects,flash,floatingspace,listblock,richcombo,font,forms,format,horizontalrule,htmlwriter,iframe,wysiwygarea,image,indent,indentblock,indentlist,smiley,justify,menubutton,language,link,list,liststyle,magicline,maximize,newpage,pagebreak,pastetext,pastefromword,preview,print,removeformat,save,selectall,showblocks,showborders,sourcearea,specialchar,scayt,stylescombo,tab,table,tabletools,undo,wsc",CKEDITOR.config.skin="moono",function(){var e=function(e,t){var n=CKEDITOR.getUrl("plugins/"+t);e=e.split(",");for(var r=0;r<e.length;r++)CKEDITOR.skin.icons[e[r]]={path:n,offset:-e[++r],bgsize:e[++r]}};CKEDITOR.env.hidpi?e("about,0,,bold,24,,italic,48,,strike,72,,subscript,96,,superscript,120,,underline,144,,bidiltr,168,,bidirtl,192,,blockquote,216,,copy-rtl,240,,copy,264,,cut-rtl,288,,cut,312,,paste-rtl,336,,paste,360,,bgcolor,384,,textcolor,408,,templates-rtl,432,,templates,456,,creatediv,480,,find-rtl,504,,find,528,,replace,552,,flash,576,,button,600,,checkbox,624,,form,648,,hiddenfield,672,,imagebutton,696,,radio,720,,select-rtl,744,,select,768,,textarea-rtl,792,,textarea,816,,textfield-rtl,840,,textfield,864,,horizontalrule,888,,iframe,912,,image,936,,indent-rtl,960,,indent,984,,outdent-rtl,1008,,outdent,1032,,smiley,1056,,justifyblock,1080,,justifycenter,1104,,justifyleft,1128,,justifyright,1152,,language,1176,,anchor-rtl,1200,,anchor,1224,,link,1248,,unlink,1272,,bulletedlist-rtl,1296,,bulletedlist,1320,,numberedlist-rtl,1344,,numberedlist,1368,,maximize,1392,,newpage-rtl,1416,,newpage,1440,,pagebreak-rtl,1464,,pagebreak,1488,,pastetext-rtl,1512,,pastetext,1536,,pastefromword-rtl,1560,,pastefromword,1584,,preview-rtl,1608,,preview,1632,,print,1656,,removeformat,1680,,save,1704,,selectall,1728,,showblocks-rtl,1752,,showblocks,1776,,source-rtl,1800,,source,1824,,specialchar,1848,,scayt,1872,,table,1896,,redo-rtl,1920,,redo,1944,,undo-rtl,1968,,undo,1992,,spellchecker,2016,","icons_hidpi.png"):e("about,0,auto,bold,24,auto,italic,48,auto,strike,72,auto,subscript,96,auto,superscript,120,auto,underline,144,auto,bidiltr,168,auto,bidirtl,192,auto,blockquote,216,auto,copy-rtl,240,auto,copy,264,auto,cut-rtl,288,auto,cut,312,auto,paste-rtl,336,auto,paste,360,auto,bgcolor,384,auto,textcolor,408,auto,templates-rtl,432,auto,templates,456,auto,creatediv,480,auto,find-rtl,504,auto,find,528,auto,replace,552,auto,flash,576,auto,button,600,auto,checkbox,624,auto,form,648,auto,hiddenfield,672,auto,imagebutton,696,auto,radio,720,auto,select-rtl,744,auto,select,768,auto,textarea-rtl,792,auto,textarea,816,auto,textfield-rtl,840,auto,textfield,864,auto,horizontalrule,888,auto,iframe,912,auto,image,936,auto,indent-rtl,960,auto,indent,984,auto,outdent-rtl,1008,auto,outdent,1032,auto,smiley,1056,auto,justifyblock,1080,auto,justifycenter,1104,auto,justifyleft,1128,auto,justifyright,1152,auto,language,1176,auto,anchor-rtl,1200,auto,anchor,1224,auto,link,1248,auto,unlink,1272,auto,bulletedlist-rtl,1296,auto,bulletedlist,1320,auto,numberedlist-rtl,1344,auto,numberedlist,1368,auto,maximize,1392,auto,newpage-rtl,1416,auto,newpage,1440,auto,pagebreak-rtl,1464,auto,pagebreak,1488,auto,pastetext-rtl,1512,auto,pastetext,1536,auto,pastefromword-rtl,1560,auto,pastefromword,1584,auto,preview-rtl,1608,auto,preview,1632,auto,print,1656,auto,removeformat,1680,auto,save,1704,auto,selectall,1728,auto,showblocks-rtl,1752,auto,showblocks,1776,auto,source-rtl,1800,auto,source,1824,auto,specialchar,1848,auto,scayt,1872,auto,table,1896,auto,redo-rtl,1920,auto,redo,1944,auto,undo-rtl,1968,auto,undo,1992,auto,spellchecker,2016,auto","icons.png")}(),CKEDITOR.lang.languages={af:1,sq:1,ar:1,eu:1,bn:1,bs:1,bg:1,ca:1,"zh-cn":1,zh:1,hr:1,cs:1,da:1,nl:1,en:1,"en-au":1,"en-ca":1,"en-gb":1,eo:1,et:1,fo:1,fi:1,fr:1,"fr-ca":1,gl:1,ka:1,de:1,el:1,gu:1,he:1,hi:1,hu:1,is:1,id:1,it:1,ja:1,km:1,ko:1,ku:1,lv:1,lt:1,mk:1,ms:1,mn:1,no:1,nb:1,fa:1,pl:1,"pt-br":1,pt:1,ro:1,ru:1,sr:1,"sr-latn":1,si:1,sk:1,sl:1,es:1,sv:1,tt:1,th:1,tr:1,ug:1,uk:1,vi:1,cy:1}}(),function(e){CKEDITOR.config.jqueryOverrideVal="undefined"==typeof CKEDITOR.config.jqueryOverrideVal?!0:CKEDITOR.config.jqueryOverrideVal,"undefined"!=typeof e&&(e.extend(e.fn,{ckeditorGet:function(){var e=this.eq(0).data("ckeditorInstance");if(!e)throw"CKEditor is not initialized yet, use ckeditor() with a callback.";return e},ckeditor:function(t,n){if(!CKEDITOR.env.isCompatible)throw Error("The environment is incompatible.");if(!e.isFunction(t))var r=n,n=t,t=r;var i=[],n=n||{};this.each(function(){var r=e(this),s=r.data("ckeditorInstance"),o=r.data("_ckeditorInstanceLock"),u=this,f=new e.Deferred;i.push(f.promise());if(s&&!o)t&&t.apply(s,[this]),f.resolve();else if(o)s.once("instanceReady",function(){setTimeout(function(){s.element?(s.element.$==u&&t&&t.apply(s,[u]),f.resolve()):setTimeout(arguments.callee,100)},0)},null,null,9999);else{if(n.autoUpdateElement||"undefined"==typeof n.autoUpdateElement&&CKEDITOR.config.autoUpdateElement)n.autoUpdateElementJquery=!0;n.autoUpdateElement=!1,r.data("_ckeditorInstanceLock",!0),s=e(this).is("textarea")?CKEDITOR.replace(u,n):CKEDITOR.inline(u,n),r.data("ckeditorInstance",s),s.on("instanceReady",function(n){var i=n.editor;setTimeout(function(){if(i.element){n.removeListener(),i.on("dataReady",function(){r.trigger("dataReady.ckeditor",[i])}),i.on("setData",function(e){r.trigger("setData.ckeditor",[i,e.data])}),i.on("getData",function(e){r.trigger("getData.ckeditor",[i,e.data])},999),i.on("destroy",function(){r.trigger("destroy.ckeditor",[i])}),i.on("save",function(){return e(u.form).submit(),!1},null,null,20);if(i.config.autoUpdateElementJquery&&r.is("textarea")&&e(u.form).length){var s=function(){r.ckeditor(function(){i.updateElement()})};e(u.form).submit(s),e(u.form).bind("form-pre-serialize",s),r.bind("destroy.ckeditor",function(){e(u.form).unbind("submit",s),e(u.form).unbind("form-pre-serialize",s)})}i.on("destroy",function(){r.removeData("ckeditorInstance")}),r.removeData("_ckeditorInstanceLock"),r.trigger("instanceReady.ckeditor",[i]),t&&t.apply(i,[u]),f.resolve()}else setTimeout(arguments.callee,100)},0)},null,null,9999)}});var s=new e.Deferred;return this.promise=s.promise(),e.when.apply(this,i).then(function(){s.resolve()}),this.editor=this.eq(0).data("ckeditorInstance"),this}}),CKEDITOR.config.jqueryOverrideVal&&(e.fn.val=CKEDITOR.tools.override(e.fn.val,function(t){return function(n){if(arguments.length){var r=this,i=[],s=this.each(function(){var r=e(this),s=r.data("ckeditorInstance");if(r.is("textarea")&&s){var o=new e.Deferred;return s.setData(n,function(){o.resolve()}),i.push(o.promise()),!0}return t.call(r,n)});if(i.length){var o=new e.Deferred;return e.when.apply(this,i).done(function(){o.resolveWith(r)}),o.promise()}return s}var s=e(this).eq(0),u=s.data("ckeditorInstance");return s.is("textarea")&&u?u.getData():t.call(s)}})))}(window.jQuery),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.cms.editor.RichEditor=r.common.BaseView.extend({doInitialize:function(e){this.init(e)},init:function(e){var t=this,n=[["imgUpload","Table","Rule","Smiley","SpecialChar","Video","Phone"],["NumberedList","BulletedList","-","Outdent","Indent","Blockquote","Link","Unlink","Anchor"],["Maximize"],"/",["Undo","Redo","-","RemoveFormat"],["JustifyLeft","JustifyCenter","JustifyRight","JustifyBlock","-"],["Bold","Italic","Underline","StrikeThrough","-","Subscript","Superscript"],"/",["Styles","Format","FontSize"],["TextColor","BGColor"],["Pcard"]],i=[["Undo","Redo","-","RemoveFormat"],["imgUpload","Table","Rule","Smiley","SpecialChar","Video","Phone"],["NumberedList","BulletedList","-","Outdent","Indent","Blockquote","Link","Unlink","Anchor"],["Maximize"],"/",["JustifyLeft","JustifyCenter","JustifyRight","JustifyBlock","-"],["Bold","Italic","Underline","StrikeThrough","-","Subscript","Superscript"],["Styles","Format","FontSize"],["TextColor","BGColor"]];this.changeNumber=0,CKEDITOR.timestamp=r.App.config.buildNumber,this.$el.ckeditor({allowedContent:!0,customConfig:"",uiColor:"#fafafa",dialog_backgroundCoverColor:"rgb(0, 0, 0)",baseFloatZIndex:1e9,filebrowserImageUploadUrl:"/api/v2/ckupload",extraPlugins:"video,phone,pcard,imgUpload",removePlugins:"elementspath",toolbar:e.minToolbar?i:n}),this.editor=this.$el.editor,this.addEditorListeners()},addEditorListeners:function(t){var n=this;this.onEditorReady(function(){n.editor.on("change",function(e){n.initState?n.initState=!1:n.trigger("changed")}),n.editor.on("paste",function(t){var n=e("<p>");n.html(t.data.dataValue),n.find("img").attr("data-img-id",""),t.data.dataValue=n.html()}),n.editor.on("key",function(e){e.data.keyCode==9&&(e.data.domEvent.preventDefault(),n.editor.insertHtml("<span>&nbsp;&nbsp;&nbsp;&nbsp;</span>"))})})},onEditorReady:function(e){this.editor.on("instanceReady",e)},initContent:function(e){this.initState=!0,this.setContent(e)},setContent:function(e){if(this.editor.status==="ready")this.editor.setData(e);else{var t=this;this.editor.once("instanceReady",function(n){t.editor.setData(e)})}},getContent:function(){return this.editor.getData()},insertLink:function(){},insertImage:function(){},insertPhoneNumber:function(){},insertVideo:function(e){},onShow:function(e){},onRefresh:function(e){},onRecover:function(){this.$el.hide(),this.init()},onHide:function(){this.editor.destroy()},onRemove:function(e){this.editor.destroy()},_prepareEditorForUse:function(){},_initAutoResize:function(e){},_setupAutoResize:function(){},_resize:function(){}});var i=function(){return""}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.cms||(r.modules.cms={}),r.modules.cms.templates||(r.modules.cms.templates={})}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.cms.templates.AttributeEditor=r.common.BaseView.extend({doInitialize:function(e){this.doInternalInitialize(e)},doInternalInitialize:function(e){},getValue:function(){return{}},reset:function(){this.doReset()},resetDefaults:function(){this.doResetDefaults()},commit:function(){this.doCommit()},valueChanged:function(){this.trigger("valueChanged",this.getValue())},valueChanging:function(){this.trigger("valueChanging",this.getValue())},doReset:function(){return},doResetDefaults:function(){},doCommit:function(){return}});var i=function(e){return'<div class="col-sm-4 grey">'+e.label+'</div>	      	<div class="col-sm-8"><span data-type="cpWrapper"></span></div>'}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.cms.templates.ColorEditor=r.modules.cms.templates.AttributeEditor.extend({doInternalInitialize:function(e){this._attribute=e.attribute||{},this.$el.addClass("col-sm-6"),this.$el.html(i(this._attribute)),this._colorPicker=new r.modules.common.ColorPicker({el:this.$el.find("span[data-type=cpWrapper]"),color:this._defaultValue()}),this._colorPicker.on("valueChanged",this.valueChanged=n.bind(this.valueChanged,this)).on("valueChanging",this.valueChanging=n.bind(this.valueChanging,this)),this._color=this._colorPicker.getColor()},getValue:function(){return n.extend(n.clone(this._attribute),{default_value:this._attribute.default_value,value:this._color})},valueChanging:function(e){this._color=e,r.modules.cms.templates.AttributeEditor.prototype.valueChanging.apply(this)},valueChanged:function(e){this._color=e,r.modules.cms.templates.AttributeEditor.prototype.valueChanged.apply(this)},doReset:function(){this._setColor(this._defaultValue())},doResetDefaults:function(){this._setColor(this._attribute.default_value)},doCommit:function(){this._attribute.value=this._color},onRemove:function(){this._colorPicker.off("valueChanged",this.valueChanged).off("valueChanging",this.valueChanging),this._colorPicker.remove()},_setColor:function(e){this._color=e,this._colorPicker.setColor(this._color)},_defaultValue:function(){return this._attribute.value!=undefined?this._attribute.value:this._attribute.default_value}});var i=function(e){return'<div class="col-sm-4 grey">'+e.label+'</div>	      	<div class="col-sm-8"><span data-type="cpWrapper"></span></div>'}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.cms.templates.CheckboxEditor=r.modules.cms.templates.AttributeEditor.extend({events:{"change input":"valueChanged"},doInternalInitialize:function(e){this._attribute=e.attribute||{},this.$el.addClass("col-sm-6"),this.$input=this.$el.html(i(this._attribute)).find("input"),this._setValue(this._defaultValue())},getValue:function(){return{id:this._attribute.id,name:this._attribute.name,default_value:this._attribute.default_value,value:this._isChecked()}},doCommit:function(){this._attribute.value=this._isChecked()},doReset:function(){this._setValue(this._defaultValue())},doResetDefaults:function(){this._setValue(this._attribute.default_value)},_defaultValue:function(){return this._attribute.value!=undefined?this._attribute.value:this._attribute.default_value},_isChecked:function(){return this.$input[0].checked},_setValue:function(e){e?this.$input.attr("checked",!0):this.$input.attr("checked",!1)}});var i=function(e){return'<div class="col-sm-8 grey"><label><span>'+e.label+'</span><input type="checkbox" name="'+e.id+'"/></label></div>'}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.cms.templates.RadioEditor=r.modules.cms.templates.AttributeEditor.extend({events:{"change input":"valueChanged"},doInternalInitialize:function(e){this._attribute=e.attribute||{},this.$el.addClass("col-sm-12"),this.$el.html(i(this._attribute)).find("input"),this._setValue(this._defaultValue())},getValue:function(){return{id:this._attribute.id,name:this._attribute.name,default_value:this._attribute.default_value,value:this.$el.find("input:checked").val()}},doCommit:function(){this._attribute.value=this.$el.find("input:checked").val()},doReset:function(){this._setValue(this._defaultValue())},doResetDefaults:function(){this._setValue(this._attribute.default_value)},_setValue:function(e){this.$el.find('input[value="'+e+'"]').attr("checked",!0)},_defaultValue:function(){return this._attribute.value!=undefined?this._attribute.value:this._attribute.default_value}});var i=function(e){var t='<div class="col-sm-2 grey">'+e.label+'</div>      		<div class="col-sm-8">';return n.each(e.available_values,function(n){t+='<label><input type="radio" name="'+e.id+'" value="'+n.value+'"/><span>'+n.label+"</span></label>"}),t+="</div>",t}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.cms.templates.NumberEditor=r.modules.cms.templates.AttributeEditor.extend({events:{"keyup input":"_onKeyup"},doInternalInitialize:function(e){this._lastInput="",this._attribute=e.attribute||{},this.$el.addClass("col-sm-6"),this.$input=this.$el.html(i(this._attribute)).find("input"),this._setValue(this._defaultValue())},getValue:function(){return{id:this._attribute.id,name:this._attribute.name,default_value:this._attribute.default_value,value:this.$input.val()}},doCommit:function(){this._attribute.value=this.$input.val()},doReset:function(){this._setValue(this._defaultValue())},doResetDefaults:function(){this._setValue(this._attribute.default_value)},_setValue:function(e){this.$input.val(e),this._lastInput=e},_valueAsNumber:function(){if(n.isNumber(this._lastInput))return this._lastInput;try{return parseInt(this._lastInput)}catch(e){return 0}},_defaultValue:function(){return this._attribute.value!=undefined?this._attribute.value:this._attribute.default_value},_onKeyup:function(t){if(t.keyCode==r.constants.enter||t.keyCode==r.constants.tab)return;if(t.keyCode==r.constants.del&&this._lastInput!=e(t.target).val()){this.valueChanged();return}if((t.keyCode<48||t.keyCode>57)&&t.keyCode!=r.constants.upArrow&&t.keyCode!=r.constants.downArrow){this._setValue(this._lastInput);return}var n;if(t.keyCode==r.constants.upArrow||t.keyCode==r.constants.downArrow)n=this._valueAsNumber(),t.keyCode==r.constants.upArrow&&n++,t.keyCode==r.constants.downArrow&&n--;else try{n=parseInt(e(t.target).val())}catch(t){}this._attribute.max_value!=undefined&&n>this._attribute.max_value?n=this._attribute.max_value:this._attribute.min_value!=undefined&&n<this._attribute.min_value&&(n=this._attribute.min_value),this._setValue(n),this.valueChanged()}});var i=function(e){return'<div class="col-sm-4 grey">'+e.label+'</div>      		<div class="col-sm-8"><input type="text" name="'+e.id+'" data-attr-type="number"/></div>'}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.cms.templates.ShortNumberEditor=r.modules.cms.templates.AttributeEditor.extend({events:{"keyup input":"_onKeyup"},doInternalInitialize:function(e){this._attribute=e.attribute||{},this.$el.addClass("col-sm-6"),this.$input=this.$el.html(i(this._attribute)).find("[data-attr-type=shortNumber]").slider({min:this._attribute.min_value,max:this._attribute.max_value}),this.$input.on("slide",this.valueChanged=n.bind(this.valueChanged,this)),this._setValue(this._defaultValue())},getValue:function(){return{id:this._attribute.id,name:this._attribute.name,default_value:this._attribute.default_value,value:this.$input.slider("getValue")}},doCommit:function(){this._attribute.value=this.$input.slider("getValue")},doReset:function(){this._setValue(this._defaultValue())},doResetDefaults:function(){this._setValue(this._attribute.default_value)},onRemove:function(){this.$input.off("slide",this.valueChanged)},_setValue:function(e){if(e==undefined||e==null)return;this._attribute.min_value!=undefined&&this._attribute.min_value>e&&(e=this._attribute.min_value),this._attribute.max_value!=undefined&&this._attribute.max_value<e&&(e=this._attribute.max_value),this.$input.slider("setValue",e)},_defaultValue:function(){if(this._attribute.value==undefined)return this._attribute.default_value;try{return parseInt(this._attribute.value)}catch(e){return this._attribute.default_value}}});var i=function(e){return'<div class="col-sm-4 grey">'+e.label+'</div>      		<div class="col-sm-8"><div data-attr-type="shortNumber"></div></div>'}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.cms.templates.GridNumberEditor=r.modules.cms.templates.AttributeEditor.extend({events:{"change input":"valueChanged","click li img":"_selectImage"},doInternalInitialize:function(e){this._attribute=e.attribute||{},this.$el.html(i(this._attribute)),this._setValue(this._defaultValue())},getValue:function(){return{id:this._attribute.id,name:this._attribute.name,default_value:this._attribute.default_value,value:this.$el.find("input:checked").val()}},doCommit:function(){this._attribute.value=this.$el.find("input:checked").val()},doReset:function(){this._setValue(this._defaultValue())},doResetDefaults:function(){this._setValue(this._attribute.default_value)},_setValue:function(e){this.$el.find('input[value="'+e+'"]').attr("checked","checked")},_selectImage:function(t){e(t.target).closest("li").find("input").attr("checked",!0).trigger("change")},_defaultValue:function(){return this._attribute.value!=undefined?this._attribute.value:this._attribute.default_value}});var i=function(e){var t='<ul class="grid-number-configurator">';return n.each(e.available_values,function(n){t+='<li>		  	<div>		    	<img src="'+r.assetLink(n.thumbnail_url)+'"/>		    </div>		    <div>		    	<input type="radio" name="'+e.id+'" value="'+n.value+'"/>		    </div>		  </li>'}),t+="</ul>",t}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.cms.templates.DefaultEditor=r.modules.cms.templates.AttributeEditor.extend({doInternalInitialize:function(e){this._attribute=e.attribute||{},this.$el.html(i(this._attribute))},getValue:function(){return{}},doCommit:function(){return},doReset:function(){return}});var i=function(e){return'<div class="col-sm-4 grey">'+e.label+'</div>      		<div class="col-sm-8" data-attribute-id="'+e.id+'">'+e.name+"["+e.type+"]</div>"}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.cms.templates.AttributesGroup=r.common.BaseView.extend({events:{"click .group-configurator-title [data-action=resetDefaults]":"resetDefaults"},doInitialize:function(e){this._group=e.group||{},this._initialValues=e.values||{},this._attrEditors=[],this.$el.html(i(this._group)),this._onAttributeChanged=n.bind(this._onAttributeChanged,this),this._onAttributeChanging=n.bind(this._onAttributeChanging,this),this._render()},getValues:function(){var e=[];return n.each(this._attrEditors,function(t){var n=t.getValue();e.push({id:n.id,name:n.name,value:n.value,default_value:n.default_value})}),e},commit:function(){n.each(this._attrEditors,function(e){e.commit()})},reset:function(){n.each(this._attrEditors,function(e){e.reset()})},resetDefaults:function(){n.each(this._attrEditors,function(e){e.resetDefaults()}),this._fireAttributesChangedEvent()},onRemove:function(){var e=this;n.each(this._attrEditors,function(t){t.off("valueChanged",e._onAttributeChanged).off("valueChanging",e._onAttributeChanging),t.remove()})},_render:function(){var t=this,i=0,s=this._group.attributes.length,o=this.$el.find(".group-configurator-attributes"),u=e('<div class="attributes-row"/>').appendTo(o);n.each(this._group.attributes,function(a){a.type||(a.type="");var f=n.clone(a),l=n.find(t._initialValues.attributes,function(e){return e.name==a.name});!l||(f.value=l.value);var c,h=e("<div/>").appendTo(u);switch(a.type.toLowerCase()){case"color":c=new r.modules.cms.templates.ColorEditor({attribute:f,el:h});break;case"checkbox":c=new r.modules.cms.templates.CheckboxEditor({attribute:f,el:h});break;case"radio":c=new r.modules.cms.templates.RadioEditor({attribute:f,el:h});break;case"number":c=new r.modules.cms.templates.NumberEditor({attribute:f,el:h});break;case"shortnumber":c=new r.modules.cms.templates.ShortNumberEditor({attribute:f,el:h});break;case"gridnumber":c=new r.modules.cms.templates.GridNumberEditor({attribute:f,el:h});break;default:c=new r.modules.cms.templates.DefaultEditor({attribute:f,el:h})}c.on("valueChanged",t._onAttributeChanged).on("valueChanging",t._onAttributeChanging),t._attrEditors.push(c),++i%2==0&&(u.append('<div class="clearfix"/>'),i<s&&(u=e('<div class="attributes-row"/>').appendTo(o)))}),i%2!=0&&u.append('<div class="clearfix"/>')},_onAttributeChanged:function(e){this.trigger("valueChanged",[e])},_onAttributeChanging:function(e){this.trigger("valueChanging",[e])},_fireAttributesChangedEvent:function(){this.trigger("valueChanged",this.getValues())}});var i=function(e){return'<div class="form-group group-configurator">				<div class="light-grey group-configurator-title">'+n.unescape(e.label)+'<span class="options" data-action="resetDefaults">(恢复默认值)</span>					</div>				<div class="group-configurator-attributes"></div>			</div>'}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.cms.templates.AttributesConfigurator=r.common.BaseView.extend({events:{"click .template-configurator-options":"_toggleConfigurator"},doInitialize:function(e){this._onAttributeChanged=n.bind(this._onAttributeChanged,this),this._onAttributeChanging=n.bind(this._onAttributeChanging,this),this.$el.html(i())},getValues:function(e){var t=[];return n.each(this._groups,function(r){n.each(r.getValues(),function(r){if(r.value==undefined||!e&&r.value==r.default_value)return;var i=r.id.split("."),s=n.find(t,function(e){return e.name==i[0]});s||(s={name:i[0],attributes:[]},t.push(s)),s.attributes.push({id:r.id,name:i[1],value:r.value})})}),t},setAttributes:function(e,t,n,r){this._cleanup(),this._templateInfo={id:n.id,option_id:n.option_id,type:n.type},this._attributes=e||[],this._initialValues=t||[],this._groups=[],this._render(),r&&this._fireAllAttributesChangedEvent(),this._isConfiguratorStateOpened()&&this.$el.find(".template-attributes-configurator").hasClass("hide")&&this.$el.find(".template-configurator-options").trigger("click")},commit:function(){n.each(this._groups,function(e){e.commit()})},reset:function(){n.each(this._groups,function(e){e.reset()}),this._fireAllAttributesChangedEvent()},onRemove:function(){var e=this;n.each(this._groups,function(t){t.off("valueChanged",e._onAttributeChanged).off("valueChanging",e._onAttributeChanging),t.remove()})},_cleanup:function(){n.each(this._groups,function(e){e.remove()}),this._templateInfo={},this._attributes=[],this._initialValues=[],this._groups=[]},_render:function(){var t=this,i=this.$el.find(".template-attributes-configurator");n.each(this._attributes,function(s){var o=n.find(t._initialValues,function(e){return e.name==s.name});n.each(s.groups,function(n){var s=new r.modules.cms.templates.AttributesGroup({el:e("<div/>").appendTo(i),group:n,values:o});s.on("valueChanged",t._onAttributeChanged).on("valueChanging",t._onAttributeChanging),t._groups.push(s)})})},_onAttributeChanging:function(e){this._onAttributeChanged(e,!1)},_onAttributeChanged:function(e,t){if(!e||!e.length)return;t!=undefined||(t=!0);var i={sectionId:this.args.sectionId,optionId:this._templateInfo.option_id,type:this._getAttributeType(),attributes:{}};n.each(e,function(e){var t=e.id.split(".");i.attributes[t[0]]||(i.attributes[t[0]]={}),i.attributes[t[0]][t[1]]=e.value}),r.modules.AppPreviewer.templateAttributeChanged(i),t&&this.trigger("changed")},_getAttributeType:function(){switch(this._templateInfo.type){case"LAYOUT":return"home";case"NAVIGATION":return"nav";case"LIST":return"list";case"CONTENT":return"content";case"HEADERBAR":return"headerBar"}return"UNKNOWN"},_toggleConfigurator:function(t){var n=this.$el.find(".template-attributes-configurator"),r=e(t.target);r.is("div")||(r=r.closest("div")),n.hasClass("hide")?(n.removeClass("hide"),r.find("i").removeClass("glyphicon-chevron-down").addClass("glyphicon-chevron-up"),this._setConfiguratorStateOpened(!0)):(n.addClass("hide"),r.find("i").removeClass("glyphicon-chevron-up").addClass("glyphicon-chevron-down"),this._setConfiguratorStateOpened(!1))},_setConfiguratorStateOpened:function(e){var t=r.App.config.currentApp.id;r.App.config.prefs[t]["template_configurator_"+this._templateInfo.type+"_opened"]=e},_isConfiguratorStateOpened:function(){var e=r.App.config.currentApp.id;return 1==r.App.config.prefs[e]["template_configurator_"+this._templateInfo.type+"_opened"]},_fireAllAttributesChangedEvent:function(){var e=this.getValues(!0),t=[];n.each(e,function(e){t=n.union(t,e.attributes)}),this._onAttributeChanged(t,!1)}});var i=function(){return'<div class="template-configurator-options pull-right" data-action="toggleCollapse"> 高级选项 <i class="glyphicon glyphicon-chevron-down"></i></div>			<div class="template-attributes-configurator hide"></div>'}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf")}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.AppSettings=r.common.BaseView.extend({events:{"keyup input[name=name]":"_onKeyup","click a[data-action=save]":"_save","click a[data-action=return]":"_cancel",submit:"_save"},doInitialize:function(){this._app=r.App.config.currentApp,this.$form=this.$el.html(i()).find("form"),this.$form.find("input[name=name]").val(n.unescape(this._app.name)),this.$form.find("input[name=about_info]").val(n.unescape(this._app.about_info)),this._homeTemplateConfigurator=new r.modules.cms.TemplateConfigurator({el:this.$form.find(".template-slider[data-type=HOME]"),templates:this._findHomeNavTemplates(),selectedTemplateId:this._app.home.template_id}),this._homeTemplateConfigurator.on("templateSettings.updated",n.bind(this._onTemplateChanged,this)),this._templateAttrsConfigurator=new r.modules.cms.templates.AttributesConfigurator({el:this.$el.find('.form-group div[data-type="homeAttrsConfigurator"]')}),this._templateAttrsConfigurator.on("changed",n.bind(this._contentChanged,this)),this._initializeTemplateAttrsConfigurator(this._app.home.template_id),this._headerbarConfigurator=new r.modules.cms.templates.AttributesConfigurator({el:this.$el.find('div[data-type="headerBarConfigurator"]')}),this._headerbarConfigurator.on("changed",n.bind(this._contentChanged,this)),this._initializeHeaderbarConfigurator(),t.Events.on("previewer.loaded",n.bind(this._onPreviewerLoaded,this))},onHide:function(){this.isChanged()&&this._cancel()},onRemove:function(){t.Events.off("previewer.loaded",this._onPreviewerLoaded),this._homeTemplateConfigurator.off("templateSettings.updated",this._onTemplateChanged),this._templateAttrsConfigurator.off("changed",this._contentChanged),this._headerbarConfigurator.off("changed",this._contentChanged),this.isChanged()&&this._cancel(),this._homeTemplateConfigurator.remove(),this._templateAttrsConfigurator.remove(),this._headerbarConfigurator.remove(),this._clearCachedTemplateAttributes()},isChanged:function(){return this._contentModifiedDt||this._templateModifiedDt},_onTopImgSelecterShown:function(e){var t=this._app.top_img_url;if(t&&t.indexOf("material")>=0){var n=this.$topImgSelecter.find('li div[data-url="'+t+'"]'),r=n.parent("li");r.click()}},_return:function(e){e.preventDefault(),r.navigate("/builder/"+r.App.config.currentApp.id+"/cms/home")},_findHomeNavTemplates:function(){return n.find(r.App.config.sectionTypes,function(e){return e.code=="HOME"}).templates},_uploadImgs:function(t){e(t.target).closest(".form-group").find(".thumbnail").trigger("click")},_cancel:function(e){e.preventDefault(),this.$form.find("input[name=name]").val(n.unescape(this._app.name)),this.$form.find("input[name=app_icon_url]").val(""),this.$form.find("input[name=title_img_url]").val(""),this.$form.find("input[name=home_bg_img_url]").val(""),this.$form.find("input[name=home_top_img_url]").val(""),this._app.icon_url?this.$form.find(".thumbnail[data-action=uploadAppIcon]").attr({src:this._app.icon_url}):this.$form.find(".thumbnail[data-action=uploadAppIcon]").imageHolder(),this._app.title_img_url?this.$form.find(".thumbnail[data-action=uploadTitleImg]").attr({src:this._app.title_img_url}):this.$form.find(".thumbnail[data-action=uploadTitleImg]").imageHolder(),this._app.home.bg_img_url?this.$form.find(".thumbnail[data-action=uploadBgImg]").attr({src:this._app.home.bg_img_url}):this.$form.find(".thumbnail[data-action=uploadBgImg]").imageHolder(),this._app.top_img_url?this.$form.find(".thumbnail[data-action=uploadTopImg]").attr({src:this._app.top_img_url}):this.$form.find(".thumbnail[data-action=uploadTopImg]").imageHolder(),this._app.startup_pic?this.$form.find(".thumbnail[data-action=uploadStartupImg]").attr({src:this._app.startup_pic}):this.$form.find(".thumbnail[data-action=uploadStartupImg]").imageHolder(),this._contentChanged(!1),this._templateChanged(!1),r.navigate("/builder/"+r.App.config.currentApp.id+"/cms/home")},_save:function(n){n.preventDefault();var i=this;r.showProgressIndicator("保存中..."),this.$form.find("input[name=authenticityToken]").val(r.App.config.authToken),this.$form.find("input[name=name]").val(r.App.config.currentApp.name),this.$form.find("input[name=home_template_id]").val(this._homeTemplateConfigurator.getSelectedTemplate().id),this.$form.find(".form-group").removeClass("has-error"),this.$form.find("input[name=template_attributes]").val(JSON.stringify(this._templateAttrsConfigurator.getValues())),this.$form.find("input[name=headerbar_attributes]").val(JSON.stringify(this._headerbarConfigurator.getValues())),e.post(r.api("/apps/"+this._app.id+"/settings"),this.$form.serialize()).done(function(e){if(e.code==400){i.$form.find("[data-action=save]").addClass("disabled"),i._handleValidationErrors(e.errors),r.closeProgressIndicator(),r.showMessage("ERROR","有些项填写不正确，请根据提示进行检查.",!0);return}i._app.icon_url!=e.app.icon_url&&i._setImgInputVal("app_icon_url",e.app.icon_url),i._app.title_img_url!=e.app.title_img_url&&i._setImgInputVal("title_img_url",e.app.title_img_url),i._app.home.bg_img_url!=e.app.home.bg_img_url&&i._setImgInputVal("home_bg_img_url",e.app.home.bg_img_url),i._app.top_img_url!=e.app.top_img_url&&i._setImgInputVal("home_top_img_url",e.app.top_img_url),i._app=r.App.config.currentApp=e.app,t.Events.trigger("app.settings.updated",e.app),t.Events.trigger("app.settings.cache",e.app),t.Events.trigger("app.settings.currApp",e.app),i._templateAttrsConfigurator.commit(),i._headerbarConfigurator.commit(),r.showMessage("SUCCESS","保存成功.",!0),i._contentChanged(!1),i._templateChanged(!1),r.closeProgressIndicator(),r.navigate("/builder/"+r.App.config.currentApp.id+"/cms/home")}).error(function(e){r.closeProgressBar(),i.$form.find("[data-action=save]").addClass("disabled"),r.closeProgressIndicator(),r.showMessage("ERROR","微站设置保存出错.")})},_handleValidationErrors:function(e){var t=this.$form;n.each(e,function(e){t.find("[name="+e.key+"]").after('<div class="validation-error">'+e.message+"</div>").parents(".form-group").addClass("has-error")}),t.find(".form-actions").addClass("has-error").prepend('<span class="validation-error">有些项填写不正确，请根据指示检查.</span>')},_removeValidationErrorOnFormActions:function(){this.$formActions||(this.$formActions=this.$el.find(".form-actions")),this.$formActions.removeClass("has-error").find(".validation-error").remove()},_contentChanged:function(e){e!=undefined||(e=!0),e?(this._contentModifiedDt=(new Date).getTime(),this._enableFormActions()):(this._contentModifiedDt=null,this._headerbarConfigurator.reset(),this._disableFormActionsIfNecessary()),this._fireSettingsChangedEvent()},_templateChanged:function(e){e!=undefined||(e=!0);if(e)this._templateModifiedDt=(new Date).getTime(),this._enableFormActions();else{this._templateModifiedDt=null;var t=this._homeTemplateConfigurator.getSelectedTemplate().id!=this._app.home.template_id;this._homeTemplateConfigurator.selectTemplate(this._app.home.template_id),t?this._initializeTemplateAttrsConfigurator(this._app.home.template_id):this._templateAttrsConfigurator.reset(),this._disableFormActionsIfNecessary()}this._fireTemplateChangedEvent()},_enableFormActions:function(){this.$form.find("[data-action=save]").removeClass("disabled"),this.$form.find("[data-action=return]").removeClass("disabled")},_disableFormActionsIfNecessary:function(){!this._contentModifiedDt&&!this._templateModifiedDt&&this.$form.find("[data-action=save]").addClass("disabled")},_initializeTemplateAttrsConfigurator:function(e,t){this._cacheCurrentTemplateAttributes();var n=this._findTemplateById(e),r=this._cachedTemplateAttributes[e]||[];t==undefined&&(t=!0),this._templateAttrsConfigurator.setAttributes(n.attributes,r,n,t)},_initializeHeaderbarConfigurator:function(){var e=r.App.config.headerBarAttributes||[],t={id:"",option_id:"",type:"HEADERBAR"};this._headerbarConfigurator.setAttributes(e,this._app.headerbar.attributes,t)},_cacheCurrentTemplateAttributes:function(){this._cachedTemplateAttributes?this._cachedTemplateAttributes[this._lastTemplateId]=this._templateAttrsConfigurator.getValues():(this._cachedTemplateAttributes={},this._cachedTemplateAttributes[this._app.home.template_id]=this._app.home.attributes)},_clearCachedTemplateAttributes:function(){delete this._cachedTemplateAttributes},_onTemplateChanged:function(e){this._templateChanged(),this._initializeTemplateAttrsConfigurator(e.id),this._lastTemplateId=e.id},_onKeyup:function(t){e(t.target).parents(".form-group").removeClass("has-error").end().next(".validation-error").remove(),this._removeValidationErrorOnFormActions(),this._contentChanged()},_setImgInputVal:function(e,t){this.$form.find("input[name="+e+"]").val(t)},_onAppIconUploaded:function(e,t){this._setImgInputVal("app_icon_url",t.url),this._contentChanged()},_onTitleImgUploaded:function(e,t){this._setImgInputVal("title_img_url",t.url),this._contentChanged()},_onTitleImgRemoved:function(){this.$form.find("input[name=title_img_url]").val(""),this._app.title_img_url=null,this._contentChanged()},_onHomeBgImgUploaded:function(e,t){this._setImgInputVal("home_bg_img_url",t.url),this._contentChanged()},_onHomeBgImgRemoved:function(){this.$form.find("input[name=home_bg_img_url]").val(""),this._contentChanged()},_onHomeTopImgUploaded:function(e,t){this._setImgInputVal("home_top_img_url",t.url),this._contentChanged()},_onHomeTopImgRemoved:function(){this.$form.find("input[name=home_top_img_url]").val(""),this._app.top_img_url=null,this._contentChanged()},_onStartupImgUploaded:function(e,t){this.$form.find("input[name=startup_pic]").val(t.url),this._contentChanged()},_onStartupImgRemoved:function(){this.$form.find("input[name=startup_pic]").val(""),this._app.top_img_url=null,this._contentChanged()},_onPreviewerLoaded:function(){this.isChanged()&&this._fireSettingsChangedEvent()},_findTemplateById:function(e){return n.find(this._findHomeNavTemplates(),function(t){return t.id==e})},_fireSettingsChangedEvent:function(){},_fireTemplateChangedEvent:function(){var e=this._homeTemplateConfigurator.getSelectedTemplate().optionId;r.modules.AppPreviewer.homeTemplateChanged(e)}});var i=function(){return'			<form class="form-horizontal appSettingForm">				<input type="hidden" name="authenticityToken"/>		        <input type="hidden" name="name"/>		        <input type="hidden" name="about_info"/>				<input type="hidden" name="home_template_id"/>				<input type="hidden" name="app_icon_url"/>				<input type="hidden" name="title_img_url"/>				<input type="hidden" name="home_bg_img_url"/>				<input type="hidden" name="home_top_img_url"/>				<input type="hidden" name="startup_pic"/>				<input type="hidden" name="template_attributes"/>				<input type="hidden" name="headerbar_attributes"/>				 <div class="topBtns">			        <div class="pull-right">						<a href="#" class="btn btn-cancel btn-sm" data-action="return">							<i class="icon-remove bigger-110"></i>取消						</a> 						<a href="#" class="btn btn-success btn-sm disabled" data-loading-text="保存中..." data-action="save">					        <i class="icon-ok bigger-120 "></i>保存					    </a>			        </div>			    </div>				<h3 class="header smaller light-grey">首页板式</h3>				<div class="form-group">					<div class="col-sm-12">						<div class="carousel slide col-sm-12 template-slider" data-type="HOME"></div>						<div class="clearfix"></div>						<div data-type="homeAttrsConfigurator"></div>						<div class="clearfix"><br/><br/><br/></div>					</div>				</div>			</form>'},s=function(){var e='<div id="modal-bgiSelecter" class="modal in" aria-hidden="false">				    <div class="modal-dialog bgiSelecter">				        <div class="modal-content">				            <div class="modal-header lighter blue">选择背景图片				                <span class="close" data-dismiss="modal">×</span>				            </div>				            <div class="modal-body">				                <div>				                    <ul class="bgiSelecter-inner clearfix">				                    	<li><div class="bgi-101@2x~iphone" data-url="/files/material/bgis/640/101@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/101@2x~iphone.jpg)"></div></li><li><div class="bgi-102@2x~iphone" data-url="/files/material/bgis/640/102@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/102@2x~iphone.jpg)"></div></li><li><div class="bgi-103@2x~iphone" data-url="/files/material/bgis/640/103@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/103@2x~iphone.jpg)"></div></li><li><div class="bgi-104@2x~iphone" data-url="/files/material/bgis/640/104@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/104@2x~iphone.jpg)"></div></li><li><div class="bgi-105@2x~iphone" data-url="/files/material/bgis/640/105@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/105@2x~iphone.jpg)"></div></li><li><div class="bgi-106@2x~iphone" data-url="/files/material/bgis/640/106@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/106@2x~iphone.jpg)"></div></li><li><div class="bgi-107@2x~iphone" data-url="/files/material/bgis/640/107@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/107@2x~iphone.jpg)"></div></li><li><div class="bgi-108@2x~iphone" data-url="/files/material/bgis/640/108@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/108@2x~iphone.jpg)"></div></li><li><div class="bgi-109@2x~iphone" data-url="/files/material/bgis/640/109@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/109@2x~iphone.jpg)"></div></li><li><div class="bgi-110@2x~iphone" data-url="/files/material/bgis/640/110@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/110@2x~iphone.jpg)"></div></li><li><div class="bgi-111@2x~iphone" data-url="/files/material/bgis/640/111@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/111@2x~iphone.jpg)"></div></li><li><div class="bgi-112@2x~iphone" data-url="/files/material/bgis/640/112@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/112@2x~iphone.jpg)"></div></li><li><div class="bgi-113@2x~iphone" data-url="/files/material/bgis/640/113@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/113@2x~iphone.jpg)"></div></li><li><div class="bgi-114@2x~iphone" data-url="/files/material/bgis/640/114@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/114@2x~iphone.jpg)"></div></li><li><div class="bgi-115@2x~iphone" data-url="/files/material/bgis/640/115@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/115@2x~iphone.jpg)"></div></li><li><div class="bgi-116@2x~iphone" data-url="/files/material/bgis/640/116@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/116@2x~iphone.jpg)"></div></li><li><div class="bgi-117@2x~iphone" data-url="/files/material/bgis/640/117@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/117@2x~iphone.jpg)"></div></li><li><div class="bgi-118@2x~iphone" data-url="/files/material/bgis/640/118@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/118@2x~iphone.jpg)"></div></li><li><div class="bgi-119@2x~iphone" data-url="/files/material/bgis/640/119@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/119@2x~iphone.jpg)"></div></li><li><div class="bgi-120@2x~iphone" data-url="/files/material/bgis/640/120@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/120@2x~iphone.jpg)"></div></li><li><div class="bgi-121@2x~iphone" data-url="/files/material/bgis/640/121@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/121@2x~iphone.jpg)"></div></li><li><div class="bgi-122@2x~iphone" data-url="/files/material/bgis/640/122@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/122@2x~iphone.jpg)"></div></li><li><div class="bgi-123@2x~iphone" data-url="/files/material/bgis/640/123@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/123@2x~iphone.jpg)"></div></li><li><div class="bgi-124@2x~iphone" data-url="/files/material/bgis/640/124@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/124@2x~iphone.jpg)"></div></li><li><div class="bgi-125@2x~iphone" data-url="/files/material/bgis/640/125@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/125@2x~iphone.jpg)"></div></li><li><div class="bgi-126@2x~iphone" data-url="/files/material/bgis/640/126@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/126@2x~iphone.jpg)"></div></li><li><div class="bgi-127@2x~iphone" data-url="/files/material/bgis/640/127@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/127@2x~iphone.jpg)"></div></li><li><div class="bgi-200@2x~iphone" data-url="/files/material/bgis/640/200@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/200@2x~iphone.jpg)"></div></li><li><div class="bgi-201@2x~iphone" data-url="/files/material/bgis/640/201@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/201@2x~iphone.jpg)"></div></li><li><div class="bgi-202@2x~iphone" data-url="/files/material/bgis/640/202@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/202@2x~iphone.jpg)"></div></li><li><div class="bgi-203@2x~iphone" data-url="/files/material/bgis/640/203@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/203@2x~iphone.jpg)"></div></li><li><div class="bgi-204@2x~iphone" data-url="/files/material/bgis/640/204@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/204@2x~iphone.jpg)"></div></li><li><div class="bgi-205@2x~iphone" data-url="/files/material/bgis/640/205@2x~iphone.jpg" style="background-image:url(/files/material/bgis/100/205@2x~iphone.jpg)"></div></li>				                    </ul>				                </div>				            </div>				            <div class="modal-footer">				                <button type="button" class="btn btn-cancel" data-dismiss="modal">				                    <i class="icon-remove bigger-110"></i>取消				                </button>				                <button class="btn btn-success" data-action="selectTopImg">				                    <i class="icon-ok bigger-110"></i>确定				                </button>				            </div>				        </div>				    </div>				</div>';return e},o=function(){return r.App.config.root+"/builder/"+r.App.config.currentApp.id+"/cms/home"}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.store||(r.modules.store={})}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf"),i=require("moment");r.modules.store.OrderInfo=r.common.BaseView.extend({events:{"click a[data-action=back-list]":"_back2list","click #order-operation-button":"_doOrderOperation"},doInitialize:function(){this.$el.html(a())},onShow:function(e){this._loadData(e.orderId)},_loadData:function(t){var n=this;r.showProgressIndicator("装载订单信息..."),e.get("/api/store/order",{appId:r.App.config.currentApp.id,orderId:t}).done(function(e){n.orderDetail=e.result,n._render(),r.closeProgressIndicator()}).error(function(e){r.closeProgressIndicator(),r.showMessage("ERROR","订单信息装载出错.",!0)})},_render:function(){e("#orderInformation span.order-info").text(""),e("#order_item_list").html("");var t=this.orderDetail;e("#orderId").text(t.orderSn),e("#buyerName").text(t.memberName),e("#payway").text(t.payment.paymentConfigName),e("#orderStatus").text(s(t.orderStatus)),e("#paymentStatus").text(o(t.paymentStatus)),e("#shipStatus").text(u(t.shippingStatus)),e("#orderCreateTime").text(i(t.createTime).format("YYYY-MM-DD HH:mm:ss")),e("#orderTotalPrice").text(t.productTotalPrice),e("#shipName").text(t.shipName),e("#shipAddress").text(t.shipAddress),e("#shipPhone").text(t.shipPhone),e("#shipZipCode").text(t.shipZipCode),this._canShipOrderProduct()?(e("#shipCompany div.profile-info-value").html('<input name="shipCompany"></input'),e("#shipSn div.profile-info-value").html('<input name="shipSn"></input')):(e("#shipCompany div.profile-info-value").html('<span name="shipCompany" class="order-info">'+t.shipCompany?t.shipCompany:"</span>"),e("#shipSn div.profile-info-value").html('<span name="shipSn" class="order-info">'+t.shipSn?t.shipSn:"</span>")),e.each(t.orderItems,function(t,n){e("#order_item_list").append('<div class="message-item col-xs-12">					<span class="col-md-4 align-left"> <span class="img" style="background-image:url('+n.productPicture+');"></span>'+n.productItemName+'</span>					<span class="col-md-2"> '+n.productPrice+'元 </span>					<span class="col-md-1"> '+n.productQuantity+'</span>					<span class="col-md-2"> '+n.productPrice*n.productQuantity+"元 </span>				</div>")}),this._canShipOrderProduct()?(e("#order-operation-button").show(),this.operation="MARK_ORDER_SHIPPED",e("#order-operation-button span").text("确认发货")):e("#order-operation-button").hide()},_validateShipForm:function(){e("#orderInformation").validate({onkeyup:function(t){e(t).valid()},onfocusout:function(t){e(t).valid()},errorElement:"div",errorClass:"help-block",focusInvalid:!1,rules:{shipCompany:{required:!0},shipSn:{required:!0}},messages:{shipCompany:"物流公司不能为空",shipSn:"物流单号不能为空"},highlight:function(t){e(t).closest(".form-group").removeClass("has-info").addClass("has-error")},success:function(t){e(t).closest(".form-group").removeClass("has-error").addClass("has-info"),e(t).remove()},errorPlacement:function(e,t){e.insertAfter(t.parent())}})},_canShipOrderProduct:function(){var e=this.orderDetail;return e.paymentStatus=="PAID"&&e.shippingStatus=="UNSHIPPED"},_back2list:function(e){e.preventDefault(),r.navigate("/builder/"+r.App.config.currentApp.id+"/business/store/orders")},_handleValdiationErrors:function(e){},_doOrderOperation:function(t){t.preventDefault();var n=this,i=this.orderDetail;e("#order-operation-button").button("loading");if(this.operation=="CONFIRM_ORDER")r.showProgressIndicator("订单确认中..."),e.ajax({url:"/api/store/order",type:"POST",contentType:"application/json;charset=utf-8",data:JSON.stringify({operation:"CONFIRM_ORDER",orderId:i.id})}).done(function(e){if(e.code==200){i.orderStatus="CONFIRMED",n._render(),r.closeProgressIndicator();return}n._handleValdiationErrors(e.errors),r.closeProgressIndicator(),r.showMessage("ERROR","有些输入先填写不正确，请根据提示进行检查.",!0)}).complete(function(t){e("#order-operation-button").button("reset")});else if(this.operation=="MARK_ORDER_SHIPPED"){var s=e("#shipCompany input").val(),o=e("#shipSn input").val();this._validateShipForm();if(!e("#orderInformation").valid())return e("#order-operation-button").button("reset"),!1;if(!s||!o){e("#order-operation-button").button("reset");return}r.showProgressIndicator("保存物流信息..."),e.ajax({url:"/api/store/order",type:"POST",contentType:"application/json;charset=utf-8",data:JSON.stringify({operation:"MARK_ORDER_SHIPPED",orderId:i.id,shipCompany:s,shipSn:o})}).done(function(e){if(e.code==200){i.shippingStatus="SHIPPED",i.shipCompany=s,i.shipSn=o,n._render(),r.closeProgressIndicator();return}n._handleValdiationErrors(e.errors),r.closeProgressIndicator(),r.showMessage("ERROR","有些输入项填写不正确，请根据提示进行检查.",!0)}).error(function(){r.showMessage("ERROR","服务器内部错误.",!0)}).complete(function(t){e("#order-operation-button").button("reset")})}}});var s=function(e){if(e=="UNCONFIRMED")return"未确认";if(e=="CONFIRMED")return"已确认";if(e=="COMPLETED")return"已完成";if(e=="CANCELED")return"已取消";if(e=="RETURNED")return"已退货"},o=function(e){if(e=="UNPAID")return"买家未支付";if(e=="PAID")return"买家已支付";if(e=="REFUNDED")return"卖家已退款"},u=function(e){if(e=="UNSHIPPED")return"卖家未发货";if(e=="SHIPPED")return"卖家已发货";if(e=="RECEIVED")return"买家已收货"},a=function(){return'<div class="page-content orderInformation">		<form action="" id="orderInformation" novalidate="novalidate">		<div class="page-header">			<h1>				订单管理				<small>					<i class="icon-double-angle-right"></i>					订单信息 : <span id="orderId"></span>				</small>				<a href="#" data-action="back-list" class="btn btn-sm pull-right">返回订单列表 </a>			</h1>		</div>		<div class="row">			<div class="col-md-4"><!-- 基本信息 -->				<div class="widget-box">					<div class="widget-header widget-header-flat">						<h4 class="lighter smaller"><i class="icon icon-barcode"></i>基本信息</h4>					</div>					<div class="widget-body">						<div class="widget-main padding-0">							<div class="profile-user-info profile-user-info-striped">								<div class="profile-info-row">									<div class="profile-info-name"> 订单状态 </div>									<div class="profile-info-value">										<span id="orderStatus" class="order-info label label-sm"></span>									</div>								</div>								<div class="profile-info-row">									<div class="profile-info-name"> 购货人 </div>									<div class="profile-info-value">										<span id="buyerName" class="order-info"></span>									</div>								</div>								<div class="profile-info-row">									<div class="profile-info-name"> 订单金额 </div>									<div class="profile-info-value">										<span id="orderTotalPrice" class="order-info"></span>元									</div>								</div>								<div class="profile-info-row">									<div class="profile-info-name"> 下单时间 </div>									<div class="profile-info-value">										<span id="orderCreateTime" class="order-info"></span>									</div>								</div>								<div class="profile-info-row">									<div class="profile-info-name"> 支付方式 </div>									<div class="profile-info-value">										<span id="payway" class="order-info"></span>									</div>								</div>							</div>						</div>					</div>				</div>			</div><!-- 基本信息 end -->			<div class="col-md-4"><!-- 收货人信息 -->				<div class="widget-box">					<div class="widget-header widget-header-flat">						<h4 class="lighter smaller"><i class="icon icon-user"></i>买家信息</h4>					</div>					<div class="widget-body">						<div class="widget-main padding-0">							<div class="profile-user-info profile-user-info-striped">								<div class="profile-info-row">									<div class="profile-info-name"> 付款状态 </div>									<div class="profile-info-value">										<span id="paymentStatus" class="order-info label label-sm"></span>									</div>								</div>								<div class="profile-info-row">									<div class="profile-info-name"> 收货人 </div>									<div class="profile-info-value">										<span id="shipName" class="order-info"></span>									</div>								</div>								<div class="profile-info-row">									<div class="profile-info-name"> 地址 </div>									<div class="profile-info-value">										<i class="icon-map-marker light-orange bigger-110"></i>										<span id="shipAddress" class="order-info"></span>									</div>								</div>								<div class="profile-info-row">									<div class="profile-info-name"> 电话 </div>									<div class="profile-info-value">										<span id="shipPhone" class="order-info"></span>									</div>								</div>								<div class="profile-info-row">									<div class="profile-info-name"> 邮编 </div>									<div class="profile-info-value">										<span id="shipZipCode" class="order-info">610000</span>									</div>								</div>							</div>						</div>					</div>				</div>			</div><!-- 收货人信息 end -->			<div class="col-md-4"><!-- 物流信息 -->				<div class="widget-box">					<div class="widget-header widget-header-flat">						<h4 class="lighter smaller"><i class="icon icon-dollar"></i>物流信息</h4>					</div>					<div class="widget-body">						<div class="widget-main padding-0">							<div class="profile-user-info profile-user-info-striped">								<div class="profile-info-row">									<div class="profile-info-name"> 发货状态 </div>									<div class="profile-info-value">										<span id="shipStatus"  class="order-info label label-sm"></span>									</div>								</div>								<div id="shipCompany" class="profile-info-row form-group">									<div class="profile-info-name control-label"> 物流公司 </div>									<div class="profile-info-value">										<span name="shipCompany" class="order-info"></span>									</div>								</div>								<div id="shipSn" class="profile-info-row form-group">									<div class="profile-info-name control-label"> 物流单号 </div>									<div class="profile-info-value">									</div>								</div>							</div>						</div>					</div>				</div>			</div><!-- 其他信息 end-->		</div>		<div class="widget-box transparent">			<div class="widget-header">				<h4 class="lighter">商品信息</h4>			</div>			<div class="widget-body">				<div class="message-container">					<div class="message-navbar clearfix">						<div class="message-bar col-xs-12">							<span class="col-xs-12 col-md-4"> 商品名称 </span>							<span class="col-xs-12 col-md-2"> 价格 </span>							<span class="col-xs-12 col-md-1"> 数量 </span>							<span class="col-xs-12 col-md-2"> 小计 </span>						</div>					</div>					<div class="message-list-container clearfix">						<div id="order_item_list" class="message-list">						</div>					</div>					<div class="message-footer clearfix" >						<div class="pull-right">							<button id="order-operation-button" class="btn btn-success" style="display: none;">								<i class="icon-ok bigger-110"></i>								<span></span>							</button>						</div>					</div>				</div>			</div>		</form>	</div></div>'}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.store.OrderList=r.common.BaseView.extend({events:{"click [data-action=viewOrder]":"_manageOrder"},doInitialize:function(){this.$list=this.$el.html(o()).find(".contentListInner"),this.paginater=(new r.modules.common.Paginater({el:this.$el.find(".paginationWrapper")})).on("pageChanged",n.bind(this._onPageChanged,this))},onShow:function(e){this._loadData(1)},onRemove:function(){this.paginater.off("pageChanged",this._onPageChanged)},_loadData:function(t){var n=this;r.showProgressIndicator("装载订单列表..."),e.get("/api/store/orders",{appId:r.App.config.currentApp.id,psize:this.paginater.psize,pno:t}).done(function(e){n.$list.html(i(e.result.items)),n.paginater.setData({psize:e.result.pageSize,pno:e.result.pageNo,total_count:e.result.totalCount}),r.closeProgressIndicator()}).error(function(e){r.closeProgressIndicator(),r.showMessage("ERROR","订单列表装载出错.",!0)})},_onPageChanged:function(e){this._loadData(e)},_manageOrder:function(t){return t.preventDefault(),r.navigate("/builder/"+r.App.config.currentApp.id+"/business/store/orders/"+e(t.target).closest("[data-item-id]").data().itemId),!1}});var i=function(e){var t="";return n.each(e,function(e){t+='<tr>				<td class="center">			<label>				<input type="checkbox" class="ace">				<span class="lbl"></span>			</label>		</td>		<td><a href="#"  data-action="viewOrder" data-item-id="'+e.id+'">'+e.orderSn+"</a></td>		<td>"+e.createTime+"</td>		<td>"+e.shipName+"</td>		<td>"+e.productTotalPrice+'元</td>		<td>			<span class="label label-sm '+s(e.orderDisplayStatus)+'">'+e.orderDisplayStatus+'</span>		</td>		<td>			<button class="btn btn-xs btn-success tooltip-info" data-action="viewOrder" data-item-id="'+e.id+'" data-rel="tooltip" data-placement="top" data-original-title="查看">				<i class="icon-zoom-in bigger-120"></i>			</button>		</td>	</tr>'}),t},s=function(e){if(e=="已完成")return"label-success";if(e=="买家已支付")return"label-danger";if(e=="卖家已发货")return"label-info";if(e=="买家未支付")return"label-warning"},o=function(){return'<div id="orderManagement" class="tab-pane clearfix active">		<div class="table-header">订单列表</div>		<div class="table-responsive">			<div class="dataTables_wrapper">				<table class="table table-striped table-bordered table-hover dataTable">					<thead>						<tr>							<th class="center">								<label>									<input type="checkbox" class="ace">									<span class="lbl"></span>								</label>							</th>							<th>订单号</th>							<th>下单时间</th>							<th>收货人</th>							<th>总金额</th>							<th>订单状态</th>							<th>操作</th>						</tr>					</thead>					<tbody class="contentListInner"></tbody>				</table>				<div class="paginationWrapper"></div>			</div>		</div>	</div>'}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.store.PaymentConfig=r.common.BaseView.extend({events:{submit:"_save","click a[data-action=back-list]":"_back2list"},doInitialize:function(e){this._paymentConfigId=e.paymentConfigId,this.$el.html(i()),this.$form=this.$el.find("form")},onShow:function(e){this._loadData()},onRecover:function(){this._loadData()},_isNewPaymentConfig:function(){return this._paymentConfigId=="new"},_render:function(){var e=this._paymentConfig;e.id!="new"&&(this.$form.find("input[name=configName]").val(e.name),this.$form.find("input[name=partnerId]").val(e.partnerId),this.$form.find("input[name=key]").val(e.key),this.$form.find("input[name=sellerEmail]").val(e.sellerEmail),this.$form.find("textarea[name=description]").val(e.description)),this._validatePaymentForm()},_loadData:function(){if(this._isNewPaymentConfig()){this._paymentConfig=this._createPaymentConfig(),this._render();return}var t=this;r.showProgressIndicator("装载支付设置..."),e.get("/api/store/paymentConfig",{appId:r.App.config.currentApp.id,paymentConfigId:this._paymentConfigId}).done(function(e){t._paymentConfig=e.result,t._paymentConfig.appId=r.App.config.currentApp.id,t._render(),r.closeProgressIndicator()}).error(function(e){r.closeProgressIndicator(),r.showMessage("ERROR","支付设置信息装载失败.",!0)})},_createPaymentConfig:function(){return{appId:r.App.config.currentApp.id,paymentProvider:"ALIPAY",name:"",partnerId:"",key:"",sellerEmail:"",description:""}},_validatePaymentForm:function(){e("#paymentInfoForm").validate({onkeyup:function(t){e(t).valid()},onfocusout:function(t){e(t).valid()},errorElement:"div",errorClass:"help-block",focusInvalid:!1,rules:{sellerEmail:{required:!0},partnerId:{required:!0},key:{required:!0},configName:{required:!0}},messages:{sellerEmail:"商家支付帐号不能为空",key:"交易安全校验码(key)不能为空",configName:"支付方式名称不能为空",partnerId:"合作者身份(parterID)不能为空"},highlight:function(t){e(t).closest(".form-group").addClass("has-error")},unhighlight:function(t){e(t).closest(".form-group").removeClass("has-error")}})},_save:function(t){t.preventDefault();if(!e("#paymentInfoForm").valid())return e("#payment-operation-button").button("reset"),!1;r.showProgressIndicator("保存支付设置...");var n=this.$form.find(".btn-primary").button("loading"),i=this;this._paymentConfig.name=this.$form.find("input[name=configName]").val(),this._paymentConfig.partnerId=this.$form.find("input[name=partnerId]").val(),this._paymentConfig.key=this.$form.find("input[name=key]").val(),this._paymentConfig.sellerEmail=this.$form.find("input[name=sellerEmail]").val(),this._paymentConfig.description=this.$form.find("textarea[name=description]").val(),e.ajax({url:"/api/store/paymentConfig",type:"POST",contentType:"application/json;charset=utf-8",data:JSON.stringify(this._paymentConfig)}).done(function(e){if(e.code==200){i._back2list(),i.$form.find("input,textarea").val(""),r.closeProgressIndicator();return}i._handleValdiationErrors(e.errors),r.closeProgressIndicator(),r.showMessage("ERROR","有些输入项编写不正确，请根据提示进行检查.",!0)}).error(function(){r.showMessage("ERROR","服务器内部错误.",!0)}).complete(function(e){n.button("reset")})},_back2list:function(e){e&&e.preventDefault(),r.navigate("/builder/"+r.App.config.currentApp.id+"/business/store/paymentConfigs")},_handleValdiationErrors:function(e){}});var i=function(){return'<div class="page-content orderInformation">		<div class="page-header">		<h1>			支付设置			<small>				<i class="icon-double-angle-right"></i>				支付宝			</small>			<a href="#" data-action="back-list" class="btn btn-sm pull-right">返回支付方式列表 </a>		</h1>	</div>	<form id="paymentInfoForm"  class="form-horizontal appSettingForm">		<div class="form-group">			<label class="col-sm-3 control-label no-padding-right">选择支付方式</label>			<div class="col-sm-9">				<select name="paymentProvider" class="col-sm-6">					<option value="ALIPAY">支付宝</option>				</select>			</div>		</div>		<hr>		<div class="form-group">			<label class="col-sm-3 col-sm-3 control-label no-padding-right">商家支付帐号</label>			<div class="col-sm-9">			<input name="sellerEmail" type="text" placeholder="商家支付帐号" class="col-sm-6">			</div>		</div>		<div class="form-group">			<label class="col-sm-3 col-sm-3 control-label no-padding-right">支付方式名称</label>			<div class="col-sm-9">				<input name="configName" type="text" placeholder="支付方式名称" class="col-sm-6">			</div>		</div>		<div class="form-group">			<label class="col-sm-3 col-sm-3 control-label no-padding-right">合作者身份(parterID)</label>			<div class="col-sm-9">				<input name="partnerId" type="text" placeholder="合作者身份" class="col-sm-6">			</div>		</div>		<div class="form-group">			<label class="col-sm-3 col-sm-3 control-label no-padding-right">交易安全校验码(key)</label>			<div class="col-sm-9">				<input name="key" type="text" placeholder="交易安全校验码(key)" class="col-sm-6">			</div>		</div>		<div class="form-group">			<label class="col-sm-3 col-sm-3 control-label no-padding-right">选择接口类型</label>			<div class="col-sm-9">				<select name="paymentProviderService" class="col-sm-6">					<option value="">即时到账交易接口</option>				</select>			</div>		</div>		<div class="form-group">			<label class="control-label col-xs-12 col-sm-3 control-label no-padding-right" for="overview">介绍</label>			<div class="col-sm-9">				<textarea name="description" placeholder="介绍" style="min-height: 100px;" class="col-sm-6"></textarea>			</div>		</div>		<div class="clearfix form-actions">			<div class="pull-right">				<button id="payment-operation-button" class="btn btn-success btn-primary" data-loading-text="保存中...">					<i class="icon-ok bigger-110"></i>					确定				</button>			</div>		</div>	</form></div>'}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.store.PaymentConfigList=r.common.BaseView.extend({events:{"click .createBtn":"_createOrUpdatePaymentConfig","click a[data-action=viewPaymentConfig]":"_createOrUpdatePaymentConfig"},doInitialize:function(){this.$list=this.$el.html(s()).find(".contentListInner")},onShow:function(e){this._loadData()},_loadData:function(){r.showProgressIndicator("装载支付方式列表...");var t=this;e.get("/api/store/paymentConfigs",{appId:r.App.config.currentApp.id}).done(function(e){t.$list.html(i(e.result)),r.closeProgressIndicator()}).error(function(e){r.closeProgressIndicator(),r.showMessage("ERROR","支付方式列表装载失败.",!0)})},_createOrUpdatePaymentConfig:function(t){return t.preventDefault(),r.navigate("/builder/"+r.App.config.currentApp.id+"/business/store/paymentConfigs/"+e(t.target).data().itemId),!1}});var i=function(e){var t="";return n.each(e,function(e){t+='<tr>			<td class="center">				<label>					<input type="checkbox" class="ace">					<span class="lbl"></span>				</label>			</td>			<td><a href="#" data-action="viewPaymentConfig" data-item-id="'+e.id+'">'+e.name+"</a></td>			<td>"+e.orderIndex+"</td>			</tr>"}),t},s=function(){return'<div id="paymentSetting" class="tab-pane">		<div class="table-header">		支付方式列表	</div>	<div class="table-responsive">		<div class="dataTables_wrapper">			<div class="row">				<div class="col-sm-8">					<button type="button" class="btn btn-xs btn-success createBtn" data-item-id="new">						<i class="icon-plus bigger-125"></i>						添加支付方式					</button>				</div>			</div>			<table class="table table-bordered table-hover dataTable">				<thead>					<tr>						<th class="center" width="50">							<label>								<input type="checkbox" class="ace">								<span class="lbl"></span>							</label>						</th>						<th>支付方式名称</th>						<th>排序</th>					</tr>				</thead>				<tbody class="contentListInner"></tbody>			</table>		</div>	</div></div></div>'}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.store.StoreModule=r.common.ViewStack.extend({events:{"click .storeAdminHeader li>a":"_selectTab"},doInitialize:function(){this.views={orders:{clazz:r.modules.store.OrderList,removable:!0},order:{clazz:r.modules.store.OrderInfo,removable:!0},paymentConfigs:{clazz:r.modules.store.PaymentConfigList,removable:!0},paymentConfig:{clazz:r.modules.store.PaymentConfig,removable:!0}},this.$el.html(s()),this.on("viewChanged",n.bind(this._onViewChanged,this))},show:function(e,t){if(!e){r.common.BaseView.prototype.show.apply(this,t);return}var i=t&&n.extend(t,{})||{};r.common.ViewStack.prototype.show.apply(this,[e].concat(i))},viewport:function(){return this._viewport||(this._viewport=this.$el.find(".tab-content"))},isViewChangedWhenRecover:function(){return this.getLastFragment()!=t.history.getFragment()},onRemove:function(){this.off("viewChanged",this._onViewChanged)},_selectTab:function(t){t.preventDefault();var n=e(t.target).closest("a").attr("href").replace(r.App.config.root,"");r.navigate(n)},_onViewChanged:function(e,t){if(t=="order"||t=="paymentConfig")t+="s";this.$el.find('.storeAdminHeader li[data-view-id="'+t+'"]').addClass("active").siblings().removeClass("active")}});var i=function(e){return r.App.config.root+"/builder/"+r.App.config.currentApp.id+"/business/store/"+e},s=function(){return'<div class="page-content">			<div class="page-header storeModuleHeader">			<h1>商城管理</h1>		</div>		<div class="sectionModuleContent">			<div class="tabbable">				<ul class="nav nav-tabs storeAdminHeader">					<li data-view-id="orders">						<a href="'+i("orders")+'"><i class="icon-shopping-cart bigger-110"></i> 订单管理</a>					</li>					<li data-view-id="paymentConfigs">						<a href="'+i("paymentConfigs")+'"><i class="icon-dollar bigger-110"></i> 支付设置</a>					</li>				</ul>				<div class="tab-content clearfix storeAdminTabContent"></div>			</div>		</div>	</div>'}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.promotion||(r.modules.promotion={})}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.promotion.AppPromotion=r.common.BaseView.extend({events:{"click .btn[data-action=uploadCompanyIcon]":"_uploadImgs","click .btn[data-action=androidUploadCompanyIcon]":"_uploadImgs","click .btn[data-action=uploadStartupImg]":"_startupImg","click #cancelQrCodeChange":"_cancelQRCodeChange","click #cancelAndroidQrCodeChange":"_cancelAndroidQRCodeChange","click #cancelStartupImg":"_cancelStartupImg","click #qrCodeChange":"_qrCodeChange","click #androidQrCodeChange":"_androidQrCodeChange","click #saveStartupPic":"_saveStartupPic","click .nav[data-type=sidebar] li>a":"_navigate","click .btn[data-action=bindDomain]":"_bindDomain"},doInitialize:function(){this._appId=this.args.appId,t.Events.on("app.settings.bindDomain",n.bind(this._onDomainBinded,this))},viewport:function(){return this._viewport||(this._viewport=this.$el.find(".promotion-viewport")),this._viewport},show:function(e,t){this.$el.html(i()),this._initZerocopy(),this._initializeIconUploader()},onRemove:function(){this.off("viewChanged",this._onViewChanged)},isViewChangedWhenRecover:function(){return this._appId!=r.App.config.currentApp.id},_initZerocopy:function(){e("button.zerocopy").zclip("remove"),e("button.zerocopy").zclip({path:"/img/ZeroClipboard.swf",copy:this.$el.find("#zerocopy-url").text()})},_navigate:function(t){t.preventDefault();var n=e(t.target).parents("li");r.navigate(this._link(n.data().viewId))},_link:function(e){return"/builder/"+r.App.config.currentApp.id+"/promotion/"+e},_onViewChanged:function(e,t){this.$el.find(".nav[data-type=sidebar] li[data-view-id="+t+"]").siblings().removeClass("active").end().addClass("active")},_initializeIconUploader:function(){var e=r.App.config.currentApp.dimensional_code_pic_path,t=r.App.config.currentApp.android_qr_code_url,i=r.App.config.currentApp.startup_pic;e?(this.$el.find("[data-action=uploadbgCompanyIcon]>img").attr("src",e),this.$el.find("img[data-action=uploadCompanyIcon]").hide()):this.$el.find("img[data-action=uploadCompanyIcon]").show(),t?(this.$el.find("[data-action=androidUploadbgCompanyIcon]>img").attr("src",t),this.$el.find("img[data-action=androidUploadCompanyIcon]").hide()):this.$el.find("img[data-action=androidUploadCompanyIcon]").show(),i&&this.$el.find("img[data-action=uploadStartupImg]").attr({src:i}),new r.modules.common.ImageUploader({wrapperView:this,el:this.$el.find(".orig-qrcode img[data-action=uploadCompanyIcon]"),uploadUrl:r.api("/files"),onsuccess:n.bind(this._onAppIconUploaded,this)})},onAndroidShow:function(){this.$form=this.$el.find("#androidCompanyLogoForm"),this.$form.find("input[name=appId]").val(r.App.config.currentApp.id);if(r.App.config.currentApp.android_qr_code_url){var e=r.App.config.currentApp.android_qr_code_url;this.$form.find("[data-action=androidUploadbgCompanyIcon]>img").attr("src",e),this.$form.find("img[data-action=androidUploadCompanyIcon]").hide()}this.androidQrCodeChanged?this.$el.find("img[data-action=androidUploadCompanyIcon]").show():this.$el.find("img[data-action=androidUploadCompanyIcon]").hide()},onStartupImgShow:function(){this.$form=this.$el.find("#startupPicForm"),this.$form.find("input[name=appId]").val(r.App.config.currentApp.id),r.App.config.currentApp.startup_pic&&this.$el.find("img[data-action=uploadStartupImg]").attr({src:r.App.config.currentApp.startup_pic})},onQrShow:function(){this.$form=this.$el.find("#companyLogoForm"),this.$form.find("input[name=appId]").val(r.App.config.currentApp.id);if(r.App.config.currentApp.dimensional_code_pic_path){var e=r.App.config.currentApp.dimensional_code_pic_path;this.$form.find("[data-action=uploadbgCompanyIcon]>img").attr("src",e),this.$form.find("img[data-action=uploadCompanyIcon]").hide()}this.qrCodeChanged?this.$el.find("img[data-action=uploadCompanyIcon]").show():this.$el.find("img[data-action=uploadCompanyIcon]").hide()},_onAppIconUploaded:function(e,t){this.qrCodeChanged=!0,this.$form=this.$el.find("#companyLogoForm"),this.$el.find("img[data-action=uploadCompanyIcon]").show(),this.$form.find("input[name=companyLogo]").val(t.url)},_onAppStartupImg:function(e,t){this.$form=this.$el.find("#startupPicForm"),this.$form.find("input[name=startup_pic]").val(t.url)},_onAndroidAppIconUploaded:function(e,t){this.androidQrCodeChanged=!0,this.$form=this.$el.find("#androidCompanyLogoForm"),this.$el.find("img[data-action=androidUploadCompanyIcon]").show(),this.$form.find("input[name=companyLogo]").val(t.url)},_cancelQRCodeChange:function(e){e.preventDefault(),this.qrCodeChanged=!1,this.$el.find("img[data-action=uploadCompanyIcon]").hide()},_cancelAndroidQRCodeChange:function(e){e.preventDefault(),this.androidQrCodeChanged=!1,this.$el.find("img[data-action=androidUploadCompanyIcon]").hide()},_cancelStartupImg:function(e){e.preventDefault(),r.App.config.currentApp.startup_pic&&this.$el.find("img[data-action=uploadStartupImg]").attr({src:r.App.config.currentApp.startup_pic})},_sinaShare:function(){return this._getShareUrl("weibo")},_qqShare:function(){return this._getShareUrl("qq")},_isAppPublished:function(){return r.App.config.currentApp.publish_state=="PUBLISHED"},_qrCodeChange:function(t){t.preventDefault();if(this.qrCodeChanged){r.showProgressIndicator("更新二维码...");var n=this;e.post("/api/promotion/webapp_qrcode",{authenticityToken:r.App.config.authToken,appId:r.App.config.currentApp.id,companyLogo:this.$form.find("input[name=companyLogo]").val()}).done(function(e){e.code==200?(r.App.config.currentApp.dimensional_code_pic_path=e.message,n.qrCodeChanged=!1,n.onQrShow(),r.showMessage("SUCCESS","二维码更新成功",!0),r.closeProgressIndicator()):(r.closeProgressIndicator(),r.showMessage("ERROR","二维码更新失败",!0))})}},_uploadImgs:function(t){e(t.target).parents(".form-group").find(".thumbnail").trigger("click")},_startupImg:function(t){e(t.target).parents(".startupImg").find(".thumbnail").trigger("click")},_androidQrCodeChange:function(t){t.preventDefault();if(!this._isAppPublished()){r.showMessage("ERROR","微站还没有发布，该功能要微站发布后才能使用.",!0);return}if(this.androidQrCodeChanged){r.showProgressIndicator("更新二维码...");var n=this;e.post("/api/promotion/android_qrcode",{authenticityToken:r.App.config.authToken,appId:r.App.config.currentApp.id,companyLogo:this.$form.find("input[name=companyLogo]").val()}).done(function(e){e.code==200?(r.App.config.currentApp.android_qr_code_url=e.message,n.androidQrCodeChanged=!1,n.onAndroidShow(),r.showMessage("SUCCESS","android二维码更新成功",!0),r.closeProgressIndicator()):(r.closeProgressIndicator(),r.showMessage("ERROR","二维码更新失败",!0))})}},_saveStartupPic:function(t){t.preventDefault();var n=this;n.$form=this.$el.find("#startupPicForm"),r.showProgressIndicator("更新启动图片..."),n.$form.find("input[name=authenticityToken]").val(r.App.config.authToken),n.$form.find("input[name=appId]").val(r.App.config.currentApp.id),n.$form.find("input[name=name]").val(r.App.config.currentApp.name),e.post(r.api("/apps/"+r.App.config.currentApp.id+"/settings"),n.$form.serialize()).done(function(e){e.code==200&&(e.code==200?(r.App.config.currentApp.startup_pic=e.startup_pic,n.onStartupImgShow(),r.showMessage("SUCCESS","启动图片更新成功",!0),r.closeProgressIndicator()):(r.closeProgressIndicator(),r.showMessage("ERROR","启动图片更新失败",!0)))})},_dimensionalcode:function(t){t.preventDefault();var n=r.App.config.currentApp.dimensional_code_pic_path;e.post(r.api("/apps/"+r.App.config.currentApp.id+"/dimensional")).done(function(e){})},_onDomainBinded:function(e){r.App.config.currentApp.code=e.app_code,this.show()},_bindDomain:function(){new r.modules.cms.PublishDialog({appInfo:r.App.config.currentApp})}});var i=function(){var e=function(){return r.App.config.currentApp.app_code_update_count?'<button class="btn btn-xs zerocopy" data-clipboard-text="点击复制" title="点击复制">复制连接</button>':'<button class="btn btn-xs" data-action="bindDomain">绑定个性域名</button>'},t=function(){var e=r.App.config.hostDomain+"/apps/"+r.App.config.currentApp.id;return r.App.config.currentApp.code&&(e=r.App.config.hostDomain+"/apps/"+r.App.config.currentApp.code),'<a style="word-break: break-all" id="zerocopy-url" href="'+e+'" target="_blank">'+e+"</a>"};return'<div class="container-inner">					<div id="promotion">					    <div class="page-content promotion">					        <h3 class="blue pull-left">					            微站URL<br>					            '+t()+" "+e()+'					        </h3>					        <div class="clearfix">					        </div>					        <p>					            微站URL是指向微站的web地址，可用于微信公众账号菜单链接、微博、微信的分享等					        </p>					        <div class="bdshare_t bds_tools">					            <div class="pull-left">分享到:</div>					            <a class="bds_tsina sinaShare" title="分享到新浪微博" target="_blank" href="'+s("weibo")+'">					            </a>					            <a class="bds_qzone qqShare" title="分享到QQ空间" target="_blank" href="'+s("qq")+'">					            </a>					        </div>					        <div class="clearfix">					        </div>					        <hr>					        <h3 class="blue">					            微站二维码					        </h3>					        <p>					            微站二维码存放了掌卡所制作的微站的链接地址，通过扫描微站二维码可以直接在浏览器、微信、微博等应用中访问微站。					        </p>					        <form id="companyLogoForm">								<input type="hidden" name="appId"/>								<input type="hidden" name="companyLogo"/>						        <div class="form-group orig-qrcode col-sm-6 no-padding-left">						            <div data-action="uploadbgCompanyIcon" class="img">						            	<img src="'+o()+'" alt="" />						                <div class="widget-fgp-image">						                    <div class="imageUploader" style="background-image: url('+o()+');">						                    <img class="thumbnail" data-src="holder.js/50x50" data-action="uploadCompanyIcon"/>						                        <div class="img-handlers">						                            <i class="icon-remove bigger-120 hide" data-action="remove">						                            </i>						                        </div>						                    </div>						                </div>						            </div>						            <button type="button" class="btn btn-sm btn-xs" data-action="uploadCompanyIcon">						                上传图标						            </button>						            <div class="clearfix">						            </div>						            <div class="pull-right btns">						                <button id="cancelQrCodeChange" class="btn btn-xs" type="button">						                    <i class="icon-remove bigger-110">						                    </i>						                    取消						                </button>						                <button id="qrCodeChange" class="btn btn-success btn-xs" type="button">						                    <i class="icon-ok bigger-110">						                    </i>						                    确定						                </button>						            </div>						            <div class="clearfix">						            </div>						        </div>						        <div class="clearfix">					            </div>					        </form>					        <hr>					    </div>					</div>				</div>'},s=function(e){var t=r.App.config.currentApp,n=r.App.config.hostDomain+"/apps/"+t.id;r.App.config.currentApp.code&&(n=r.App.config.hostDomain+"/apps/"+t.code);var i={name:t.name,icon_url:t.icon_url,viewUrl:n},s;return e==="weibo"?s=r.util.getWeiboShareUrl("vSite",i):e==="qq"&&(s=r.util.getQQShareUrl("vSite",i)),s},o=function(){return r.App.config.currentApp.dimensional_code_pic_path},u=function(){var e=r.App.config.webApps.apps;if(!e)return"row hide";var t;for(var n=0;n<e.length;n++)e[n].id==r.App.config.currentApp.id&&(t=e[n]);return t.product_state!="undefined"&&t.product_state=="BOUGHT"?"row":"row hide"},a=function(){return r.App.config.currentApp.android_dim_code_pic_path}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.promotion.AppPromotionNew=r.common.BaseView.extend({events:{"click .btn[data-action=uploadCompanyIcon]":"_uploadImgs","click .btn[data-action=androidUploadCompanyIcon]":"_uploadImgs","click .btn[data-action=uploadStartupImg]":"_startupImg","click #cancelQrCodeChange":"_cancelQRCodeChange","click #cancelAndroidQrCodeChange":"_cancelAndroidQRCodeChange","click #cancelStartupImg":"_cancelStartupImg","click #qrCodeChange":"_qrCodeChange","click #androidQrCodeChange":"_androidQrCodeChange","click #saveStartupPic":"_saveStartupPic","click .nav[data-type=sidebar] li>a":"_navigate"},doInitialize:function(){this._appId=this.args.appId,this.$el.html(i()),this._initializeIconUploader()},onRemove:function(){this.off("viewChanged",this._onViewChanged)},isViewChangedWhenRecover:function(){return this._appId!=r.App.config.currentApp.id},_initZerocopy:function(){e("button.zerocopy").zclip("remove"),e("button.zerocopy").zclip({path:"/img/ZeroClipboard.swf",copy:this.$el.find("#zerocopy-url").text()})},_navigate:function(t){t.preventDefault();var n=e(t.target).parents("li");r.navigate(this._link(n.data().viewId))},_link:function(e){return"/builder/"+r.App.config.currentApp.id+"/promotion/"+e},_onViewChanged:function(e,t){this.$el.find(".nav[data-type=sidebar] li[data-view-id="+t+"]").siblings().removeClass("active").end().addClass("active")},_initializeIconUploader:function(){var e=r.App.config.currentApp.dimensional_code_pic_path,t=r.App.config.currentApp.android_dim_code_pic_path,i=r.App.config.currentApp.startup_pic;e?(this.$el.find("[data-action=uploadbgCompanyIcon]>img").attr("src",e),this.$el.find("img[data-action=uploadCompanyIcon]").hide()):this.$el.find("img[data-action=uploadCompanyIcon]").show(),t?(this.$el.find("[data-action=androidUploadbgCompanyIcon]>img").attr("src",t),this.$el.find("img[data-action=androidUploadCompanyIcon]").hide()):this.$el.find("img[data-action=androidUploadCompanyIcon]").show(),i&&this.$el.find("img[data-action=uploadStartupImg]").attr({src:i}),new r.modules.common.ImageUploader({wrapperView:this,el:this.$el.find(".orig-qrcode img[data-action=uploadCompanyIcon]"),uploadUrl:r.api("/files"),onsuccess:n.bind(this._onAppIconUploaded,this)})},onAndroidShow:function(){this.$form=this.$el.find("#androidCompanyLogoForm"),this.$form.find("input[name=appId]").val(r.App.config.currentApp.id);if(r.App.config.currentApp.android_qr_code_url){var e=r.App.config.currentApp.android_qr_code_url;this.$form.find("[data-action=androidUploadbgCompanyIcon]>img").attr("src",e),this.$form.find("img[data-action=androidUploadCompanyIcon]").hide()}this.androidQrCodeChanged?this.$el.find("img[data-action=androidUploadCompanyIcon]").show():this.$el.find("img[data-action=androidUploadCompanyIcon]").hide()},onStartupImgShow:function(){this.$form=this.$el.find("#startupPicForm"),this.$form.find("input[name=appId]").val(r.App.config.currentApp.id),r.App.config.currentApp.startup_pic&&this.$el.find("img[data-action=uploadStartupImg]").attr({src:r.App.config.currentApp.startup_pic})},onQrShow:function(){this.$form=this.$el.find("#companyLogoForm"),this.$form.find("input[name=appId]").val(r.App.config.currentApp.id);if(r.App.config.currentApp.dimensional_code_pic_path){var e=r.App.config.currentApp.dimensional_code_pic_path;this.$form.find("[data-action=uploadbgCompanyIcon]>img").attr("src",e),this.$form.find("img[data-action=uploadCompanyIcon]").hide()}this.qrCodeChanged?this.$el.find("img[data-action=uploadCompanyIcon]").show():this.$el.find("img[data-action=uploadCompanyIcon]").hide()},_onAppIconUploaded:function(e,t){this.qrCodeChanged=!0,this.$form=this.$el.find("#companyLogoForm"),this.$el.find("img[data-action=uploadCompanyIcon]").show(),this.$form.find("input[name=companyLogo]").val(t.url)},_onAppStartupImg:function(e,t){this.$form=this.$el.find("#startupPicForm"),this.$form.find("input[name=startup_pic]").val(t.url)},_onAndroidAppIconUploaded:function(e,t){this.androidQrCodeChanged=!0,this.$form=this.$el.find("#androidCompanyLogoForm"),this.$el.find("img[data-action=androidUploadCompanyIcon]").show(),this.$form.find("input[name=companyLogo]").val(t.url)},_cancelQRCodeChange:function(e){e.preventDefault(),this.qrCodeChanged=!1,this.$el.find("img[data-action=uploadCompanyIcon]").hide()},_cancelAndroidQRCodeChange:function(e){e.preventDefault(),this.androidQrCodeChanged=!1,this.$el.find("img[data-action=androidUploadCompanyIcon]").hide()},_cancelStartupImg:function(e){e.preventDefault(),r.App.config.currentApp.startup_pic&&this.$el.find("img[data-action=uploadStartupImg]").attr({src:r.App.config.currentApp.startup_pic})},_sinaShare:function(){return this._getShareUrl("weibo")},_qqShare:function(){return this._getShareUrl("qq")},_isAppPublished:function(){return r.App.config.currentApp.publish_state=="PUBLISHED"},_qrCodeChange:function(t){t.preventDefault();if(this.qrCodeChanged){r.showProgressIndicator("更新二维码...");var n=this;e.post("/api/promotion/webapp_qrcode",{authenticityToken:r.App.config.authToken,appId:r.App.config.currentApp.id,companyLogo:this.$form.find("input[name=companyLogo]").val()}).done(function(e){e.code==200?(r.App.config.currentApp.dimensional_code_pic_path=e.message,n.qrCodeChanged=!1,n.onQrShow(),r.showMessage("SUCCESS","二维码更新成功",!0),r.closeProgressIndicator()):(r.closeProgressIndicator(),r.showMessage("ERROR","二维码更新失败",!0))})}},_uploadImgs:function(t){e(t.target).parents(".form-group").find(".thumbnail").trigger("click")},_startupImg:function(t){e(t.target).parents(".startupImg").find(".thumbnail").trigger("click")},_androidQrCodeChange:function(t){t.preventDefault();if(!this._isAppPublished()){r.showMessage("ERROR","微站还没有发布，该功能要微站发布后才能使用.",!0);return}if(this.androidQrCodeChanged){r.showProgressIndicator("更新二维码...");var n=this;e.post("/api/promotion/android_qrcode",{authenticityToken:r.App.config.authToken,appId:r.App.config.currentApp.id,companyLogo:this.$form.find("input[name=companyLogo]").val()}).done(function(e){e.code==200?(r.App.config.currentApp.android_qr_code_url=e.message,n.androidQrCodeChanged=!1,n.onAndroidShow(),r.showMessage("SUCCESS","android二维码更新成功",!0),r.closeProgressIndicator()):(r.closeProgressIndicator(),r.showMessage("ERROR","二维码更新失败",!0))})}},_saveStartupPic:function(t){t.preventDefault();var n=this;n.$form=this.$el.find("#startupPicForm"),r.showProgressIndicator("更新启动图片..."),n.$form.find("input[name=authenticityToken]").val(r.App.config.authToken),n.$form.find("input[name=appId]").val(r.App.config.currentApp.id),n.$form.find("input[name=name]").val(r.App.config.currentApp.name),e.post(r.api("/apps/"+r.App.config.currentApp.id+"/settings"),n.$form.serialize()).done(function(e){e.code==200&&(e.code==200?(r.App.config.currentApp.startup_pic=e.startup_pic,n.onStartupImgShow(),r.showMessage("SUCCESS","启动图片更新成功",!0),r.closeProgressIndicator()):(r.closeProgressIndicator(),r.showMessage("ERROR","启动图片更新失败",!0)))})},_dimensionalcode:function(t){t.preventDefault();var n=r.App.config.currentApp.dimensional_code_pic_path;e.post(r.api("/apps/"+r.App.config.currentApp.id+"/dimensional")).done(function(e){})}});var i=function(){return'<h3 class="blue">					            微站二维码					        </h3>					        <p>					            微站二维码存放了掌卡所制作的微站的链接地址，通过扫描微站二维码可以直接在浏览器、微信、微博等应用中访问微站。					        </p>					        <form id="companyLogoForm">								<input type="hidden" name="appId"/>								<input type="hidden" name="companyLogo"/>						        <div class="form-group orig-qrcode col-sm-12 no-padding-left">						            <div data-action="uploadbgCompanyIcon" class="img">						            	<img src="'+u()+'" alt="" />						                <div class="widget-fgp-image">						                    <div class="imageUploader" style="background-image: url('+u()+');">						                    <img class="thumbnail" data-src="holder.js/50x50" data-action="uploadCompanyIcon"/>						                        <div class="img-handlers">						                            <i class="icon-remove bigger-120 hide" data-action="remove">						                            </i>						                        </div>						                    </div>						                </div>						            </div>						            <button type="button" class="btn btn-sm btn-xs" data-action="uploadCompanyIcon">						                上传图标						            </button>						            <div class="clearfix">						            </div>						            <div class="qrcodebtn btns">						                <button id="cancelQrCodeChange" class="btn btn-xs" type="button">						                    <i class="icon-remove bigger-110">						                    </i>						                    取消						                </button>						                <button id="qrCodeChange" class="btn btn-success btn-xs" type="button">						                    <i class="icon-ok bigger-110">						                    </i>						                    确定						                </button>						            </div>						            <div class="clearfix">						            </div>						        </div>						        <div class="clearfix">					            </div>					        </form>					        <hr>'},s=function(){var e=r.App.config.hostDomain+"/apps/"+r.App.config.currentApp.id;return r.App.config.currentApp.code&&(e=r.App.config.hostDomain+"/apps/"+r.App.config.currentApp.code),'<a style="word-break: break-all" id="zerocopy-url" href="'+e+'" target="_blank">'+e+"</a>"},o=function(e){var t=r.App.config.currentApp,n=r.App.config.hostDomain+"/apps/"+t.id;r.App.config.currentApp.code&&(n=r.App.config.hostDomain+"/apps/"+t.code);var i={name:t.name,icon_url:t.icon_url,viewUrl:n},s;return e==="weibo"?s=r.util.getWeiboShareUrl("vSite",i):e==="qq"&&(s=r.util.getQQShareUrl("vSite",i)),s},u=function(){return r.App.config.currentApp.dimensional_code_pic_path},a=function(){var e=r.App.config.webApps.apps;if(!e)return"row hide";var t;for(var n=0;n<e.length;n++)e[n].id==r.App.config.currentApp.id&&(t=e[n]);return t.product_state!="undefined"&&t.product_state=="BOUGHT"?"row":"row hide"},f=function(){return r.App.config.currentApp.android_dim_code_pic_path}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.event||(r.modules.event={})}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.event.EventModule=r.common.ViewStack.extend({events:{"click a.return-list":"_returnEventList"},doInitialize:function(){this.views={events:{clazz:r.modules.event.EventList,removable:!0},event:{clazz:r.modules.event.EventDetail,removable:!0}},this.$moduleContent=this.$el.html(i()).find(".page-content"),this.on("viewChanged",n.bind(this._onViewChanged,this))},show:function(e,t){if(!e){r.common.BaseView.prototype.show.apply(this,t);return}var i=t&&n.extend(t,{})||{};r.common.ViewStack.prototype.show.apply(this,[e].concat(i))},viewport:function(){return this._viewport||(this._viewport=this.$el.find(".event-content"))},isViewChangedWhenRecover:function(){return this.getLastFragment()!=t.history.getFragment()},onRemove:function(){this.off("viewChanged",this._onViewChanged)},_onViewChanged:function(e,t){t=="events"?this.$moduleContent.find(".return-list").addClass("hide"):t=="event"&&this.$moduleContent.find(".return-list").removeClass("hide")},_returnEventList:function(e){e.preventDefault(),r.navigate("/builder/"+r.App.config.currentApp.id+"/business/event/events")}});var i=function(){return'<div class="page-content">					<div class="page-header eventModuleHeader">						<h1>							<span class="headerName">活动管理</span>							<a href="#" class="btn btn-sm pull-right hide return-list">返回活动列表 </a>						</h1>					</div>					<div class="event-content"></div>			    </div>		'}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf"),i=require("moment");r.modules.event.EventList=r.common.BaseView.extend({events:{"click [data-action=viewEventDetail]":"_viewEventDetail","change select.event_sections":"_changeSection"},doInitialize:function(){this.$list=this.$el.html(o()).find(".contentListInner"),this.paginater=(new r.modules.common.Paginater({el:this.$el.find(".paginationWrapper")})).on("pageChanged",n.bind(this._onPageChanged,this))},onShow:function(e){this.$el.closest("div.page-content").removeClass("eventDetail").end().parents("#event").find("span.headerName").html("活动管理"),this._loadData(1)},onRemove:function(){this.paginater.off("pageChanged",this._onPageChanged)},_loadData:function(t){var i=this;r.showProgressIndicator("装载活动列表..."),e.get("/api/event/events",{appId:r.App.config.currentApp.id,psize:this.paginater.psize,pno:t}).done(function(e){i.$list.html(s(e.result.items)),i.paginater.setData({psize:e.result.psize,pno:e.result.pno,total_count:e.result.totalCount}),r.closeProgressIndicator()}).error(function(e){r.closeProgressIndicator(),r.showMessage("ERROR","订单活动装载出错.",!0)}),e.get("/api/sections/"+r.App.config.currentApp.id+"/EVENT").done(function(e){i._sections=e;var t=i.$el.find(".event_sections").find("option:not(.preserved)").remove().end();n.each(e,function(e){t.append(i._renderSectionOption(e))})}).error(function(e){r.showMessage("ERROR","活动栏目装载出错.",!0)})},_loadSectionData:function(t,i){var o=this;r.showProgressIndicator("装载活动列表..."),e.get("/api/event/events",{appId:r.App.config.currentApp.id,psize:this.paginater.psize,pno:i,sectionId:t}).done(function(e){o.$list.html(s(e.result.items)),o.paginater.setData({psize:e.result.psize,pno:e.result.pno,total_count:e.result.totalCount}),r.closeProgressIndicator()}).error(function(e){r.closeProgressIndicator(),r.showMessage("ERROR","订单活动装载出错.",!0)});var u=n.find(o._sections,function(e){return e.id==t}),a=o.$el.find(".event_sections");a.find(":selected").removeAttr("selected"),a.find("[value='"+t+"']").attr("selected","selected")},_renderSectionOption:function(e){return'<option value="'+e.id+'">'+e.name+"</option>"},_onPageChanged:function(e){this._loadData(e)},_viewEventDetail:function(t){return t.preventDefault(),r.navigate("/builder/"+r.App.config.currentApp.id+"/business/event/events/"+e(t.target).closest("[data-item-id]").data().itemId),!1},_changeSection:function(t){var n=e(t.target).val();n?this._loadSectionData(n,1):this._loadData(1)}});var s=function(e){var t="";return n.each(e,function(e){t+='<tr>				<td class="center">				<label>					<input type="checkbox" class="ace">					<span class="lbl"></span>				</label>			</td>			<td>				<a href="#" data-action="viewEventDetail" data-item-id="'+e.id+'">'+e.title+"</a>			</td>			<td>"+i(e.attributes.start_time).format("YYYY-MM-DD HH:mm")+"</td>			<td>"+i(e.attributes.end_time).format("YYYY-MM-DD HH:mm")+'</td>			<td>				<span class="label label-sm '+(e.attributes.applicable?"label-success":"")+'">'+(e.attributes.applicable?"是":"否")+'</span>			</td>			<td>				<span class="label label-sm '+(e.attributes.signin_apply?"label-success":"")+'">'+(e.attributes.signin_apply?"是":"否")+"</span>			</td>			<td>"+i(e.attributes.apply_start_time).format("YYYY-MM-DD HH:mm")+"</td>			<td>"+i(e.attributes.apply_end_time).format("YYYY-MM-DD HH:mm")+"</td>			<td>"+e.attributes.apply_count+"</td>		</tr>"}),t},o=function(){return'<div class="eventList">			<div class="table-header">				活动列表			</div>			<div class="table-responsive">				<div class="dataTables_wrapper">					<div class="row filter">						<label>							栏目 							<select class="event_sections">								<option class="preserved" value="" selected="selected">-----------</option>							</select>						</label>					</div>					<table class="table table-striped table-bordered table-hover dataTable">						<thead>							<tr>								<th class="center">									<label>										<input type="checkbox" class="ace">										<span class="lbl"></span>									</label>								</th>								<th>活动名称</th>								<th>开始时间</th>								<th>结束时间</th>								<th>允许报名</th>								<th>必须登录后报名</th>								<th>报名开始时间</th>								<th>报名结束时间</th>								<th>已报名人数</th>							</tr>						</thead>						<tbody class="contentListInner"></tbody>					</table>				</div>				<div class="paginationWrapper">				</div>			</div>		</div>'}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf"),i=require("moment");r.modules.event.EventDetail=r.common.BaseView.extend({doInitialize:function(){this.$el.html(s()),this.$detail=this.$el.find("div.event-detail").html(o()),this.$applications=this.$el.find("div.applications").html(u()),this.paginater=(new r.modules.common.Paginater({el:this.$el.find(".paginationWrapper")})).on("pageChanged",n.bind(this._onPageChanged,this))},onShow:function(e){this._eventId=e.eventId,this._loadEvent(e.eventId,1)},_loadEvent:function(t,n){var i=this;r.showProgressIndicator("装载活动详情..."),e.get("/api/event/event",{appId:r.App.config.currentApp.id,eventId:t,pno:n,psize:10}).done(function(e){i.event=e.result.event,i.applications=e.result.applications,i._render(),i.paginater.setData({psize:i.applications.pageSize,pno:i.applications.pageNo,total_count:i.applications.totalCount}),r.closeProgressIndicator()}).error(function(e){r.closeProgressIndicator(),r.showMessage("ERROR","装载活动详情出错.",!0)})},_render:function(){var e=this;this.$el.closest("div.page-content").addClass("eventDetail").end().parents("#event").find("span.headerName").html(this.event.title),this.$detail.find(".address").html(this.event.address),this.$detail.find(".start_time").html(i(this.event.startTime).format("YYYY-MM-DD HH:mm")),this.$detail.find(".end_time").html(i(this.event.endTime).format("YYYY-MM-DD HH:mm")),this.$detail.find(".applicable").html(this.event.applicable?"是":"否"),this.event.applicable&&this.$detail.find(".applicable").addClass("label-success"),this.event.applicable&&(this.$detail.find(".signin_apply").html(this.event.signinApply?"是":"否"),this.event.signinApply&&this.$detail.find(".signin_apply").addClass("label-success"),this.$detail.find(".apply_start_time").html(i(this.event.pplyStartTime).format("YYYY-MM-DD HH:mm")),this.$detail.find(".apply_end_time").html(i(this.event.applyEndTime).format("YYYY-MM-DD HH:mm")));var t=this.$el.find("span.apply-count");t.html(t.html().replace("0",e.applications.totalCount));var r=this.$applications.find(".application-list");r.html(""),n.each(e.applications.items,function(t){r.append(e._renderApplication(t))})},_renderApplication:function(e){return'<div class="message-item col-xs-12">				        <span class="col-md-2">'+e.name+'</span>				        <span class="col-md-2">'+e.phone+'</span>				        <span class="col-md-3">'+e.remark+'</span>				        <span class="col-md-3">'+i(e.applyTime).format("YYYY-MM-DD HH:mm")+'</span>				        <span class="col-md-2">'+(e.email||"")+"</span>					</div>"},_onPageChanged:function(e){this._loadEvent(this._eventId,e)}});var s=function(){return'<div class="row">	    <div class="col-md-12">	        <div class="widget-box">	        	<div class="widget-header widget-header-flat">					 <h4 class="lighter smaller">	                    <i class="icon icon-barcode">	                    </i>活动信息	                </h4>					<div class="widget-toolbar">					</div>				</div>	            <div class="widget-body event-detail">	            </div>	        </div>	     	<div class="widget-box transparent">			    <div class="widget-header">					<h4 class="lighter">        				报名统计<span class="label label-lg label-success arrowed-right apply-count">已报名：0人</span>					</h4>			    </div>			    <div class="widget-body applications">			    </div>			</div>	    </div>	</div></div>'},o=function(){return'<div class="widget-main padding-0">	        <table class="table table-bordered">			<tbody>				<tr>					<td>						开始时间					</td>					<td class="start_time"></td>					<td>						结束时间					</td>					<td class="end_time"></td>				</tr>				<tr>					<td>						地点					</td>					<td class="address" colspan = "3"></td>				</tr>				<tr>					<td>						允许报名					</td>					<td>						<span class="label label-sm applicable"></span>					</td>					<td>						必须登录后报名					</td>					<td>						<span class="label label-sm signin_apply"></span>					</td>				</tr>				<tr>					<td>						报名开始时间					</td>					<td class="apply_start_time" ></td>					<td>						报名结束时间					</td>					<td class="apply_end_time" ></td>				</tr>			</tbody>		</table>	</div>'},u=function(){return'<div class="message-container">		        <div class="message-navbar clearfix">		        <div class="message-bar">		            <span class="col-md-2">姓名</span>		            <span class="col-md-2">手机</span>		            <span class="col-md-3">备注</span>		            <span class="col-md-3">报名记录时间</span>					<span class="col-md-2">账号</span>		        </div>		    </div>		    <div class="message-list-container clearfix">		        <div class="message-list application-list"></div>		    </div>		    <div class="message-footer clearfix paginationWrapper"></div>		</div>'}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.appointment||(r.modules.appointment={})}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.appointment.AppointmentModule=r.common.ViewStack.extend({events:{"click a.return-list":"_returnAppointmentList"},doInitialize:function(){this.views={appointments:{clazz:r.modules.appointment.AppointmentList,removable:!0},appointment:{clazz:r.modules.appointment.AppointmentDetail,removable:!0}},this.$moduleContent=this.$el.html(i()).find(".page-content"),this.on("viewChanged",n.bind(this._onViewChanged,this))},show:function(e,t){if(!e){r.common.BaseView.prototype.show.apply(this,t);return}var i=t&&n.extend(t,{})||{};r.common.ViewStack.prototype.show.apply(this,[e].concat(i))},viewport:function(){return this._viewport||(this._viewport=this.$el.find(".appointment-content"))},isViewChangedWhenRecover:function(){return this.getLastFragment()!=t.history.getFragment()},onRemove:function(){this.off("viewChanged",this._onViewChanged)},_onViewChanged:function(e,t){t=="appointments"?this.$moduleContent.find(".return-list").addClass("hide"):t=="appointment"&&this.$moduleContent.find(".return-list").removeClass("hide")},_returnAppointmentList:function(e){e.preventDefault(),r.navigate("/builder/"+r.App.config.currentApp.id+"/business/appointment/appointments")}});var i=function(){return'<div class="page-content appointmentManage">					<div class="page-header eventModuleHeader">						<h1>							<span class="headerName">预约管理</span>							<a href="#" class="btn btn-sm pull-right hide return-list">返回预约列表 </a>						</h1>					</div>					<div class="appointment-content"></div>			    </div>		'}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf"),i=require("moment");r.modules.appointment.AppointmentList=r.common.BaseView.extend({events:{"click [data-action=viewAppointmentDetail]":"_viewAppointmentDetail"},doInitialize:function(){this.$list=this.$el.html(o()).find(".contentListInner"),this.paginater=(new r.modules.common.Paginater({el:this.$el.find(".paginationWrapper")})).on("pageChanged",n.bind(this._onPageChanged,this))},onShow:function(e){this.$el.closest("div.page-content").removeClass("eventDetail").end().parents("#appointment").find("span.headerName").html("预约管理"),this._loadData(1)},onRemove:function(){this.paginater.off("pageChanged",this._onPageChanged)},_loadData:function(t){var n=this;r.showProgressIndicator("装载预约列表..."),e.get("/api/appointment/appointments",{appId:r.App.config.currentApp.id,psize:this.paginater.psize,pno:t}).done(function(e){n.$list.html(s(e.result.items)),n.paginater.setData({psize:e.result.psize,pno:e.result.pno,total_count:e.result.totalCount}),r.closeProgressIndicator()}).error(function(e){r.closeProgressIndicator(),r.showMessage("ERROR","订单活动装载出错.",!0)})},_onPageChanged:function(e){this._loadData(e)},_viewAppointmentDetail:function(t){return t.preventDefault(),r.navigate("/builder/"+r.App.config.currentApp.id+"/business/appointment/appointments/"+e(t.target).closest("[data-item-id]").data().itemId),!1}});var s=function(e){var t="";return n.each(e,function(e){t+='<tr>				<td class="center">				<label>					<input type="checkbox" class="ace">					<span class="lbl"></span>				</label>			</td>			<td>				<a href="#" data-action="viewAppointmentDetail" data-item-id="'+e.id+'">'+e.title+'</a>			</td>			<td>				<span class="label label-sm '+(e.attributes.allow_phone_call?"label-success":"")+'">'+(e.attributes.allow_phone_call?"是":"否")+'</span>			</td>			<td>				<span class="label label-sm '+(e.attributes.allow_online?"label-success":"")+'">'+(e.attributes.allow_online?"是":"否")+'</span>			</td>			<td>				<span class="label label-sm '+(e.attributes.must_login?"label-success":"")+'">'+(e.attributes.must_login?"是":"否")+"</span>			</td>			<td>"+(e.attributes.phone||"")+"</td>			<td>"+e.attributes.apply_count+"</td>		</tr>"}),t},o=function(){return'<div class="eventList">			<div class="table-header">				预约列表			</div>			<div class="table-responsive">				<div class="dataTables_wrapper">					<table class="table table-striped table-bordered table-hover dataTable">						<thead>							<tr>								<th class="center">									<label>										<input type="checkbox" class="ace">										<span class="lbl"></span>									</label>								</th>								<th>预约名称</th>								<th>允许电话预约</th>								<th>允许在线预约</th>								<th>必须登录后预约</th>								<th>预约电话</th>								<th>已预约人数</th>							</tr>						</thead>						<tbody class="contentListInner"></tbody>					</table>				</div>				<div class="paginationWrapper">				</div>			</div>		</div>'}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf"),i=require("moment");r.modules.appointment.AppointmentDetail=r.common.BaseView.extend({events:{"click [data-action=confirmAppointment]":"_confirmAppointment"},doInitialize:function(){this.$el.html(s()),this.$detail=this.$el.find("div.appointment-detail").html(o()),this.$applications=this.$el.find("div.applications").html(u()),this.paginater=(new r.modules.common.Paginater({el:this.$el.find(".paginationWrapper")})).on("pageChanged",n.bind(this._onPageChanged,this))},onShow:function(e){this._appointmentId=e.appointmentId,this._loadAppointment(e.appointmentId,1)},_loadAppointment:function(t,n){var i=this;r.showProgressIndicator("装载活动详情..."),e.get("/api/appointment/appointment",{appId:r.App.config.currentApp.id,appointmentId:t,pno:n,psize:10}).done(function(e){i._appointment=e.result.appointment,i._applications=e.result.applications,i._render(),i.paginater.setData({psize:i._applications.pageSize,pno:i._applications.pageNo,total_count:i._applications.totalCount}),r.closeProgressIndicator()}).error(function(e){r.closeProgressIndicator(),r.showMessage("ERROR","装载活动详情出错.",!0)})},_render:function(){var e=this;this.$el.closest("div.page-content").addClass("eventDetail").end().parents("#appointment").find("span.headerName").html(this._appointment.title),this.$detail.find(".allow_phone_call").html(this._appointment.allowPhoneCall?"是":"否"),this._appointment.allowPhoneCall&&this.$detail.find(".allow_phone_call").addClass("label-success"),this.$detail.find(".allow_online").html(this._appointment.allowOnline?"是":"否"),this._appointment.allowOnline&&this.$detail.find(".allow_online").addClass("label-success"),this.$detail.find(".must_login").html(this._appointment.mustLogin?"是":"否"),this._appointment.mustLogin&&this.$detail.find(".must_login").addClass("label-success"),this._appointment.allowPhoneCall&&this.$detail.find(".phone").html(this._appointment.phone);var t=this.$el.find("span.apply-count");t.html(t.html().replace("0",e._applications.totalCount));var r=this.$applications.find(".application-list");r.html(""),n.each(e._applications.items,function(t){r.append(e._renderApplication(t))})},_confirmAppointment:function(t){var i=e(t.target).closest("button").attr("data-item-id"),s=n.find(this._applications.items,function(e){return e.id==i});new r.modules.cms.AppointmentConfirmDialog({application:s,applicationItemView:e(t.target).closest("tr")})},_renderApplication:function(e){var t=e.confirmTime?i(e.confirmTime).format("YYYY-MM-DD"):"";return'<tr>            <td class="center">            <label>                <input type="checkbox" class="ace">                <span class="lbl">                </span>            </label>        </td>        <td>'+e.name+"</td>        <td>"+e.phone+"</td>        <td>"+i(e.appointmentTime).format("YYYY-MM-DD")+"</td>        <td>"+(e.remark||"")+"</td>        <td>"+i(e.submitAppointmentTime).format("YYYY-MM-DD HH:mm")+'</td>        <td class="confirmRemark">'+(e.confirmRemark||"")+'</td>        <td class="confirmTime">'+t+'</td>        <td><span class="label label-sm '+(e.confirmTime?"label-success":"")+'">'+(e.confirmTime?"是":"否")+'</span></td>        <td>            <button type="button" class="btn btn-primary btn-xs" data-item-id="'+e.id+'" data-rel="tooltip" data-placement="top" data-original-title="确认" data-action="confirmAppointment" data-toggle="modal">				<i class="icon-pencil bigger-110"></i>			</button>        </td>    </tr>'},_onPageChanged:function(e){this._loadAppointment(this._appointmentId,e)}});var s=function(){return'<div class="row">	    <div class="col-md-12">	        <div class="widget-box">	        	<div class="widget-header widget-header-flat">					 <h4 class="lighter smaller">	                    <i class="icon icon-barcode">	                    </i>预约信息	                </h4>					<div class="widget-toolbar">					</div>				</div>	            <div class="widget-body appointment-detail">	            </div>	        </div>	     	<div class="widget-box transparent">			    <div class="widget-header">					<h4 class="lighter">		预约统计<span class="label label-lg label-success arrowed-right apply-count">已预约：0人</span>					</h4>			    </div>			    <div class="applications">			    </div>			</div>	    </div>	</div></div>'},o=function(){return'<div class="widget-main padding-0">	        <table class="table table-bordered">			<tbody>				<tr>					<td>允许电话预约</td>					<td><span class="label label-sm allow_phone_call"></span></td>					<td>预约电话</td>					<td class="phone"></td>				</tr>				<tr>					<td>允许在线预约</td>					<td><span class="label label-sm allow_online"></span></td>					<td>必须登录后预约</td>					<td><span class="label label-sm must_login"></span></td>				</tr>			</tbody>		</table>	</div>'},u=function(){return'<div class="table-responsive">        <div class="dataTables_wrapper">        <div class="appointmentTable">            <table class="table table-striped table-bordered table-hover dataTable">                <thead>                    <tr>                        <th class="center">                            <label>                                <input type="checkbox" class="ace">                                <span class="lbl">                                </span>                            </label>                        </th>                        <th class="name">姓名</th>                        <th class="phoneNum">电话</th>                        <th class="appointTime">预约时间</th>                        <th>预约内容</th>                        <th class="submitTime">预约提交时间</th>                        <th>确认信息</th>                        <th class="confirmTime">最终预约时间</th>						<th>预约确认状态</th>                        <th class="operation">操作</th>                    </tr>                </thead>                <tbody class="contentListInner application-list">                </tbody>            </table>        </div>        <div class="paginationWrapper">        </div>    </div></div>'}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf"),i=require("moment");r.modules.cms.AppointmentConfirmDialog=r.modules.common.Dialog.extend({events:{"click .close, .btn[data-action=cancel]":"close","click .btn[data-action=save]":"_confirm"},internalInitialize:function(t){this.$applicationItemView=t.applicationItemView,this._application=t.application,this.viewport().html(s(this._application));var n=this,r=this._application.confirmTime||this._application.appointmentTime;n.$el.find("input[name=confirmDate]").val(i(r).format("YYYY-MM-DD")),e(".date-picker").datepicker({autoclose:!0,language:"zh-CN"})},title:function(){return this.args.title||"确认预约"},onShow:function(e){var t=this.args.view||"typeList"},onClose:function(){},_confirm:function(){var t=this,s=t.$el.find("textarea[name=confirmRemark]").val(),o=t.$el.find("input[name=confirmDate]").val();e.post("/api/appointment/application",{applicationId:t._application.id,confirmDate:o,note:s}).done(function(e){t.$applicationItemView.find(".confirmTime").html(i(e.result.confirmTime).format("YYYY-MM-DD")),t.$applicationItemView.find(".confirmRemark").text(e.result.confirmRemark),t.$applicationItemView.find(".confirmAppointmentTime").html(i(e.result.confirmAppointmentTime).format("YYYY-MM-DD HH:mm")),r.showMessage("SUCCESS","确认预约成功.",!0),n.extend(t._application,e.result),t.close()}).error(function(e){r.showMessage("ERROR","确认预约出错.",!0),t.close()})}});var s=function(e){return'<div class="modal-body">		<form class="form-horizontal">		<div class="form-group">			<div class="table-header">预约信息</div>			<table class="table table-bordered table-striped">				<tbody>					<tr>						<td width="">姓名</td>						<td>'+e.name+"</td>					</tr>					<tr>						<td>预约时间</td>						<td>"+i(e.appointmentTime).format("YYYY-MM-DD")+"</td>					</tr>					<tr>						<td>预约内容</td>						<td>"+(e.remark||"")+'</td>					</tr>				</tbody>			</table>		</div>		<div class="form-group">		    <div class="table-header">确认信息</div>			<table class="table table-bordered table-striped">				<tbody>					<tr>						<td width="80">							确认时间						</td>						<td>							<div class="input-group input-group-sm">								<input type="text" name="confirmDate" readonly class="form-control hasDatepicker date-picker" data-date-format="yyyy-mm-dd">								<span class="input-group-addon datapicker_button">									<i class="icon-calendar bigger-110"></i>								</span>							</div>						</td>					</tr>					<tr>						<td>							确认内容						</td>						<td>							<textarea name="confirmRemark" class="form-control" rows="5">'+(e.confirmRemark||"")+'</textarea>						</td>					</tr>				</tbody>			</table>		</div>		</form>		</div>		<div class="modal-footer">			<button type="button" class="btn" data-action="cancel"><i class="icon-remove"></i> 取消</button>			<button type="submit" class="btn btn-primary" data-action="save"><i class="icon-ok icon-white"></i> 确定</button>		</div>'}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.business||(r.modules.business={}),r.modules.business.BusinessModule=r.common.ViewStack.extend({events:{"click .business-nav li>a":"_selectTab"},doInitialize:function(){this.views={store:r.modules.store.StoreModule,event:{clazz:r.modules.event.EventModule,removable:!0},appointment:{clazz:r.modules.appointment.AppointmentModule,removable:!0},members:{clazz:r.modules.AppMembers,removable:!0},scoreadmin:{clazz:r.modules.ScoreAndHandcoinAdmin,removable:!0},scoreconfig:{clazz:r.modules.ScoreAndHandcoinConfig,removable:!0}},this.$el.html(s()),this.on("viewChanged",n.bind(this._onViewChanged,this))},show:function(e,t){if(!e){r.common.BaseView.prototype.show.apply(this,t);return}var i=t&&n.extend(t,{})||{};r.common.ViewStack.prototype.show.apply(this,[e].concat(i))},viewport:function(){return this._viewport||(this._viewport=this.$el.find(".business-viewport"))},isViewChangedWhenRecover:function(){return this.getLastFragment()!=t.history.getFragment()},onRemove:function(){this.off("viewChanged",this._onViewChanged)},_selectTab:function(t){t.preventDefault();var n=e(t.target).closest("a").attr("href").replace(r.App.config.root,"");r.navigate(n)},_onViewChanged:function(e,t){this.$el.find('.business-nav li[data-view-id="'+t+'"]').addClass("active").siblings().removeClass("active")}});var i=function(e){return r.App.config.root+"/builder/"+r.App.config.currentApp.id+"/business/"+e},s=function(){return'<div class="main-container-inner business">		    <div>		        <ul class="nav business-nav" data-type="sidebar">		            <li data-view-id="members"><a href="'+i("members")+'"><i class="icon-group"></i>会员管理</a></li>		            <li data-view-id="event"><a href="'+i("event")+'"><i class="icon-volume-down"></i>活动管理</a></li>		            <li data-view-id="appointment"><a href="'+i("appointment")+'"><i class="icon-time"></i>预约管理</a></li>		            <li data-view-id="store"><a href="'+i("store")+'"><i class="icon-shopping-cart"></i>商城管理</a></li>		            <li data-view-id="scoreadmin"><a href="'+i("scoreadmin")+'"><i class="icon-gift"></i>积分/掌币管理</a></li>		        </ul>		    </div>			<div class="business-viewport"></>		</div>'}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf"),i=require("moment");r.modules.ScoreAndHandcoinAdmin=r.common.BaseView.extend({events:{"click a.configScore":"_configScore","click button.search":"_searchMembers","click input.selectall":"_selectAllMember","click a[data-action=score-records]":"_showScoreRecords","click a[data-action=handcoin-records]":"_showHandcoinRecords","click a[data-action=score-exchange]":"_exchangeScore","click a[data-action=score-giving]":"_giveScore","click a[data-action=audit-handcoin]":"_auditHandcoin","click button.multiExchange":"_multiExchangeScore","click button.multiGiving":"_multiGiveScore"},show:function(t){var n=this;n.$el.html(r.tpl.render("template-webapp-bussiness-score-member-admin")),n.$dataPage=n.$el.find("div.scoreAdminDataPage"),n.$modalScoreExchange=e("#modal-score-exchange"),n.$modalScoreMultiExchange=e("#modal-score-multi-exchange"),n.$modalScoreGiving=e("#modal-score-giving"),n.$modalScoreMultiGiving=e("#modal-score-multi-giving"),n.$modalAuditHandcoin=e("#modal-score-audit-handcoin"),e.get("/api/apps/"+r.App.config.currentApp.id+"/score/scoreadmin",function(e){e.code===200?(r.App.config.currentApp.appConfig=e.result.appConfig,n.currentAppMembers=e.result.appMembers,n.unauditHandcoinExchangeCount=e.result.unauditHandcoinExchangeCount,n._setScoreRuleConfiged(r.App.config.currentApp.appConfig),n.$dataPage.html(r.tpl.render("template-webapp-bussiness-score-member-admin-data",e.result)),n.$el.find("div.ruleTip").toggle(!r.App.config.currentApp.appConfig.isScoreRuleConfiged),n._configPaginater(e.result.appMembers)):r.showMessage("ERROR","获取app信息出错",!0)})},_configScore:function(e){e.preventDefault(),r.navigate("/builder/"+r.App.config.currentApp.id+"/business/scoreconfig")},_adjustLetZeroInput:function(t){var n=e(t.target).val();!e.isNumeric(n)||n<0||n>1e4?e(t.target).val(0):e(t.target).val(Number(n))},_showScoreRecords:function(t){t.preventDefault();var n=e(t.target).closest("tr").data("member-id"),i=e("#modal-score-records").find("tbody.contentListInner");i.html(""),e("#modal-score-records").modal(),e.get("/api/apps/"+r.App.config.currentApp.id+"/score/"+n+"/records").done(function(t){var n="";e.each(t.result,function(e,t){n+="<tr><td>"+t.acquireTime+"</td><td>"+t.reason+"</td><td>"+t.amount+"</td></tr>"}),i.html(n)}).error(function(e){r.showMessage("ERROR","数据装载失败, 你可能遭遇了网络问题.",!0)})},_showHandcoinRecords:function(t){t.preventDefault();var n=e(t.target).closest("tr").data("member-id"),i=e("#modal-handcoin-records").find("tbody.contentListInner");i.html(""),e("#modal-handcoin-records").modal(),e.get("/api/apps/"+r.App.config.currentApp.id+"/handcoin/"+n+"/records").done(function(t){var n="";e.each(t.result,function(e,t){n+="<tr><td>"+t.acquireTime+"</td><td>"+t.reason+"</td><td>"+t.amount+"</td></tr>"}),i.html(n)}).error(function(e){r.showMessage("ERROR","数据装载失败, 你可能遭遇了网络问题.",!0)})},_exchangeScore:function(t){t.preventDefault();var i=this,s=e(t.target).closest("tr").data("member-id");this.currentMemberId=s;var o=n.find(this.currentAppMembers.items,function(e){return e.id==s}),u=this.$modalScoreExchange,a=u.find("div.modal-body");a.html(r.tpl.render("template-modal-score-exchange-form",{appConfig:r.App.config.currentApp.appConfig,appMember:o})),a.find("input.scoreExchangeInput").bind("keyup",e.proxy(this._onScoreExchangeInputChanged,this)),u.modal("show"),u.find("button.scoreExchange").enable().off("click").click(function(t){u.find("button.scoreExchange").disable(),t.preventDefault();var n=Number(u.find("input.scoreExchangeInput").val()),o=Number(u.find("span.userScore").html());if(n>o){r.showMessage("ERROR","兑换积分不能大于用户可用积分.",!0),u.find("button.scoreExchange").enable();return}e.post("/api/apps/"+r.App.config.currentApp.id+"/score/update ",{appMemberId:s,score:-n}).done(function(e){e.code=="200"?(u.modal("hide"),i._onPageChanged()):r.showMessage("ERROR",e.message,!0)}).error(function(e){r.showMessage("ERROR","提交失败, 你可能遭遇了网络问题.",!0)})})},_multiExchangeScore:function(t){var n=this;if(e("input.checkMember:checked").length<1){r.showMessage("ERROR","请选择要兑现的账号.",!0);return}var i=this.$modalScoreMultiExchange,s=i.find("div.modal-body");s.html(r.tpl.render("template-modal-score-multi-exchange-form",{appConfig:r.App.config.currentApp.appConfig})),s.find("input.scoreExchangeInput").bind("keyup",e.proxy(this._onScoreExchangeInputChanged,this)),i.modal(),i.find("button.multiScoreExchange").enable().off("click").click(function(t){i.find("button.multiScoreExchange").disable(),t.preventDefault();var s=e(t.target).closest("form").find("input.scoreExchangeInput").val(),o=n.$el.find("input.checkMember:checked").attrAll("data-member-id");e.post("/api/apps/"+r.App.config.currentApp.id+"/score/multiupdate",{appMemberIds:o,score:-s}).done(function(e){i.modal("hide"),n._onPageChanged()}).error(function(e){r.showMessage("ERROR","提交失败, 你可能遭遇了网络问题.",!0)})})},_giveScore:function(t){t.preventDefault();var n=this,i=e(t.target).closest("td").data("member-id"),s=this.$modalScoreGiving;s.data("member-id",i),s.modal("show"),s.find("input.scoreGivingInput").bind("keyup",e.proxy(this._adjustLetZeroInput,this)),s.find("button.scoreGiving").enable().off("click").click(function(t){s.find("button.scoreGiving").disable(),t.preventDefault();var o=e(t.target).closest("form").find("input.scoreGivingInput").val();e.post("/api/apps/"+r.App.config.currentApp.id+"/score/update ",{appMemberId:i,score:o}).done(function(e){s.modal("hide"),n._onPageChanged()}).error(function(e){r.showMessage("ERROR","提交失败, 你可能遭遇了网络问题.",!0)})})},_multiGiveScore:function(t){var n=this;if(e("input.checkMember:checked").length<1){r.showMessage("ERROR","请选择要兑现的账号.",!0);return}var i=this.$modalScoreMultiGiving;i.modal("show"),i.find("input.scoreGivingInput").bind("keyup",e.proxy(this._adjustLetZeroInput,this)),i.find("button.multiScoreGiving").enable().off("click").click(function(t){i.find("button.multiScoreGiving").disable(),t.preventDefault();var s=i.find("input.scoreGivingInput").val(),o=n.$el.find("input.checkMember:checked").attrAll("data-member-id");e.post("/api/apps/"+r.App.config.currentApp.id+"/score/multiupdate",{appMemberIds:o,score:s}).done(function(e){i.modal("hide"),n._onPageChanged()}).error(function(e){r.showMessage("ERROR","提交失败, 你可能遭遇了网络问题.",!0)})})},_auditHandcoin:function(t){var n=this,i=e(t.target).closest("td").data("member-id"),s=this.$modalAuditHandcoin,o=s.find("tbody.contentListInner");o.html("");var u=e.get("/api/apps/"+r.App.config.currentApp.id+"/handcoin/exchange/unhandle").done(function(t){o.html(r.tpl.render("template-webapp-bussiness-score-unaudit-handcoins",{requests:t.result,appConfig:r.App.config.currentApp.appConfig})),s.modal("show"),s.find("a.handleHandcoin").enable().click(function(t){s.find("button.multiScoreGiving").disable().unbind("click"),t.preventDefault();var i=e(t.target).val()==="approve",o=e(t.target).closest("td").data("request-id");e.post("/api/apps/"+r.App.config.currentApp.id+"/handcoin/unhandle",{requestId:o,accept:i}).done(function(e){s.modal("hide"),i&&n.show()}).error(function(e){r.showMessage("ERROR","提交失败, 你可能遭遇了网络问题.",!0)})})}).error(function(e){r.showMessage("ERROR","数据装载失败, 你可能遭遇了网络问题.",!0)})},_onScoreExchangeInputChanged:function(t){this._adjustLetZeroInput(t);var n=e(t.target).closest("div.form-group").find("span.caculated"),i=e(t.target).val(),s=r.App.config.currentApp.appConfig;i>=0?n.html((i/s.scoreExchangeScore*s.scoreExchangeRMB).toFixed(2)):n.html("0")},_setScoreRuleConfiged:function(e){e.isScoreRuleConfiged=e.enableRegistGiveScore||e.enableShareWebsiteGiveScore||e.enableInviteFansGiveScore||e.enableBuyProductGiveHandcoin},_configPaginater:function(e){this.paginater=(new r.modules.common.Paginater({el:this.$dataPage.find(".paginationWrapper")})).on("pageChanged",n.bind(this._onPageChanged,this)),this.paginater.setData({psize:e.pageSize,pno:e.pageNo,total_count:e.totalCount})},_selectAllMember:function(t){var n=e(t.target).prop("checked");this.$el.find(".contentListInner input[type=checkbox]").prop("checked",n)},_searchMembers:function(e){e.preventDefault(),this._onPageChanged()},_onPageChanged:function(t){t?this.currentPageNo=t:t=this.currentPageNo?this.currentPageNo:1;var n=this,i=this.$el.find("input.keyword").val();r.showProgressIndicator("装载用户列表..."),e.get("/api/store/appmembers",{appId:r.App.config.currentApp.id,psize:this.paginater.psize,pno:t,keyword:i}).done(function(e){r.closeProgressIndicator(),n.currentAppMembers=e.result,n.$dataPage.html(r.tpl.render("template-webapp-bussiness-score-member-admin-data",{appMembers:e.result,appConfig:r.App.config.currentApp.appConfig,unauditHandcoinExchangeCount:n.unauditHandcoinExchangeCount,keyword:i})),n._configPaginater(e.result)}).error(function(e){r.closeProgressIndicator(),r.showMessage("ERROR","用户列表装载失败, 你可能遭遇了网络问题.",!0)})}})}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf"),i=require("moment");r.modules.ScoreAndHandcoinConfig=r.common.BaseView.extend({events:{"change input":"_onInputChanged","click button[data-action=cancelConfig]":"_cancelConfig","input input.ltZero":"_adjustLetZeroInput","input input.ltOne":"_adjustLetOneInput","input input.percent":"_adjustPercent","click input[name=enableOfflineScoreExchange]":"_toggleAdminCodeInput","click input[name=enableBuyProductGiveHandcoin]":"_toggleGetHandcoinConfigInput","click input[name=enableScoreUsage]":"_toggleEnableScoreUsageConfig","click input[name=enableHandcoinUsage]":"_toggleEnableHandcoinUsageConfig","click button[data-action=saveConfig]":"_saveConfig"},show:function(t){var n=this;r.App.config.currentApp.appConfig?this._renderForm(this,r.App.config.currentApp.appConfig):e.get("/api/apps/"+r.App.config.currentApp.id+"/config",function(e){e.code===200?(r.App.config.currentApp.appConfig=e.result,n._renderForm(n,r.App.config.currentApp.appConfig)):r.showMessage("ERROR","获取app配置出错",!0)})},_renderForm:function(e,t){e.$el.html(r.tpl.render("template-webapp-bussiness-score-config",t)),e.$form=e.$el.find("form")},isChanged:function(){return this._lastModifiedDt},_onInputChanged:function(e){this._lastModifiedDt=(new Date).getTime(),this.$el.find("button[data-action=saveConfig]").enable()},_adjustLetZeroInput:function(t){var n=e(t.target).val();!e.isNumeric(n)||n<0||n>1e4?e(t.target).val(0):e(t.target).val(Number(n))},_adjustLetOneInput:function(t){var n=e(t.target).val();!e.isNumeric(n)||n<1||n>1e4?e(t.target).val(1):e(t.target).val(Number(n))},_adjustPercent:function(t){var n=e(t.target).val().replace("%","");if(!e.isNumeric(n)||n<1||n>100)n=1;e(t.target).val(Number(n)+"%"),this._onInputChanged(t)},_cancelConfig:function(e){e.preventDefault(),r.navigate("/builder/"+r.App.config.currentApp.id+"/business/scoreadmin")},_toggleAdminCodeInput:function(e){this.$el.find("[name='adminCode']").closest("tr").toggle("normal")},_toggleGetHandcoinConfigInput:function(e){this.$el.find("[name='buyProductGiveHandcoinScale']").closest("tr").toggle("normal")},_toggleEnableScoreUsageConfig:function(e){this.$el.find(".enableScoreUsageConfigTb").toggle("normal")},_toggleEnableHandcoinUsageConfig:function(e){this.$el.find("[name=handcoinExchangeHandcoin]").closest("tr").toggle("normal")},_saveConfig:function(t){t.preventDefault();var n=this.$form,i=this,s={enableRegistGiveScore:n.find("[name='enableRegistGiveScore']")[0].checked,enableShareWebsiteGiveScore:n.find("[name='enableShareWebsiteGiveScore']")[0].checked,enableInviteFansGiveScore:n.find("[name='enableInviteFansGiveScore']")[0].checked,enableScoreUsage:n.find("[name='enableScoreUsage']")[0].checked,enableOfflineScoreExchange:n.find("[name='enableOfflineScoreExchange']")[0].checked,adminCode:n.find("[name='adminCode']").val(),buyProductMaxScoreScale:n.find("[name='buyProductMaxScoreScale']").val().replace("%",""),scoreExchangeScore:n.find("[name='scoreExchangeScore']").val(),scoreExchangeRMB:n.find("[name='scoreExchangeRMB']").val(),registGiveScore:n.find("[name='registGiveScore']").val(),shareWebsiteGiveScore:n.find("[name='shareWebsiteGiveScore']").val(),inviteFansGiveScore:n.find("[name='inviteFansGiveScore']").val(),enableBuyProductGiveHandcoin:n.find("[name='enableBuyProductGiveHandcoin']")[0].checked,enableHandcoinUsage:n.find("[name='enableHandcoinUsage']")[0].checked,handcoinExchangeHandcoin:n.find("[name='handcoinExchangeHandcoin']").val(),handcoinExchangeRMB:n.find("[name='handcoinExchangeRMB']").val(),buyProductGiveHandcoinScale:n.find("[name='buyProductGiveHandcoinScale']").val().replace("%","")};e.ajax({url:"/api/apps/"+r.App.config.currentApp.id+"/config",type:"PUT",contentType:"application/json;charset=utf-8",data:JSON.stringify(s)}).done(function(e){e.code==200?(i._lastModifiedDt=null,r.showMessage("SUCCESS","设置保存成功!",!0),r.navigate("/builder/"+r.App.config.currentApp.id+"/business/scoreadmin")):r.showMessage("ERROR","设置保存失败.请联系管理员",!0)})}})}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.AppBuilderModule=r.common.ViewStack.extend({doInitialize:function(){this._appId=this.args.appId,this._currentApp=this.args.currentApp,r.App.config.prefs[this._appId]||(r.App.config.prefs[this._appId]={}),this.views={cms:r.modules.cms.CMSModule,settings:{clazz:r.modules.AppSettings,removable:!0},promotion:{clazz:r.modules.promotion.AppPromotion,removable:!0},business:{clazz:r.modules.business.BusinessModule,removable:!0}},this._viewsWithoutPreviewer={promotion:!0,business:!0},this.$el.html(i()),this._navbar=new r.modules.AppBuilderNavbar({currentApp:this._currentApp,el:this.$el.find("#wrap-navbarOfConsole")}),this._previewer=new r.modules.AppPreviewer({el:this.$el.find(".monitor"),lazyLoad:!0}),this.on("viewChanged",n.bind(this._onViewChanged,this)),e("body").tooltip({selector:"[data-rel=tooltip]"})},viewport:function(){return this._viewport||(this._viewport=this.$el.find(".container-inner")),this._viewport},show:function(n){if(this._loaded){var i=[n];arguments.length<=1||(i=i.concat(arguments[1])),r.common.ViewStack.prototype.show.apply(this,i);return}r.showProgressIndicator("装载App信息...");var s=this,o=arguments;if(r.App.config.currentApp){this._loaded=!0;var i=[n];o.length<=1||(i=i.concat(o[1])),r.common.ViewStack.prototype.show.apply(this,i),t.Events.trigger("appInitialized"),r.closeProgressIndicator();return}e.get(r.api("/apps/"+this._appId)).done(function(e){s._loaded=!0,r.App.config.currentApp=e.app,console.log(r.App.config.currentApp);var i=[n];o.length<=1||(i=i.concat(o[1])),r.common.ViewStack.prototype.show.apply(s,i),t.Events.trigger("appInitialized"),r.closeProgressIndicator()}).error(function(e){r.closeProgressIndicator(),e.status==403?r.showMessage("ERROR","你要访问的这个微站不是你创建的，你没有权限访问哦."):r.showMessage("ERROR","微站信息加载出错, 可能是网速问题，请稍后再试",!0)})},onRemove:function(){this.off("viewChanged",this._onViewChanged),this._navbar.remove(),this._previewer.remove()},isViewChangedWhenRecover:function(){return this._appId!=r.App.config.currentApp.id},_onViewChanged:function(e,n){this._viewsWithoutPreviewer[n]?this._previewer.hide():this._previewer.recover(),t.Events.trigger("appBuilder.moduleChanged",n)}});var i=function(){return'<div id="wrap-navbarOfConsole"></div>			<div class="main-container container">				<div class="monitor"></div>				<div class="container-inner"></div>			</div>'}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.AppBuilderNavbar=r.common.BaseView.extend({events:{"click #cms":"_navigate","click #business":"_promotionNavigate","click #promotion":"_promotionNavigate","click #releaseApp":"_releaseApp","click #returnToAppsPage":"_returnToAppsPage"},doInitialize:function(s){var o=this;jQuery("body").addClass("body_console"),this._currentApp=s.currentApp||{},this.$el.html(i(this._currentApp)),this.$el.find("#releaseApp").show(),this._currentApp&&this._currentApp.id&&e.post(r.api("/apps/active/"+this._currentApp.id),{authenticityToken:r.App.config.authToken}),t.Events.on("appInitialized",n.bind(this._onAppInitialized,this)),t.Events.on("appBuilder.moduleChanged",n.bind(this._onModuleChanged,this)),t.Events.on("app.settings.updated",n.bind(this._onAppSettingsUpdated,this)),t.Events.on("app.settings.cache",n.bind(this._onCache,this)),t.Events.on("app.settings.published",n.bind(this._published,this)),t.Events.on("app.settings.currApp",n.bind(this._currApp,this))},onRemove:function(){t.Events.off("appInitialized",this._onAppInitialized),t.Events.off("appBuilder.moduleChanged",this._onModuleChanged),t.Events.off("app.settings.updated",this._onAppSettingsUpdated),t.Events.off("app.settings.cache",this._onCache)},_onCache:function(e){this._appCache=e},_published:function(e){var t=e;t.publish_state=="PUBLISHED"&&this.$el.find("#releaseApp").hide()},_currApp:function(e){e&&e.icon_url&&this._setLogoBgImg(e)},_navigate:function(t){t.preventDefault();var n=e(t.target).closest("a").attr("href").replace(r.App.config.root,"");r.App.config.currentApp.publish_state=="UNPUBLISHED"&&this.$el.find("#releaseApp").show(),r.navigate(n)},_promotionNavigate:function(t){t.preventDefault();var n=e(t.target).closest("a").attr("href").replace(r.App.config.root,"");r.App.config.currentApp.publish_state=="UNPUBLISHED"&&this.$el.find("#releaseApp").show(),r.navigate(n)},_returnToAppsPage:function(e){e.preventDefault(),jQuery("body").removeClass("body_console"),t.Events.trigger("app.settings.publish",this._currentApp),r.navigate("/")},_onAppInitialized:function(){var t=this;this._setAppName(r.App.config.currentApp),this.$el.find(".nav li>a").each(function(){var n=e(this);if(n.data().action){var i=r.App.config.root+"/builder/"+r.App.config.currentApp.id+"/"+n.data().action;n.attr({href:i}),t._setLogoBgImg(r.App.config.currentApp)}})},_setAppName:function(e){var t=r.util.strCut(e.name,16);this.$el.find(".navbar-brand .name").text(t)},_setLogoBgImg:function(e){e||this.$('[data-action="logoIcon"]').css(r.cssBgImgStyle(e.icon_url,"obj"))},_releaseApp:function(e){e.preventDefault(),new r.modules.cms.PublishDialog},_onModuleChanged:function(e){this.$el.find(".nav li>a[data-action="+e+"]").parent().siblings().removeClass("active").end().addClass("active")},_onAppSettingsUpdated:function(e){this.$el.find(".navbar-header .name").html(e.name)}});var i=function(e){return'<div id="wrap-topNavOfConsole"><div class="navbar navbar-fixed-top topNavOfConsole">				<div class="navbar-container container" id="navbar-container">				<div class="navbar-header pull-left">				    <a href="#" class="navbar-brand">				    <span data-action="logoIcon" class="logo" style="'+r.cssBgImgStyle(e.icon_url)+'"></span>					<span class="name"></span>				    </a>				    <!-- /.brand -->				</div>				<!-- /.navbar-header -->				<div class="navbar-header pull-left appSettingMenu" id="appSettingMenu">				    <ul class="nav ace-nav">				        <li class="active">				            <a href="#" id="cms" data-action="cms">				                内容				            </a>				        </li>				        <li>				            <a href="#" id="business" data-action="business">				                业务				            </a>				        </li>				        <li>				            <a href="#" id="promotion" data-action="promotion">				                推广				            </a>				        </li>				    </ul>				    <!-- /.ace-nav -->				</div>				<!-- /.navbar-header -->				<div id="navbarPublishedStatus" class="navbar-header pull-right">				    <a href="#console" id="returnToAppsPage" class="btn btn-primary btn-sm" style="margin-left:10px;">				        <i class="icon-reply bigger-120"></i>				        微站列表				    </a>				</div>				</div>				</div>			</div>'},s=function(e){return e!=undefined&&e.publish_state=="UNPUBLISHED"?'<a href="" id="releaseApp" class="btn btn-warning btn-sm">	        <i class="icon-check bigger-120"></i>	        发布	    </a>':""}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf"),i=require("moment");r.modules.AppMembers=r.common.BaseView.extend({events:{"click a.[data-action=show-fans-detail]":"_showFansDetail"},doInitialize:function(e){this.$list=this.$el.html(u()).find(".contentListInner"),this.paginater=(new r.modules.common.Paginater({el:this.$el.find(".paginationWrapper")})).on("pageChanged",n.bind(this._onPageChanged,this))},onShow:function(e){this._loadData(1)},_loadData:function(t){var n=this;r.showProgressIndicator("装载用户列表..."),e.get("/api/store/appmembers",{appId:r.App.config.currentApp.id,psize:this.paginater.psize,pno:t}).done(function(e){r.closeProgressIndicator(),n.$list.html(s(e.result.items)),n.paginater.setData({psize:e.result.pageSize,pno:e.result.pageNo,total_count:e.result.totalCount})}).error(function(e){r.closeProgressIndicator(),r.showMessage("ERROR","用户列表装载失败, 你可能遭遇了网络问题.",!0)})},_onPageChanged:function(e){this._loadData(e)},_showFansDetail:function(t){var i=e(t.target).closest("tr").data("member-id");e.get("/api/apps/"+r.App.config.currentApp.id+"/fans/"+i,function(t){if(t.code===200){var i=e("#modal-member-fans").find("tbody.contentListInner"),s="";n.each(t.result,function(e){s+="<tr><td>"+e.telephone+"</td></tr>"}),i.html(s),e("#modal-member-fans").modal()}else r.showMessage("ERROR","获取app信息出错",!0)})}});var s=function(e){var t="";return n.each(e,function(e){t+="<tr data-member-id="+e.id+'>				<td class="center">					<label>						<input type="checkbox" class="ace">						<span class="lbl"></span>					</label>				</td>				<td>'+e.userName+'</td>				<td width="100" class="ctl-td">'+e.introMemberCount+'<div class="linkInTd"><a href="#" data-action="show-fans-detail">查看</a></div></td>				<td>'+i(e.createDate).format("YYYY-MM-DD HH:mm:ss")+"</td>				<td>"+o(e.state)+"</td>			</tr>"}),t},o=function(e){if(e=="ENABLE")return"可用";if(e=="DISABLED")return"禁用";if(e=="DELETE")return"删除"},u=function(){return'<div class="main-container-inner">		<div class="page-content">		<div class="page-header">			<h1>				会员管理			</h1>		</div>		<div class="table-header">			会员列表		</div>		<div class="table-responsive">			<div class="dataTables_wrapper">				<div class="contentList">					<table class="table table-striped table-bordered table-hover dataTable">						<thead>							<tr>								<th class="center">									<label>										<input type="checkbox" class="ace">										<span class="lbl"></span>									</label>								</th>								<th>账号</th>								<th>粉丝</th>									<th>创建日期</th>								<th>状态</th>							</tr>						</thead>						<tbody class="contentListInner"></tbody>					</table>				</div>				<div class="paginationWrapper">				</div>			</div>		</div>		</div></div>'}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.AppPreviewer=r.common.BaseView.extend({doInitialize:function(r){this.messageSendBuffer={ready:[]},this.deviceType=this.args.deviceType||"PHONE",this.$el.html(i()),this.$frame=this.$el.find("iframe"),r.lazyLoad||this.$frame.attr({src:this._url()}),t.Events.on("appInitialized",this._onAppInitialized=n.bind(this._onAppInitialized,this)),t.Events.on("app.nav.home",this._onNavHome=n.bind(this._onNavHome,this)),t.Events.on("app.nav.section",this._onNavSection=n.bind(this._onNavSection,this)),t.Events.on("app.settingsChanged",this._onAppSettingsChanged=n.bind(this._onAppSettingsChanged,this)),t.Events.on("app.homeTemplateChanged",this._onHomeTemplateChanged=n.bind(this._onHomeTemplateChanged,this)),t.Events.on("app.sectionSettingsChanged",this._onSectionSettingsChanged=n.bind(this._onSectionSettingsChanged,this)),t.Events.on("app.sectionTemplatesChanged",this._onSectionTemplateChanged=n.bind(this._onSectionTemplateChanged,this)),t.Events.on("app.itemContentChagned",this._onItemContentChanged=n.bind(this._onItemContentChanged,this)),t.Events.on("app.template.attributeChanged",this._onTemplateAttributeChanged=n.bind(this._onTemplateAttributeChanged,this)),t.Events.on("app.sectionFocusChanged",n.bind(this._onSectionFocusChanged,this)),e(window).bind("message",this.onPreviewerLoaded=n.bind(this._onPreviewerLoaded,this)),this.throttle={}},onRemove:function(){t.Events.off("appInitialized",this._onAppInitialized),t.Events.off("app.nav.home",this._onNavHome),t.Events.off("app.nav.section",this._onNavSection),t.Events.off("app.settingsChanged",this._onAppSettingsChanged),t.Events.off("app.homeTemplateChanged",this._onHomeTemplateChanged),t.Events.off("app.sectionSettingsChanged",this._onSectionSettingsChanged),t.Events.off("app.sectionTemplatesChanged",this._onSectionTemplateChanged),t.Events.off("app.itemContentChagned",this._onItemContentChanged),t.Events.off("app.template.attributeChanged",this._onTemplateAttributeChanged),e(window).unbind("message",this.onWindowMessage)},hide:function(){this._viewState="HIDDEN",this.$el.addClass("hide"),this.onHide()},refresh:function(e){this._viewState="REFRESH",this.$el.removeClass("hide"),this.onRefresh(e)},recover:function(){this._viewState="RECOVERRED",this.$el.removeClass("hide"),this._lastBackboneFragment=t.history.getFragment(),this.onRecover()},_onAppInitialized:function(){this.$frame.attr({src:this._url()}),this.isDebugPreviewer=window.location.search&&window.location.search.indexOf("debugPreviewer")>=0,this.isDebugPreviewer&&e("#navbar-container").find(".navbar-header ul").append('<li class="li-debugPreviewer"><a target="_blank" href="'+this._debugUrl()+'">debugPreviewer</a></li>')},_onAppSettingsChanged:function(e){this._sendMessage("setAppInfo",e)},_onHomeTemplateChanged:function(e){this._sendMessage("setAppLayout",e)},_onSectionSettingsChanged:function(e){this._sendMessage("setSectionsInfo",e)},_onSectionTemplateChanged:function(e){this._sendMessage("setSectionsLayout",e)},_onItemContentChanged:function(e){this._sendMessage("setItemInfo",e)},_onTemplateAttributeChanged:function(e){this._sendMessage("setCompAttr",e)},_onNavHome:function(e){if(!this._testThrottle("navHome",500))return;this._sendMessage("goToHome",e)},_onNavSection:function(e){if(!this._testThrottle("navSection",500))return;this._sendMessage("goToSection",e)},_onSectionFocusChanged:function(e){this._sendMessage("setSectionFocusInfo",e)},_testThrottle:function(e,t){console.debug("===try "+e),t=t||500;var n=this.throttle.navHome||0,r=Date.now();return r-n<=500?!1:(this.throttle.navHome=r,!0)},_url:function(e){var t="/console/preview?env=preview&terminalType="+this.deviceType+"&appId="+r.App.config.currentApp.id+"&securityKey="+encodeURIComponent(r.App.config.currentApp.security_key);return this.args.noStartupFocus&&(t+="&noStartupFocus"),this.args.setSectionsInfo&&(t+="&setSectionsInfo=true"),e&&(e.terminalType=="PHONE"&&e.phoneLayout?t+="&phoneLayout="+e.phoneLayout:e.padLayout&&(t+="&padLayout="+e.padLayout)),t+"&"+r.App.config.buildNumber},_debugUrl:function(){var e="/front/dev/testcase/index.html?env=localMac&mode=preview";return e=e+"&appId="+r.App.config.currentApp.id+"&securityKey="+encodeURIComponent(r.App.config.currentApp.security_key),e},_sendMessage:function(e,t){var n={method:e,param:t};if(!this.previewerLoaded){this.messageSendBuffer.ready.push(n);return}console.debug("======sendMessage=====",n),this.$frame[0].contentWindow.postMessage(JSON.stringify(n),"*"),this.isDebugPreviewer&&this.debugPreviewer&&this.debugPreviewer.postMessage(JSON.stringify(n),"*")},_onPreviewerLoaded:function(e){console.debug("===========receive message",e);var n=this,r=e.originalEvent&&e.originalEvent.data||{};typeof r=="object"||(r=JSON.parse(r));if(r.method=="onReady"){this.previewerLoaded=!0,this.$el.find(".progressIndicator").remove();var i;while(i=this.messageSendBuffer.ready.shift())n._sendMessage(i.method,i.param);t.Events.trigger("previewer.loaded")}this.isDebugPreviewer&&r.method=="onDebugReady"&&(this.debugPreviewer=e.originalEvent.source)},_onAppStyleChanged:function(){}}),r.modules.AppPreviewer.navHome=function(){t.Events.trigger("app.nav.home")},r.modules.AppPreviewer.navSection=function(e){t.Events.trigger("app.nav.section",e)},r.modules.AppPreviewer.appSettingsChanged=function(e){t.Events.trigger("app.settingsChanged",e)},r.modules.AppPreviewer.homeTemplateChanged=function(e){t.Events.trigger("app.homeTemplateChanged",e)},r.modules.AppPreviewer.sectionSettingsChanged=function(e){t.Events.trigger("app.sectionSettingsChanged",e)},r.modules.AppPreviewer.sectionTemplatesChanged=function(e){t.Events.trigger("app.sectionTemplatesChanged",e)},r.modules.AppPreviewer.itemContentChanged=function(e){t.Events.trigger("app.itemContentChagned",e)},r.modules.AppPreviewer.templateAttributeChanged=function(e){console.log("<templateAttributes>",e),t.Events.trigger("app.template.attributeChanged",e)},r.modules.AppPreviewer.sectionFocusChanged=function(e){t.Events.trigger("app.sectionFocusChanged",e)};var i=function(){return'<div class="showMonitor">			<div class="btn btn-app btn-xs btn-warning ace-settings-btn">				<i class="icon-double-angle-left" data-icon1="icon-double-angle-left" data-icon2="icon-double-angle-right"></i>			</div>		</div>		<div class="progressIndicator">			<img src="'+r.assetLink("/img/loader.gif")+'"/>		</div>		<iframe frameborder="0" src=""></iframe>'}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.MainModule=r.common.ViewStack.extend({doInitialize:function(e){this.views={builder:{clazz:r.modules.AppBuilderModule,removable:!0},appList:{clazz:r.modules.AppModule,removable:!1}}},isViewChangedWhenRecover:function(){return!1}});var i=r.common.AppRouter.extend({routes:{"":"appList","userSetting/:appId":"userSetting","builder/:appId":"appBuilder","builder/:appId/cms":"appBuilder","builder/:appId/cms/welcome":"cmsWelcome","builder/:appId/cms/home(/:anchor)":"cmsHome","builder/:appId/cms/:sectionId/content(/:anchor)":"sectionContent","builder/:appId/cms/:sectionId/settings(/:anchor)":"sectionSettings","builder/:appId/cms/:sectionId/layoutSettings":"layoutSettings","builder/:appId/cms/:sectionId/new":"createOrUpdateItem","builder/:appId/cms/:sectionId/:itemId":"createOrUpdateItem","builder/:appId/settings":"appSettings","builder/:appId/business":"businessHome","builder/:appId/business/members":"listMembers","builder/:appId/business/store":"orderList","builder/:appId/business/store/orders":"orderList","builder/:appId/business/store/orders/:orderId":"order","builder/:appId/business/store/paymentConfigs":"paymentConfigs","builder/:appId/business/store/paymentConfigs/new":"createOrUpdatePaymentConfig","builder/:appId/business/store/paymentConfigs/:paymentConfigId":"createOrUpdatePaymentConfig","builder/:appId/business/event":"eventList","builder/:appId/business/event/events":"eventList","builder/:appId/business/event/events/:eventId":"eventDetail","builder/:appId/business/appointment":"appointmentList","builder/:appId/business/appointment/appointments":"appointmentList","builder/:appId/business/appointment/appointments/:appointmentId":"appointmentDetail","builder/:appId/business/scoreadmin":"scoreadmin","builder/:appId/business/scoreconfig":"scoreconfig","builder/:appId/promotion":"promotion","builder/:appId/cms/layout":"cmsLayout"},doInitialize:function(){this._workspace=new r.modules.MainModule({el:e("<div/>").appendTo("#modulePages")})},contentView:function(){return this._workspace.currentView()},appBuilder:function(t){var n=this;e.get(r.api("/apps/"+t)).done(function(e){n._currentApp=e.app,r.App.config.currentApp=e.app,n.checkUnsavedChanges(function(){n._workspace.show("builder.cms",{appId:t,currentApp:n._currentApp})})}).error(function(e){})},cmsHome:function(t,n){var i=this;if(r.App.config.currentApp){this._currentApp=r.App.config.currentApp,this.checkUnsavedChanges(function(){i._workspace.show("builder.cms.cmsHome",{appId:t,currentApp:i._currentApp,anchor:n})});return}e.get(r.api("/apps/"+t)).done(function(e){i._currentApp=e.app,r.App.config.currentApp=e.app,i.checkUnsavedChanges(function(){i._workspace.show("builder.cms.cmsHome",{appId:t,currentApp:i._currentApp,anchor:n})})}).error(function(e){})},cmsLayout:function(e){var t=this;this.checkUnsavedChanges(function(){t._workspace.show("builder.cms.cmsLayout",{appId:e})})},cmsWelcome:function(e){var t=this;this.checkUnsavedChanges(function(){t._workspace.show("builder.cms.welcome",{appId:e})})},sectionContent:function(e,t,n){var r=this;this.checkUnsavedChanges(function(){r._workspace.show("builder.cms.section.admin.content",{appId:e,sectionId:t,anchor:n})})},sectionSettings:function(e,t,n){var r=this;this.checkUnsavedChanges(function(){r._workspace.show("builder.cms.section.admin.settings",{appId:e,sectionId:t,anchor:n})})},layoutSettings:function(e,t){var n=this;this.checkUnsavedChanges(function(){n._workspace.show("builder.cms.section.layout",{appId:e,sectionId:t})})},createOrUpdateItem:function(e,t,n){n||(n="new");var r=this;this.checkUnsavedChanges(function(){r._workspace.show("builder.cms.section.edit",{appId:e,sectionId:t,itemId:n})})},listMembers:function(e){var t=this;this.checkUnsavedChanges(function(){t._workspace.show("builder.business.members",{appId:e})})},scoreadmin:function(e){var t=this;this.checkUnsavedChanges(function(){t._workspace.show("builder.business.scoreadmin",{appId:e})})},scoreconfig:function(e){var t=this;this.checkUnsavedChanges(function(){t._workspace.show("builder.business.scoreconfig",{appId:e})})},appSettings:function(e){var t=this;this.checkUnsavedChanges(function(){t._workspace.show("builder.settings",{appId:e})})},businessHome:function(e){var t=this;this.checkUnsavedChanges(function(){t._workspace.show("builder.business.members",{appId:e})})},orderList:function(e){var t=this;this.checkUnsavedChanges(function(){t._workspace.show("builder.business.store.orders",{appId:e})})},order:function(e,t){var n=this;this.checkUnsavedChanges(function(){n._workspace.show("builder.business.store.order",{appId:e,orderId:t})})},paymentConfigs:function(e){var t=this;this.checkUnsavedChanges(function(){t._workspace.show("builder.business.store.paymentConfigs",{appId:e})})},createOrUpdatePaymentConfig:function(e,t){t||(t="new");var n=this;this.checkUnsavedChanges(function(){n._workspace.show("builder.business.store.paymentConfig",{appId:e,paymentConfigId:t})})},promotion:function(e){var t=this;this.checkUnsavedChanges(function(){t._workspace.show("builder.promotion",{appId:e})})},eventList:function(e){var t=this;this.checkUnsavedChanges(function(){t._workspace.show("builder.business.event.events",{appId:e})})},eventDetail:function(e,t){var n=this;this.checkUnsavedChanges(function(){n._workspace.show("builder.business.event.event",{appId:e,eventId:t})})},appointmentList:function(e){var t=this;this.checkUnsavedChanges(function(){t._workspace.show("builder.business.appointment.appointments",{appId:e})})},appointmentDetail:function(e,t){var n=this;this.checkUnsavedChanges(function(){n._workspace.show("builder.business.appointment.appointment",{appId:e,appointmentId:t})})},appList:function(){var e=this;this.checkUnsavedChanges(function(){e._workspace.show("appList.appList")})},userSetting:function(){var e=this;this.checkUnsavedChanges(function(){e._workspace.show("appList.accountSetting")})}});r.modules.ConsoleLauncher=function(){},n.extend(r.modules.ConsoleLauncher.prototype,r.common.Launcher.prototype,{internalInitialize:function(){this._router=new i;var e=this;r.App.currentView=function(){return e._router.contentView()}}})}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.app||(r.modules.app={})}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.AppModule=r.common.ViewStack.extend({doInitialize:function(){this.views={accountSetting:{clazz:r.modules.user.AccountSetting,removable:!0},appList:{clazz:r.modules.app.AppList,removable:!1}},this.$el.html(i()),this._navbar=new r.modules.AppNavbar({el:this.$el.find(".navbar")})},viewport:function(){return this._viewport||(this._viewport=this.$el.find(".main-container-inner")),this._viewport},onRemove:function(){this._navbar.remove()},isViewChangedWhenRecover:function(){return this.getLastFragment()!=t.history.getFragment()}});var i=function(){return'<div class="main-container container">						<div class="main-container-inner">						</div>					</div>				<div id="creatApp" class="modal"><!-- 创建应用modal -->				</div>				<div id="wrap-feedback" >			        <a href="#" class="feedbackBtn btn btn-xs btn-inverse" data-toggle="modal" data-action="wrap-feedback">				    <i class="icon-list-alt bigger-110"></i>我要反馈				    </a>			        <div data-action="feedbackView"> </div>				</div>'}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.AppNavbar=r.common.BaseView.extend({events:{"click .navbar-container a[data-toggle=dropdown]":"_setting","click .navbar-container a[data-toggle=accountSetting]":"_accountSetting","click .navbar-container a[data-toggle=powerOff]":"_powerOff"},doInitialize:function(e){this.$el.html(i())},_setting:function(t){t.preventDefault();var n=this.$el.find("ul[data-action=accountSetting]");n.toggle(),n.data().popup||(n.data({popup:!0}),r.doJob(function(){e(document).on("click.navbar.popup",function(){n.hide(),e(document).off("click.navbar.popup"),n.removeData("popup")})}))},_accountSetting:function(e){e.preventDefault();var t=this.$el.find("ul[data-action=accountSetting]");t.hide();var n="/userSetting/"+r.App.config.websiteOwner.id;r.navigate(n)},_powerOff:function(){window.location="/logout"}});var i=function(){return""}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.app||(r.modules.app={})}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf"),i=r.common.BaseView.extend({events:{submit:"_saveCreateApp","click .btn[data-action=uploadAppImg]":"_uploadAppImg","click .btn[data-action=ok]":"_saveCreateApp","keyup input":"_onKeyup","click .btn[data-action=cancel]":"_cancel"},doInitialize:function(e){var t=this;t._app=e.app,t._cacheAppName=e.appName,this.$form=this.$el.html(s(e.app,e.appName)).find("form"),this._changeName=e.changeName,this._initImageUploaders(),this._homeTemplateConfigurator=new r.modules.cms.TemplateConfigurator({el:this.$form.find(".template-slider[data-type=HOME]"),templates:this._findHomeNavTemplates(),selectedTemplateId:this._app.templateId}),t._cacheApp=t._app},onShow:function(){this.$form.find('input[name="entityApp.name"]').focus()},_uploadAppImg:function(t){t.preventDefault(),e(t.target).closest("#appForm").find("img[data-action=uploadAppImg]").trigger("click")},_initImageUploaders:function(){this._app&&this.$form.find("img[data-action=uploadAppImg]").attr({src:this._app.appImg}),new r.modules.common.ImageUploader({wrapperView:this,el:this.$form.find("img[data-action=uploadAppImg]"),uploadUrl:r.api("/files"),onsuccess:n.bind(this._onAppImgUploaded,this)})},_cancelImageUploaders:function(){this._cacheApp.appImg&&this.$form.find("img[data-action=uploadAppImg]").attr({src:this._cacheApp.appImg}),new r.modules.common.ImageUploader({wrapperView:this,el:this.$form.find("img[data-action=uploadAppImg]"),uploadUrl:r.api("/files"),onsuccess:n.bind(this._onAppImgUploaded,this)})},_onAppImgUploaded:function(e,t){this.$el.find("#appImgUrl").val(t.url)},_findHomeNavTemplates:function(){return n.find(r.App.config.sectionTypes,function(e){return e.code=="HOME"}).templates},_cancel:function(e){e.preventDefault(),this.$form=this.$el.html(s(this._cacheApp,this._cacheAppName)).find("form"),this._cancelImageUploaders(),this._homeTemplateConfigurator=new r.modules.cms.TemplateConfigurator({el:this.$form.find(".template-slider[data-type=HOME]"),templates:this._findHomeNavTemplates(),selectedTemplateId:this._cacheApp.templateId}),t.Events.trigger("appClose",{action:"close"}),r.navigate("/")},_onKeyup:function(t){t.preventDefault();var n=this;e.post(r.api("/apps/queryName"),this.$form.serialize()).done(function(e){if(e.code!=200){n._flag=!0,n._errorMsg=e.message,r.showMessage("ERROR",n._errorMsg,!0);return}n._flag=!1,r.closeProgressIndicator()}).error(function(e){})},_saveCreateApp:function(n){var i=this.$el.find("button[data-action=ok]");i.disable(),n.preventDefault();if(this.checkIsUploading())return!1;var s=this;if(s._flag){r.showMessage("ERROR",s._errorMsg,!0);return}var o=this._changeName,u=e("#appId").val(),a=this._homeTemplateConfigurator.getSelectedTemplate().id;this.$form.find("input[name=homeTemplateId]").val(a);var f=e("#appImgUrl").val();f==undefined&&e("#appImgUrl").val(""),u==undefined||u==""?r.showProgressIndicator("微站创建中..."):r.showProgressIndicator("编辑基本信息..."),e.post(r.api("/apps/save"),this.$form.serialize()).done(function(n){i.enable();if(n.code==400){t.Events.trigger("appClose",{action:"close"}),r.showMessage("ERROR",n.message,!0);return}if(n.code==500){t.Events.trigger("appClose",{action:"close"}),r.showMessage("ERROR",n.message,!0);return}if(n.code==425){t.Events.trigger("appClose",{action:"close"}),r.showMessage("ERROR","请购买微站后,系统才允许创建新微站!",!0);return}if(n.code==424){t.Events.trigger("appClose",{action:"close"}),r.showMessage("ERROR","已经达到可以创建的微站数，请先购买我们的产品。",!0);return}if(!u){t.Events.trigger("app.saved",n.app),r.navigate("/builder/"+n.app.id);var f=setTimeout(function(){t.Events.trigger("appClose",{action:"close"}),clearTimeout(f)},500)}else o(e("#name").val(),n.app.app_img,a,e("input:radio:checked").val()),s._cacheApp.appImg=n.app.app_img,s._cacheApp.appName=e("#name").val(),s._cacheApp.templateId=a,t.Events.trigger("appClose",{action:"close"});r.closeProgressIndicator()}).error(function(e){i.enable()})}});r.modules.app.CreateApp=r.modules.common.Dialog.extend({internalInitialize:function(r){var s=r.changeName,o=e('<div class="section-creation-dialog-inner"/>').appendTo(this.viewport());this._saveCreateApp=new i({app:r.app,appName:r.appName,allowComment:r.allowComment,el:o,changeName:s}),t.Events.on("appClose",n.bind(this._onCommand,this))},title:function(){return this.args.app.appId==undefined?"创建微站":"编辑基本信息"},onShow:function(e){var t=this.args.view||"typeList";this._saveCreateApp.show(t)},_onCommand:function(e){(e.action="close")&&this.close()},onClose:function(){t.Events.off("appClose",this._onCommand)}});var s=function(e,t){return'<div class="modal-content">                    <div class="modal-body">                        <form class="form-horizontal" id="appForm">                             <input type="hidden" id="appId" name="entityApp.id" value="'+o(e)+'"/>                             <input type="hidden" id="appImgUrl" name="entityApp.appImg" value="'+u(e)+'"/>                             <input type="hidden" name="homeTemplateId"/>                            <div class="form-group">                                <label class="control-label col-sm-3 no-padding-right">                             	微站名称                                </label>                                <div class="col-sm-9">                                    <div class="clearfix">                                    <input type="text" name="entityApp.name" id="name" value="'+a(t)+'" placeholder="微站名称" class="col-xs-12 col-sm-6">                                    </div>                                    <div id="errorName" class="errorInfo hide">微站名称错误</div>                                </div>                            </div>                            <div class="form-group">                                <label class="control-label col-sm-3 no-padding-right">                                    	微站图标                                </label>                                <div class="col-sm-9">                                    <div class="widget-fgp-image" style="width:180px;">                                        <div class="imageUploader pull-left" style="width:100px">                                        	<img data-src="holder.js/100x100/text:最大尺寸200x200" data-action="uploadAppImg" alt="最大尺寸200x200">                                        </div>                                        <div class="pull-right">                                            <button type="button" class="btn btn-xs btn-default" data-action="uploadAppImg">                                                <i class="icon-arrow-up bigger-125">                                                </i>                                                    	上传                                            </button>                                        </div>                                       <div class="clearfix">                                    </div>                                    </div>                                    （用于App生成和链接分享）                                </div>                            </div>                            <div class="form-group">                                <label class="control-label col-sm-3 no-padding-right">                                    		首页版式                                </label>                                <div class="col-sm-12">                                <div class="carousel slide col-sm-12 template-slider" data-type="HOME"></div>                                <div class="clearfix"></div>                                <div data-type="homeAttrsConfigurator"></div>                            </div>                        </form>                    </div>                    </div>                    <div class="modal-footer">                        <button type="button" class="btn btn-cancel" data-action="cancel">                            <i class="icon-remove bigger-110">                            </i>                            取消                        </button>                            <button id="saveApp" class="btn btn-primary" data-action="ok">确定                            <i class="icon-ok"></i>                        </button>                    </div>                </div>'},o=function(e){return e==undefined||e==""?"":e.appId==undefined||e.appId==""?"":e.appId},u=function(e){return e==undefined||e==""?"":e.appImg==undefined||e.appImg==""?"":e.appImg},a=function(e){return e==undefined||e==""?"":e}}(),function(){"use strict";var e=require("backbone"),t=require("jQuery"),n=require("underscore"),r=require("yf");r.modules.app.AccountInfoSidebar=r.common.BaseView.extend({doInitialize:function(t){this.$el.html(s()),e.Events.on("freshAccountInfo",n.bind(this._onCommand,this))},_onCommand:function(e){if(e!=undefined){var n=this,i=e;t.get(r.api("/webApp")).done(function(e){}).error(function(e){r.closeProgressIndicator()})}}});var i=function(e){return e!=undefined?e:"公司名称"},s=function(){return'	  	<div class="accountInfo">			<div id="appPermission" class="appPermission">			</div>			<div id="builtAppCount" class="appPermission">	     	</div>			<div class="qrCodeSlider">				<div class="slideBack"><i class="icon-double-angle-left"></i></div>				<div class="appName">					<div class="appIcon" style="background-image: url();"></div>					春晓微商城				</div>				<div class="code" style="background-image:url()">					<span>原生app</span>				</div>				<div class="code" style="background-image:url()">					<span>webapp</span>				</div>			</div>		</div>'},o=function(e){if(e=="NEW")return"未审核";if(e=="AUDITING")return"审核中";if(e=="APPROVED")return"通过";if(e=="NOT_APPROVED")return"未通过"}}(),function(){"use strict";var e=require("backbone"),t=require("jQuery"),n=require("underscore"),r=require("yf");r.modules.app.AppInfoSidebar=r.common.BaseView.extend({events:{"click .slideBack":"close"},doInitialize:function(t){this.$el.html(i(t.app,t.qrcode,t.preview,t.url)),Mousetrap.bind("esc",this.close=n.bind(this.close,this)),e.Events.on("app.settings.freshQrCode",n.bind(this._freshQrCode,this)),this.show()},onShow:function(){var e=this;r.doJob(function(){e.$el.find(".qrCodeSlider").addClass("show")},100)},close:function(){this.$el.find(".qrCodeSlider").removeClass("show");var e=this;r.doJob(function(){e.remove()},100)},getAppId:function(){return this.args.app.id},onHide:function(){},onRecover:function(){},onRemove:function(){Mousetrap.unbind("esc",this.close)},_freshQrCode:function(e){var n=e,i=this;n!=undefined&&t.get(r.api("/apps/"+n.id)).done(function(e){i.$el.find("[data-action=appName]").html(e.app.name),i._appName=e.app.name,t("#dimensionalCodePicPath").css({backgroundImage:"url("+e.app.dimensional_code_pic_path+")"}),t("#androidDimCodePicPath").css({backgroundImage:"url("+e.app.android_qr_code_url+")"})}).error(function(e){e.status==403?r.showMessage("ERROR","你要访问的这个App不是你创建的，你没有权限访问哦.",!0):r.showMessage("ERROR","应用信息加载出错, 可能是网速问题，请稍后再试",!0)})}});var i=function(e,t,n,i){return'<div class="qrCodeSlider">				<div class="slideBack"><i class="icon-double-angle-left"></i></div>				<div data-action="appName" class="appName">					<div class="appIcon" style="background-image: url("");"></div>					'+e.name+'				</div>				<div class="codes" '+s(t)+'>					<div id="dimensionalCodePicPath" class="code">						<img src="'+r.assetLink(e.dimensional_code_pic_path)+'" alt="微站二维码">						<span>'+(e.dimensional_code_pic_path==undefined?"":"微站二维码")+'</span>					</div>				</div>				<div class="previewer" '+u(n)+'>				<div class="previewerInner">					<iframe frameborder="0" src="'+(i==undefined?"":i)+'"></iframe>				</div>			</div>			</div>'},s=function(e){return e!="qrcode"?'style="display: none;"':""},o=function(e,t){return e||(e=t),e!=undefined?'<div id="androidDimCodePicPath" class="code">			<img src="'+r.assetLink(e)+'" alt="Android客户端二维码">			<span>Android客户端二维码</span>		</div>':""},u=function(e){return e!="preview"?'style="display: none;"':""},a=function(e){var t="";return n.each(e,function(e){t+=f(e)}),t+='<div class="appItem addApp">				<div>					<i class="icon-plus"></i>					<span>创建新微站</span>				</div>			</div>',t},f=function(e){return'<div class="appItem">		<div class="appName"><a href="builder.html">'+e.name+'</a></div>		<div class="appIcon">			<div class="empty">				<div>					<i class="icon-camera"></i>				</div>			</div>		</div>		<div class="appControl">			<a href="#" data-rel="tooltip" data-original-title="二维码" data-action="qrcode">				<i class="icon-qrcode"></i>			</a>			<a href="#" data-rel="tooltip" data-original-title="预览">				<i class="icon-eye-open"></i>			</a>			<a href="builder.html" data-rel="tooltip" data-original-title="配置微站">				<i class="icon-pencil"></i>			</a>		</div>		<label>			<input name="switch-field-1" class="ace ace-switch ace-switch-6" type="checkbox">			<span class="lbl"></span>		</label>	</div>'}}(),function(){"use strict";var e=require("backbone"),t=require("jQuery"),n=require("underscore"),r=require("yf"),i=require("moment");r.modules.app.AppList=r.common.BaseView.extend({events:{"click .iconCol button[data-action=qrcode]":"_showQRCode","click .appControl a[data-action=editApp]":"_editApp","click .appControl a[data-action=previewApp]":"_previewApp","click .appItems a[data-action=createApp]":"_createApp","click #createApp":"_createApp","click .appItem .appIcon":"_contentApp","click .appItem[data-app-id]":"_appContentShow","click .appItem .infoCol":"_showQRCode","click .appItem input[data-action=toggleStatus]":"_toggleSectionStatus","click .appItem .appName a":"_openApp","click a[data-action=app-buy]":"_appBuy","click a[data-action=bindDomain]":"bindDomain","click a[data-action=app-upgrade]":"_appUpgrade","click a[data-action=app-renew]":"_appRenew","click input[data-action=switch]":"_switch","click .promotion .title a":"_contentAppInfo"},doInitialize:function(i){this.$el.html(s()),new r.modules.app.AccountInfoSidebar({el:t("<div/>").insertAfter(this.$el.find(".appItems"))}),e.Events.on("app.settings.fresh",n.bind(this._onCommand,this)),e.Events.on("app.settings.publish",n.bind(this._onPublish,this)),e.Events.on("app.settings.bindDomain",n.bind(this._bindDomain,this)),e.Events.on("app.saved",n.bind(this._onAppSaved,this)),e.Events.on("app.settings.freshCms",n.bind(this._onFreshCms,this))},onShow:function(){this._loadData()},onHide:function(){},onRecover:function(){},onRemove:function(){e.Events.off("app.settings.fresh",this._onCommand),e.Events.off("app.settings.publish",this._onPublish),e.Events.off("app.saved",this._onAppSaved),e.Events.off("app.settings.freshCms",this._onFreshCms),this._length>0?this._appInfoSidebar=new r.modules.app.AppInfoSidebar({app:this._app,qrcode:"qrcode",el:t("<div/>").appendTo(this.$el.find(".accountInfo"))}):new r.modules.app.AccountInfoSidebar({el:t("<div/>").insertAfter(this.$el.find(".appItems"))})},_loadData:function(){r.showProgressIndicator("装载微站列表...");var e=this;t.get(r.api("/apps")).done(function(i){console.log(i),r.App.config.webApps.apps=e._apps=i.apps,e._appVoList={},n.each(i.appVoList,function(t,n){e._appVoList[t.app_id]=t}),e._appInfoMap={},n.each(i.apps,function(t,n){e._appInfoMap[t.id]=t}),e._layoutTemplateId=i.templateId;if(e._apps.length>0){e._app=r.App.config.currentApp||i.apps[0];var s=e._app.list_index||e._app.sort_index;e._app.page=Math.floor((e._apps.length-s)/2)}e._length=e._apps.length,e._renderAll(),e._appInfoSidebar&&e._appInfoSidebar.close(),e._length>0?e._appInfoSidebar=new r.modules.app.AppInfoSidebar({app:e._app,qrcode:"qrcode",el:t("<div/>").appendTo(e.$el.find(".accountInfo"))}):new r.modules.app.AccountInfoSidebar({el:t("<div/>").insertAfter(e.$el.find(".appItems"))}),r.closeProgressIndicator()}).error(function(e){r.closeProgressIndicator()})},_initZerocopy:function(){var e=t('a[data-action="copyLink"]');e.zclip("remove"),e.zclip({path:"/img/ZeroClipboard.swf",copy:n.bind(this._getVSiteUrl,this)})},_getVSiteUrl:function(){return r.App.config.currentApp.personalized_addr},_render:function(){var e=this;this.$el.find(".appItemsInner").html(o(this._apps)),e._apps=this._apps,e._apps.length>0&&(e._currApp!=undefined?e._app=e._currApp:e._app=e._apps[0],e._appInfoSidebar=new r.modules.app.AppInfoSidebar({app:e._app,qrcode:"qrcode",el:t("<div/>").appendTo(e.$el.find(".accountInfo"))})),e._length=e._apps.length,this.$el.find(".appItem a").tooltip(),this.$el.find(".appItem label").tooltip(),this.$el.find(".appIcon").tooltip()},_renderAll:function(){var e=this;this.$el.find(".appItemsInner").html(o(this._apps)),this._apps.length>0&&(this.$el.find(".appItem a").tooltip(),this.$el.find(".appItem label").tooltip(),this.$el.find(".appIcon").tooltip(),this.$el.find(".appItem").filter("[data-app-id="+this._app.id+"]").trigger("click"),this.$el.find("[data-slide-to="+this._app.page+"]").trigger("click"))},_previewApp:function(e){e.preventDefault(),e.stopPropagation(),t(e.target).parents(".appItem[data-app-id]").click(),this._appInfoSidebar&&this._appInfoSidebar.close();var i=t(e.target).closest(".appItem").data().appId,s=t(e.target).closest(".appItem").data().securitykey,o="/console/preview?env=preview&terminalType=PHONE&appId="+i+"&securityKey="+encodeURIComponent(s)+"&"+r.App.config.buildNumber,u=this,a=n.find(u._apps,function(e){return e.id==i});u._appInfoSidebar=new r.modules.app.AppInfoSidebar({app:a,preview:"preview",url:o,el:t("<div/>").appendTo(u.$el.find(".accountInfo"))})},_toggleSectionStatus:function(e){var n=t(e.target).closest(".appItem").data().state;if(n=="PAUSED_BY_ADMIN"||n=="UNPUBLISHED"){t(e.target).closest("input").removeAttr("checked"),t(e.target).closest("label").attr("data-original-title",n=="UNPUBLISHED"?"未发布":"平台商暂停"),t(e.target).closest("label").tooltip("show"),n=="UNPUBLISHED"?r.showMessage("ERROR","此微站还未发布,请先发布微站!",!0):r.showMessage("ERROR","此微站被平台商暂停,请联系平台商!",!0);return}var i=t(e.target).attr("checked")?"PUBLISHED":"PAUSED_BY_USER",s=i=="PUBLISHED"?"PUBLISHED":"PAUSED_BY_USER",o=t(e.target).closest(".appItem").data().appId;if(s=="PAUSED_BY_ADMIN"||s=="UNPUBLISHED")return;t.ajax(r.api("/apps/state"),{type:"POST",data:"state="+s+"&appId="+o}).done(function(n){n.code=="200"?(t(e.target).closest("label").attr("data-original-title",i=="PAUSED_BY_USER"?"已停用":"已启用"),t(e.target).closest("label").tooltip("show"),i=="PAUSED_BY_USER"?t(e.target).closest("input").removeAttr("checked"):t(e.target).closest("input").attr("checked")):r.showMessage("error","暂停/启用微站错误",!0)})},_createApp:function(e){e.preventDefault();var n=this,i=t(e.target).closest(".appItem").data();i.templateId=this._layoutTemplateId,new r.modules.app.CreateApp({app:i})},_configApp:function(e){e.preventDefault();var n=t(e.target).closest(".appItem").data(),i=n.appId;r.navigate("/builder/"+i+"/settings")},_editApp:function(e){function a(n,r,o,u){t(e.target).closest(".appItem").find(".appName>a").text(n),jQuery("#appIcon"+s).attr("src",r),i.appAllowComment=u,i.appName=n,i.appImg=r,i.templateId=o}e.preventDefault(),e.stopPropagation(),t(e.target).parents(".appItem[data-app-id]").click();var n=this,i=t(e.target).closest(".appItem").data(),s=i.appId,o;n._appName!=undefined?o=n._appName:o=i.appName;var u=i.appAllowComment;new r.modules.app.CreateApp({app:i,appName:o,allowComment:u,changeName:a})},_switch:function(e){e.preventDefault(),e.stopPropagation(),t(e.target).parents(".appItem[data-app-id]").click();var n=t(e.target).closest(".appItem").data(),i=n.appId;t.ajax(r.api("/apps/state"),{type:"POST",data:"appId="+i}).done(function(n){n.code=="200"?n.result.publish_state=="PUBLISHED"?t(e.target).closest("input").attr("checked","true"):t(e.target).closest("input").removeAttr("checked"):r.showMessage("error","暂停/启用微站错误",!0)})},_contentApp:function(e){e.preventDefault();var n=t(e.target).closest(".appItem").data(),i=n.appId,s;i!=undefined?s="/builder/"+i:s="/",r.navigate(s)},_contentAppInfo:function(e){e.preventDefault();var n=t(e.target).closest(".promotion-wrap").data(),i=n.appId,s;i!=undefined?s="/builder/"+i:s="/",r.navigate(s)},_appPromotion:function(){},_appContentShow:function(e){e&&e.preventDefault&&e.preventDefault();var n=this,i=n._appVoList,s=n._appInfoMap,o=t(e.target).closest(".appItem");o.parent().siblings().find(".appItem").removeClass("active"),o.addClass("active").siblings().removeClass("active");var u=o.data(),a=u.appId;r.App.config.currentApp=s[a],n.$el.find(".promotion").html(f(i[a],s[a])).removeClass("hide"),this._initZerocopy(),new r.modules.promotion.AppPromotionNew({el:this.$('[data-block="qrcode"]'),appId:a})},_onCommand:function(e){var t=e;t!=undefined&&(this.$el.find("#"+t.id+">a").html(t.name),jQuery("[data-action="+t.id+"]").css({backgroundImage:"url("+t.icon_url+")"}))},_onFreshCms:function(e){this.$el.find(".appIcon").tooltip("hide")},_onPublish:function(e){var n=e,i=this;n!=undefined&&t.get(r.api("/apps/"+n.id)).done(function(e){i._onAppSaved(e.app)}).error(function(e){e.status==403?r.showMessage("ERROR","你要访问的这个App不是你创建的，你没有权限访问哦.",!0):r.showMessage("ERROR","应用信息加载出错, 可能是网速问题，请稍后再试",!0)})},_onFreshStatus:function(e){var e=e;e!=undefined&&(this.$el.find("[data-app-productState="+e.id+"] ").removeClass(),e.productState=="BOUGHT"&&(this.$el.find("[data-app-productState="+e.id+"] ").addClass("app-label purchased"),this.$el.find("[data-app-productState="+e.id+"] ").text("已购买")),this.$el.find("[data-app-expiryDate="+e.id+"]").html(h(e.expiryEndDate,e.productState)))},_showQRCode:function(e){var i=this;e.preventDefault(),e.target.nodeName.toLowerCase()=="button"&&e.stopPropagation(),t(e.target).parents(".appItem[data-app-id]").click(),this._appInfoSidebar&&this._appInfoSidebar.close();var s=t(e.target).closest(".appItem").data().appId,o=n.find(i._apps,function(e){return e.id==s});i._appInfoSidebar=new r.modules.app.AppInfoSidebar({app:o,qrcode:"qrcode",el:t("<div/>").appendTo(i.$el.find(".accountInfo"))})},_appBuy:function(e){e.preventDefault(),e.stopPropagation(),t(e.target).parents(".appItem[data-app-id]").click();var n=this,i=t(e.target).closest(".appItem").data().appId;Buypop.appBuy(i,function(e){e.code=="501"?r.showMessage("ERROR",e.message,!0):(n._onFreshStatus(e.result.app),r.showMessage("SUCCESS","微站购买成功.",!0))})},_appUpgrade:function(e){e.preventDefault(),e.stopPropagation(),t(e.target).parents(".appItem[data-app-id]").click();var n=this,i=t(e.target).closest(".appItem").data().appId;Buypop.appUpgrade(i,function(e){e.code=="501"?r.showMessage("ERROR",e.message,!0):(n._onFreshStatus(e.result.app),r.showMessage("SUCCESS","微站升级成功.",!0))})},_appRenew:function(e){e.preventDefault(),e.stopPropagation(),t(e.target).parents(".appItem[data-app-id]").click();var n=this,i=t(e.target).closest(".appItem").data().appId;Buypop.appRenew(i,function(e){e.code=="501"?r.showMessage("ERROR",e.message,!0):(n._onFreshStatus(e.result.app),r.showMessage("SUCCESS","微站续费成功.",!0))})},_openApp:function(e){e.preventDefault();var n=t(e.target);n.parent().siblings(".appIcon").tooltip("hide");var i=n.attr("href");!i||(i=i.substring(r.App.config.root.length)),r.navigate(i)},_onAppSaved:function(e){this._loadData()},_bindDomain:function(e){var i=this;e=e||{};var s=e.id;this._appVoList[s].release_count=1,this.$el.find(".promotion").html(f(this._appVoList[s],e)).removeClass("hide"),this._initZerocopy(),this._appInfoSidebar&&this._appInfoSidebar.close();var o=n.find(i._apps,function(e){return e.id==s});i._appInfoSidebar=new r.modules.app.AppInfoSidebar({app:o,qrcode:"qrcode",el:t("<div/>").appendTo(i.$el.find(".accountInfo"))}),new r.modules.promotion.AppPromotionNew({el:this.$('[data-block="qrcode"]'),appId:s})},bindDomain:function(){new r.modules.cms.PublishDialog({appInfo:r.App.config.currentApp})}});var s=function(){return'  		<div class="appList">		   <div class="appItems">				<div class="clearfix"></div>	   			<div class="appItemsInner"></div>	   			<div class="clearfix"></div>	   			<div id="promotion" class="promotion hide">	   		</div>		</div>'},o=function(e){var t=this,n=e.length===1?"less-num2":"more-num2",i=e.length>1?"addApp2":"",s="";return s+='<div class="appItem addApp '+i+" "+n+'">			<div id="createApp">				<i class="icon-plus"></i>				<span>创建微站</span>			</div>		</div>',e.length===1?(s="",r.navigate("/builder/"+e[0].id+"/cms/home")):e.length>1&&(s=a(e,"more-num2")),s},u=function(e,t){var n=e.publish_state=="PUBLISHED"?"checked":"";return'<div class="appItem '+t+'"  data-app-id="'+e.id+'" data-template-id="'+e.home.phone_template_id+'" data-app-img="'+e.app_img+'" data-securitykey="'+e.security_key+'"'+'" data-app-name="'+e.name+'"'+'" data-app-allow-comment="'+e.allow_comment+'" data-state="'+e.publish_state+'" >	              '+l(e.product_state,e.id)+'			   <div class="iconCol">			     '+p(e.id,e.app_img)+'			       <button class="btn btn-xs btn-primary" data-action="qrcode">二维码<i class="icon-qrcode"></i></button>			   </div>			   <div class="infoCol">			       <div class="appName">			       <a data-action="'+e.id+'pageNav" href="/console/builder/'+e.id+'">'+e.name+'</a>			       </div>			       <div class="appControl">			           <a href="#" data-rel="tooltip" data-original-title="编辑基本信息" data-action="editApp">			               <i class="icon-pencil"></i>			           </a>			           <a href="#" data-toggle="modal" data-rel="tooltip" data-original-title="预览" data-action="previewApp">			               <i class="icon-eye-open"></i>			           </a>			           '+c(e.publish_state)+'			       </div>			       <hr>			       <div class="expiryDate" data-app-expiryDate="'+e.id+'">			           '+h(e.expiry_end_date,e.product_state)+"			       </div>			   </div>			</div>"},a=function(e,t){var r="",i="",s=t+" active",o=e.length;return n.each(e,function(e,n){n%2==0&&(n==0?(r+='<div class="item active">',i+='<li data-target="#myCarousel" data-slide-to="'+n/2+'" class="active"></li>'):(r+='<div class="item">',i+='<li data-target="#myCarousel" data-slide-to="'+n/2+'"></li>')),n==0?r+=u(e,s):r+=u(e,t);if(n%2==1||n==o-1)r+="</div>"}),'<div class="clearfix"></div><div id="myCarousel" class="carousel slide" data-interval="false">				  <ol class="carousel-indicators">'+i+'</ol>				  <div class="carousel-inner">'+r+'</div>				  <a class="carousel-control left icon-chevron-left" href="#myCarousel" data-slide="prev"></a>				  <a class="carousel-control right icon-chevron-left" href="#myCarousel" data-slide="next"></a>			   </div>'},f=function(e,t){var n=function(){return e.release_count?'<a href="#" data-action="copyLink" class="btn btn-xs">复制连接</a>':'<a href="#" data-action="bindDomain" class="btn btn-xs">绑定个性域名</a>'};return'<div class="promotion-wrap" data-app-id="'+t.id+'">					<div class="title"><h2>'+t.name+'<a href="">编辑微站</a></h2></div>					<div class="page-content">						<div class="profile">							<div class="profile-statistic">								<h3 class="size18">统计概况<a href="/statistics" target="_blank">更多>></a></h3>								<div class="wrapper-left"><p><span>总浏览量: </span>'+e.total_browse+"</p><p>一周浏览量: "+e.week_browse+'</p></div>								<div class="wrapper-right"><p><span>会员总数: </span>'+e.total_member+"</p><p>新增会员数: "+e.new_member+'</p></div>							</div>							<div class="profile-business">								<h3 class="size18">业务管理<a href="/console/builder/'+t.id+'/business" target="_blank">更多>></a> </h3>								<div class="wrapper-left"><p>活动报名人数: <a href="/console/builder/'+t.id+'/business/event" target="_blank">'+e.activity_member+'</a></p><p>掌币兑换申请: <a href="/console/builder/'+t.id+'/business/scoreadmin" target="_blank">'+e.hand_coin_exchange+'</a></p></div>								<div class="wrapper-right"><p>预约人数: <a href="/console/builder/'+t.id+'/business/appointment" target="_blank">'+e.appointment_member+'</a></p><p><span>订单数: </span><a href="/console/builder/'+t.id+'/business/store" target="_blank">'+e.orders+'</a></p></div>	                        </div><div class="clearfix"></div><hr>	                        <h3 class="size18 pull-left">微站URL<br><a style="word-break: break-all" href="'+(t.personalized_addr||"javascript:;")+'" target="_blank">'+(t.personalized_addr||"未绑定个性域名")+"</a>"+n()+'</h3>	                        <div class="clearfix"></div>	                        <p>微站URL是指向微站的web地址，可用于微信公众账号菜单链接、微博、微信的分享等</p>	                        <div class="bdshare_t bds_tools">			                    <div class="pull-left">分享到:</div>			                    <a class="bds_tsina sinaShare" title="分享到新浪微博" target="_blank" href="'+v("weibo")+'"></a>			                    <a class="bds_qzone qqShare" title="分享到QQ空间" target="_blank" href="'+v("qq")+'"></a>			                    <div class="clearfix"></div>			                </div><hr>			                <div data-block="qrcode"></div>						</div>					</div>				</div>'},l=function(e,t){if(e=="INIT"||e=="TRIAL")return'<span class="app-label onTrial" data-app-productState="'+t+'">			<b>试用中</b>			</span>';if(e=="TRIAL_EXPIRED")return'<span class="app-label expired" data-app-productState="'+t+'">			<b>试用过期</b>			</span>';if(e=="EXPIRED")return'<span class="app-label expired" data-app-productState="'+t+'">			<b>已过期</b>			</span>';if(e=="BOUGHT")return'<span class="app-label purchased" data-app-productState="'+t+'">			<b>已购买</b>			</span>'},c=function(e){var t=e=="PUBLISHED"?'checked="checked"':"";return e=="UNPUBLISHED"||e=="PAUSED_BY_ADMIN"?"":'<label style="margin-left:5px;">			    <input data-action="switch" class="ace ace-switch ace-switch-3" type="checkbox" '+t+'>			    <span class="lbl"></span>    		</label>'},h=function(e,t){if(t=="INIT"||t=="TRIAL"||t=="TRIAL_EXPIRED")return'<div class="pull-left">试用有效期: <span>'+i(e).format("YYYY-MM-DD")+"</span></div>";if(t=="BOUGHT")return'<div class="pull-left">有效期: <span>'+i(e).format("YYYY-MM-DD")+"</span></div>";if(t=="EXPIRED")return'<div class="pull-left">有效期: <span>'+i(e).format("YYYY-MM-DD")+"</span></div>"},p=function(e,t){return t!=undefined&&t!=""?' <img id="appIcon'+e+'" src="'+r.assetLink(t)+'"  class="appIcon" style="background-image:none">':' <img id="appIcon'+e+'" class="appIcon">'},d=function(){return""},v=function(e){var t=r.App.config.currentApp,n=r.App.config.hostDomain+"/apps/"+t.id;r.App.config.currentApp.code&&(n=r.App.config.hostDomain+"/apps/"+t.code);var i={name:t.name,icon_url:t.icon_url,viewUrl:n},s;return e==="weibo"?s=r.util.getWeiboShareUrl("vSite",i):e==="qq"&&(s=r.util.getQQShareUrl("vSite",i)),s}}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.user||(r.modules.user={})}(),function(){"use strict";var e=require("jQuery"),t=require("backbone"),n=require("underscore"),r=require("yf");r.modules.user.AccountSetting=r.common.BaseView.extend({events:{"click #return":"_return","click #userInfo":"_userInfo","click #changePassword":"_changePassword","click #saveChangePassword":"_saveChangePassword","click .btn[data-action=uploadAppIcon]":"_uploadImgs","click #saveUserInfo":"_saveUserInfo","click #websiteType":"_websiteType","click #cancel":"_cancel","click #passwordCancel":"_passwordCancel"},doInitialize:function(){var t,n,s=this;e.get(r.api("/user/baseInfo")).done(function(e){e.code=="200"&&(s._iocUrl=e.websiteOwner.qualificationInfo!=undefined?e.websiteOwner.qualificationInfo:"",t=s.$el.html(i(e.websiteOwner)).find(".form-group"),s._cacheData=e.websiteOwner,s._initImageUploaders(s._iocUrl,t))})},viewport:function(){return this._viewport||(this._viewport=this.$el.find(".promotion-viewport")),this._viewport},show:function(e,t){},onRemove:function(){this.off("viewChanged",this._onViewChanged)},_return:function(e){e.preventDefault(),r.navigate("/")},_userInfo:function(t){t.preventDefault(),e("#updatePassword").removeClass("active"),e("#changePwd").hide(),e("#user").addClass("active"),e("#customerInfo").addClass("changePwd tab-pane active").show()},_changePassword:function(t){t.preventDefault(),e("#updatePassword").addClass("active"),e("#changePwd").addClass("changePwd tab-pane active").show(),e("#user").removeClass("active"),e("#customerInfo").hide()},_saveChangePassword:function(t){t.preventDefault();var n=this;e(".validation-error").remove(),e(".has-error").removeClass("has-error"),e.ajax(r.api("/user/updatePassword"),{type:"PUT",data:e("#passwordUpdateForm").serialize()}).done(function(t){t.code=="200"?(e("#password").val(""),e("#newPassword").val(""),e("#confirmPassword").val(""),r.showMessage("success","修改密码成功!",!0)):n._passwordErrors(t.errors)})},_saveUserInfo:function(t){t.preventDefault();var n=this;e(".validation-error").remove(),e(".has-error").removeClass("has-error"),e.ajax(r.api("/userInfo"),{type:"PUT",data:e("#baseInfoForm").serialize()}).done(function(e){e.code=="200"?(n._cacheData=e.websiteOwner,r.showMessage("success","客户信息修改成功!",!0)):n._handleValdiationErrors(e.errors)})},_handleValdiationErrors:function(t){if(n.isArray(t)&&t[0].key=="overall"){r.showMessage("ERROR",t[0].message,!0);return}n.each(t,function(t){e("#"+t.key).after('<div class="validation-error">'+t.message+"</div>").parents(".form-group").addClass("has-error")}),e("#baseInfoFormError").addClass("has-error").prepend('<span class="validation-error">有些项填写不正确，请根据指示检查.</span>')},_passwordErrors:function(t){n.each(t,function(t){e("#"+t.key).after('<div class="validation-error">'+t.message+"</div>").parents(".form-group").addClass("has-error")}),e("#passwordErrors").addClass("has-error").prepend('<span class="validation-error">有些项填写不正确，请根据指示检查.</span>')},_cancel:function(t){t.preventDefault(),e(".validation-error").remove(),e(".has-error").removeClass("has-error"),this._initImageUploaders(this._iocUrl,this.$el.html(i(this._cacheData)).find(".form-group"))},_passwordCancel:function(t){t.preventDefault(),e(".validation-error").remove(),e(".has-error").removeClass("has-error")},_initImageUploaders:function(e,t){e&&t.find(".thumbnail[data-action=uploadAppIcon]").attr({src:e}),new r.modules.common.ImageUploader({el:t.find(".thumbnail[data-action=uploadAppIcon]"),uploadUrl:r.api("/files"),onsuccess:n.bind(this._onAppIconUploaded,this)})},_uploadImgs:function(t){t.preventDefault(),e(t.target).closest("#baseInfoForm").find(".thumbnail").trigger("click")},_onAppIconUploaded:function(e,t){this.$el.find("#qualificationInfo_url").val(t.url)},_websiteType:function(t){t.preventDefault();var n=e("#websiteType").val();n!=undefined&&n=="FIRM"&&(e(".validation-error").remove(),e("#nameDiv").attr("class","form-group enhanced required "),e("#telephoneDiv").attr("class","form-group enhanced required"),e("#faxDiv").attr("class","form-group enhanced"),e("#descpDiv").attr("class","form-group enhanced required"),e("#websiteTypeName").html("企业名称"),e("#telephoneDiv div>font").attr("class",""),e("#cellphoneDiv div>font").attr("class","hide"),e("#telephoneLabel").html("企业电话"),e("#faxLabel").html("企业传真"),e("#emailLabel").html("企业邮箱"),e("#formGroupLabel").html("企业营业执照副本"),e("#contactLabel").html("联系人"),e("#descpLabel").html("企业简介")),n!=undefined&&n=="OTHER"&&(e(".validation-error").remove(),e("#nameDiv").attr("class","form-group enhanced required "),e("#telephoneDiv").attr("class","form-group enhanced required"),e("#faxDiv").attr("class","form-group enhanced"),e("#descpDiv").attr("class","form-group enhanced required"),e("#websiteTypeName").html("单位名称"),e("#telephoneDiv div>font").attr("class",""),e("#cellphoneDiv div>font").attr("class","hide"),e("#telephoneLabel").html("单位电话"),e("#emailLabel").html("单位邮箱"),e("#faxLabel").html("单位传真"),e("#formGroupLabel").html("单位介绍信"),e("#selectContactName").html("联系人"),e("#descpLabel").html("单位简介")),n!=undefined&&n=="PERSONAL"&&(e(".validation-error").remove(),e("#nameDiv").attr("class","form-group enhanced required hide"),e("#telephoneDiv").attr("class","form-group enhanced required hide"),e("#faxDiv").attr("class","form-group enhanced required hide"),e("#descpDiv").attr("class","form-group enhanced required hide"),e("#telephoneDiv div>font").attr("class","hide"),e("#cellphoneDiv").attr("class","form-group enhanced required"),e("#emailLabel").html("邮箱"),e("#formGroupLabel").html("身份证"),e("#selectContactName").html("姓名"))}});var i=function(e){return'<div id="pageContentAccountSetting" class="page-content accountSetting">					<a href="#" id="return"  class="btn btn-sm pull-right">返回应用列表 </a>					<div class="clearfix"></div>					<div class="tabbable">						<ul class="nav nav-tabs">							<li id="user" class="active">								<a id="userInfo" data-toggle="tab" href="#">客户信息</a>							</li>							<li id="updatePassword" >								<a id="changePassword" data-toggle="tab" href="#">修改密码</a>							</li>						</ul>		                      '+s(e)+'							<div id="changePwd" class="changePwd tab-pane">								<form id="passwordUpdateForm">									<div class="form-group enhanced required">										<label class="form-group-label">原密码</label>										<div class="form-group-control">											<input type="password" id="password" name="password" class="form-control" placeholder="原密码">										</div>									</div>									<div class="form-group enhanced required">										<label class="form-group-label">新密码</label>										<div class="form-group-control">											<input type="password" id="newPassword" name="newPassword" class="form-control" placeholder="新密码">										</div>									</div>									<div class="form-group enhanced required">										<label class="form-group-label">确认新密码</label>										<div class="form-group-control">											<input type="password" id="confirmPassword" name="confirmPassword" class="form-control" placeholder="确认新密码">										</div>									</div>									<div id="passwordErrors" class="form-group form-actions">										<button id="passwordCancel" type="reset" class="btn btn-cancel">取消</button> 										<button id="saveChangePassword" class="btn btn-primary">保存</button>									</div>								</form>							</div>							</div>						</div>		                '+o(e)+"				</div>"},s=function(e){return'		<div class="tab-content clearfix">			<div id="customerInfo" class="customerInfo tab-pane active">				<form id="baseInfoForm" method="post">		            <input type="hidden" id="qualificationInfo_url" name="websiteOwnerEntity.qualificationInfo" value="'+e.qualificationInfo+'"/>		            <input type="hidden" id="agentId"  name="websiteOwnerEntity.id" value="'+e.id+'"/>					<div class="form-group enhanced">						<label class="form-group-label">用户类型</label>						<div class="form-group-control">							<select id="websiteType" name="websiteOwnerEntity.websiteType">								<option value="FIRM" '+(e.websiteType!=undefined&&e.websiteType=="FIRM"?"selected":"")+'>企业用户</option>								<option value="PERSONAL" '+(e.websiteType!=undefined&&e.websiteType=="PERSONAL"?"selected":"")+'>个人用户</option>								<option value="OTHER" '+(e.websiteType!=undefined&&e.websiteType=="OTHER"?"selected":"")+'>其他</option>							</select>						</div>					</div>					<div id="nameDiv" class="form-group enhanced required">						<label id="websiteTypeName" class="form-group-label">企业名称</label>						<div class="form-group-control">							<input type="text" id="name" name="websiteOwnerEntity.name"  class="form-control" value="'+(e.name!=undefined?e.name:"")+'">						</div>					</div>					<div class="form-group enhanced required">						<label id="formGroupLabel" class="form-group-label">企业营业执照副本</label>						<div  class="form-group-control">							<div id="qualificationInfo" class="licensePhoto">								<div class="imageUploader">									<img class="thumbnail dz-clickable" data-src="holder.js/100x100/text:120x120" data-action="uploadAppIcon">								</div>								<button type="button" class="btn btn-xs btn-default" data-action="uploadAppIcon">									<i class="icon-upload bigger-125"></i>上传								</button>							</div>						</div>					</div>					<div id="contactNameDiv" class="form-group enhanced required">						<label id="selectContactName" class="form-group-label">联系人</label>						<div class="form-group-control">							<input type="text" name="websiteOwnerEntity.contactName"  id="contactName" class="form-control" value="'+(e.contactName!=undefined?e.contactName:"")+'">						</div>					</div>					<div id="cellphoneDiv" class="form-group enhanced">						<label id="cellphoneLabel" class="form-group-label">联系电话</label>						<div class="form-group-control">							<input type="text" name="websiteOwnerEntity.cellphone"  id="cellphone" class="form-control" value="'+(e.cellphone!=undefined?e.cellphone:"")+'">						</div>					</div>					<div id="telephoneDiv" class="form-group enhanced required">						<label class="form-group-label">企业电话</label>						<div class="form-group-control">							<input type="text" name="websiteOwnerEntity.telephone"  id="telephone" class="form-control" value="'+(e.telephone!=undefined?e.telephone:"")+'">						</div>					</div>					<div id="emailDiv" class="form-group enhanced required">						<label id="emailLabel" class="form-group-label">企业邮箱</label>						<div class="form-group-control">							<input type="text" name="websiteOwnerEntity.email" id="email" class="form-control" value="'+(e.email!=undefined?e.email:"")+'">						</div>					</div>					<div id="faxDiv" class="form-group enhanced">						<label id="faxLabel" class="form-group-label">企业传真</label>						<div class="form-group-control">							<input type="text" name="websiteOwnerEntity.fax"  id="fax" class="form-control" value="'+(e.fax!=undefined?e.fax:"")+'">						</div>					</div>					<div class="form-group enhanced">						<label class="form-group-label">从事行业</label>						<div class="form-group-control">							<select id="industry" name="websiteOwnerEntity.industry">								<option value="NEWS" "'+(e.industry!=undefined&&e.industry=="NEWS"?"checked":"")+'">新闻</option>								<option value="EDUCATION" "'+(e.industry!=undefined&&e.industry=="EDUCATION"?"checked":"")+'">教育</option>								<option value="IT" "'+(e.industry!=undefined&&e.industry=="IT"?"checked":"")+'">IT</option>								<option value="OTHER" "'+(e.industry!=undefined&&e.industry=="OTHER"?"checked":"")+'">其他</option>							</select>						</div>					</div>					<div id="postCodeDiv" class="form-group enhanced">						<label class="form-group-label">地址</label>						<div class="form-group-control">							<input type="text" name="websiteOwnerEntity.address" id="address" class="form-control" value="'+(e.address!=undefined?e.address:"")+'">						</div>					</div>					<div class="form-group enhanced">						<label class="form-group-label">邮编</label>						<div class="form-group-control">							<input type="text" name="websiteOwnerEntity.postCode" id="postCode" class="form-control" value="'+(e.postCode!=undefined?e.postCode:"")+'">						</div>					</div>					<div id="descpDiv" class="form-group enhanced">						<label id="descpLabel" class="form-group-label">企业简介</label>						<div class="form-group-control">							<textarea type="text" name="websiteOwnerEntity.descp" id="descp" class="form-control">'+(e.descp!=undefined?e.descp:"")+'</textarea>						</div>					</div>					<div id="baseInfoFormError" class="form-group form-actions">						<button id="cancel" type="reset" class="btn btn-cancel">取消</button> 						<button id="saveUserInfo" class="btn btn-primary">保存</button>					</div>				</form>			</div>		'},o=function(e){return'			<div class="accountInfo">				<div id="unitName" class="unitName">					<i class="icon-home"></i>		            '+(e.name!=undefined?e.name:"企业名称")+'				</div>				<div id="appPermission" class="appPermission">					<i class="icon-th-large"></i>					可建应用数:'+e.appCount+'				</div>				<div id="builtAppCount" class="appPermission">					<i class="icon-th-large"></i>			     	已建应用数: '+e.builtAppCount+'				</div>				<div id="verifyStatu" class="verifyStatu">					<i class="icon-check"></i>					审核状态: <span id="verifyStatuSpan">'+u(e.auditStates)+"</span>				</div>			</div>		"},u=function(e){if(e=="NEW")return"未审核";if(e=="AUDITING")return"审核中";if(e=="APPROVED")return"通过";if(e=="NOT_APPROVED")return"未通过"}}()